var pdfBuilderReact;(()=>{"use strict";var e,t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function o(e,t,n){return(t=function(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(t),e=jQuery,window.PDFBuilderSettingsSaver={collectTabSettings:function(e){var t={},r=document.getElementById("pdf-builder-tab-"+e);return r?(r.querySelectorAll("input, select, textarea").forEach(function(r){var n=r.name;if(n){var a;switch(r.type){case"checkbox":a=r.checked?"1":"0";break;case"radio":if(!r.checked)return;a=r.value;break;case"number":case"range":a=r.value?parseFloat(r.value):"";break;default:a=r.value||""}var o=n.replace(/^pdf_builder_/,"");t[e+"_"+o]=a}}),t):(console.warn("[PDF Builder] Tab container not found:",e),t)},collectAllSettings:function(){var e={};return["general","appearance","security","advanced"].forEach(function(t){var r=this.collectTabSettings(t);Object.assign(e,r)}.bind(this)),e},saveTabSettings:function(t,r){return new Promise(function(n,o){var i=window.pdfBuilderAjax?window.pdfBuilderAjax.nonce:"";e.ajax({url:window.ajaxurl||window.pdfBuilderAjax.ajaxUrl,type:"POST",data:a({action:"pdf_builder_save_"+t,_wpnonce:i},r),success:function(e){e.success?n(e):o(new Error(e.data||"Unknown error"))},error:function(e,t,r){o(new Error("AJAX Error: "+r))}})})},saveAllSettingsGlobally:function(){var e=this,t=[];return this.showGlobalSaveLoading(),["general","licence","systeme","securite","pdf","contenu","templates","developpeur"].forEach(function(r){var n=e.collectTabSettings(r);Object.keys(n).length>0&&t.push(e.saveTabSettings(r,n))}),Promise.all(t).then(function(t){return e.hideGlobalSaveLoading(),e.showGlobalSaveSuccess(),t}).catch(function(t){throw e.hideGlobalSaveLoading(),e.showGlobalSaveError(t.message),t})},showGlobalSaveLoading:function(){var e=document.getElementById("pdf-builder-global-save-btn");e&&(e.disabled=!0,e.innerHTML='<span class="spinner is-active"></span> Sauvegarde...')},hideGlobalSaveLoading:function(){var e=document.getElementById("pdf-builder-global-save-btn");e&&(e.disabled=!1,e.innerHTML="Sauvegarder Tout")},showGlobalSaveSuccess:function(){this.showGlobalSaveMessage("Paramètres sauvegardés avec succès!","success")},showGlobalSaveError:function(e){this.showGlobalSaveMessage("Erreur lors de la sauvegarde: "+e,"error")},showGlobalSaveMessage:function(e,t){document.querySelectorAll(".pdf-builder-global-save-message").forEach(function(e){e.remove()});var r=document.createElement("div");r.className="pdf-builder-global-save-message notice notice-"+t+" is-dismissible",r.innerHTML="<p>"+e+"</p>";var n=document.createElement("button");n.type="button",n.className="notice-dismiss",n.addEventListener("click",function(){r.remove()}),r.appendChild(n);var a=document.getElementById("pdf-builder-global-save-btn");a&&a.parentNode&&a.parentNode.insertBefore(r,a.nextSibling),"success"===t&&setTimeout(function(){r.parentNode&&r.remove()},5e3)},init:function(){var e=this,t=document.getElementById("pdf-builder-global-save-btn");t&&t.addEventListener("click",function(t){t.preventDefault(),e.saveAllSettingsGlobally().catch(function(e){console.error("[PDF Builder] Global save failed:",e)})}),["general","licence","systeme","securite","pdf","contenu","templates","developpeur"].forEach(function(t){var r=document.getElementById("pdf-builder-save-"+t+"-btn");r&&r.addEventListener("click",function(r){r.preventDefault();var n=e.collectTabSettings(t);e.saveTabSettings(t,n).then(function(){e.showTabSaveSuccess(t)}).catch(function(r){e.showTabSaveError(t,r.message)})})})},showTabSaveSuccess:function(e){this.showTabSaveMessage(e,"Paramètres sauvegardés!","success")},showTabSaveError:function(e,t){this.showTabSaveMessage(e,"Erreur: "+t,"error")},showTabSaveMessage:function(e,t,r){var n=document.getElementById("pdf-builder-tab-"+e);if(n){n.querySelectorAll(".pdf-builder-tab-save-message").forEach(function(e){e.remove()});var a=document.createElement("div");a.className="pdf-builder-tab-save-message notice notice-"+r,a.innerHTML="<p>"+t+"</p>";var o=n.firstElementChild;n.insertBefore(a,o),"success"===r&&setTimeout(function(){a.parentNode&&a.remove()},3e3)}}},e(document).ready(function(){window.PDFBuilderSettingsSaver.init()}),pdfBuilderReact=t})();