(()=>{"use strict";var e;window.pdfBuilderSkipFeedback=function(){console.log("[PDF Builder] ‚úÖ pdfBuilderSkipFeedback() appel√©e"),console.log("[PDF Builder] URL de d√©sactivation:",window._pdfBuilderDeactivateUrl),window._pdfBuilderDeactivateUrl?window.location.href=window._pdfBuilderDeactivateUrl:(console.error("[PDF Builder] ‚ùå _pdfBuilderDeactivateUrl est null/undefined !"),alert("[DEBUG] _pdfBuilderDeactivateUrl est vide. V√©rifiez que le lien a bien √©t√© intercept√©."))},window.pdfBuilderSendFeedback=function(){console.log("[PDF Builder] ‚úÖ pdfBuilderSendFeedback() appel√©e"),console.log("[PDF Builder] URL de d√©sactivation:",window._pdfBuilderDeactivateUrl);var e=document.querySelector('input[name="deactivation_reason"]:checked'),n=document.getElementById("pdf_builder_feedback_message"),i=document.getElementById("pdf_builder_feedback_email"),t=document.getElementById("pdf_builder_send_feedback");return console.log("[PDF Builder] reason:",e?e.value:"AUCUNE RAISON S√âLECTIONN√âE"),console.log("[PDF Builder] email:",i?i.value:"N/A"),console.log("[PDF Builder] pdfBuilderDeactivation:","undefined"!=typeof pdfBuilderDeactivation?pdfBuilderDeactivation:"UNDEFINED ‚ùå"),t&&(t.disabled=!0,t.textContent="Envoi en cours..."),"undefined"==typeof jQuery?(console.error("[PDF Builder] ‚ùå jQuery non disponible !"),void(window._pdfBuilderDeactivateUrl&&(window.location.href=window._pdfBuilderDeactivateUrl))):"undefined"==typeof pdfBuilderDeactivation?(console.error("[PDF Builder] ‚ùå pdfBuilderDeactivation non d√©fini, d√©sactivation directe"),void(window._pdfBuilderDeactivateUrl&&(window.location.href=window._pdfBuilderDeactivateUrl))):void jQuery.ajax({url:pdfBuilderDeactivation.ajaxUrl,type:"POST",data:{action:"pdf_builder_send_deactivation_feedback",nonce:pdfBuilderDeactivation.nonce,reason:e?e.value:"autre",message:n?n.value:"",email:i?i.value:""},success:function(e){console.log("[PDF Builder] ‚úÖ Feedback envoy√©:",e)},error:function(e,n,i){console.error("[PDF Builder] ‚ùå Erreur AJAX:",n,i)},complete:function(){console.log("[PDF Builder] Redirection vers:",window._pdfBuilderDeactivateUrl),window._pdfBuilderDeactivateUrl&&(window.location.href=window._pdfBuilderDeactivateUrl)}})},console.log("[PDF Builder] ‚úÖ Fonctions globales d√©finies:",{skip:typeof window.pdfBuilderSkipFeedback,send:typeof window.pdfBuilderSendFeedback}),(e=jQuery)(document).ready(function(){const n=e("body");e('<style id="pdf-builder-modal-styles">').text('\n            #pdf-builder-deactivation-modal {\n                display: none !important;\n                position: fixed !important;\n                top: 0 !important;\n                left: 0 !important;\n                z-index: 999999 !important;\n                width: 100% !important;\n                height: 100% !important;\n                background: rgba(0, 0, 0, 0.6) !important;\n                justify-content: center !important;\n                align-items: center !important;\n            }\n            #pdf-builder-deactivation-modal.show {\n                display: flex !important;\n            }\n            #pdf-builder-deactivation-modal .modal-content {\n                background: white !important;\n                border-radius: 8px !important;\n                box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2) !important;\n                max-width: 500px !important;\n                width: 90% !important;\n                padding: 0 !important;\n                overflow: hidden !important;\n            }\n            #pdf-builder-deactivation-modal .modal-header {\n                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;\n                color: white !important;\n                padding: 20px !important;\n                margin: 0 !important;\n            }\n            #pdf-builder-deactivation-modal .modal-header h2 {\n                margin: 0 !important;\n                font-size: 18px !important;\n            }\n            #pdf-builder-deactivation-modal .modal-body {\n                padding: 20px !important;\n            }\n            #pdf-builder-deactivation-modal .feedback-group {\n                margin-bottom: 15px !important;\n            }\n            #pdf-builder-deactivation-modal .feedback-option {\n                display: flex !important;\n                align-items: flex-start !important;\n                padding: 10px !important;\n                border: 1px solid #e0e0e0 !important;\n                border-radius: 5px !important;\n                cursor: pointer !important;\n                margin-bottom: 8px !important;\n            }\n            #pdf-builder-deactivation-modal .feedback-option:hover {\n                background: #f9f9f9 !important;\n                border-color: #667eea !important;\n            }\n            #pdf-builder-deactivation-modal .feedback-option input[type="radio"] {\n                margin-top: 2px !important;\n                margin-right: 10px !important;\n                cursor: pointer !important;\n            }\n            #pdf-builder-deactivation-modal .feedback-option label {\n                cursor: pointer !important;\n                flex: 1 !important;\n            }\n            #pdf-builder-deactivation-modal textarea {\n                width: 100% !important;\n                min-height: 80px !important;\n                padding: 10px !important;\n                border: 1px solid #e0e0e0 !important;\n                border-radius: 5px !important;\n                font-family: inherit !important;\n                display: none !important;\n                box-sizing: border-box !important;\n                margin-top: 10px !important;\n            }\n            #pdf-builder-deactivation-modal textarea.show { display: block !important; }\n            #pdf-builder-deactivation-modal .email-field { margin-bottom: 15px !important; display: none !important; }\n            #pdf-builder-deactivation-modal .email-field.show { display: block !important; }\n            #pdf-builder-deactivation-modal .email-field input {\n                width: 100% !important;\n                padding: 8px !important;\n                border: 1px solid #e0e0e0 !important;\n                border-radius: 5px !important;\n                box-sizing: border-box !important;\n            }\n            #pdf-builder-deactivation-modal .modal-footer {\n                display: flex !important;\n                gap: 10px !important;\n                padding: 20px !important;\n                background: #f5f5f5 !important;\n                justify-content: space-between !important;\n            }\n            #pdf-builder-deactivation-modal .skip-button {\n                padding: 8px 12px !important;\n                border: none !important;\n                background: transparent !important;\n                color: #666 !important;\n                cursor: pointer !important;\n                font-size: 13px !important;\n                text-decoration: underline !important;\n            }\n            #pdf-builder-deactivation-modal .deactivate-button {\n                padding: 10px 20px !important;\n                border: none !important;\n                background: #dc3545 !important;\n                color: white !important;\n                border-radius: 5px !important;\n                cursor: pointer !important;\n                font-weight: 500 !important;\n                font-size: 14px !important;\n            }\n            #pdf-builder-deactivation-modal .deactivate-button:disabled {\n                opacity: 0.6 !important;\n                cursor: not-allowed !important;\n            }\n        ').appendTo("head"),console.log("[PDF Builder] Styles inject√©s"),n.append('\n            <div id="pdf-builder-deactivation-modal">\n                <div class="modal-content">\n                    <div class="modal-header">\n                        <h2>Nous serions tristes de vous voir partir üò¢</h2>\n                        <p style="margin: 5px 0 0 0; font-size: 14px; opacity: 0.9;">Aidez-nous √† am√©liorer PDF Builder Pro</p>\n                    </div>\n                    <div class="modal-body">\n                        <p style="margin: 0 0 15px 0; font-size: 14px;">Dites-nous pourquoi vous d√©sactivez le plugin :</p>\n                        <div class="feedback-group">\n                            <div class="feedback-option"><input type="radio" id="r1" name="deactivation_reason" value="dont_need"><label for="r1">Je n\'en ai plus besoin</label></div>\n                            <div class="feedback-option"><input type="radio" id="r2" name="deactivation_reason" value="not_working"><label for="r2">Le plugin ne fonctionne pas correctement</label></div>\n                            <div class="feedback-option"><input type="radio" id="r3" name="deactivation_reason" value="slow_performance"><label for="r3">Le plugin ralentit mon site</label></div>\n                            <div class="feedback-option"><input type="radio" id="r4" name="deactivation_reason" value="confusing"><label for="r4">Le plugin est difficile √† utiliser</label></div>\n                            <div class="feedback-option"><input type="radio" id="r5" name="deactivation_reason" value="expensive"><label for="r5">C\'est trop cher pour les fonctionnalit√©s</label></div>\n                            <div class="feedback-option"><input type="radio" id="r6" name="deactivation_reason" value="found_alternative"><label for="r6">J\'ai trouv√© une meilleure alternative</label></div>\n                            <div class="feedback-option"><input type="radio" id="r7" name="deactivation_reason" value="temporary"><label for="r7">D√©sactivation temporaire</label></div>\n                            <div class="feedback-option"><input type="radio" id="r8" name="deactivation_reason" value="autre"><label for="r8">Autre raison</label></div>\n                        </div>\n                        <div class="email-field" id="pdf_builder_email_field">\n                            <label for="pdf_builder_feedback_email">Votre email (pour vous recontacter) :</label>\n                            <input type="email" id="pdf_builder_feedback_email" placeholder="votre@email.com">\n                        </div>\n                        <textarea id="pdf_builder_feedback_message" placeholder="Parlez-nous de votre exp√©rience... (optionnel)"></textarea>\n                    </div>\n                    <div class="modal-footer">\n                        <button type="button" class="skip-button" id="pdf_builder_skip_btn">Passer et d√©sactiver</button>\n                        <button type="button" id="pdf_builder_send_feedback" class="deactivate-button">Envoyer et d√©sactiver</button>\n                    </div>\n                </div>\n            </div>\n        '),console.log("[PDF Builder] Modal HTML ajout√© au DOM");const i=e("#pdf-builder-deactivation-modal"),t=document.getElementById("pdf_builder_skip_btn"),o=document.getElementById("pdf_builder_send_feedback");t.addEventListener("mousedown",function(e){console.log("[PDF Builder] üñ±Ô∏è mousedown sur Skip, target:",e.target.id)},!0),o.addEventListener("mousedown",function(e){console.log("[PDF Builder] üñ±Ô∏è mousedown sur Send, target:",e.target.id)},!0),t.addEventListener("click",function(e){console.log("[PDF Builder] ‚úÖ click Skip (capture)"),e.stopPropagation(),window.pdfBuilderSkipFeedback()},!0),o.addEventListener("click",function(e){console.log("[PDF Builder] ‚úÖ click Send (capture)"),e.stopPropagation(),window.pdfBuilderSendFeedback()},!0),document.getElementById("pdf-builder-deactivation-modal").addEventListener("click",function(e){console.log("[PDF Builder] üéØ Click sur le modal, target:",e.target.tagName,e.target.id,e.target.className)},!0),console.log("[PDF Builder] Event listeners attach√©s aux boutons",{skipBtn:!!t,sendBtn:!!o,skipBtnRect:t?JSON.stringify(t.getBoundingClientRect()):"N/A",sendBtnRect:o?JSON.stringify(o.getBoundingClientRect()):"N/A"}),n.on("change",'input[name="deactivation_reason"]',function(){e("#pdf_builder_feedback_message").addClass("show"),e("#pdf_builder_email_field").addClass("show")}),e(document).on("click",'a[href*="action=deactivate"][href*="pdf-builder"]',function(e){e.preventDefault(),e.stopImmediatePropagation(),window._pdfBuilderDeactivateUrl=this.href,console.log("[PDF Builder] D√©sactivation intercept√©e:",window._pdfBuilderDeactivateUrl),console.log("[PDF Builder] pdfBuilderSkipFeedback disponible:",typeof window.pdfBuilderSkipFeedback),console.log("[PDF Builder] pdfBuilderSendFeedback disponible:",typeof window.pdfBuilderSendFeedback),i.addClass("show"),console.log("[PDF Builder] Modal show appliqu√©, classes:",i.attr("class"))})})})();