(()=>{"use strict";!function(e){function a(e,a){"undefined"!=typeof showSystemNotification?showSystemNotification(e,a):alert(e)}e(document).ready(function(){e(".pdfb-canvas-modal-apply").on("click",function(n){n.preventDefault();var t=e(this),c=(t.data("category"),t.closest(".pdfb-canvas-modal-overlay"));if(0===c.find("form").length){var o=new FormData;c.find("input, select, textarea").each(function(){var a=e(this),n=a.attr("name"),t=a.attr("type"),c=a.val();if(n&&!a.prop("disabled"))if("checkbox"===t){if(a.prop("checked"))if(n.endsWith("[]")){var s=n.slice(0,-2);o.append(s,c)}else o.append(n,c)}else"radio"===t?a.prop("checked")&&o.append(n,c):o.append(n,c)}),o.append("action","pdf_builder_save_canvas_settings"),o.append("nonce",pdf_builder_canvas_settings.nonce||""),t.prop("disabled",!0).text("⏳ Sauvegarde..."),e.ajax({url:pdf_builder_canvas_settings.ajax_url||ajaxurl,type:"POST",data:o,processData:!1,contentType:!1,success:function(e){e.success?(a("Paramètres canvas sauvegardés avec succès !","success"),c.hide(),setTimeout(function(){window.location.reload()},1e3)):a("Erreur lors de la sauvegarde : "+(e.data||"Erreur inconnue"),"error")},error:function(e,n,t){a("Erreur AJAX : "+t,"error")},complete:function(){t.prop("disabled",!1).text("✅ Appliquer")}})}}),e(".pdfb-canvas-modal-cancel").on("click",function(a){a.preventDefault(),e(this).closest(".pdfb-canvas-modal-overlay").hide()}),e(".pdfb-canvas-modal-close").on("click",function(a){a.preventDefault(),e(this).closest(".pdfb-canvas-modal-overlay").hide()}),e(".pdfb-canvas-modal-overlay").on("click",function(a){a.target===this&&e(this).hide()})})}(jQuery)})();