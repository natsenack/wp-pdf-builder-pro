(window.webpackChunkpdfBuilderReact=window.webpackChunkpdfBuilderReact||[]).push([[483],{411:()=>{function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}!function(e,t){"use strict";function initializeUtilities(){e.PDF_BUILDER_CONFIG&&e.PDF_BUILDER_CONFIG.debug&&console.log("PDF Builder Utilities initialized"),e.LocalCache.load()}e.PerformanceMetrics={metrics:{},start:function(e){this.metrics[e]||(this.metrics[e]={count:0,totalTime:0,avgTime:0,errorCount:0,minTime:1/0,maxTime:0}),this.metrics[e].startTime=Date.now()},end:function(e){if(this.metrics[e]&&this.metrics[e].startTime){var t=Date.now()-this.metrics[e].startTime,r=this.metrics[e];r.count++,r.totalTime+=t,r.avgTime=r.totalTime/r.count,r.minTime=Math.min(r.minTime,t),r.maxTime=Math.max(r.maxTime,t),delete r.startTime}},error:function(t,r){this.metrics[t]||(this.metrics[t]={count:0,totalTime:0,avgTime:0,errorCount:0,minTime:1/0,maxTime:0}),this.metrics[t].errorCount++,e.PDF_BUILDER_CONFIG&&e.PDF_BUILDER_CONFIG.debug&&console.error("PerformanceMetrics error for "+t+":",r)},getMetrics:function(){return JSON.parse(JSON.stringify(this.metrics))},reset:function(){this.metrics={}}},e.LocalCache={VERSION:"1.1",EXPIRY_HOURS:3,clear:function(){try{sessionStorage.removeItem("pdf_builder_settings_backup"),sessionStorage.removeItem("pdf_builder_cache_metadata")}catch(e){console.warn("LocalCache: Unable to clear cache",e)}},save:function(e){try{var t={data:e,timestamp:Date.now(),version:this.VERSION,hash:this.simpleHash(JSON.stringify(e)),sessionId:this.getSessionId()};sessionStorage.setItem("pdf_builder_settings_backup",JSON.stringify(t)),sessionStorage.setItem("pdf_builder_cache_metadata",JSON.stringify({timestamp:t.timestamp,version:t.version,hash:t.hash}))}catch(r){console.warn("LocalCache: Unable to save data",r)}},load:function(){try{var e=sessionStorage.getItem("pdf_builder_settings_backup");if(!e)return null;var t=JSON.parse(e);return Date.now()-t.timestamp>=60*this.EXPIRY_HOURS*60*1e3||(t.version!==this.VERSION||t.hash!==this.simpleHash(JSON.stringify(t.data))||t.sessionId!==this.getSessionId())?(this.clear(),null):t.data}catch(r){return console.warn("LocalCache: Corrupted data, clearing cache",r),this.clear(),null}},simpleHash:function(e){var t=0;if(0===e.length)return t.toString();for(var r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t&=t}return t.toString()},getSessionId:function(){var e=sessionStorage.getItem("pdf_builder_session_id");return e||(e="session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("pdf_builder_session_id",e)),e}},e.validateFormData=function(e){var t=[];if(!e||"object"!==_typeof(e))return t.push("Données de formulaire invalides"),t;for(var r=0,n=["pdf_builder_cache_max_size","pdf_builder_cache_ttl","pdf_builder_max_execution_time","pdf_builder_memory_limit"];r<n.length;r++){var a=n[r];if(void 0!==e[a]&&""!==e[a]){var i=parseInt(e[a]);(isNaN(i)||i<0)&&t.push("".concat(a.replace("pdf_builder_","").replace(/_/g," ")," doit être un nombre positif"))}}for(var o=0,c=["pdf_builder_company_email"];o<c.length;o++){var s=c[o];if(e[s]&&e[s].trim()){/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e[s])||t.push("".concat(s.replace("pdf_builder_","").replace(/_/g," ")," doit être une adresse email valide"))}}for(var l=0,u=["pdf_builder_logo_url","pdf_builder_custom_css_url"];l<u.length;l++){var d=u[l];if(e[d]&&e[d].trim())try{new URL(e[d])}catch(_){t.push("".concat(d.replace("pdf_builder_","").replace(/_/g," ")," doit être une URL valide"))}}for(var f=0,m=["pdf_builder_company_name"];f<m.length;f++){var p=m[f];e[p]&&e[p].trim()||t.push("".concat(p.replace("pdf_builder_","").replace(/_/g," ")," est obligatoire"))}return t},e.AjaxCompat={fetch:function(e){function fetch(t){return e.apply(this,arguments)}return fetch.toString=function(){return e.toString()},fetch}(function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="ajax_"+Date.now();return e.PerformanceMetrics.start(n),fetch(t,r).then(function(t){if(e.PerformanceMetrics.end(n),!t.ok)throw new Error("HTTP ".concat(t.status,": ").concat(t.statusText));return t}).catch(function(t){throw e.PerformanceMetrics.error(n,t),t})}),post:function(t,r){var n=new FormData;for(var a in e.PDF_BUILDER_CONFIG&&e.PDF_BUILDER_CONFIG.nonce&&n.append("nonce",e.PDF_BUILDER_CONFIG.nonce),r)n.append(a,r[a]);return this.fetch(t,{method:"POST",body:n}).then(function(e){return e.json()})},get:function(e){return this.fetch(e).then(function(e){return e.json()})}},"loading"===t.readyState?t.addEventListener("DOMContentLoaded",function(){initializeUtilities()}):initializeUtilities()}(window,document)},483:(e,t,r)=>{"use strict";r.r(t);r(411);function _slicedToArray(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,o,c=[],s=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);s=!0);}catch(e){l=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}(e,t)||_unsupportedIterableToArray(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,F=function(){};return{s:F,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function debugLog(){}void 0===window.PDF_BUILDER_CONFIG&&(window.PDF_BUILDER_CONFIG={debug:!1,ajaxurl:"",nonce:""}),document.addEventListener("DOMContentLoaded",function(){window.PerformanceMetrics&&window.PerformanceMetrics.start("tabs_initialization");var e=document.getElementById("pdf-builder-tabs"),t=document.getElementById("pdf-builder-tab-content");if(e&&t){e.addEventListener("click",function(r){var n=r.target.closest(".nav-tab");if(n){r.preventDefault();var a=n.getAttribute("data-tab");if(a){e.querySelectorAll(".nav-tab").forEach(function(e){e.classList.remove("nav-tab-active"),e.setAttribute("aria-selected","false")}),t.querySelectorAll(".tab-content").forEach(function(e){e.classList.remove("active")}),n.classList.add("nav-tab-active"),n.setAttribute("aria-selected","true");var i=document.getElementById("tab-content-"+a);i&&i.classList.add("active"),window.LocalCache&&window.LocalCache.save({activeTab:a,timestamp:Date.now()});try{localStorage.setItem("pdf_builder_active_tab",a)}catch(r){}}}});var r=!1;if(window.LocalCache){var n=window.LocalCache.load();if(n&&n.activeTab){var a=e.querySelector('[data-tab="'+n.activeTab+'"]'),i=document.getElementById("tab-content-"+n.activeTab);a&&i&&(a.click(),r=!0)}}if(!r)try{var o=localStorage.getItem("pdf_builder_active_tab");if(o){var c=e.querySelector('[data-tab="'+o+'"]'),s=document.getElementById("tab-content-"+o);c&&s&&(c.click(),r=!0)}}catch(u){}if(!r){var l=e.querySelector(".nav-tab");l&&l.click()}window.PerformanceMetrics&&window.PerformanceMetrics.end("tabs_initialization")}else window.PerformanceMetrics&&window.PerformanceMetrics.error("tabs_initialization","Containers not found")});var n=!1;document.addEventListener("DOMContentLoaded",function initSaveButton(){if(!("undefined"!=typeof window&&window.location&&-1===window.location.href.indexOf("page=pdf-builder-settings")||n)){var e=document.getElementById("pdf-builder-save-floating-btn"),t=document.getElementById("pdf-builder-save-floating");e&&t?(e.addEventListener("click",function(t){t.preventDefault();var r=document.querySelector('form[action="options.php"]');if(!r){var n,a=_createForOfIteratorHelper(document.querySelectorAll("form"));try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.querySelector('[name*="pdf_builder_settings"]')){r=i,debugLog();break}}}catch(d){a.e(d)}finally{a.f()}}if(r||(r=document.querySelector("form")),r){var o,c=_createForOfIteratorHelper(new FormData(r).entries());try{for(c.s();!(o=c.n()).done;){var s=_slicedToArray(o.value,2),l=s[0];(l.includes("template")||l.includes("pdf_builder_settings"))&&0}}catch(d){c.e(d)}finally{c.f()}var u=e.textContent;e.textContent="Sauvegarde...",e.disabled=!0,r.submit(),setTimeout(function(){e.textContent=u,e.disabled=!1},5e3)}else{document.querySelectorAll("form").forEach(function(e,t){e.querySelectorAll('[name*="template"], [name*="pdf_builder_settings"]')})}}),n=!0):setTimeout(initSaveButton,1e3)}}),window.PDFBuilderTabsAPI={switchToTab:function(e){var t=document.querySelector('[data-tab="'+e+'"]');t&&t.click()},getActiveTab:function(){try{return localStorage.getItem("pdf_builder_active_tab")}catch(e){return null}},toggleAdvancedSection:function(){var e=document.getElementById("advanced-section"),t=document.getElementById("advanced-toggle");if(e&&t){var r="none"!==e.style.display;e.style.display=r?"none":"block",t.textContent=r?"▼":"▲"}},resetTemplatesStatus:function(){confirm("Êtes-vous sûr de vouloir réinitialiser tous les mappings de templates ? Cette action ne peut pas être annulée.")&&(document.querySelectorAll('#templates-status-form select[name^="pdf_builder_order_status_templates"]').forEach(function(e){e.value=""}),alert("Les mappings de templates ont été réinitialisés. N'oubliez pas de sauvegarder vos modifications."))}}}}]);