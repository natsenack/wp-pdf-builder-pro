/*! For license information please see hooks-contexts-ae795992.js.LICENSE.txt */
"use strict";(this.webpackChunkwp_pdf_builder_pro=this.webpackChunkwp_pdf_builder_pro||[]).push([[542],{49:function(e,t,n){n.d(t,{h:function(){return b},r:function(){return h}});var r=n(594),o=n(848);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var i=r&&r.prototype instanceof s?r:s,c=Object.create(i.prototype);return l(c,"_invoke",function(n,r,o){var a,i,l,s=0,c=o||[],u=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,l=e,f.n=n,d}};function p(n,r){for(i=n,l=r,t=0;!u&&s&&!o&&t<c.length;t++){var o,a=c[t],p=f.p,m=a[2];n>3?(o=m===r)&&(l=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,f.n=m,i=0))}if(o||n>1)return d;throw u=!0,r}return function(o,c,m){if(s>1)throw TypeError("Generator is already running");for(u&&1===c&&p(c,m),i=c,l=m;(t=i<2?e:l)||!u;){a||(i?i<3?(i>1&&(f.n=-1),p(i,l)):f.n=l:f.v=l);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(u=f.n<0)?l:n.call(r,f))!==d)break}catch(t){a=e,i=1,l=t}finally{s=1}}return{value:t,done:u}}}(n,o,a),!0),c}var d={};function s(){}function c(){}function u(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(l(t={},r,function(){return this}),t),p=u.prototype=s.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,l(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=u,l(p,"constructor",u),l(u,"constructor",c),c.displayName="GeneratorFunction",l(u,o,"GeneratorFunction"),l(p),l(p,o,"Generator"),l(p,r,function(){return this}),l(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:a,m:m}})()}function l(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}l=function(e,t,n,r){function a(t,n){l(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},l(e,t,n,r)}function d(e,t,n,r,o,a,i){try{var l=e[a](i),d=l.value}catch(e){return void n(e)}l.done?t(d):Promise.resolve(d).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){d(a,r,o,i,l,"next",e)}function l(e){d(a,r,o,i,l,"throw",e)}i(void 0)})}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],d=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;d=!1}else for(;!(d=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);d=!0);}catch(e){s=!0,o=e}finally{try{if(!d&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){m(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function m(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=(0,r.createContext)(void 0),y={canvasWidth:210,canvasHeight:297,canvasUnit:"mm",canvasOrientation:"portrait",canvasBackgroundColor:"#ffffff",containerBackgroundColor:"#f8f9fa",borderColor:"#cccccc",borderWidth:1,shadowEnabled:!1,marginTop:20,marginRight:20,marginBottom:20,marginLeft:20,showMargins:!1,gridShow:!0,gridSize:10,gridColor:"#e5e7eb",gridSnapEnabled:!0,gridSnapTolerance:8,guidesEnabled:!0,navigationEnabled:!0,zoomDefault:100,zoomMin:10,zoomMax:500,zoomStep:25,selectionDragEnabled:!0,selectionMultiSelectEnabled:!0,selectionRotationEnabled:!1,selectionCopyPasteEnabled:!0,selectionShowHandles:!0,selectionHandleSize:8,selectionHandleColor:"#0066cc",canvasSelectionMode:"click",exportQuality:100,exportFormat:"pdf",exportCompression:!0,exportIncludeMetadata:!0,historyUndoLevels:50,historyRedoLevels:50,historyAutoSaveEnabled:!0,historyAutoSaveInterval:3e4,lazyLoadingEditor:!0,lazyLoadingPlugin:!0,debugMode:!1,memoryLimitJs:256,isLoading:!0,isReady:!1,error:null,refreshSettings:function(){}};function g(){try{var e,t,n,r,o,a,i,l,d,s,c,u,f,m,v,g,h,b,S,E,_,w,T,O,M,z,x=window.pdfBuilderCanvasSettings;return"undefined"!=typeof window&&window.pdfBuilderCanvasSettings,x?{canvasWidth:null!==(e=x.canvas_width)&&void 0!==e?e:y.canvasWidth,canvasHeight:null!==(t=x.canvas_height)&&void 0!==t?t:y.canvasHeight,canvasUnit:null!==(n=x.canvas_unit)&&void 0!==n?n:y.canvasUnit,canvasOrientation:null!==(r=x.canvas_orientation)&&void 0!==r?r:y.canvasOrientation,canvasBackgroundColor:null!==(o=x.canvas_background_color)&&void 0!==o?o:y.canvasBackgroundColor,containerBackgroundColor:null!==(a=x.container_background_color)&&void 0!==a?a:y.containerBackgroundColor,borderColor:null!==(i=x.border_color)&&void 0!==i?i:y.borderColor,borderWidth:null!==(l=x.border_width)&&void 0!==l?l:y.borderWidth,shadowEnabled:!0===x.shadow_enabled||"1"===x.shadow_enabled,marginTop:null!==(d=x.margin_top)&&void 0!==d?d:y.marginTop,marginRight:null!==(s=x.margin_right)&&void 0!==s?s:y.marginRight,marginBottom:null!==(c=x.margin_bottom)&&void 0!==c?c:y.marginBottom,marginLeft:null!==(u=x.margin_left)&&void 0!==u?u:y.marginLeft,showMargins:!0===x.show_margins||"1"===x.show_margins,gridShow:!0===x.show_grid||"1"===x.show_grid,gridSize:!0===x.show_grid||"1"===x.show_grid?null!==(f=x.grid_size)&&void 0!==f?f:y.gridSize:0,gridColor:null!==(m=x.grid_color)&&void 0!==m?m:y.gridColor,gridSnapEnabled:!(!0!==x.show_grid&&"1"!==x.show_grid||!0!==x.snap_to_grid&&"1"!==x.snap_to_grid),gridSnapTolerance:null!==(v=x.snap_tolerance)&&void 0!==v?v:y.gridSnapTolerance,guidesEnabled:!0===x.show_guides||"1"===x.show_guides,navigationEnabled:!0===x.navigation_enabled||"1"===x.navigation_enabled,zoomDefault:(P=Math.max(1,null!==(j=x.min_zoom)&&void 0!==j?j:y.zoomMin),D=Math.max(P,null!==(C=x.max_zoom)&&void 0!==C?C:y.zoomMax),R=null!==(L=x.default_zoom)&&void 0!==L?L:y.zoomDefault,Math.max(P,Math.min(D,R))),zoomMin:Math.max(1,null!==(g=x.min_zoom)&&void 0!==g?g:y.zoomMin),zoomMax:function(e,t){var n=Math.max(1,null!==(e=x.min_zoom)&&void 0!==e?e:y.zoomMin),r=null!==(t=x.max_zoom)&&void 0!==t?t:y.zoomMax;return Math.max(n,r)}(),zoomStep:Math.max(1,null!==(h=x.zoom_step)&&void 0!==h?h:y.zoomStep),selectionDragEnabled:!0===x.drag_enabled||"1"===x.drag_enabled,selectionMultiSelectEnabled:!0===x.multi_select||"1"===x.multi_select,selectionRotationEnabled:!0===x.enable_rotation||"1"===x.enable_rotation,selectionCopyPasteEnabled:!0===x.copy_paste_enabled||"1"===x.copy_paste_enabled,selectionShowHandles:!0===x.show_resize_handles||"1"===x.show_resize_handles,selectionHandleSize:null!==(b=x.handle_size)&&void 0!==b?b:y.selectionHandleSize,selectionHandleColor:null!==(S=x.handle_color)&&void 0!==S?S:y.selectionHandleColor,canvasSelectionMode:null!==(E=x.canvas_selection_mode)&&void 0!==E?E:y.canvasSelectionMode,exportQuality:null!==(_=x.image_quality)&&void 0!==_?_:y.exportQuality,exportFormat:null!==(w=x.export_format)&&void 0!==w?w:y.exportFormat,exportCompression:!0===x.compress_images||"1"===x.compress_images,exportIncludeMetadata:!0===x.include_metadata||"1"===x.include_metadata,historyUndoLevels:null!==(T=x.history_undo_levels)&&void 0!==T?T:y.historyUndoLevels,historyRedoLevels:null!==(O=x.history_redo_levels)&&void 0!==O?O:y.historyRedoLevels,historyAutoSaveEnabled:!0===x.history_auto_save_enabled||"1"===x.history_auto_save_enabled,historyAutoSaveInterval:null!==(M=x.history_auto_save_interval)&&void 0!==M?M:y.historyAutoSaveInterval,lazyLoadingEditor:!0===x.lazy_loading_editor||"1"===x.lazy_loading_editor,lazyLoadingPlugin:!0===x.lazy_loading_plugin||"1"===x.lazy_loading_plugin,debugMode:!0===x.debug_mode||"1"===x.debug_mode,memoryLimitJs:null!==(z=x.memory_limit_js)&&void 0!==z?z:y.memoryLimitJs,isLoading:!1,isReady:!0,error:null,refreshSettings:function(){}}:p(p({},y),{},{isLoading:!1,isReady:!0})}catch(k){var A=k instanceof Error?k.message:"Unknown error";return p(p({},y),{},{isLoading:!1,isReady:!1,error:A,refreshSettings:function(){}})}var j,C,L,P,D,R}function h(e){var t=e.children,n=c((0,r.useState)(function(){return g()}),2),a=n[0],l=n[1];(0,r.useEffect)(function(){var e=g();l(e)},[]),(0,r.useEffect)(function(){var e=function(){var e=g();l(e)};return window.addEventListener("pdfBuilderCanvasSettingsUpdated",e),function(){return window.removeEventListener("pdfBuilderCanvasSettingsUpdated",e)}},[]),(0,r.useEffect)(function(){if(!a.gridShow){var e=!1,t={};a.gridSnapEnabled&&(t.gridSnapEnabled=!1,e=!0),0!==a.gridSize&&(t.gridSize=0,e=!0),e&&l(function(e){return p(p({},e),t)})}},[a.gridShow,a.gridSnapEnabled,a.gridSize]);var d,u,f=p(p({},a),{},m(m({updateGridSettings:function(e){l(function(t){return p(p({},t),e)})},saveGridSettings:(u=s(i().m(function e(t){var n,r,o,a,d;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o={show_grid:t.gridShow,grid_size:t.gridSize,snap_to_grid:t.gridSnapEnabled},(a=new FormData).append("action","pdf_builder_save_canvas_settings"),a.append("nonce",(null===(n=window.pdfBuilderAjax)||void 0===n?void 0:n.nonce)||""),a.append("settings",JSON.stringify(o)),e.n=1,fetch((null===(r=window.pdfBuilderAjax)||void 0===r?void 0:r.url)||"/wp-admin/admin-ajax.php",{method:"POST",body:a});case 1:if(!(d=e.v).ok){e.n=3;break}return e.n=2,d.json();case 2:e.v.success&&l(function(e){return p(p({},e),t)}),e.n=4;break;case 3:case 4:e.n=6;break;case 5:e.p=5,e.v;case 6:return e.a(2)}},e,null,[[0,5]])})),function(e){return u.apply(this,arguments)})},"saveGridSettings",(d=s(i().m(function e(t){var n,r,o,a,d;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o=p({},t),!1===t.gridShow&&(o.gridSize=0,o.gridSnapEnabled=!1),(a=new URLSearchParams).append("action","pdf_builder_save_canvas_settings"),a.append("nonce",(null===(n=window.pdfBuilderAjax)||void 0===n?void 0:n.nonce)||""),void 0!==o.gridShow&&a.append("canvas_grid_enabled",o.gridShow?"1":"0"),void 0!==o.gridSize&&a.append("canvas_grid_size",o.gridSize.toString()),void 0!==o.gridSnapEnabled&&a.append("canvas_snap_to_grid",o.gridSnapEnabled?"1":"0"),e.n=1,fetch((null===(r=window.pdfBuilderAjax)||void 0===r?void 0:r.ajax_url)||"/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a});case 1:if(!(d=e.v).ok){e.n=3;break}return e.n=2,d.json();case 2:e.v.success&&l(function(e){return p(p({},e),o)}),e.n=4;break;case 3:case 4:e.n=6;break;case 5:e.p=5,e.v;case 6:return e.a(2)}},e,null,[[0,5]])})),function(e){return d.apply(this,arguments)})),"refreshSettings",function(){var e=g();l(e)}));return(0,o.jsx)(v.Provider,{value:f,children:t})}function b(){var e=(0,r.useContext)(v);if(void 0===e)throw new Error("useCanvasSettings must be used within CanvasSettingsProvider");return e}},75:function(e,t,n){n.d(t,{$J:function(){return O},nY:function(){return M}});var r=n(594),o=n(49),a=n(848);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],d=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;d=!1}else for(;!(d=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);d=!0);}catch(e){s=!0,o=e}finally{try{if(!d&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){p(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:794,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1123;return e.map(function(e){var r=e.x,o=e.y,a=Math.min(15,.3*e.width);r<0&&(r=0),r+a>t&&(r=Math.max(0,t-a));var i=Math.min(10,.3*e.height);return o<0&&(o=0),o+i>n&&(o=Math.max(0,n-i)),r!==e.x||o!==e.y?f(f({},e),{},{x:r,y:o}):e})},v=function(e){var t={showHeaders:!0,showBorders:!0,showAlternatingRows:!0,showSku:!0,showDescription:!0,showQuantity:!0,fontSize:11,currency:"â‚¬",tableStyle:"default",textAlign:"left",verticalAlign:"top",backgroundColor:"#ffffff",headerBackgroundColor:"#f9fafb",headerTextColor:"#111827",alternateRowColor:"#f9fafb",borderColor:"#e5e7eb",textColor:"#374151"};return e.map(function(e){if("product_table"!==e.type)return e;var n=f({},e);Object.keys(t).forEach(function(e){e in n||(n[e]=t[e])});["showHeaders","showBorders","showAlternatingRows","showSku","showDescription","showQuantity"].forEach(function(e){"boolean"!=typeof n[e]&&(n[e]=t[e])});["fontSize"].forEach(function(e){"number"!=typeof n[e]&&(n[e]=t[e])});["left","center","right"].includes(n.textAlign)||(n.textAlign=t.textAlign);["top","middle","bottom"].includes(n.verticalAlign)||(n.verticalAlign=t.verticalAlign);return["backgroundColor","headerBackgroundColor","alternateRowColor","borderColor","headerTextColor","textColor"].forEach(function(e){n[e]&&!/^#[0-9A-Fa-f]{6}$/.test(n[e])&&(n[e]=t[e])}),n.currency&&"string"==typeof n.currency||(n.currency=t.currency),n})},y={zoom:100,pan:{x:0,y:0},showGrid:!1,gridSize:20,snapToGrid:!0,backgroundColor:"#ffffff"},g={selectedElements:[],isSelecting:!1},h={isDragging:!1,draggedElements:[]},b={past:[],present:{elements:[],canvas:y,selection:g,drag:h,mode:"select",template:{isNew:!0,isModified:!1,isSaving:!1,isLoading:!0},previewMode:"editor",history:{}},future:[],canUndo:!1,canRedo:!1};b.present.history=b;var S={elements:[],canvas:y,selection:g,drag:h,mode:"select",template:{isNew:!0,isModified:!1,isSaving:!1,isLoading:!0,name:"Nouveau template",description:"",tags:[],canvasWidth:794,canvasHeight:1123,marginTop:28,marginBottom:28,showGuides:!0,snapToGrid:!1},previewMode:"editor",history:b};function E(e,t){switch(t.type){case"ADD_ELEMENT":return f(f({},e),{},{elements:[].concat(d(e.elements),[t.payload]),template:f(f({},e.template),{},{isModified:!0}),history:_(e,f(f({},e),{},{elements:[].concat(d(e.elements),[t.payload])}))});case"UPDATE_ELEMENT":var n=e.elements.map(function(e){return e.id!==t.payload.id?e:f(f(f({},e),t.payload.updates),{},{updatedAt:new Date})});return f(f({},e),{},{elements:n,template:f(f({},e.template),{},{isModified:!0}),history:_(e,f(f({},e),{},{elements:n}))});case"REMOVE_ELEMENT":return f(f({},e),{},{elements:e.elements.filter(function(e){return e.id!==t.payload}),selection:f(f({},e.selection),{},{selectedElements:e.selection.selectedElements.filter(function(e){return e!==t.payload})}),template:f(f({},e.template),{},{isModified:!0}),history:_(e,f(f({},e),{},{elements:e.elements.filter(function(e){return e.id!==t.payload}),selection:f(f({},e.selection),{},{selectedElements:e.selection.selectedElements.filter(function(e){return e!==t.payload})})}))});case"SET_ELEMENTS":return f(f({},e),{},{elements:t.payload,history:_(e,f(f({},e),{},{elements:t.payload}))});case"SET_SELECTION":return f(f({},e),{},{selection:f(f({},e.selection),{},{selectedElements:t.payload,selectionBounds:w(t.payload,e.elements)})});case"CLEAR_SELECTION":return f(f({},e),{},{selection:f(f({},e.selection),{},{selectedElements:[],selectionBounds:void 0})});case"SET_CANVAS":return f(f({},e),{},{canvas:f(f({},e.canvas),t.payload)});case"SET_MODE":return f(f({},e),{},{mode:t.payload});case"SET_DRAG_STATE":return f(f({},e),{},{drag:f(f({},e.drag),t.payload)});case"SET_PREVIEW_MODE":return f(f({},e),{},{previewMode:t.payload});case"SET_ORDER_ID":return f(f({},e),{},{orderId:t.payload});case"UNDO":if(!e.history.canUndo)return e;var r=e.history.past[e.history.past.length-1];return f(f({},r),{},{history:{past:e.history.past.slice(0,-1),present:r,future:[e].concat(d(e.history.future)),canUndo:e.history.past.length>1,canRedo:!0}});case"REDO":if(!e.history.canRedo)return e;var o=e.history.future[0];return f(f({},o),{},{history:{past:[].concat(d(e.history.past),[e]),present:o,future:e.history.future.slice(1),canUndo:!0,canRedo:e.history.future.length>1}});case"RESET":return S;case"SAVE_TEMPLATE":var a,i;return f(f({},e),{},{template:f(f({},e.template),{},{isNew:!1,isModified:!1,isSaving:!1,lastSaved:new Date,id:(null===(a=t.payload)||void 0===a?void 0:a.id)||e.template.id,name:(null===(i=t.payload)||void 0===i?void 0:i.name)||e.template.name})});case"SET_TEMPLATE_MODIFIED":return f(f({},e),{},{template:f(f({},e.template),{},{isModified:t.payload})});case"SET_TEMPLATE_SAVING":return f(f({},e),{},{template:f(f({},e.template),{},{isSaving:t.payload})});case"UPDATE_TEMPLATE_SETTINGS":return f(f({},e),{},{template:f(f(f({},e.template),t.payload),{},{isModified:!0})});case"TOGGLE_GUIDES":return f(f({},e),{},{template:f(f({},e.template),{},{showGuides:!e.template.showGuides})});case"LOAD_TEMPLATE":var l=t.payload.elements||[],s=v(l),c=m(s),u=t.payload.canvas?f(f({},e.canvas),t.payload.canvas):e.canvas;return f(f({},e),{},{elements:c,canvas:u,template:f(f({},e.template),{},{id:t.payload.id,name:t.payload.name,isNew:!1,isModified:!1,isSaving:!1,isLoading:!1,lastSaved:t.payload.lastSaved}),history:_(e,f(f({},e),{},{elements:c,canvas:u}))});case"NEW_TEMPLATE":return f(f({},S),{},{template:{isNew:!0,isModified:!1,isSaving:!1,isLoading:!1}});default:return e}}function _(e,t){var n=f(f({},e),{},{elements:e.elements.map(function(e){return f({},e)}),canvas:f({},e.canvas),selection:f(f({},e.selection),{},{selectedElements:d(e.selection.selectedElements)}),drag:f({},e.drag),template:f({},e.template),history:e.history});return{past:[].concat(d(e.history.past),[n]),present:t,future:[],canUndo:!0,canRedo:!1}}function w(e,t){if(0!==e.length){var n=t.filter(function(t){return e.includes(t.id)});if(0!==n.length){var r=1/0,o=1/0,a=-1/0,i=-1/0;return n.forEach(function(e){r=Math.min(r,e.x),o=Math.min(o,e.y),a=Math.max(a,e.x+e.width),i=Math.max(i,e.y+e.height)}),{x:r,y:o,width:a-r,height:i-o}}}}var T=(0,r.createContext)(void 0);function O(e){var t=e.children,n=e.initialState,i=f(f({},S),n||{}),d=l((0,r.useReducer)(E,i),2),s=d[0],c=d[1],u=(0,o.h)();(0,r.useEffect)(function(){u.isReady&&100!==u.zoomDefault&&c({type:"SET_CANVAS",payload:{zoom:Math.max(u.zoomMin,Math.min(u.zoomDefault,u.zoomMax))}})},[u.zoomDefault,u.zoomMax,u.zoomMin,u.isReady]),(0,r.useEffect)(function(){var e={};u.gridSize!==s.canvas.gridSize&&(e.gridSize=u.gridSize),s.canvas.showGrid===u.gridShow&&u.gridShow!==s.canvas.showGrid&&(e.showGrid=u.gridShow),s.canvas.snapToGrid===u.gridSnapEnabled&&u.gridSnapEnabled!==s.canvas.snapToGrid&&(e.snapToGrid=u.gridSnapEnabled),Object.keys(e).length>0&&c({type:"SET_CANVAS",payload:e})},[u.gridSize,u.gridShow,u.gridSnapEnabled]),(0,r.useEffect)(function(){var e=function(e){var t=e.detail;t&&c({type:"LOAD_TEMPLATE",payload:t})};return document.addEventListener("pdfBuilderLoadTemplate",e),function(){document.removeEventListener("pdfBuilderLoadTemplate",e)}},[]);var p=function(e){c({type:"SET_CANVAS",payload:e})},m={state:s,dispatch:c,addElement:function(e){c({type:"ADD_ELEMENT",payload:e})},updateElement:function(e,t){c({type:"UPDATE_ELEMENT",payload:{id:e,updates:t}})},removeElement:function(e){c({type:"REMOVE_ELEMENT",payload:e})},setSelection:function(e){c({type:"SET_SELECTION",payload:e})},clearSelection:function(){c({type:"CLEAR_SELECTION"})},setCanvas:p,setMode:function(e){c({type:"SET_MODE",payload:e})},undo:function(){c({type:"UNDO"})},redo:function(){c({type:"REDO"})},reset:function(){c({type:"RESET"})},toggleGrid:function(){p({showGrid:!s.canvas.showGrid})},toggleGuides:function(){c({type:"TOGGLE_GUIDES"})}};return(0,a.jsx)(T.Provider,{value:m,children:t})}function M(){var e=(0,r.useContext)(T);if(void 0===e)throw new Error("useBuilder must be used within a BuilderProvider");return e}}}]);