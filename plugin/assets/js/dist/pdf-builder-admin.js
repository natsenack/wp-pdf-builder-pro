/*! For license information please see pdf-builder-admin.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.pdfBuilderPro=t():e.pdfBuilderPro=t()}(this,function(){return function(){"use strict";var e={52:function(e,t,n){function r(e){this.canvasInstance=e,this.selectedElements=new Set,this.selectionBounds=null,this.isSelecting=!1,this.selectionStartPoint=null,this.selectionRect=null,this.selectionColor="rgba(0, 123, 255, 0.2)",this.selectionBorderColor="#007bff",this.selectionBorderWidth=2,this.minSelectionSize=5}n.r(t),n.d(t,{PDFCanvasSelectionManager:function(){return r}}),e=n.hmd(e),r.prototype.selectAtPoint=function(e,t){var n=this.canvasInstance.getElementAtPoint(e);return t||this.clearSelection(),!!n&&(t&&this.selectedElements.has(n.id)?this.selectedElements.delete(n.id):this.selectedElements.add(n.id),this.updateSelectionBounds(),!0)},r.prototype.startSelection=function(e){this.isSelecting=!0,this.selectionStartPoint={x:e.x,y:e.y},this.selectionRect={x:e.x,y:e.y,width:0,height:0}},r.prototype.updateSelection=function(e){this.isSelecting&&this.selectionStartPoint&&(this.selectionRect.x=Math.min(this.selectionStartPoint.x,e.x),this.selectionRect.y=Math.min(this.selectionStartPoint.y,e.y),this.selectionRect.width=Math.abs(e.x-this.selectionStartPoint.x),this.selectionRect.height=Math.abs(e.y-this.selectionStartPoint.y))},r.prototype.endSelection=function(e){if(this.isSelecting&&this.selectionRect){if(e||this.clearSelection(),this.selectionRect.width>=this.minSelectionSize&&this.selectionRect.height>=this.minSelectionSize)this.getElementsInRect(this.selectionRect).forEach(function(e){this.selectedElements.add(e)}.bind(this));this.updateSelectionBounds(),this.isSelecting=!1,this.selectionStartPoint=null,this.selectionRect=null}},r.prototype.getElementsInRect=function(e){var t=[];return this.canvasInstance.elements.forEach(function(n,r){this.elementIntersectsRect(n,e)&&t.push(r)}.bind(this)),t},r.prototype.elementIntersectsRect=function(e,t){var n=e.properties;return!(n.x+n.width<t.x||t.x+t.width<n.x||n.y+n.height<t.y||t.y+t.height<n.y)},r.prototype.updateSelectionBounds=function(){if(0!==this.selectedElements.size){var e=1/0,t=1/0,n=-1/0,r=-1/0;this.selectedElements.forEach(function(i){var o=this.canvasInstance.elements.get(i);if(o){var a=o.properties;e=Math.min(e,a.x),t=Math.min(t,a.y),n=Math.max(n,a.x+a.width),r=Math.max(r,a.y+a.height)}}.bind(this)),this.selectionBounds={x:e,y:t,width:n-e,height:r-t}}else this.selectionBounds=null},r.prototype.clearSelection=function(){this.selectedElements.clear(),this.selectionBounds=null},r.prototype.getSelectionCount=function(){return this.selectedElements.size},r.prototype.getSelectedElementIds=function(){return Array.from(this.selectedElements)},r.prototype.getSelectedElements=function(){var e=[];return this.selectedElements.forEach(function(t){var n=this.canvasInstance.elements.get(t);n&&e.push(n)}.bind(this)),e},r.prototype.isElementSelected=function(e){return this.selectedElements.has(e)},r.prototype.selectAll=function(){this.canvasInstance.elements.forEach(function(e,t){this.selectedElements.add(t)}.bind(this)),this.updateSelectionBounds()},r.prototype.render=function(e){this.isSelecting&&this.selectionRect&&(e.save(),e.fillStyle=this.selectionColor,e.strokeStyle=this.selectionBorderColor,e.lineWidth=this.selectionBorderWidth,e.fillRect(this.selectionRect.x,this.selectionRect.y,this.selectionRect.width,this.selectionRect.height),e.strokeRect(this.selectionRect.x,this.selectionRect.y,this.selectionRect.width,this.selectionRect.height),e.restore()),this.selectionBounds&&this.selectedElements.size>0&&(e.save(),e.strokeStyle=this.selectionBorderColor,e.lineWidth=this.selectionBorderWidth,e.setLineDash([5,5]),e.strokeRect(this.selectionBounds.x,this.selectionBounds.y,this.selectionBounds.width,this.selectionBounds.height),e.restore())},r.prototype.dispose=function(){this.clearSelection(),this.isSelecting=!1,this.selectionStartPoint=null,this.selectionRect=null},e.exports&&(e.exports=r),t.default=r},57:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.r(t),n.d(t,{PDFCanvasEventManager:function(){return u}});var u=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=null,this.canvasInstance=t,this.eventListeners=new Map,this.mouseState={isDown:!1,button:null,position:{x:0,y:0},lastPosition:{x:0,y:0},dragStart:null},this.keyboardState={keys:new Set,modifiers:{ctrl:!1,shift:!1,alt:!1,meta:!1}},this.touchState={touches:new Map,gesture:null},this.eventConfig={enableKeyboard:!0,enableMouse:!0,enableTouch:!0,enableWheel:!0,enableContextMenu:!1,throttleMouseMove:!0,mouseMoveThrottleMs:16},this.throttleTimers=new Map},(t=[{key:"initialize",value:function(e){this.canvas=e,this.init()}},{key:"init",value:function(){this.attachMouseEvents(),this.attachKeyboardEvents(),this.attachTouchEvents(),this.attachWheelEvents(),this.attachFocusEvents()}},{key:"attachMouseEvents",value:function(){var e=this;this.eventConfig.enableMouse&&["mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","click","dblclick","contextmenu"].forEach(function(t){var n=e.createMouseHandler(t);e.canvas.addEventListener(t,n,{passive:!1}),e.eventListeners.set("mouse_".concat(t),n)})}},{key:"attachKeyboardEvents",value:function(){var e=this;this.eventConfig.enableKeyboard&&["keydown","keyup","keypress"].forEach(function(t){var n=e.createKeyboardHandler(t);document.addEventListener(t,n,{passive:!1}),e.eventListeners.set("keyboard_".concat(t),n)})}},{key:"attachTouchEvents",value:function(){var e=this;this.eventConfig.enableTouch&&["touchstart","touchend","touchmove","touchcancel","gesturestart","gesturechange","gestureend"].forEach(function(t){var n=e.createTouchHandler(t);e.canvas.addEventListener(t,n,{passive:!1,capture:!0}),e.eventListeners.set("touch_".concat(t),n)})}},{key:"attachWheelEvents",value:function(){if(this.eventConfig.enableWheel){var e=this.createWheelHandler();this.canvas.addEventListener("wheel",e,{passive:!1}),this.eventListeners.set("wheel",e)}}},{key:"attachFocusEvents",value:function(){var e=this;["focus","blur","focusin","focusout"].forEach(function(t){var n=e.createFocusHandler(t);e.canvas.addEventListener(t,n),e.eventListeners.set("focus_".concat(t),n)})}},{key:"createMouseHandler",value:function(e){var t=this;return function(n){if("contextmenu"!==e||t.eventConfig.enableContextMenu){t.updateMouseState(n,e);var r=t.normalizeMouseEvent(n,e);"mousemove"===e&&t.eventConfig.throttleMouseMove?t.throttleEvent("mousemove",function(){t.dispatchEvent(r)},t.eventConfig.mouseMoveThrottleMs):t.dispatchEvent(r),t.shouldPreventDefault(n,e)&&n.preventDefault()}else n.preventDefault()}}},{key:"updateMouseState",value:function(e,t){var n=this.canvas.getBoundingClientRect(),r=this.canvas.width/n.width,i=this.canvas.height/n.height;switch(this.mouseState.lastPosition=s({},this.mouseState.position),this.mouseState.position={x:(e.clientX-n.left)*r,y:(e.clientY-n.top)*i},t){case"mousedown":this.mouseState.isDown=!0,this.mouseState.button=e.button,this.mouseState.dragStart=s({},this.mouseState.position);break;case"mouseup":this.mouseState.isDown=!1,this.mouseState.button=null,this.mouseState.dragStart=null}}},{key:"normalizeMouseEvent",value:function(e,t){return{type:t,originalEvent:e,position:s({},this.mouseState.position),delta:{x:this.mouseState.position.x-this.mouseState.lastPosition.x,y:this.mouseState.position.y-this.mouseState.lastPosition.y},button:e.button,buttons:e.buttons,isDown:this.mouseState.isDown,modifiers:s({},this.keyboardState.modifiers),dragStart:this.mouseState.dragStart?s({},this.mouseState.dragStart):null,timestamp:Date.now()}}},{key:"createKeyboardHandler",value:function(e){var t=this;return function(n){t.updateKeyboardState(n,e);var r=t.normalizeKeyboardEvent(n,e);t.dispatchEvent(r),t.shouldPreventDefault(n,e)&&n.preventDefault()}}},{key:"updateKeyboardState",value:function(e,t){var n=e.key.toLowerCase();switch(t){case"keydown":this.keyboardState.keys.add(n);break;case"keyup":this.keyboardState.keys.delete(n)}this.keyboardState.modifiers={ctrl:e.ctrlKey,shift:e.shiftKey,alt:e.altKey,meta:e.metaKey}}},{key:"normalizeKeyboardEvent",value:function(e,t){return{type:t,originalEvent:e,key:e.key,code:e.code,modifiers:s({},this.keyboardState.modifiers),isRepeat:e.repeat,timestamp:Date.now()}}},{key:"createTouchHandler",value:function(e){var t=this;return function(n){t.updateTouchState(n,e);var r=t.normalizeTouchEvent(n,e);t.dispatchEvent(r),t.shouldPreventDefault(n,e)&&n.preventDefault()}}},{key:"updateTouchState",value:function(e,t){var n=this,r=this.canvas.getBoundingClientRect(),i=this.canvas.width/r.width,o=this.canvas.height/r.height;switch(t){case"touchstart":Array.from(e.touches).forEach(function(e){var t={id:e.identifier,x:(e.clientX-r.left)*i,y:(e.clientY-r.top)*o,force:e.force||1};n.touchState.touches.set(e.identifier,t)});break;case"touchend":case"touchcancel":Array.from(e.changedTouches).forEach(function(e){n.touchState.touches.delete(e.identifier)});break;case"touchmove":Array.from(e.touches).forEach(function(e){if(n.touchState.touches.has(e.identifier)){var t=n.touchState.touches.get(e.identifier);t.x=(e.clientX-r.left)*i,t.y=(e.clientY-r.top)*o,t.force=e.force||1}})}this.detectGestures(e)}},{key:"detectGestures",value:function(e){var t=Array.from(this.touchState.touches.values());if(2===t.length){var n=t[0],r=t[1],i=Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2));this.touchState.gesture?this.touchState.gesture.currentDistance=i:this.touchState.gesture={type:"pinch",initialDistance:i,currentDistance:i}}else this.touchState.gesture=null}},{key:"normalizeTouchEvent",value:function(e,t){return{type:t,originalEvent:e,touches:Array.from(this.touchState.touches.values()),changedTouches:Array.from(e.changedTouches||[]).map(function(e){return{id:e.identifier,x:e.clientX,y:e.clientY,force:e.force||1}}),gesture:this.touchState.gesture,timestamp:Date.now()}}},{key:"createWheelHandler",value:function(){var e=this;return function(t){var n=e.normalizeWheelEvent(t);e.dispatchEvent(n),e.shouldPreventDefault(t,"wheel")&&t.preventDefault()}}},{key:"normalizeWheelEvent",value:function(e){return{type:"wheel",originalEvent:e,deltaX:e.deltaX,deltaY:e.deltaY,deltaZ:e.deltaZ,deltaMode:e.deltaMode,modifiers:s({},this.keyboardState.modifiers),timestamp:Date.now()}}},{key:"createFocusHandler",value:function(e){var t=this;return function(n){var r={type:e,originalEvent:n,timestamp:Date.now()};t.dispatchEvent(r)}}},{key:"shouldPreventDefault",value:function(e,t){return"wheel"===t||("contextmenu"===t&&!this.eventConfig.enableContextMenu||!("keydown"!==t||!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Space"].includes(e.code)))}},{key:"dispatchEvent",value:function(e){if(this.canvasInstance){var t={mousedown:"handleMouseDown",mouseup:"handleMouseUp",mousemove:"handleMouseMove",click:"handleClick",dblclick:"handleDoubleClick",keydown:"handleKeyDown",keyup:"handleKeyUp",wheel:"handleWheel",touchstart:"handleTouchStart",touchend:"handleTouchEnd",touchmove:"handleTouchMove"}[e.type];t&&"function"==typeof this.canvasInstance[t]&&this.canvasInstance[t](e),this.emitCustomEvent(e)}}},{key:"emitCustomEvent",value:function(e){var t=new CustomEvent("pdf-canvas-event",{detail:e,bubbles:!0,cancelable:!0});this.canvas.dispatchEvent(t)}},{key:"throttleEvent",value:function(e,t,n){var r=this;this.throttleTimers.has(e)&&clearTimeout(this.throttleTimers.get(e));var i=setTimeout(function(){t(),r.throttleTimers.delete(e)},n);this.throttleTimers.set(e,i)}},{key:"addEventListener",value:function(e,t){this.canvas.addEventListener("pdf-canvas-".concat(e),t)}},{key:"removeEventListener",value:function(e,t){this.canvas.removeEventListener("pdf-canvas-".concat(e),t)}},{key:"getEventState",value:function(){return{mouse:s({},this.mouseState),keyboard:{keys:Array.from(this.keyboardState.keys),modifiers:s({},this.keyboardState.modifiers)},touch:{touches:Array.from(this.touchState.touches.values()),gesture:this.touchState.gesture}}}},{key:"configure",value:function(e){this.eventConfig=s(s({},this.eventConfig),e)}},{key:"simulateEvent",value:function(e,t){var n=s(s({type:e,simulated:!0},t),{},{timestamp:Date.now()});this.dispatchEvent(n)}},{key:"dispose",value:function(){var e=this;this.eventListeners.forEach(function(t,n){var r=i(n.split("_"),2),o=r[0],a=r[1];("keyboard"===o?document:e.canvas).removeEventListener(a,t)}),this.eventListeners.clear(),this.throttleTimers.clear(),this.mouseState={isDown:!1,button:null,position:{x:0,y:0},lastPosition:{x:0,y:0},dragStart:null},this.keyboardState={keys:new Set,modifiers:{ctrl:!1,shift:!1,alt:!1,meta:!1}},this.touchState={touches:new Map,gesture:null}}}])&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();t.default=u},166:function(e,t,n){function r(e){this.canvasInstance=e,this.history=[],this.historyIndex=-1,this.maxHistorySize=50,this.saveState()}n.r(t),n.d(t,{PDFCanvasHistoryManager:function(){return r}}),e=n.hmd(e),r.prototype.saveState=function(){var e={elements:new Map,selectedElement:this.canvasInstance.selectedElement?this.canvasInstance.selectedElement.id:null,timestamp:Date.now()};this.canvasInstance.elements.forEach(function(t,n){e.elements.set(n,JSON.parse(JSON.stringify(t)))}),this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.push(e),this.historyIndex++,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex--)},r.prototype.undo=function(){return this.historyIndex>0&&(this.historyIndex--,this.restoreState(this.history[this.historyIndex]),!0)},r.prototype.redo=function(){return this.historyIndex<this.history.length-1&&(this.historyIndex++,this.restoreState(this.history[this.historyIndex]),!0)},r.prototype.restoreState=function(e){var t=this;if(this.canvasInstance.elements.clear(),e.elements.forEach(function(e,n){t.canvasInstance.elements.set(n,JSON.parse(JSON.stringify(e)))}),e.selectedElement){if(this.canvasInstance.selectedElement=this.canvasInstance.elements.get(e.selectedElement),this.canvasInstance.selectionManager){this.canvasInstance.selectionManager.clearSelection();var n=this.canvasInstance.selectedElement;n&&n.properties?this.canvasInstance.selectionManager.selectAtPoint({x:(n.properties.x||0)+(n.properties.width||100)/2,y:(n.properties.y||0)+(n.properties.height||50)/2},!1):console.warn("restoreState: selectedElement has no properties",n)}}else this.canvasInstance.selectedElement=null,this.canvasInstance.selectionManager&&this.canvasInstance.selectionManager.clearSelection();this.canvasInstance.render(),this.canvasInstance.emit("history-restored",{action:"restore",timestamp:e.timestamp})},r.prototype.canUndo=function(){return this.historyIndex>0},r.prototype.canRedo=function(){return this.historyIndex<this.history.length-1},r.prototype.getHistoryInfo=function(){return{size:this.history.length,currentIndex:this.historyIndex,canUndo:this.canUndo(),canRedo:this.canRedo(),maxSize:this.maxHistorySize}},r.prototype.clearHistory=function(){this.history=[],this.historyIndex=-1,this.saveState()},r.prototype.configure=function(e){if(void 0!==e.maxHistorySize&&(this.maxHistorySize=Math.max(10,Math.min(200,e.maxHistorySize)),this.history.length>this.maxHistorySize)){var t=Math.max(0,this.history.length-this.maxHistorySize);this.history=this.history.slice(t),this.historyIndex=Math.max(0,this.historyIndex-t)}},e.exports&&(e.exports=r),t.default=r},264:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.r(t),n.d(t,{PDFCanvasRenderUtils:function(){return c},RenderUtils:function(){return l}});var c=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.cache=new Map},t=[{key:"drawRoundedRect",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=o.fill,s=void 0===a?null:a,c=o.stroke,l=void 0===c?null:c,h=o.lineWidth,u=void 0===h?1:h,d=o.shadow,f=void 0===d?null:d;this.ctx.save(),f&&(this.ctx.shadowColor=f.color||"#000000",this.ctx.shadowBlur=f.blur||4,this.ctx.shadowOffsetX=f.offsetX||2,this.ctx.shadowOffsetY=f.offsetY||2),this.ctx.beginPath(),this.ctx.moveTo(e+i,t),this.ctx.lineTo(e+n-i,t),this.ctx.quadraticCurveTo(e+n,t,e+n,t+i),this.ctx.lineTo(e+n,t+r-i),this.ctx.quadraticCurveTo(e+n,t+r,e+n-i,t+r),this.ctx.lineTo(e+i,t+r),this.ctx.quadraticCurveTo(e,t+r,e,t+r-i),this.ctx.lineTo(e,t+i),this.ctx.quadraticCurveTo(e,t,e+i,t),this.ctx.closePath(),s&&(this.ctx.fillStyle=s,this.ctx.fill()),l&&(this.ctx.strokeStyle=l,this.ctx.lineWidth=u,this.ctx.stroke()),this.ctx.restore()}},{key:"drawMultilineText",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=o.fontSize,s=void 0===a?14:a,c=o.fontFamily,l=void 0===c?"Arial, sans-serif":c,h=o.fontWeight,u=void 0===h?"normal":h,d=o.color,f=void 0===d?"#000000":d,y=o.lineHeight,p=void 0===y?1.2:y,m=o.textAlign,v=void 0===m?"left":m,g=o.verticalAlign,b=void 0===g?"top":g,w=o.maxLines,x=void 0===w?null:w,S=o.ellipsis,k=void 0===S?"...":S;if(!e)return{width:0,height:0,lines:0};this.ctx.save(),this.ctx.font="".concat(u," ").concat(s,"px ").concat(l),this.ctx.fillStyle=f,this.ctx.textAlign=v;var E,P,C=[],T="",O=i(e.split(" "));try{for(O.s();!(P=O.n()).done;){var M=P.value,I=T+(T?" ":"")+M;this.ctx.measureText(I).width>r&&T?(C.push(T),T=M):T=I}}catch(e){O.e(e)}finally{O.f()}if(T&&C.push(T),x&&C.length>x){C.splice(x-1);var D=C[C.length-1];for(this.ctx.measureText(k).width;C.length>0&&this.ctx.measureText(D+k).width>r;){var j=D.split(" ");j.pop(),C[C.length-1]=j.join(" ")}C[C.length-1]+=k}E=C.length*(s*p);var A=n;"middle"===b?A=n-E/2+s/2:"bottom"===b&&(A=n-E+s);for(var z=0;z<C.length;z++){var L=A+z*(s*p);this.ctx.fillText(C[z],t,L)}return this.ctx.restore(),{width:r,height:E,lines:C.length}}},{key:"drawShape",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="".concat(e,"_").concat(r,"_").concat(JSON.stringify(i));if(this.cache.has(o)){var a=this.cache.get(o);this.drawCachedShape(a,t,n)}else{var s=this.createShape(e,r,i);this.cache.set(o,s),this.drawCachedShape(s,t,n)}}},{key:"createShape",value:function(e,t,n){var r=n.sides,i=void 0===r?6:r,o=n.spikes,a=void 0===o?5:o,s=n.rotation,c=void 0===s?0:s,l=[],h=t/2,u=t/2,d=t/2;switch(e){case"polygon":for(var f=0;f<i;f++){var y=2*f*Math.PI/i+c;l.push({x:h+d*Math.cos(y),y:u+d*Math.sin(y)})}break;case"star":for(var p=0;p<2*a;p++){var m=p*Math.PI/a+c,v=p%2==0?d:.5*d;l.push({x:h+v*Math.cos(m),y:u+v*Math.sin(m)})}break;case"arrow":l.push({x:0,y:.3*t},{x:.7*t,y:.3*t},{x:.7*t,y:.2*t},{x:t,y:.5*t},{x:.7*t,y:.8*t},{x:.7*t,y:.7*t},{x:0,y:.7*t})}return{points:l,type:e}}},{key:"drawCachedShape",value:function(e,t,n){if(this.ctx.save(),this.ctx.translate(t,n),this.ctx.beginPath(),e.points.length>0){this.ctx.moveTo(e.points[0].x,e.points[0].y);for(var r=1;r<e.points.length;r++)this.ctx.lineTo(e.points[r].x,e.points[r].y);this.ctx.closePath()}this.ctx.fillStyle="#e5e7eb",this.ctx.fill(),this.ctx.strokeStyle="#64748b",this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.restore()}},{key:"drawGrid",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.color,o=void 0===i?"#f0f0f0":i,a=r.lineWidth,s=void 0===a?1:a,c=r.showLabels,l=void 0!==c&&c,h=r.labelSize,u=void 0===h?10:h;this.ctx.save(),this.ctx.strokeStyle=o,this.ctx.lineWidth=s,this.ctx.font="".concat(u,"px monospace"),this.ctx.fillStyle="#999";for(var d=0;d<=e;d+=n)this.ctx.beginPath(),this.ctx.moveTo(d,0),this.ctx.lineTo(d,t),this.ctx.stroke(),l&&d>0&&this.ctx.fillText(d.toString(),d+2,u+2);for(var f=0;f<=t;f+=n)this.ctx.beginPath(),this.ctx.moveTo(0,f),this.ctx.lineTo(e,f),this.ctx.stroke(),l&&f>0&&this.ctx.fillText(f.toString(),2,f-2);this.ctx.restore()}},{key:"drawResizeHandles",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=e.properties,i=[{x:r.x,y:r.y,cursor:"nw-resize"},{x:r.x+r.width,y:r.y,cursor:"ne-resize"},{x:r.x+r.width,y:r.y+r.height,cursor:"se-resize"},{x:r.x,y:r.y+r.height,cursor:"sw-resize"}];this.ctx.save(),this.ctx.fillStyle="#007bff",this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=1,i.forEach(function(e){t.ctx.beginPath(),t.ctx.arc(e.x,e.y,n/2,0,2*Math.PI),t.ctx.fill(),t.ctx.stroke(),t.ctx.fillStyle="#ffffff",t.ctx.font="".concat(n-2,"px monospace"),t.ctx.textAlign="center",t.ctx.fillText("â†”",e.x,e.y+2)}),this.ctx.restore()}},{key:"applyAdvancedEffects",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.properties,t.brightness&&100!==t.brightness&&(this.ctx.filter="brightness(".concat(t.brightness,"%)")),t.contrast&&100!==t.contrast&&(this.ctx.filter+=" contrast(".concat(t.contrast,"%)")),t.saturate&&100!==t.saturate&&(this.ctx.filter+=" saturate(".concat(t.saturate,"%)")),t.blur&&t.blur>0&&(this.ctx.filter+=" blur(".concat(t.blur,"px)")),t.hueRotate&&0!==t.hueRotate&&(this.ctx.filter+=" hue-rotate(".concat(t.hueRotate,"deg)"))}},{key:"measureText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.fontSize,r=void 0===n?14:n,i=t.fontFamily,o=void 0===i?"Arial, sans-serif":i,a=t.fontWeight,s=void 0===a?"normal":a;this.ctx.save(),this.ctx.font="".concat(s," ").concat(r,"px ").concat(o);var c=this.ctx.measureText(e),l=1.2*r;return this.ctx.restore(),{width:c.width,height:l,actualBoundingBoxAscent:c.actualBoundingBoxAscent||0,actualBoundingBoxDescent:c.actualBoundingBoxDescent||0}}},{key:"createLinearGradient",value:function(e,t,n,r,i){var o=this.ctx.createLinearGradient(e,t,n,r);return i.forEach(function(e,t){var n=i.length>1?t/(i.length-1):0;o.addColorStop(n,e)}),o}},{key:"createRadialGradient",value:function(e,t,n,r,i,o,a){var s=this.ctx.createRadialGradient(e,t,n,r,i,o);return a.forEach(function(e,t){var n=a.length>1?t/(a.length-1):0;s.addColorStop(n,e)}),s}},{key:"drawStyledLine",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=i.color,a=void 0===o?"#000000":o,s=i.width,c=void 0===s?1:s,l=i.style,h=void 0===l?"solid":l,u=i.cap,d=void 0===u?"butt":u,f=i.dash,y=void 0===f?[]:f;this.ctx.save(),this.ctx.strokeStyle=a,this.ctx.lineWidth=c,this.ctx.lineCap=d,"dashed"===h?this.ctx.setLineDash([5,5]):"dotted"===h?this.ctx.setLineDash([2,2]):y.length>0&&this.ctx.setLineDash(y),this.ctx.beginPath(),this.ctx.moveTo(e,t),this.ctx.lineTo(n,r),this.ctx.stroke(),this.ctx.restore()}},{key:"drawBezierCurve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.tension,r=void 0===n?.5:n,i=t.close,o=void 0!==i&&i;if(!(e.length<2)){if(this.ctx.save(),t.color&&(this.ctx.strokeStyle=t.color),t.width&&(this.ctx.lineWidth=t.width),t.fill&&(this.ctx.fillStyle=t.fill),this.ctx.beginPath(),this.ctx.moveTo(e[0].x,e[0].y),2===e.length)this.ctx.lineTo(e[1].x,e[1].y);else for(var a=1;a<e.length;a++){var s=e[a-1],c=e[a],l=e[a+1]||c,h=s.x+(c.x-s.x)*r,u=s.y+(c.y-s.y)*r,d=c.x-(l.x-s.x)*r,f=c.y-(l.y-s.y)*r;this.ctx.bezierCurveTo(h,u,d,f,c.x,c.y)}o&&this.ctx.closePath(),t.fill&&this.ctx.fill(),this.ctx.stroke(),this.ctx.restore()}}},{key:"clearCache",value:function(){this.cache.clear()}},{key:"getCacheStats",value:function(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}],t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}(),l={degToRad:function(e){return e*(Math.PI/180)},radToDeg:function(e){return e*(180/Math.PI)},distance:function(e,t,n,r){return Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))},angle:function(e,t,n,r){return Math.atan2(r-t,n-e)},pointInRect:function(e,t,n,r,i,o){return e>=n&&e<=n+i&&t>=r&&t<=r+o},pointInCircle:function(e,t,n,r,i){return this.distance(e,t,n,r)<=i},generateRegularPolygon:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=[],o=0;o<e;o++){var a=2*o*Math.PI/e-Math.PI/2;i.push({x:n+t*Math.cos(a),y:r+t*Math.sin(a)})}return i},lerp:function(e,t,n){return e+(t-e)*n},clamp:function(e,t,n){return Math.min(Math.max(e,t),n)}};t.default=c},287:function(e,t,n){n.r(t),n.d(t,{PDFCanvasVanilla:function(){return R},default:function(){return W}});var r=n(901),i=n(878),o=n(351),a=n(483),s=n(57),c=(n(264),n(52)),l=n(557),h=n(718),u=n(730),d=n(349);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g(r.key),r)}}function g(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}var b=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasInstance=t,this.isTransforming=!1,this.transformHandle=null,this.transformStartPoint=null,this.originalBounds=null,this.snapToGrid=!1,this.gridSize=20,this.minSize=10,this.handleSize=12,this.handleColor="#007bff",this.handleBorderColor="#ffffff",this.rotationHandleColor="#ff6b35"},t=[{key:"startTransform",value:function(e,t){if(!e||!t)return!1;if(!this.canvasInstance.selectionManager||0===this.canvasInstance.selectionManager.getSelectionCount())return!1;if(this.isTransforming=!0,this.transformHandle=t,this.transformStartPoint={x:e.x,y:e.y},t.element){var n=t.element.properties;n?this.originalBounds={x:n.x||0,y:n.y||0,width:n.width||100,height:n.height||50}:(console.warn("startTransform: handle.element.properties is undefined"),this.originalBounds={x:0,y:0,width:100,height:50})}else this.originalBounds=this.canvasInstance.selectionManager.selectionBounds;return!0}},{key:"updateTransform",value:function(e){if(e&&this.isTransforming&&this.transformStartPoint&&this.originalBounds){var t=e.x-this.transformStartPoint.x,n=e.y-this.transformStartPoint.y;switch(this.transformHandle.type){case"move":this.moveElements(t,n);break;case"resize":this.resizeElements(this.transformHandle.position,t,n);break;case"rotate":this.rotateElements(t,n)}this.canvasInstance.render()}}},{key:"endTransform",value:function(){this.isTransforming&&(this.isTransforming=!1,this.transformHandle=null,this.transformStartPoint=null,this.originalBounds=null,this.canvasInstance.historyManager&&this.canvasInstance.historyManager.saveState())}},{key:"moveElement",value:function(e,t,n){var r=this.originalBounds;if(e&&e.properties){var i=r.x+t,o=r.y+n;if(this.snapToGrid){var a=this.snapToGridPoint(i,o);i=a.x,o=a.y}e.properties.x=i,e.properties.y=o,e.updatedAt=Date.now()}else console.warn("moveElement: invalid element or properties",e)}},{key:"moveElements",value:function(e,t){var n=this;this.transformHandle&&this.transformHandle.element?this.moveElement(this.transformHandle.element,e,t):this.canvasInstance.selectionManager.getSelectedElementIds().forEach(function(r){var i=n.canvasInstance.elements.get(r);i&&n.moveElement(i,e,t)}),this.canvasInstance.selectionManager.updateSelectionBounds()}},{key:"resizeElements",value:function(e,t,n){var r=this;this.transformHandle&&this.transformHandle.element?this.resizeElement(this.transformHandle.element,e,t,n):this.canvasInstance.selectionManager.getSelectedElementIds().forEach(function(i){var o=r.canvasInstance.elements.get(i);o&&r.resizeElement(o,e,t,n)}),this.canvasInstance.selectionManager.updateSelectionBounds()}},{key:"resizeElement",value:function(e,t,n,r){if(e&&e.properties){var i=e.properties,o=this.originalBounds,a=o.x,s=o.y,c=o.width,l=o.height;switch(t){case"nw":a=o.x+n,s=o.y+r,c=Math.max(this.minSize,o.width-n),l=Math.max(this.minSize,o.height-r);break;case"ne":s=o.y+r,c=Math.max(this.minSize,o.width+n),l=Math.max(this.minSize,o.height-r);break;case"sw":a=o.x+n,c=Math.max(this.minSize,o.width-n),l=Math.max(this.minSize,o.height+r);break;case"se":c=Math.max(this.minSize,o.width+n),l=Math.max(this.minSize,o.height+r);break;case"n":s=o.y+r,l=Math.max(this.minSize,o.height-r);break;case"s":l=Math.max(this.minSize,o.height+r);break;case"w":a=o.x+n,c=Math.max(this.minSize,o.width-n);break;case"e":c=Math.max(this.minSize,o.width+n)}i.x=a,i.y=s,i.width=c,i.height=l,e.updatedAt=Date.now()}else console.warn("resizeElement: invalid element or properties",e)}},{key:"rotateElements",value:function(e,t){var n=this,r=this.originalBounds.x+this.originalBounds.width/2,i=this.originalBounds.y+this.originalBounds.height/2,o=Math.atan2(this.transformStartPoint.y-i,this.transformStartPoint.x-r),a=Math.atan2(this.transformStartPoint.y+t-i,this.transformStartPoint.x+e-r)-o;this.canvasInstance.selectionManager.getSelectedElementIds().forEach(function(e){var t=n.canvasInstance.elements.get(e);t&&t.properties&&(t.properties.rotation=(t.properties.rotation||0)+a,t.updatedAt=Date.now())})}},{key:"snapToGridPoint",value:function(e,t){return{x:Math.round(e/this.gridSize)*this.gridSize,y:Math.round(t/this.gridSize)*this.gridSize}}},{key:"getHandleAtPoint",value:function(e){if(!e)return null;var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=p(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(this.canvasInstance.selectionManager.getSelectedElements());try{for(n.s();!(t=n.n()).done;){var r=t.value,i=this.getHandleAtPointForElement(e,r);if(i)return i}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"getHandleAtPointForElement",value:function(e,t){if(!e||!t||!t.properties)return null;for(var n=t.properties,r=this.getResizeHandles(n),i=0,o=Object.entries(r);i<o.length;i++){var a=y(o[i],2),s=a[0],c=a[1];if(Math.sqrt(Math.pow(e.x-c.x,2)+Math.pow(e.y-c.y,2))<=this.handleSize/2)return{type:"resize",position:s,element:t,x:c.x,y:c.y}}return null}},{key:"getResizeHandles",value:function(e){if(!e)return console.warn("getResizeHandles: props is undefined"),{nw:{x:0,y:0},n:{x:50,y:0},ne:{x:100,y:0},w:{x:0,y:25},e:{x:100,y:25},sw:{x:0,y:50},s:{x:50,y:50},se:{x:100,y:50}};var t=e.x||0,n=e.y||0,r=e.width||100,i=e.height||50;return{nw:{x:t,y:n},n:{x:t+r/2,y:n},ne:{x:t+r,y:n},w:{x:t,y:n+i/2},e:{x:t+r,y:n+i/2},sw:{x:t,y:n+i},s:{x:t+r/2,y:n+i},se:{x:t+r,y:n+i}}}},{key:"render",value:function(e){var t=this;this.canvasInstance.selectionManager&&0!==this.canvasInstance.selectionManager.getSelectionCount()&&this.canvasInstance.selectionManager.getSelectedElements().forEach(function(n){t.renderElementHandles(e,n)})}},{key:"renderElementHandles",value:function(e,t){var n=this;if(t&&t.properties){var r=this.getResizeHandles(t.properties);e.save(),Object.values(r).forEach(function(t){e.fillStyle=n.handleColor,e.strokeStyle=n.handleBorderColor,e.lineWidth=1,e.beginPath(),e.rect(t.x-n.handleSize/2,t.y-n.handleSize/2,n.handleSize,n.handleSize),e.fill(),e.stroke()});var i=r.n;e.fillStyle=this.rotationHandleColor,e.strokeStyle=this.handleBorderColor,e.beginPath(),e.arc(i.x,i.y-20,this.handleSize/2,0,2*Math.PI),e.fill(),e.stroke(),e.restore()}else console.warn("renderElementHandles: invalid element or properties",t)}},{key:"configure",value:function(e){void 0!==e.snapToGrid&&(this.snapToGrid=e.snapToGrid),void 0!==e.gridSize&&(this.gridSize=e.gridSize),void 0!==e.minSize&&(this.minSize=e.minSize),void 0!==e.handleSize&&(this.handleSize=e.handleSize)}},{key:"dispose",value:function(){this.endTransform()}}],t&&v(e.prototype,t),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}(),w=n(166),x=n(703);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||P(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=P(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function P(e,t){if(e){if("string"==typeof e)return C(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function T(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return O(l,"_invoke",function(n,r,i){var o,s,c,l=0,h=i||[],u=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,s=0,c=e,d.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!u&&l&&!i&&t<h.length;t++){var i,o=h[t],f=d.p,y=o[2];n>3?(i=y===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,d.v=r,d.n=o[1]):f<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,d.n=y,s=0))}if(i||n>1)return a;throw u=!0,r}return function(i,h,y){if(l>1)throw TypeError("Generator is already running");for(u&&1===h&&f(h,y),s=h,c=y;(t=s<2?e:c)||!u;){o||(s?s<3?(s>1&&(d.n=-1),f(s,c)):d.n=c:d.v=c);try{if(l=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(u=d.n<0)?c:n.call(r,d))!==a)break}catch(t){o=e,s=1,c=t}finally{l=1}}return{value:t,done:u}}}(n,i,o),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var h=[][r]?t(t([][r]())):(O(t={},r,function(){return this}),t),u=l.prototype=s.prototype=Object.create(h);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,O(e,i,"GeneratorFunction")),e.prototype=Object.create(u),e}return c.prototype=l,O(u,"constructor",l),O(l,"constructor",c),c.displayName="GeneratorFunction",O(l,i,"GeneratorFunction"),O(u),O(u,i,"Generator"),O(u,r,function(){return this}),O(u,"toString",function(){return"[object Generator]"}),(T=function(){return{w:o,m:d}})()}function O(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}O=function(e,t,n,r){function o(t,n){O(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},O(e,t,n,r)}function M(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function I(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){M(o,r,i,a,s,"next",e)}function s(e){M(o,r,i,a,s,"throw",e)}a(void 0)})}}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(t){A(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function A(e,t,n){return(t=L(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L(r.key),r)}}function L(e){var t=function(e,t){if("object"!=S(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==S(t)?t:t+""}var R=function(){return e=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.containerId=t,this.options=j({width:n.width||800,height:n.height||600,backgroundColor:n.backgroundColor||"#ffffff",gridSize:n.gridSize||20,showGrid:!1!==n.showGrid,zoom:n.zoom||1,snapToGrid:!1!==n.snapToGrid,constrainToCanvas:!1!==n.constrainToCanvas,dragFeedback:!1!==n.dragFeedback},n),this.dragState=null,this.isRendering=!1,this.lastMouseMoveTime=0,this.mouseMoveThrottleMs=16,this.eventListeners=new Map,this.wooCommerceManager=i.wooCommerceElementsManager,this.customizationService=o.elementCustomizationService,this.renderer=new a.PDFCanvasRenderer(this),this.eventManager=new s.PDFCanvasEventManager(this),this.selectionManager=new c.PDFCanvasSelectionManager(this),this.propertiesManager=new l.PDFCanvasPropertiesManager(this),this.layersManager=new h.PDFCanvasLayersManager(this),this.exportManager=new u.PDFCanvasExportManager(this),this.performanceOptimizer=new d.PDFCanvasPerformanceOptimizer(this),this.transformationsManager=new b(this),this.historyManager=new w.PDFCanvasHistoryManager(this),this.dragDropManager=new x.PDFCanvasDragDropManager(this),this.mode="select",this.tool=null,this.history=[],this.historyIndex=-1},t=[{key:"on",value:function(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(t)}},{key:"off",value:function(e,t){if(this.eventListeners.has(e)){var n=this.eventListeners.get(e),r=n.indexOf(t);r>-1&&n.splice(r,1)}}},{key:"emit",value:function(e,t){this.eventListeners.has(e)&&this.eventListeners.get(e).forEach(function(e){try{e(t)}catch(e){}})}},{key:"init",value:(p=I(T().m(function e(){return T().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,this.createCanvas(),this.setupContext(),this.renderer.initialize(this.canvas,this.ctx),this.eventManager.initialize(this.canvas),this.attachEventListeners(),e.n=1,this.loadInitialData();case 1:this.render(),this.isInitialized=!0,e.n=3;break;case 2:throw e.p=2,e.v;case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return p.apply(this,arguments)})},{key:"createCanvas",value:function(){if(!document.getElementById(this.containerId))throw new Error('Container with id "'.concat(this.containerId,'" not found'));if(this.canvas=document.getElementById(this.options.canvasElementId||"pdf-builder-canvas"),!this.canvas||"CANVAS"!==this.canvas.tagName)throw new Error('Canvas element with id "'.concat(this.options.canvasElementId||"pdf-builder-canvas",'" not found or is not a canvas element'));if(this.ctx=this.canvas.getContext("2d"),!this.ctx)throw new Error("Failed to get 2D context from canvas");this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height}},{key:"setupContext",value:function(){this.ctx.imageSmoothingEnabled=!0,this.ctx.imageSmoothingQuality="high",this.ctx.textBaseline="top",this.ctx.font="14px Arial, sans-serif"}},{key:"attachEventListeners",value:function(){document.addEventListener("dragover",this.handleDragOver.bind(this)),document.addEventListener("drop",this.handleDrop.bind(this)),window.addEventListener("resize",this.handleResize.bind(this))}},{key:"loadInitialData",value:(y=I(T().m(function e(){return T().w(function(e){for(;;)switch(e.n){case 0:if(!(this.options.templateId&&this.options.templateId>0)){e.n=2;break}return e.n=1,this.loadTemplateFromServer(this.options.templateId);case 1:e.n=3;break;case 2:this.options.templateData&&this.options.templateData.elements&&this.loadTemplateData(this.options.templateData);case 3:return this.wooCommerceManager.setTestMode(!0),e.n=4,this.wooCommerceManager.loadWooCommerceData();case 4:return e.a(2)}},e,this)})),function(){return y.apply(this,arguments)})},{key:"loadTemplateFromServer",value:(f=I(T().m(function e(t){var n,r;return T().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch(window.ajaxurl||"/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"pdf_builder_load_template",template_id:t,nonce:window.pdfBuilderNonce||""})});case 1:return n=e.v,e.n=2,n.json();case 2:(r=e.v).success&&r.data.template&&this.loadTemplateData(r.data.template),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,this,[[0,3]])})),function(e){return f.apply(this,arguments)})},{key:"loadTemplateData",value:function(e){var t=this;e.elements&&(this.elements.clear(),e.elements.forEach(function(e){t.addElement(e.type,e)}))}},{key:"handleMouseDown",value:function(e){console.log("handleMouseDown:",e.position);var t=e.position,n=e.modifiers.ctrl||e.modifiers.shift,r=this.transformationsManager.getHandleAtPoint(t);if(r)return console.log("Starting transformation:",r),this.transformationsManager.startTransform(t,r),void(this.canvas.style.cursor=this.getCursorForHandle(r));var i=this.getElementAtPoint(t);if(i)return console.log("Element clicked for move:",i.id),this.selectionManager.isElementSelected(i.id)||this.selectionManager.selectAtPoint(t,n),this.selectionManager.getSelectionCount()>0&&(this.transformationsManager.startTransform(t,{type:"move"}),this.canvas.style.cursor="move"),void this.render();console.log("Starting selection rectangle"),this.selectionManager.startSelection(t),this.render()}},{key:"handleMouseMove",value:function(e){var t=e.position;if(this.transformationsManager.isTransforming)this.transformationsManager.updateTransform(t);else{if(this.selectionManager.isSelecting)return this.selectionManager.updateSelection(t),void this.render();var n=this.transformationsManager.getHandleAtPoint(t);if(n)this.canvas.style.cursor=this.getCursorForHandle(n);else{var r=this.getElementAtPoint(t);this.canvas.style.cursor=r?"move":"default"}}}},{key:"handleMouseUp",value:function(e){if(console.log("handleMouseUp"),this.transformationsManager.isTransforming)return this.transformationsManager.endTransform(),void(this.canvas.style.cursor="default");if(this.selectionManager.isSelecting){var t=e.modifiers.ctrl||e.modifiers.shift;this.selectionManager.endSelection(t),this.render()}}},{key:"handleDragOver",value:function(e){try{if(!e||"function"!=typeof e.preventDefault)return;this.dragDropManager&&this.dragDropManager.handleDragOver(e)}catch(e){}}},{key:"handleDrop",value:function(e){try{if(!e||"function"!=typeof e.preventDefault)return;this.dragDropManager&&this.dragDropManager.handleDrop(e)}catch(e){}}},{key:"handleKeyDown",value:function(e){switch(console.log("handleKeyDown:",e.key),e.key){case"Delete":case"Backspace":this.deleteSelectedElements();break;case"Escape":this.selectionManager.clearSelection(),this.render();break;case"a":e.modifiers.ctrl&&(e.originalEvent.preventDefault(),this.selectAllElements());break;case"z":e.modifiers.ctrl&&(e.originalEvent.preventDefault(),e.modifiers.shift?this.redo():this.undo());break;case"y":e.modifiers.ctrl&&(e.originalEvent.preventDefault(),this.redo())}}},{key:"handleArrowKey",value:function(e){var t=this,n=this.selectionManager.getSelectedElements();if(0!==n.length){e.preventDefault();var r=e.shiftKey?10:1,i=0,o=0;switch(e.key){case"ArrowUp":o=-r;break;case"ArrowDown":o=r;break;case"ArrowLeft":i=-r;break;case"ArrowRight":i=r}if(this.options.snapToGrid){var a=this.snapToGrid(i,o);i=a.x,o=a.y}n.forEach(function(e){var n=e.properties.x+i,r=e.properties.y+o;t.updateElementProperty(e.id,"x",n),t.updateElementProperty(e.id,"y",r)}),this.historyManager.saveState(),this.render()}}},{key:"handleKeyUp",value:function(e){}},{key:"handleResize",value:function(){this.render()}},{key:"getMousePosition",value:function(e){if(!this.canvas||!e)return{x:0,y:0};var t=this.canvas.getBoundingClientRect(),n=this.canvas.width/t.width,r=this.canvas.height/t.height;return{x:(e.clientX-t.left)*n,y:(e.clientY-t.top)*r}}},{key:"handleSelectMode",value:function(e,t){var n,r,i,o=(null===(n=t.modifiers)||void 0===n?void 0:n.ctrl)||t.ctrlKey||(null===(r=t.originalEvent)||void 0===r?void 0:r.ctrlKey),a=E(this.selectionManager.getSelectedElements());try{for(a.s();!(i=a.n()).done;){var s=i.value,c=this.transformationsManager.getHandleAtPoint(e,s);if(c)return this.transformationsManager.startTransform(e,c),void this.render()}}catch(e){a.e(e)}finally{a.f()}if(this.selectionManager.selectAtPoint(e,o)){var l=this.selectionManager.getSelectedElementIds();1===l.length?this.selectedElement=this.elements.get(l[0]):this.selectedElement=null,this.transformationsManager.isTransforming||this.startDrag(e)}else this.selectionManager.startSelection(e);this.render()}},{key:"handleDrawMode",value:function(e){}},{key:"handleTextMode",value:function(e){}},{key:"startDrag",value:function(e){var t=this.selectionManager.getSelectedElements();if(0!==t.length){this.selectedElement=t[0];var n=this.calculateSelectionBounds(t);this.dragState={startPoint:j({},e),currentPoint:j({},e),elementStartPositions:t.map(function(e){return{id:e.id,x:e.properties&&e.properties.x||0,y:e.properties&&e.properties.y||0,originalX:e.properties&&e.properties.x||0,originalY:e.properties&&e.properties.y||0}}),bounds:n,snapped:!1,lastSnappedPosition:null},this.options.dragFeedback&&(this.canvas.style.cursor="grabbing")}}},{key:"handleDrag",value:function(e){var t=this;if(this.dragState&&this.dragState.elementStartPositions){this.dragState.currentPoint=j({},e);var n=e.x-this.dragState.startPoint.x,r=e.y-this.dragState.startPoint.y;if(this.options.snapToGrid){var i=this.snapToGrid(n,r);n=i.x,r=i.y,this.dragState.snapped=i.snapped}if(this.options.constrainToCanvas){var o=this.constrainToCanvas(n,r,this.dragState.bounds);n=o.x,r=o.y}var a={x:this.dragState.elementStartPositions[0].originalX+n,y:this.dragState.elementStartPositions[0].originalY+r};this.dragState.lastSnappedPosition=a,this.dragState.elementStartPositions.forEach(function(e){var i=t.elements.get(e.id);if(i){var o=e.originalX+n,a=e.originalY+r;i.properties.x=o,i.properties.y=a,i.updatedAt=Date.now()}}),this.renderDragOptimized()}}},{key:"endDrag",value:function(){var e=this;this.dragState&&(this.options.dragFeedback&&(this.canvas.style.cursor=this.getCursorForMode(this.mode)),this.dragState.elementStartPositions.some(function(t){var n=e.elements.get(t.id);return n&&(n.properties.x!==t.originalX||n.properties.y!==t.originalY)})&&this.historyManager.saveState(),this.dragState=null,this.render())}},{key:"calculateSelectionBounds",value:function(e){if(0===e.length)return null;var t=1/0,n=1/0,r=-1/0,i=-1/0;return e.forEach(function(e){var o=e.properties,a=o.x||0,s=o.y||0,c=o.width||100,l=o.height||50;t=Math.min(t,a),n=Math.min(n,s),r=Math.max(r,a+c),i=Math.max(i,s+l)}),{x:t,y:n,width:r-t,height:i-n}}},{key:"snapToGrid",value:function(e,t){var n=this.options.gridSize,r=.3*n,i=Math.round(e/n)*n,o=Math.round(t/n)*n,a=Math.abs(e-i)<=r,s=Math.abs(t-o)<=r;return{x:a?i:e,y:s?o:t,snapped:a||s}}},{key:"constrainToCanvas",value:function(e,t,n){if(!n)return{x:e,y:t};var r=this.canvas.width,i=this.canvas.height,o=n.x+e,a=n.y+t,s=e,c=t;return o<0?s=-n.x:o+n.width>r&&(s=r-n.width-n.x),a<0?c=-n.y:a+n.height>i&&(c=i-n.height-n.y),{x:s,y:c}}},{key:"renderDragOptimized",value:function(){var e=this;if(this.dragState&&!this.isRendering){this.isRendering=!0;try{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.showGrid&&this.drawGrid();var t,n=new Set(this.dragState.elementStartPositions.map(function(e){return e.id})),r=E(this.elements.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!n.has(i.id))try{this.renderer.renderElement(i,i.properties)}catch(e){}}}catch(e){r.e(e)}finally{r.f()}this.dragState.elementStartPositions.forEach(function(t){var n=e.elements.get(t.id);n&&e.renderElementWithDragFeedback(n)}),this.selectionManager.render(this.ctx),this.transformationsManager.render(this.ctx)}finally{this.isRendering=!1}}}},{key:"renderElementWithDragFeedback",value:function(e){var t=e.properties;if(this.ctx.save(),this.ctx.translate(t.x+t.width/2,t.y+t.height/2),t.rotation&&this.ctx.rotate(t.rotation*Math.PI/180),this.ctx.translate(-t.width/2,-t.height/2),void 0!==t.opacity){var n=t.opacity;n<=1?this.ctx.globalAlpha=.8*n:n<=100&&(this.ctx.globalAlpha=n/100*.8)}else this.ctx.globalAlpha=.8;switch(this.ctx.shadowColor="rgba(0, 123, 255, 0.5)",this.ctx.shadowBlur=8,this.ctx.shadowOffsetX=2,this.ctx.shadowOffsetY=2,e.type){case"text":this.renderTextElement(e);break;case"rectangle":this.renderRectangleElement(e);break;case"image":this.renderImageElement(e);break;default:this.renderGenericElement(e)}this.ctx.restore()}},{key:"handleHover",value:function(e){var t,n=E(this.selectionManager.getSelectedElements());try{for(n.s();!(t=n.n()).done;){var r=t.value,i=this.transformationsManager.getHandleAtPoint(e,r);if(i)return void(this.canvas.style.cursor={nw:"nw-resize",n:"n-resize",ne:"ne-resize",e:"e-resize",se:"se-resize",s:"s-resize",sw:"sw-resize",w:"w-resize"}[i.position]||"crosshair")}}catch(e){n.e(e)}finally{n.f()}if(this.dragState)return this.dragState.snapped,void(this.canvas.style.cursor="grabbing");var o=this.getElementAtPoint(e);this.canvas.style.cursor=o?"grab":"default"}},{key:"selectElement",value:function(e){if(this.selectedElement=this.elements.get(e),this.selectionManager.clearSelection(),this.selectedElement){var t=this.selectedElement.properties||{};this.selectionManager.selectAtPoint({x:(t.x||0)+(t.width||100)/2,y:(t.y||0)+(t.height||50)/2},!1)}this.render()}},{key:"deselectElement",value:function(){this.selectedElement=null,this.selectionManager.clearSelection(),this.render()}},{key:"getElementAtPoint",value:function(e){var t,n=E(Array.from(this.elements.values()).reverse());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.isPointInElement(e,r))return r}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"isPointInElement",value:function(e,t){var n=t.properties,r=n.x||0,i=n.y||0,o=n.width||100,a=n.height||50;return e.x>=r&&e.x<=r+o&&e.y>=i&&e.y<=i+a}},{key:"addElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.id&&this.elements.has(t.id))return console.warn("Element with ID ".concat(t.id," already exists, skipping duplicate")),t.id;for(var n=t.id||"element_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),r=j(j({},this.customizationService.getDefaultProperties(e)),t),i={},o=0,a=Object.entries(r);o<a.length;o++){var s=k(a[o],2),c=s[0],l=s[1];i[c]=this.customizationService.validateProperty(c,l)}var h={id:n,type:e,properties:i,createdAt:Date.now(),updatedAt:Date.now()};return this.elements.set(n,h),this.historyManager.saveState(),this.render(),n}},{key:"updateElementProperty",value:function(e,t,n){var i=this.elements.get(e);if(!i)return!1;var o=this.customizationService.validateProperty(t,n);return!!(0,r.isPropertyAllowed)(i.type,t)&&(i.properties[t]=o,i.updatedAt=Date.now(),this.historyManager.saveState(),this.render(),!0)}},{key:"deleteElement",value:function(e){return!!this.elements.delete(e)&&(this.selectedElement&&this.selectedElement.id===e&&(this.selectedElement=null),this.historyManager.saveState(),this.render(),!0)}},{key:"undo",value:function(){this.historyManager&&this.historyManager.undo()}},{key:"redo",value:function(){this.historyManager&&this.historyManager.redo()}},{key:"setZoom",value:function(e){this.options.zoom=Math.max(.1,Math.min(5,e)),this.canvas.style.transform="scale(".concat(this.options.zoom,")"),this.canvas.style.transformOrigin="top left"}},{key:"setMode",value:function(e){this.mode=e,this.canvas.style.cursor=this.getCursorForMode(e)}},{key:"setTool",value:function(e){this.tool=e;var t={select:"select","add-text":"text","add-text-title":"text","add-text-subtitle":"text","add-rectangle":"draw","add-circle":"draw","add-line":"draw","add-arrow":"draw","add-triangle":"draw","add-star":"draw","add-divider":"draw","add-image":"draw"}[e]||"select";this.setMode(t)}},{key:"toggleGrid",value:function(){return console.log("toggleGrid called - current showGrid:",this.options.showGrid),this.options.showGrid=!this.options.showGrid,console.log("toggleGrid - new showGrid:",this.options.showGrid),this.render(),this.options.showGrid}},{key:"setGrid",value:function(e){this.options.showGrid=e,this.render()}},{key:"setSnapToGrid",value:function(e){this.options.snapToGrid=e}},{key:"setConstrainToCanvas",value:function(e){this.options.constrainToCanvas=e}},{key:"setDragFeedback",value:function(e){this.options.dragFeedback=e}},{key:"setGridSize",value:function(e){this.options.gridSize=Math.max(5,Math.min(100,e)),this.options.showGrid&&this.render()}},{key:"selectAll",value:function(){this.selectionManager.clearSelection();var e,t=E(this.elements.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.selectionManager.selectAtPoint({x:n.properties.x+n.properties.width/2,y:n.properties.y+n.properties.height/2},!0)}}catch(e){t.e(e)}finally{t.f()}this.render()}},{key:"selectNone",value:function(){this.selectionManager.clearSelection(),this.selectedElement=null,this.render()}},{key:"invertSelection",value:function(){var e=new Set(this.selectionManager.getSelectedElementIds()),t=Array.from(this.elements.keys());this.selectionManager.clearSelection();for(var n=0,r=t;n<r.length;n++){var i=r[n];if(!e.has(i)){var o=this.elements.get(i);o&&this.selectionManager.selectAtPoint({x:o.properties.x+o.properties.width/2,y:o.properties.y+o.properties.height/2},!0)}}this.render()}},{key:"getCursorForMode",value:function(e){return{select:"default",draw:"crosshair",text:"text",move:"move"}[e]||"default"}},{key:"render",value:function(){if(!this.isRendering){this.isRendering=!0;try{if(this.performanceOptimizer&&this.performanceOptimizer.shouldRender())return void this.performanceOptimizer.optimizeRendering();this.renderNormal()}finally{this.isRendering=!1}}}},{key:"renderNormal",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.showGrid&&this.drawGrid();var e,t=E(this.elements.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;try{this.renderer.renderElement(n,n.properties)}catch(e){}}}catch(e){t.e(e)}finally{t.f()}this.selectionManager.render(this.ctx),this.transformationsManager.render(this.ctx),this.dragDropManager.render(this.ctx)}},{key:"drawGrid",value:function(){var e=this.options.gridSize,t=this.canvas.getBoundingClientRect(),n=t.width,r=t.height;this.ctx.strokeStyle="#e0e0e0",this.ctx.lineWidth=1;for(var i=0;i<=n;i+=e)this.ctx.beginPath(),this.ctx.moveTo(i,0),this.ctx.lineTo(i,r),this.ctx.stroke();for(var o=0;o<=r;o+=e)this.ctx.beginPath(),this.ctx.moveTo(0,o),this.ctx.lineTo(n,o),this.ctx.stroke()}},{key:"renderElement",value:function(e){var t=e.properties;if(this.ctx.save(),this.ctx.translate(t.x+t.width/2,t.y+t.height/2),t.rotation&&this.ctx.rotate(t.rotation*Math.PI/180),this.ctx.translate(-t.width/2,-t.height/2),void 0!==t.opacity){var n=t.opacity;n<=1?this.ctx.globalAlpha=n:n<=100&&(this.ctx.globalAlpha=n/100)}switch(e.type){case"text":this.renderTextElement(e);break;case"rectangle":this.renderRectangleElement(e);break;case"image":this.renderImageElement(e);break;default:this.renderGenericElement(e)}this.ctx.restore()}},{key:"renderTextElement",value:function(e){var t=e.properties;this.ctx.font="".concat(t.fontWeight||"normal"," ").concat(t.fontSize||14,"px ").concat(t.fontFamily||"Arial, sans-serif"),this.ctx.fillStyle=t.color||"#000000",this.ctx.textAlign=t.textAlign||"left";var n=0;"center"===t.textAlign?n=t.width/2:"right"===t.textAlign&&(n=t.width);for(var r=(t.text||"Texte").split("\n"),i=0;i<r.length;i++)this.ctx.fillText(r[i],n,0+i*(t.fontSize||14)*1.2)}},{key:"renderRectangleElement",value:function(e){var t=e.properties;t.backgroundColor&&"transparent"!==t.backgroundColor&&(this.ctx.fillStyle=t.backgroundColor,this.roundRect(0,0,t.width,t.height,t.borderRadius||0),this.ctx.fill()),t.borderWidth&&t.borderWidth>0&&(this.ctx.strokeStyle=t.borderColor||"#000000",this.ctx.lineWidth=t.borderWidth,this.roundRect(0,0,t.width,t.height,t.borderRadius||0),this.ctx.stroke())}},{key:"renderImageElement",value:function(e){var t=this,n=e.properties;if(n.src){var r=new Image;r.onload=function(){var e=n.width,i=n.height,o=0,a=0;if("cover"===n.objectFit){var s=Math.max(n.width/r.width,n.height/r.height);e=r.width*s,i=r.height*s,o=(n.width-e)/2,a=(n.height-i)/2}t.ctx.drawImage(r,o,a,e,i),t.render()},r.src=n.src}}},{key:"renderGenericElement",value:function(e){e.properties,this.isWooCommerceElement(e.type)?this.renderWooCommerceElement(e):this.renderRectangleElement(e)}},{key:"isWooCommerceElement",value:function(e){return["product_table","customer_info","company_info","company_logo","order_number","dynamic-text","mentions"].includes(e)}},{key:"renderWooCommerceElement",value:function(e){var t=e.properties;this.ctx.fillStyle=t.backgroundColor||"#f8f9fa",this.ctx.strokeStyle=t.borderColor||"#6c757d",this.ctx.lineWidth=t.borderWidth||1,this.roundRect(0,0,t.width,t.height,4),this.ctx.fill(),!1!==t.showBorders&&this.ctx.stroke(),this.ctx.fillStyle="#495057",this.ctx.font="12px Arial",this.ctx.textAlign="center",this.ctx.textBaseline="middle";var n=t.width/2,r=t.height/2,i=this.getElementDisplayName(e.type);this.ctx.fillText(i,n,r),this.ctx.strokeStyle="#007bff",this.ctx.lineWidth=2,this.ctx.setLineDash([5,5]),this.roundRect(2,2,t.width-4,t.height-4,2),this.ctx.stroke(),this.ctx.setLineDash([])}},{key:"getElementDisplayName",value:function(e){return{product_table:"ðŸ“‹ Tableau Produits",customer_info:"ðŸ‘¤ Infos Client",company_info:"ðŸ¢ Infos Entreprise",company_logo:"ðŸ–¼ï¸ Logo",order_number:"ðŸ”¢ NÂ° Commande","dynamic-text":"ðŸ“ Texte Dynamique",mentions:"ðŸ“„ Mentions"}[e]||e}},{key:"roundRect",value:function(e,t,n,r,i){0!==i?(this.ctx.beginPath(),this.ctx.moveTo(e+i,t),this.ctx.lineTo(e+n-i,t),this.ctx.quadraticCurveTo(e+n,t,e+n,t+i),this.ctx.lineTo(e+n,t+r-i),this.ctx.quadraticCurveTo(e+n,t+r,e+n-i,t+r),this.ctx.lineTo(e+i,t+r),this.ctx.quadraticCurveTo(e,t+r,e,t+r-i),this.ctx.lineTo(e,t+i),this.ctx.quadraticCurveTo(e,t,e+i,t),this.ctx.closePath()):this.ctx.rect(e,t,n,r)}},{key:"drawSelectionHandles",value:function(e){var t=this,n=e.properties;this.ctx.strokeStyle="#007bff",this.ctx.lineWidth=2,this.ctx.fillStyle="#ffffff",[{x:n.x,y:n.y},{x:n.x+n.width,y:n.y},{x:n.x+n.width,y:n.y+n.height},{x:n.x,y:n.y+n.height}].forEach(function(e){t.ctx.fillRect(e.x-4,e.y-4,8,8),t.ctx.strokeRect(e.x-4,e.y-4,8,8)}),this.ctx.strokeStyle="#007bff",this.ctx.setLineDash([5,5]),this.ctx.strokeRect(n.x,n.y,n.width,n.height),this.ctx.setLineDash([])}},{key:"saveToHistory",value:function(){var e={elements:new Map(this.elements),selectedElement:this.selectedElement?this.selectedElement.id:null};this.history=this.history.slice(0,this.historyIndex+1),this.history.push(e),this.historyIndex++,this.history.length>50&&(this.history.shift(),this.historyIndex--)}},{key:"restoreFromHistory",value:function(){var e=this.history[this.historyIndex];this.elements=new Map(e.elements),this.selectedElement=e.selectedElement?this.elements.get(e.selectedElement):null,this.render()}},{key:"exportToImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"png",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.canvas.toDataURL("image/".concat(e),t)}},{key:"exportToJSON",value:function(){return{version:"1.0",canvas:{width:this.options.width,height:this.options.height,backgroundColor:this.options.backgroundColor},elements:Array.from(this.elements.values()).map(function(e){return{id:e.id,type:e.type,properties:e.properties,createdAt:e.createdAt,updatedAt:e.updatedAt}}),metadata:{exportedAt:Date.now(),elementCount:this.elements.size}}}},{key:"importFromJSON",value:function(e){var t=this;try{return this.elements.clear(),e.elements.forEach(function(e){var n=j(j({},e),{},{properties:j({},e.properties)});t.elements.set(n.id,n)}),this.render(),this.saveToHistory(),!0}catch(e){return!1}}},{key:"dispose",value:function(){this.eventManager&&this.eventManager.dispose(),document.removeEventListener("dragover",this.handleDragOver),document.removeEventListener("drop",this.handleDrop),window.removeEventListener("resize",this.handleResize),this.elements.clear(),this.selectedElement=null,this.dragState=null,this.history=[],this.historyIndex=-1}},{key:"getStats",value:function(){var e={totalElements:this.elements.size,selectedElement:this.selectedElement?this.selectedElement.id:null,canvasSize:{width:this.canvas.width,height:this.canvas.height},zoom:this.options.zoom,mode:this.mode};return this.performanceOptimizer?j(j({},e),{},{performance:this.performanceOptimizer.getPerformanceStats()}):e}},{key:"removeDuplicateElements",value:function(){var e,t=this,n=new Map,r=[],i=E(this.elements);try{for(i.s();!(e=i.n()).done;){var o=k(e.value,2),a=o[0],s=o[1],c="".concat(s.type,"_").concat(JSON.stringify(s.properties));n.has(c)?r.push(a):n.set(c,a)}}catch(e){i.e(e)}finally{i.f()}return r.forEach(function(e){t.elements.delete(e)}),r.length>0&&(console.log("Removed ".concat(r.length," duplicate elements")),this.historyManager.saveState(),this.render()),r.length}},{key:"setGridVisibility",value:function(e){return console.log("setGridVisibility called - visible:",e),this.options.showGrid=!0===e,console.log("setGridVisibility - new showGrid:",this.options.showGrid),this.render(),this.options.showGrid}},{key:"isGridVisible",value:function(){return console.log("isGridVisible called - returning:",this.options.showGrid),this.options.showGrid}},{key:"handleClick",value:function(e){console.log("handleClick")}},{key:"handleDoubleClick",value:function(e){console.log("handleDoubleClick");var t=e.position,n=this.getElementAtPoint(t);n&&(console.log("Double-clicked element:",n.id),this.emit("element-double-click",{element:n,point:t}))}},{key:"getCursorForHandle",value:function(e){switch(e.type){case"move":return"move";case"resize":switch(e.position){case"nw":case"se":return"nw-resize";case"ne":case"sw":return"ne-resize";case"n":case"s":return"ns-resize";case"e":case"w":return"ew-resize";default:return"pointer"}case"rotate":return"alias";default:return"pointer"}}},{key:"deleteSelectedElements",value:function(){var e=this,t=Array.from(this.selectionManager.selectedElements);0!==t.length&&(t.forEach(function(t){e.elements.delete(t)}),this.selectionManager.clearSelection(),this.historyManager.saveState(),this.render(),console.log("Deleted elements:",t))}},{key:"selectAllElements",value:function(){this.selectionManager.clearSelection();var e,t=E(this.elements);try{for(t.s();!(e=t.n()).done;){var n=k(e.value,1)[0];this.selectionManager.selectedElements.add(n)}}catch(e){t.e(e)}finally{t.f()}this.selectionManager.updateSelectionBounds(),this.render(),console.log("Selected all elements")}}],t&&z(e.prototype,t),n&&z(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,f,y,p}(),W=R;window.pdfBuilderInitVanilla=function(e){var t,n;if("string"==typeof e)t=e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};else{if("object"!==S(e))throw new Error("Invalid parameters for pdfBuilderInitVanilla");t=(n=e).canvasElementId||n.containerId||"pdf-canvas-container"}try{var r=new R(t,n);return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){r.init()}):r.init(),window.pdfBuilderInstance=r,r}catch(e){throw e}},window.pdfBuilderPro={init:window.pdfBuilderInitVanilla}},349:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.r(t),n.d(t,{PDFCanvasPerformanceOptimizer:function(){return f}});var f=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasInstance=t,this.metrics={renderTime:0,frameCount:0,memoryUsage:0,elementCount:0,lastFrameTime:0},this.optimizationConfig={enableFrameSkipping:!0,maxFrameRate:60,enableObjectPooling:!0,enableDirtyRectRendering:!0,enableLOD:!0,maxCanvasSize:4096,enableWebWorkers:!1,cacheStaticElements:!0},this.objectPool=new Map,this.dirtyRegions=[],this.staticElementCache=new Map,this.frameSkipCounter=0,this.initPerformanceMonitoring()},t=[{key:"initPerformanceMonitoring",value:function(){var e=this;"undefined"!=typeof performance&&performance.memory&&(this.originalMemory=performance.memory.usedJSHeapSize),this.monitorInterval=setInterval(function(){e.updateMetrics()},1e3)}},{key:"updateMetrics",value:function(){this.metrics.elementCount=this.canvasInstance.elements.size,this.metrics.frameCount++,"undefined"!=typeof performance&&performance.memory&&(this.metrics.memoryUsage=performance.memory.usedJSHeapSize-this.originalMemory);var e=performance.now();if(this.metrics.lastFrameTime){var t=e-this.metrics.lastFrameTime;this.metrics.fps=1e3/t}this.metrics.lastFrameTime=e}},{key:"shouldRender",value:function(){return this.optimizationConfig.enableFrameSkipping}},{key:"optimizeRendering",value:function(){if(this.optimizationConfig.enableFrameSkipping){this.frameSkipCounter++;var e=1e3/this.optimizationConfig.maxFrameRate;this.frameSkipCounter>=e/16.67&&(this.frameSkipCounter=0,this.renderOptimized())}else this.renderOptimized()}},{key:"renderOptimized",value:function(){var e=performance.now();this.optimizationConfig.enableDirtyRectRendering&&this.dirtyRegions.length>0?this.renderDirtyRegions():this.renderNormal(),this.metrics.renderTime=performance.now()-e}},{key:"renderNormal",value:function(){this.canvasInstance.renderNormal()}},{key:"renderDirtyRegions",value:function(){this.renderNormal(),this.dirtyRegions=[]}},{key:"isElementInRegion",value:function(e,t){if(!e||!e.properties)return console.warn("isElementInRegion: invalid element or properties",e),!1;var n=e.properties,r=n.x||0,i=n.y||0,o=n.width||0,a=n.height||0;return!(r+o<t.x||r>t.x+t.width||i+a<t.y||i>t.y+t.height)}},{key:"markDirtyRegion",value:function(e,t,n,r){this.optimizationConfig.enableDirtyRectRendering&&(this.dirtyRegions.push({x:e,y:t,width:n,height:r}),this.mergeDirtyRegions())}},{key:"mergeDirtyRegions",value:function(){if(!(this.dirtyRegions.length<2)){for(var e=[],t=this.dirtyRegions.sort(function(e,t){return e.x-t.x}),n=t[0],r=1;r<t.length;r++){var i=t[r];n.x+n.width>=i.x&&n.y+n.height>=i.y&&n.y<=i.y+i.height?(n.width=Math.max(n.x+n.width,i.x+i.width)-n.x,n.height=Math.max(n.y+n.height,i.y+i.height)-n.y):(e.push(n),n=i)}e.push(n),this.dirtyRegions=e}}},{key:"cacheStaticElement",value:function(e){if(this.optimizationConfig.cacheStaticElements){var t=this.canvasInstance.elements.get(e);if(t){var n=document.createElement("canvas"),r=n.getContext("2d"),i=this.getElementBounds(t);n.width=i.width,n.height=i.height;var o=this.canvasInstance.ctx;this.canvasInstance.ctx=r;var a=t.properties&&t.properties.x||0,s=t.properties&&t.properties.y||0;t.properties||(t.properties={}),t.properties.x=0,t.properties.y=0,this.canvasInstance.renderElement(t),t.properties.x=a,t.properties.y=s,this.canvasInstance.ctx=o,this.staticElementCache.set(e,{canvas:n,bounds:i,lastModified:Date.now()})}}}},{key:"getElementBounds",value:function(e){if(!e||!e.properties)return console.warn("getElementBounds: invalid element or properties",e),{x:0,y:0,width:100,height:100};var t=e.properties;return{x:t.x||0,y:t.y||0,width:t.width||100,height:t.height||100}}},{key:"renderCachedElement",value:function(e,t){var n=this.staticElementCache.get(e);if(!n)return!1;var r=this.canvasInstance.elements.get(e);if(!r)return!1;var i=r.properties&&r.properties.x||0,o=r.properties&&r.properties.y||0;return t.drawImage(n.canvas,i,o),!0}},{key:"getPooledObject",value:function(e,t){if(!this.optimizationConfig.enableObjectPooling)return new t;this.objectPool.has(e)||this.objectPool.set(e,[]);var n=this.objectPool.get(e);return n.length>0?n.pop():new t}},{key:"returnToPool",value:function(e,t){if(this.optimizationConfig.enableObjectPooling){this.objectPool.has(e)||this.objectPool.set(e,[]);var n=this.objectPool.get(e);n.length<50&&("function"==typeof t.reset&&t.reset(),n.push(t))}}},{key:"optimizeCanvasSize",value:function(){var e=this.canvasInstance.canvas,t=this.optimizationConfig.maxCanvasSize;e.width>t||e.height;var n=window.devicePixelRatio||1;if(n>1&&!e.style.width){var r=e.getContext("2d"),i=e.width,o=e.height;e.width=i*n,e.height=o*n,e.style.width=i+"px",e.style.height=o+"px",r.scale(n,n)}}},{key:"throttleEvent",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,o=0;return function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var c=Date.now();c-o>i?(t.apply(r,a),o=c):(clearTimeout(n),n=setTimeout(function(){t.apply(r,a),o=Date.now()},i-(c-o)))}}},{key:"applyLOD",value:function(e,t){if(!this.optimizationConfig.enableLOD)return e;var n="high";t>300?n="low":t>100&&(n="medium");var r={high:1,medium:.7,low:.4}[n];return r<1&&(e.properties.opacity=(e.properties.opacity||100)*r),e}},{key:"cleanupCache",value:function(){var e,t=new Set(this.canvasInstance.elements.keys()),n=c(this.staticElementCache);try{for(n.s();!(e=n.n()).done;){var r=s(e.value,1)[0];t.has(r)||this.staticElementCache.delete(r)}}catch(e){n.e(e)}finally{n.f()}var i,o=c(this.objectPool);try{for(o.s();!(i=o.n()).done;){var a=s(i.value,2),l=a[0],h=a[1];h.length>10&&this.objectPool.set(l,h.slice(-10))}}catch(e){o.e(e)}finally{o.f()}}},{key:"getPerformanceStats",value:function(){return o(o({},this.metrics),{},{cacheSize:this.staticElementCache.size,poolSizes:Object.fromEntries(Array.from(this.objectPool.entries()).map(function(e){var t=s(e,2);return[t[0],t[1].length]})),dirtyRegionsCount:this.dirtyRegions.length,config:o({},this.optimizationConfig)})}},{key:"configure",value:function(e){this.optimizationConfig=o(o({},this.optimizationConfig),e)}},{key:"forceGC",value:function(){"undefined"!=typeof window&&window.gc&&window.gc()}},{key:"dispose",value:function(){this.monitorInterval&&clearInterval(this.monitorInterval),this.objectPool.clear(),this.staticElementCache.clear(),this.dirtyRegions=[],this.forceGC()}}],t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();t.default=f},351:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.r(t),n.d(t,{ElementCustomizationService:function(){return l},elementCustomizationService:function(){return h}});var l=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.propertyValidators=new Map,this.propertyPresets=new Map,this.propertyGroups=new Map,this.initDefaults()},t=[{key:"initDefaults",value:function(){var e=this;this.propertyValidators.set("numeric",function(e){return parseFloat(e)||0}),this.propertyValidators.set("positiveNumeric",function(e){return Math.max(0,parseFloat(e)||0)}),this.propertyValidators.set("percentage",function(e){return Math.max(0,Math.min(100,parseFloat(e)||100))}),this.propertyValidators.set("angle",function(e){return((parseFloat(e)||0)%360+360)%360}),this.propertyValidators.set("color",function(t){return e.validateColor(t)}),this.propertyValidators.set("fontSize",function(e){return Math.max(8,Math.min(72,parseInt(e)||14))}),this.propertyValidators.set("borderWidth",function(e){return Math.max(0,Math.min(20,parseInt(e)||0))}),this.propertyValidators.set("borderStyle",function(e){return["solid","dashed","dotted","double"].includes(e)?e:"solid"}),this.propertyValidators.set("borderRadius",function(e){return Math.max(0,Math.min(100,parseInt(e)||0))}),this.propertyPresets.set("colors",{slate:["#f8fafc","#f1f5f9","#e2e8f0","#cbd5e1","#94a3b8","#64748b","#475569","#334155","#1e293b"],blue:["#eff6ff","#dbeafe","#bfdbfe","#93c5fd","#60a5fa","#3b82f6","#2563eb","#1d4ed8","#1e40af"],green:["#f0fdf4","#dcfce7","#bbf7d0","#86efac","#4ade80","#22c55e","#16a34a","#15803d","#166534"],red:["#fef2f2","#fee2e2","#fecaca","#fca5a5","#f87171","#ef4444","#dc2626","#b91c1c","#991b1b"]}),this.propertyGroups.set("position",["x","y"]),this.propertyGroups.set("dimensions",["width","height"]),this.propertyGroups.set("typography",["fontFamily","fontSize","fontWeight","fontStyle","color","textAlign"]),this.propertyGroups.set("appearance",["backgroundColor","borderColor","borderWidth","borderRadius"]),this.propertyGroups.set("effects",["opacity","shadow","brightness","contrast","saturate"]),this.propertyGroups.set("transform",["rotation","scale"])}},{key:"validateColor",value:function(e){if(!e)return"#000000";if(/^#[0-9A-Fa-f]{6}$/.test(e)||/^#[0-9A-Fa-f]{3}$/.test(e))return e;var t=document.createElement("div");return t.style.color=e,t.style.color||"#000000"}},{key:"validateProperty",value:function(e,t){if("boolean"==typeof t)return t;if(e.startsWith("columns."))return t;var n=this.propertyValidators.get(e);if(n)try{return n(t)}catch(t){return this.getDefaultValue(e)}return this.isNumericProperty(e)?this.validateNumericProperty(e,t):this.isColorProperty(e)?this.validateColorProperty(t):this.isTextStyleProperty(e)?this.validateTextStyleProperty(e,t):t}},{key:"isNumericProperty",value:function(e){return["x","y","width","height","fontSize","opacity","lineHeight","letterSpacing","zIndex","borderWidth","borderRadius","rotation","padding"].includes(e)}},{key:"isColorProperty",value:function(e){return["color","backgroundColor","borderColor"].includes(e)}},{key:"isTextStyleProperty",value:function(e){return["fontWeight","textAlign","textDecoration","textTransform","borderStyle"].includes(e)}},{key:"validateNumericProperty",value:function(e,t){if(null==t||""===t)return this.getDefaultValue(e);var n;if("string"==typeof t){if(n=parseFloat(t),isNaN(n))return this.getDefaultValue(e)}else{if("number"!=typeof t)return this.getDefaultValue(e);n=t}var r={fontSize:{min:8,max:72},opacity:{min:0,max:1},lineHeight:{min:.5,max:3},letterSpacing:{min:-5,max:10},zIndex:{min:-100,max:1e3},borderWidth:{min:0,max:20},borderRadius:{min:0,max:100},rotation:{min:-180,max:180},padding:{min:0,max:100}};if(r[e]){var i=r[e],o=i.min,a=i.max;n=Math.max(o,Math.min(a,n))}return n}},{key:"validateColorProperty",value:function(e){if(!e)return"#000000";if("transparent"===e)return e;if(/^#[0-9A-Fa-f]{6}$/.test(e)||/^#[0-9A-Fa-f]{3}$/.test(e))return e;var t=document.createElement("div");t.style.color=e;var n=t.style.color;return n&&""!==n?e:"#000000"}},{key:"validateTextStyleProperty",value:function(e,t){var n={fontWeight:["normal","bold","100","200","300","400","500","600","700","800","900"],textAlign:["left","center","right","justify"],textDecoration:["none","underline","overline","line-through"],textTransform:["none","capitalize","uppercase","lowercase"],borderStyle:["solid","dashed","dotted","double","none"]};return n[e]&&n[e].includes(t)?t:{fontWeight:"normal",textAlign:"left",textDecoration:"none",textTransform:"none",borderStyle:"solid"}[e]||t}},{key:"getDefaultValue",value:function(e){return{x:0,y:0,width:100,height:50,fontSize:14,opacity:1,lineHeight:1.2,letterSpacing:0,zIndex:0,borderWidth:0,borderRadius:0,rotation:0,padding:0,color:"#333333",backgroundColor:"transparent",borderColor:"#dddddd",fontWeight:"normal",textAlign:"left",textDecoration:"none",textTransform:"none",borderStyle:"solid"}[e]||null}},{key:"getPresets",value:function(e){return this.propertyPresets.get(e)||{}}},{key:"getPropertiesInGroup",value:function(e){return this.propertyGroups.get(e)||[]}},{key:"applyPreset",value:function(e,t){return{"text-title":{fontSize:24,fontWeight:"bold",textAlign:"center",color:"#1e293b"},"text-subtitle":{fontSize:18,fontWeight:"bold",textAlign:"left",color:"#334155"},"text-body":{fontSize:14,fontWeight:"normal",textAlign:"left",color:"#475569"},"text-caption":{fontSize:12,fontWeight:"normal",textAlign:"left",color:"#64748b"},"shape-rounded":{borderRadius:8,borderWidth:1,borderColor:"transparent"},"shape-circle":{borderRadius:50,borderWidth:1,borderColor:"transparent"},"shape-square":{borderRadius:0,borderWidth:1,borderColor:"transparent"},"effect-shadow-soft":{shadow:!0,shadowColor:"#000000",shadowOffsetX:1,shadowOffsetY:1,opacity:90},"effect-shadow-strong":{shadow:!0,shadowColor:"#000000",shadowOffsetX:3,shadowOffsetY:3,opacity:85},"effect-glow":{shadow:!0,shadowColor:"#2563eb",shadowOffsetX:0,shadowOffsetY:0,opacity:95},"color-primary":{backgroundColor:"#2563eb",color:"#ffffff"},"color-secondary":{backgroundColor:"#64748b",color:"#ffffff"},"color-success":{backgroundColor:"#16a34a",color:"#ffffff"},"color-warning":{backgroundColor:"#ca8a04",color:"#ffffff"},"color-error":{backgroundColor:"#dc2626",color:"#ffffff"}}[e]||{}}},{key:"getDefaultProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text";return o(o({},{x:50,y:50,width:100,height:50,opacity:100,rotation:0,scale:100,visible:!0,backgroundColor:"transparent",borderColor:"transparent",borderWidth:0,borderStyle:"solid",borderRadius:0,color:"#1e293b",fontFamily:"Inter, sans-serif",fontSize:14,fontWeight:"normal",fontStyle:"normal",textAlign:"left",textDecoration:"none",text:"Texte",src:"",alt:"",objectFit:"cover",shadow:!1,shadowColor:"#000000",shadowOffsetX:2,shadowOffsetY:2,brightness:100,contrast:100,saturate:100,showHeaders:!0,showBorders:!0,headers:["Produit","QtÃ©","Prix"],dataSource:"order_items",columns:{image:!0,name:!0,sku:!1,quantity:!0,price:!0,total:!0},showSubtotal:!1,showShipping:!0,showTaxes:!0,showDiscount:!1,showTotal:!1,progressColor:"#3b82f6",progressValue:75,lineColor:"#64748b",lineWidth:2,documentType:"invoice",imageUrl:"",spacing:8,layout:"vertical",alignment:"left",fit:"contain"}),{text:{width:150,height:30},image:{width:150,height:100},rectangle:{backgroundColor:"#f1f5f9",borderWidth:1,width:150,height:80},product_table:{width:300,height:150},customer_info:{width:200,height:100},company_logo:{width:100,height:60},order_number:{width:150,height:30},company_info:{width:200,height:80},document_type:{width:120,height:40},watermark:{width:300,height:200,opacity:10,text:"CONFIDENTIEL"},"progress-bar":{width:200,height:20},barcode:{width:150,height:60},qrcode:{width:80,height:80},icon:{width:50,height:50},line:{height:2}}[e]||{})}},{key:"getComputedProperties",value:function(e){return{absoluteX:e.x+e.width/2,absoluteY:e.y+e.height/2,scaledWidth:e.width*(e.scale/100),scaledHeight:e.height*(e.scale/100),cssTransform:"rotate(".concat(e.rotation,"deg) scale(").concat(e.scale/100,")"),cssFilter:"brightness(".concat(e.brightness,"%) contrast(").concat(e.contrast,"%) saturate(").concat(e.saturate,"%)"),cssBoxShadow:e.shadow?"".concat(e.shadowOffsetX||0,"px ").concat(e.shadowOffsetY||0,"px 4px ").concat(e.shadowColor||"#000000"):"none"}}},{key:"isAnimatable",value:function(e){return["x","y","width","height","rotation","scale","opacity","brightness","contrast","saturate"].includes(e)}},{key:"getPropertyConstraints",value:function(e){return{x:{min:-1e3,max:2e3,step:1},y:{min:-1e3,max:2e3,step:1},width:{min:1,max:2e3,step:1},height:{min:1,max:2e3,step:1},fontSize:{min:8,max:72,step:1},borderWidth:{min:0,max:20,step:1},borderRadius:{min:0,max:100,step:1},rotation:{min:-180,max:180,step:1},scale:{min:10,max:200,step:5},opacity:{min:0,max:100,step:1},brightness:{min:0,max:200,step:5},contrast:{min:0,max:200,step:5},saturate:{min:0,max:200,step:5},shadowOffsetX:{min:-50,max:50,step:1},shadowOffsetY:{min:-50,max:50,step:1}}[e]||{}}}],t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}(),h=new l},451:function(e,t,n){n.r(t);var r=n(287),i=n(901),o=n(878),a=n(351),s=(n(483),n(57),n(264)),c=(n(52),n(557)),l=n(718),h=n(730);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return f(l,"_invoke",function(n,r,i){var o,s,c,l=0,h=i||[],u=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,s=0,c=e,d.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!u&&l&&!i&&t<h.length;t++){var i,o=h[t],f=d.p,y=o[2];n>3?(i=y===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,d.v=r,d.n=o[1]):f<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,d.n=y,s=0))}if(i||n>1)return a;throw u=!0,r}return function(i,h,y){if(l>1)throw TypeError("Generator is already running");for(u&&1===h&&f(h,y),s=h,c=y;(t=s<2?e:c)||!u;){o||(s?s<3?(s>1&&(d.n=-1),f(s,c)):d.n=c:d.v=c);try{if(l=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(u=d.n<0)?c:n.call(r,d))!==a)break}catch(t){o=e,s=1,c=t}finally{l=1}}return{value:t,done:u}}}(n,i,o),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var h=[][r]?t(t([][r]())):(f(t={},r,function(){return this}),t),u=l.prototype=s.prototype=Object.create(h);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,f(e,i,"GeneratorFunction")),e.prototype=Object.create(u),e}return c.prototype=l,f(u,"constructor",l),f(l,"constructor",c),c.displayName="GeneratorFunction",f(l,i,"GeneratorFunction"),f(u),f(u,i,"Generator"),f(u,r,function(){return this}),f(u,"toString",function(){return"[object Generator]"}),(d=function(){return{w:o,m:y}})()}function f(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}f=function(e,t,n,r){function o(t,n){f(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},f(e,t,n,r)}function y(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){y(o,r,i,a,s,"next",e)}function s(e){y(o,r,i,a,s,"throw",e)}a(void 0)})}}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}function v(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}e=n.hmd(e);var g=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.results={passed:0,failed:0,tests:[]},this.canvasInstance=null},t=[{key:"runAllTests",value:(C=p(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.testElementRestrictions();case 1:return e.n=2,this.testWooCommerceManager();case 2:return e.n=3,this.testCustomizationService();case 3:return e.n=4,this.testRenderUtils();case 4:return e.n=5,this.testPropertiesManager();case 5:return e.n=6,this.testLayersManager();case 6:return e.n=7,this.testExportManager();case 7:return e.n=8,this.testCanvasInitialization();case 8:return e.n=9,this.testElementCreation();case 9:return e.n=10,this.testSelectionSystem();case 10:return e.n=11,this.testEventHandling();case 11:this.printResults(),e.n=13;break;case 12:e.p=12,t=e.v,this.logTest("Test Suite",!1,t.message),this.printResults();case 13:return e.a(2)}},e,this,[[0,12]])})),function(){return C.apply(this,arguments)})},{key:"testElementRestrictions",value:(P=p(d().m(function e(){var t,n,r,o,a;return d().w(function(e){for(;;)switch(e.n){case 0:try{for(t=Object.keys(i.ELEMENT_PROPERTY_RESTRICTIONS),this.assert(t.length>0,"Types d'Ã©lÃ©ments dÃ©finis"),n=0,r=t;n<r.length;n++)o=r[n],a=i.ELEMENT_PROPERTY_RESTRICTIONS[o]&&i.ELEMENT_PROPERTY_RESTRICTIONS[o].defaults,this.assert(a,"PropriÃ©tÃ©s par dÃ©faut pour ".concat(o));this.logTest("Element Restrictions",!0)}catch(e){this.logTest("Element Restrictions",!1,e.message)}case 1:return e.a(2)}},e,this)})),function(){return P.apply(this,arguments)})},{key:"testWooCommerceManager",value:(E=p(d().m(function e(){var t,n,r,i;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t=new o.WooCommerceElementsManager,n=t.getTestData(),this.assert(Array.isArray(n),"DonnÃ©es de test disponibles"),e.n=1,t.loadWooCommerceData();case 1:r=e.v,this.assert("boolean"==typeof r,"Chargement des donnÃ©es WooCommerce"),this.logTest("WooCommerce Manager",!0),e.n=3;break;case 2:e.p=2,i=e.v,this.logTest("WooCommerce Manager",!1,i.message);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return E.apply(this,arguments)})},{key:"testCustomizationService",value:(k=p(d().m(function e(){var t,n,r;return d().w(function(e){for(;;)switch(e.n){case 0:try{t=new a.ElementCustomizationService,n=t.validateProperty("text","fontSize",12),this.assert(n,"Validation de propriÃ©tÃ© basique"),r=t.getDefaultProperties("rectangle"),this.assert(r&&"object"===u(r),"PropriÃ©tÃ©s par dÃ©faut"),this.logTest("Customization Service",!0)}catch(e){this.logTest("Customization Service",!1,e.message)}case 1:return e.a(2)}},e,this)})),function(){return k.apply(this,arguments)})},{key:"testRenderUtils",value:(S=p(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.n){case 0:try{t=document.createElement("canvas"),n=t.getContext("2d"),t.width=200,t.height=200,s.PDFCanvasRenderUtils.drawShape(n,"rectangle",{x:10,y:10,width:50,height:50,fillColor:"#ff0000",strokeColor:"#000000"}),s.PDFCanvasRenderUtils.drawMultilineText(n,"Test Text",{x:10,y:80,maxWidth:100,fontSize:12}),this.logTest("Render Utils",!0)}catch(e){this.logTest("Render Utils",!1,e.message)}case 1:return e.a(2)}},e,this)})),function(){return S.apply(this,arguments)})},{key:"testPropertiesManager",value:(x=p(d().m(function e(){var t,n,r,i;return d().w(function(e){for(;;)switch(e.n){case 0:try{t=new c.PDFCanvasPropertiesManager(null),n="test-element",t.setProperty(n,"width",100),r=t.getProperty(n,"width"),this.assert(100===r,"DÃ©finition et rÃ©cupÃ©ration de propriÃ©tÃ©"),i=t.validatePropertyByType("width",50),this.assert(i,"Validation de propriÃ©tÃ© par type"),this.logTest("Properties Manager",!0)}catch(e){this.logTest("Properties Manager",!1,e.message)}case 1:return e.a(2)}},e,this)})),function(){return x.apply(this,arguments)})},{key:"testLayersManager",value:(w=p(d().m(function e(){var t,n,r;return d().w(function(e){for(;;)switch(e.n){case 0:try{t=new l.PDFCanvasLayersManager(null),n=t.createLayer("test-layer",{name:"Test Layer"}),this.assert(n&&"test-layer"===n.id,"CrÃ©ation de calque"),r=t.getLayer("test-layer"),this.assert(r===n,"RÃ©cupÃ©ration de calque"),this.logTest("Layers Manager",!0)}catch(e){this.logTest("Layers Manager",!1,e.message)}case 1:return e.a(2)}},e,this)})),function(){return w.apply(this,arguments)})},{key:"testExportManager",value:(b=p(d().m(function e(){var t,n,r;return d().w(function(e){for(;;)switch(e.n){case 0:try{t=new h.PDFCanvasExportManager(null),n=t.getSupportedFormats(),this.assert(Array.isArray(n)&&n.includes("pdf"),"Formats d'export supportÃ©s"),t.configure({format:"a4"}),r=t.getExportStats(),this.assert("a4"===r.config.format,"Configuration d'export"),this.logTest("Export Manager",!0)}catch(e){this.logTest("Export Manager",!1,e.message)}case 1:return e.a(2)}},e,this)})),function(){return b.apply(this,arguments)})},{key:"testCanvasInitialization",value:(g=p(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,(t=document.createElement("div")).id="test-canvas-container",t.style.width="800px",t.style.height="600px",document.body.appendChild(t),this.canvasInstance=new r.PDFCanvasVanilla("test-canvas-container",{width:800,height:600}),e.n=1,this.canvasInstance.init();case 1:this.assert(this.canvasInstance.canvas,"Canvas crÃ©Ã©"),this.assert(this.canvasInstance.ctx,"Contexte 2D disponible"),this.assert(this.canvasInstance.isInitialized,"Canvas initialisÃ©"),document.body.removeChild(t),this.logTest("Canvas Initialization",!0),e.n=3;break;case 2:e.p=2,n=e.v,this.logTest("Canvas Initialization",!1,n.message);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return g.apply(this,arguments)})},{key:"testElementCreation",value:(v=p(d().m(function e(){var t,n,r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.canvasInstance){e.n=1;break}throw new Error("Canvas instance not available");case 1:t=this.canvasInstance.addElement("text",{x:100,y:100,text:"Test Text"}),this.assert(t,"Ã‰lÃ©ment texte crÃ©Ã©"),n=this.canvasInstance.addElement("rectangle",{x:200,y:200,width:100,height:50}),this.assert(n,"Ã‰lÃ©ment rectangle crÃ©Ã©"),this.assert(this.canvasInstance.elements.has(t),"Ã‰lÃ©ment texte dans la collection"),this.assert(this.canvasInstance.elements.has(n),"Ã‰lÃ©ment rectangle dans la collection"),this.logTest("Element Creation",!0),e.n=3;break;case 2:e.p=2,r=e.v,this.logTest("Element Creation",!1,r.message);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return v.apply(this,arguments)})},{key:"testSelectionSystem",value:(y=p(d().m(function e(){var t,n,r;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.canvasInstance){e.n=1;break}throw new Error("Canvas instance not available");case 1:t=this.canvasInstance.addElement("rectangle",{x:10,y:10,width:50,height:50}),n=this.canvasInstance.addElement("rectangle",{x:70,y:10,width:50,height:50}),this.canvasInstance.selectionManager.selectElement(t),this.assert(this.canvasInstance.selectionManager.isSelected(t),"Ã‰lÃ©ment sÃ©lectionnÃ©"),this.canvasInstance.selectionManager.selectElements([t,n]),this.assert(2===this.canvasInstance.selectionManager.getSelectedElements().length,"SÃ©lection multiple"),this.logTest("Selection System",!0),e.n=3;break;case 2:e.p=2,r=e.v,this.logTest("Selection System",!1,r.message);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return y.apply(this,arguments)})},{key:"testEventHandling",value:(f=p(d().m(function e(){var t,n;return d().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.canvasInstance){e.n=1;break}throw new Error("Canvas instance not available");case 1:t={type:"mousedown",clientX:100,clientY:100,preventDefault:function(){},stopPropagation:function(){}},this.canvasInstance.eventManager.handleMouseDown(t),this.logTest("Event Handling",!0),e.n=3;break;case 2:e.p=2,n=e.v,this.logTest("Event Handling",!1,n.message);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return f.apply(this,arguments)})},{key:"assert",value:function(e,t){if(!e)throw new Error("Assertion failed: ".concat(t))}},{key:"logTest",value:function(e,t){var n={name:e,passed:t,error:(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)||null,timestamp:(new Date).toISOString()};this.results.tests.push(n),t?this.results.passed++:this.results.failed++}},{key:"printResults",value:function(){this.results.failed>0&&this.results.tests.filter(function(e){return!e.passed}).forEach(function(e){})}}],t&&m(e.prototype,t),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,f,y,v,g,b,w,x,S,k,E,P,C}();window.runPDFCanvasTests=p(d().m(function e(){var t;return d().w(function(e){for(;;)switch(e.n){case 0:return t=new g,e.n=1,t.runAllTests();case 1:return e.a(2,t.results)}},e)})),e.exports&&(e.exports=g),t.default=g},483:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.r(t),n.d(t,{PDFCanvasRenderer:function(){return l}});var l=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mainInstance=t,this.canvas=null,this.ctx=null,this.devicePixelRatio=window.devicePixelRatio||1,this.imageCache=new Map,this.shapeCache=new Map,this.renderSettings={antiAlias:!0,imageSmoothing:!0,shadowQuality:"high",textRendering:"optimizeLegibility"},this.performanceStats={renderTime:0,elementCount:0,lastRenderTime:Date.now()}},(t=[{key:"initialize",value:function(e,t){this.canvas=e,this.ctx=t,this.init()}},{key:"init",value:function(){this.canvas&&this.ctx&&(this.optimizeForDevice(),this.setupContext())}},{key:"optimizeForDevice",value:function(){var e=this.canvas.getBoundingClientRect();this.canvas.width=e.width*this.devicePixelRatio,this.canvas.height=e.height*this.devicePixelRatio,this.ctx.scale(this.devicePixelRatio,this.devicePixelRatio),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px"}},{key:"setupContext",value:function(){this.ctx.imageSmoothingEnabled=this.renderSettings.imageSmoothing,this.ctx.imageSmoothingQuality="high",this.ctx.textBaseline="top",this.ctx.font="14px Arial, sans-serif",this.ctx.globalCompositeOperation="source-over"}},{key:"render",value:function(){this.clear(),this.renderBackground(),console.log("Canvas render - showGrid:",this.mainInstance.options.showGrid),this.mainInstance.options.showGrid?(console.log("Calling renderGrid"),this.renderGrid()):console.log("Grid not rendered - showGrid is false"),this.renderAllElements(),this.renderSelectionHandles()}},{key:"renderBackground",value:function(){this.ctx.fillStyle=this.mainInstance.options.backgroundColor||"#ffffff",this.ctx.fillRect(0,0,this.canvas.width/this.devicePixelRatio,this.canvas.height/this.devicePixelRatio)}},{key:"renderGrid",value:function(){var e=this.mainInstance.options.gridSize||20,t=this.canvas.width/this.devicePixelRatio,n=this.canvas.height/this.devicePixelRatio;console.log("Rendering grid:",{showGrid:this.mainInstance.options.showGrid,gridSize:e,width:t,height:n}),this.ctx.save(),this.ctx.strokeStyle="rgba(0, 0, 0, 0.1)",this.ctx.lineWidth=.5,this.ctx.setLineDash([2,2]);for(var r=0;r<=t;r+=e)this.ctx.beginPath(),this.ctx.moveTo(r,0),this.ctx.lineTo(r,n),this.ctx.stroke();for(var i=0;i<=n;i+=e)this.ctx.beginPath(),this.ctx.moveTo(0,i),this.ctx.lineTo(t,i),this.ctx.stroke();this.ctx.restore()}},{key:"renderAllElements",value:function(){var e=this;Array.from(this.mainInstance.elements.values()).sort(function(e,t){return(e.properties.zIndex||0)-(t.properties.zIndex||0)}).forEach(function(t){e.renderElement(t,{})})}},{key:"renderSelectionHandles",value:function(){var e=this,t=this.mainInstance.selectionManager.getSelectedElements();t.forEach(function(t){e.mainInstance.transformationsManager.renderElementHandles(e.ctx,t)}),t.length>1&&this.renderSelectionBounds()}},{key:"renderSelectionBounds",value:function(){var e=this.mainInstance.selectionManager.selectionBounds;e&&(this.ctx.save(),this.ctx.strokeStyle="#007bff",this.ctx.lineWidth=2,this.ctx.setLineDash([5,5]),this.ctx.strokeRect(e.x,e.y,e.width,e.height),this.ctx.restore())}},{key:"renderElement",value:function(e,t){var n=performance.now();this.ctx.save();try{if(!e||!e.properties)return void console.warn("renderElement: invalid element or properties",e);this.applyTransforms(e.properties,t),this.applyVisualEffects(e.properties),this.renderByType(e),this.applyPostFilters(e.properties)}finally{this.ctx.restore()}this.performanceStats.renderTime+=performance.now()-n,this.performanceStats.elementCount++}},{key:"applyTransforms",value:function(e,t){if(e){var n=o({x:e.x||0,y:e.y||0,width:e.width||100,height:e.height||50,rotation:e.rotation||0,scale:e.scale||100,opacity:void 0!==e.opacity?e.opacity:100},e);if(this.ctx.translate(n.x,n.y),n.rotation&&0!==n.rotation){var r=n.width/2,i=n.height/2;this.ctx.translate(r,i),this.ctx.rotate(n.rotation*Math.PI/180),this.ctx.translate(-r,-i)}if(n.scale&&100!==n.scale){var a=n.scale/100,s=n.width/2,c=n.height/2;this.ctx.translate(s,c),this.ctx.scale(a,a),this.ctx.translate(-s,-c)}if(void 0!==n.opacity){var l=n.opacity;l<=1?this.ctx.globalAlpha=l:l<=100&&(this.ctx.globalAlpha=l/100)}}else console.warn("applyTransforms: properties is undefined")}},{key:"applyVisualEffects",value:function(e){if(e.shadow?(this.ctx.shadowColor=e.shadowColor||"#000000",this.ctx.shadowBlur=4,this.ctx.shadowOffsetX=e.shadowOffsetX||2,this.ctx.shadowOffsetY=e.shadowOffsetY||2):(this.ctx.shadowColor="transparent",this.ctx.shadowBlur=0,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0),void 0!==this.ctx.filter){var t=[];e.brightness&&100!==e.brightness&&t.push("brightness(".concat(e.brightness,"%)")),e.contrast&&100!==e.contrast&&t.push("contrast(".concat(e.contrast,"%)")),e.saturate&&100!==e.saturate&&t.push("saturate(".concat(e.saturate,"%)")),this.ctx.filter=t.join(" ")||"none"}}},{key:"renderByType",value:function(e){if(this.isWooCommerceElement(e.type))this.renderWooCommerceElement(e);else switch(e.type){case"text":this.renderText(e);break;case"rectangle":case"shape-rectangle":this.renderRectangle(e);break;case"circle":case"shape-circle":this.renderCircle(e);break;case"line":case"shape-line":this.renderLine(e);break;case"image":this.renderImage(e);break;case"barcode":this.renderBarcode(e);break;case"qrcode":this.renderQRCode(e);break;default:this.renderGeneric(e)}}},{key:"isWooCommerceElement",value:function(e){return["order_number","order_date","customer_name","customer_email","billing_address","shipping_address","payment_method","order_status","subtotal","discount","shipping","taxes","total","refund","product_table","customer_info","company_info","company_logo","dynamic-text","woocommerce-invoice-number","woocommerce-invoice-date","woocommerce-order-number","woocommerce-order-date","woocommerce-billing-address","woocommerce-shipping-address","woocommerce-customer-name","woocommerce-customer-email","woocommerce-payment-method","woocommerce-order-status","woocommerce-products-table","woocommerce-subtotal","woocommerce-discount","woocommerce-shipping","woocommerce-taxes","woocommerce-total","woocommerce-refund"].includes(e)}},{key:"renderWooCommerceElement",value:function(e){var t="";this.canvasInstance&&this.canvasInstance.wooCommerceManager&&(t=this.canvasInstance.wooCommerceManager.getElementDisplayText(e.type));var n=o(o({},e),{},{properties:o(o({},e.properties),{},{text:t||"[".concat(e.type,"]")})});this.renderText(n)}},{key:"renderText",value:function(e){var t=e.properties;if(t){var n=this.buildFontString(t);this.ctx.font=n,this.ctx.fillStyle=t.color||"#000000",this.ctx.textAlign=t.textAlign||"left";var r=0,i=t.text||"",o=this.ctx.measureText(i);"center"===t.textAlign?r=(t.width||100)/2:"right"===t.textAlign&&(r=t.width||100),t.textDecoration&&this.renderTextDecoration(i,r,0,t,o),this.ctx.fillText(i,r,0),t.strokeWidth&&t.strokeWidth>0&&(this.ctx.strokeStyle=t.strokeColor||"#000000",this.ctx.lineWidth=t.strokeWidth,this.ctx.strokeText(i,r,0))}else console.warn("renderText: properties is undefined for element",e)}},{key:"buildFontString",value:function(e){var t=e.fontWeight||"normal",n=e.fontSize||14,r=e.fontFamily||"Arial, sans-serif",i=e.fontStyle||"normal";return"".concat(i," ").concat(t," ").concat(n,"px ").concat(r)}},{key:"renderTextDecoration",value:function(e,t,n,r,i){var o=n+.8*(r.fontSize||14);switch(this.ctx.strokeStyle=r.color||"#000000",this.ctx.lineWidth=1,r.textDecoration){case"underline":this.ctx.beginPath(),this.ctx.moveTo(t,o),this.ctx.lineTo(t+i.width,o),this.ctx.stroke();break;case"overline":this.ctx.beginPath(),this.ctx.moveTo(t,n),this.ctx.lineTo(t+i.width,n),this.ctx.stroke();break;case"line-through":var a=n+.5*(r.fontSize||14);this.ctx.beginPath(),this.ctx.moveTo(t,a),this.ctx.lineTo(t+i.width,a),this.ctx.stroke()}}},{key:"renderRectangle",value:function(e){var t=e.properties,n=t.borderRadius||0;this.ctx.beginPath(),0===n?this.ctx.rect(0,0,t.width,t.height):this.roundedRect(0,0,t.width,t.height,n),t.backgroundColor&&"transparent"!==t.backgroundColor&&(this.ctx.fillStyle=t.backgroundColor,this.ctx.fill()),t.borderWidth&&t.borderWidth>0&&(this.ctx.strokeStyle=t.borderColor||"#000000",this.ctx.lineWidth=t.borderWidth,this.ctx.stroke())}},{key:"renderCircle",value:function(e){var t=e.properties,n=t.width/2,r=t.height/2,i=Math.min(n,r);this.ctx.beginPath(),this.ctx.arc(n,r,i,0,2*Math.PI),t.backgroundColor&&"transparent"!==t.backgroundColor&&(this.ctx.fillStyle=t.backgroundColor,this.ctx.fill()),t.borderWidth&&t.borderWidth>0&&(this.ctx.strokeStyle=t.borderColor||"#000000",this.ctx.lineWidth=t.borderWidth,this.ctx.stroke())}},{key:"renderLine",value:function(e){var t=e.properties;this.ctx.beginPath(),this.ctx.moveTo(0,t.height/2),this.ctx.lineTo(t.width,t.height/2),this.ctx.strokeStyle=t.color||"#000000",this.ctx.lineWidth=t.lineWidth||2,this.ctx.lineCap="round",this.ctx.stroke()}},{key:"renderImage",value:function(e){var t=e.properties;if(t.src){var n=t.src;if(this.imageCache.has(n)){var r=this.imageCache.get(n);this.drawCachedImage(r,t)}else this.loadAndCacheImage(t.src,n,t)}}},{key:"loadAndCacheImage",value:function(e,t,n){var r=this,i=new Image;i.crossOrigin="anonymous",i.onload=function(){var e={image:i,loaded:!0,width:i.naturalWidth,height:i.naturalHeight};r.imageCache.set(t,e),r.drawCachedImage(e,n)},i.onerror=function(){r.drawImagePlaceholder(n)},i.src=e}},{key:"drawCachedImage",value:function(e,t){if(e.loaded){var n=e.image,r=t.width,i=t.height,o=0,a=0;if("cover"===t.objectFit){var s=Math.max(t.width/n.width,t.height/n.height);r=n.width*s,i=n.height*s,o=(t.width-r)/2,a=(t.height-i)/2}else if("contain"===t.objectFit){var c=Math.min(t.width/n.width,t.height/n.height);r=n.width*c,i=n.height*c,o=(t.width-r)/2,a=(t.height-i)/2}this.ctx.drawImage(n,o,a,r,i)}}},{key:"drawImagePlaceholder",value:function(e){this.ctx.fillStyle="#f0f0f0",this.ctx.fillRect(0,0,e.width,e.height),this.ctx.strokeStyle="#ccc",this.ctx.lineWidth=2,this.ctx.strokeRect(2,2,e.width-4,e.height-4),this.ctx.strokeStyle="#999",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.moveTo(10,10),this.ctx.lineTo(e.width-10,e.height-10),this.ctx.moveTo(e.width-10,10),this.ctx.lineTo(10,e.height-10),this.ctx.stroke()}},{key:"renderBarcode",value:function(e){var t=e.properties,n=t.value||"123456789012";this.renderSimpleBarcode(n,t)}},{key:"renderQRCode",value:function(e){var t=e.properties,n=t.value||"https://example.com";this.renderQRPlaceholder(n,t)}},{key:"renderSimpleBarcode",value:function(e,t){var n=.8*t.height,r=(t.width-2*e.length)/2,i=(t.height-n)/2;this.ctx.fillStyle=t.color||"#000000";for(var o=0;o<e.length;o++)parseInt(e[o])%2==0&&this.ctx.fillRect(r+2*o,i,2,n)}},{key:"renderQRPlaceholder",value:function(e,t){this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,t.width,t.height),this.ctx.fillStyle="#ffffff";var n=.4*Math.min(t.width,t.height),r=(t.width-n)/2,i=(t.height-n)/2;this.ctx.fillRect(r,i,n,n),this.ctx.fillStyle="#000000",this.ctx.font="10px monospace",this.ctx.textAlign="center",this.ctx.fillText("QR",t.width/2,t.height/2+3)}},{key:"renderGeneric",value:function(e){this.renderRectangle(e)}},{key:"applyPostFilters",value:function(e){}},{key:"roundedRect",value:function(e,t,n,r,i){this.ctx.beginPath(),this.ctx.moveTo(e+i,t),this.ctx.lineTo(e+n-i,t),this.ctx.quadraticCurveTo(e+n,t,e+n,t+i),this.ctx.lineTo(e+n,t+r-i),this.ctx.quadraticCurveTo(e+n,t+r,e+n-i,t+r),this.ctx.lineTo(e+i,t+r),this.ctx.quadraticCurveTo(e,t+r,e,t+r-i),this.ctx.lineTo(e,t+i),this.ctx.quadraticCurveTo(e,t,e+i,t),this.ctx.closePath()}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width/this.devicePixelRatio,this.canvas.height/this.devicePixelRatio)}},{key:"resize",value:function(e,t){this.canvas.width=e*this.devicePixelRatio,this.canvas.height=t*this.devicePixelRatio,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.ctx.scale(this.devicePixelRatio,this.devicePixelRatio)}},{key:"getPerformanceStats",value:function(){return o(o({},this.performanceStats),{},{averageRenderTime:this.performanceStats.elementCount>0?this.performanceStats.renderTime/this.performanceStats.elementCount:0,fps:this.performanceStats.lastRenderTime>0?1e3/(Date.now()-this.performanceStats.lastRenderTime):0})}},{key:"resetStats",value:function(){this.performanceStats={renderTime:0,elementCount:0,lastRenderTime:Date.now()}}},{key:"clearCache",value:function(){this.imageCache.clear(),this.shapeCache.clear()}},{key:"dispose",value:function(){this.clearCache(),this.resetStats()}}])&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();t.default=l},557:function(e,t,n){n.r(t),n.d(t,{PDFCanvasPropertiesManager:function(){return f}});var r=n(901),i=n(351);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}var f=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasInstance=t,this.propertyHistory=new Map,this.propertyBindings=new Map,this.propertyWatchers=new Map,this.bulkUpdateQueue=new Map,this.config={enableHistory:!0,maxHistorySize:50,enableValidation:!0,enableBindings:!0,enableWatchers:!0,autoSave:!0,debounceMs:100},this.debounceTimers=new Map},t=[{key:"setProperty",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.skipValidation,o=void 0!==i&&i,a=r.skipHistory,s=void 0!==a&&a,c=r.skipWatchers,l=void 0!==c&&c,h=r.immediate,u=void 0!==h&&h,d=this.canvasInstance.elements.get(e);if(!d)return!1;if(this.config.enableValidation&&!o){var f=this.validateProperty(d,t,n);if(!f.valid)return!1;n=f.value}var y=d.properties[t];return y===n||(d.properties[t]=n,d.updatedAt=Date.now(),this.config.enableHistory&&!s&&this.addToHistory(e,t,y,n),this.config.enableBindings&&this.processBindings(e,t,n),this.config.enableWatchers&&!l&&this.notifyWatchers(e,t,y,n),u?this.canvasInstance.render():this.scheduleBulkUpdate(e)),!0}},{key:"getProperty",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.canvasInstance.elements.get(e);if(!r)return n;var i=r.properties[t];return void 0!==i?i:n}},{key:"setProperties",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={},i=0,o=Object.entries(t);i<o.length;i++){var a=l(o[i],2),c=a[0],h=a[1];r[c]=this.setProperty(e,c,h,s(s({},n),{},{skipHistory:!0,immediate:!1}))}return this.config.enableHistory&&!n.skipHistory&&this.addGroupToHistory(e,t),n.immediate?this.canvasInstance.render():this.scheduleBulkUpdate(e),r}},{key:"getProperties",value:function(e){var t=this.canvasInstance.elements.get(e);return t?s({},t.properties):{}}},{key:"validateProperty",value:function(e,t,n){if(!(0,r.isPropertyAllowed)(e.type,t))return{valid:!1,reason:'Property "'.concat(t,'" not allowed for element type "').concat(e.type,'"'),value:n};var o=i.elementCustomizationService.validateProperty(t,n),a=this.validatePropertyByType(t,o,e);return{valid:a.valid,reason:a.reason,value:a.value}}},{key:"validatePropertyByType",value:function(e,t,n){var r=this,i={width:function(e){return r.validateDimension(e,1,2e3)},height:function(e){return r.validateDimension(e,1,2e3)},x:function(e){return r.validateCoordinate(e)},y:function(e){return r.validateCoordinate(e)},backgroundColor:function(e){return r.validateColor(e)},borderColor:function(e){return r.validateColor(e)},color:function(e){return r.validateColor(e)},fontSize:function(e){return r.validateRange(e,8,72)},opacity:function(e){return r.validateRange(e,0,100)},rotation:function(e){return r.validateAngle(e)},scale:function(e){return r.validateRange(e,10,200)}}[e];return i?i(t):{valid:!0,value:t}}},{key:"validateDimension",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;return"number"!=typeof e||e<t||e>n?{valid:!1,reason:"Dimension must be a number between ".concat(t," and ").concat(n),value:Math.max(t,Math.min(n,Number(e)||t))}:{valid:!0,value:e}}},{key:"validateCoordinate",value:function(e){return"number"!=typeof e?{valid:!1,reason:"Coordinate must be a number",value:Number(e)||0}:{valid:!0,value:e}}},{key:"validateColor",value:function(e){if("transparent"===e||""===e)return{valid:!0,value:e};if(/^#[0-9A-Fa-f]{6}$/.test(e)||/^#[0-9A-Fa-f]{3}$/.test(e))return{valid:!0,value:e};var t=document.createElement("div");t.style.color=e;var n=t.style.color;return n&&""!==n?{valid:!0,value:e}:{valid:!1,reason:"Invalid color format",value:"#000000"}}},{key:"validateRange",value:function(e,t,n){return"number"!=typeof e||e<t||e>n?{valid:!1,reason:"Value must be between ".concat(t," and ").concat(n),value:Math.max(t,Math.min(n,Number(e)||t))}:{valid:!0,value:e}}},{key:"validateAngle",value:function(e){if("number"!=typeof e)return{valid:!1,reason:"Angle must be a number",value:Number(e)||0};var t=(e%360+360)%360;return{valid:!0,value:t>180?t-360:t}}},{key:"addToHistory",value:function(e,t,n,r){this.propertyHistory.has(e)||this.propertyHistory.set(e,[]);var i=this.propertyHistory.get(e);i.push({property:t,oldValue:n,newValue:r,timestamp:Date.now()}),i.length>this.config.maxHistorySize&&i.shift()}},{key:"addGroupToHistory",value:function(e,t){this.propertyHistory.has(e)||this.propertyHistory.set(e,[]);var n=this.propertyHistory.get(e);n.push({properties:s({},t),timestamp:Date.now(),type:"group"}),n.length>this.config.maxHistorySize&&n.shift()}},{key:"undoProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.propertyHistory.get(e);if(!n||0===n.length)return!1;var r=null;if(t)for(var i=n.length-1;i>=0;i--){var o=n[i];if(o.property===t||"group"===o.type&&o.properties[t]){r=o,n.splice(i,1);break}}else r=n.pop();if(!r)return!1;if("group"===r.type)for(var a=0,s=Object.entries(r.properties);a<s.length;a++){var c=l(s[a],2),h=c[0],u=c[1];this.setProperty(e,h,u,{skipHistory:!0,immediate:!1})}else this.setProperty(e,r.property,r.oldValue,{skipHistory:!0,immediate:!1});return this.scheduleBulkUpdate(e),!0}},{key:"bindProperties",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o="".concat(e,".").concat(t);this.propertyBindings.has(o)||this.propertyBindings.set(o,[]),this.propertyBindings.get(o).push({targetElementId:n,targetProperty:r,transform:i})}},{key:"unbindProperties",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i="".concat(e,".").concat(t),o=this.propertyBindings.get(i);if(o)if(n&&r){var a=o.findIndex(function(e){return e.targetElementId===n&&e.targetProperty===r});-1!==a&&o.splice(a,1)}else this.propertyBindings.delete(i)}},{key:"processBindings",value:function(e,t,n){var r=this,i="".concat(e,".").concat(t),o=this.propertyBindings.get(i);o&&o.forEach(function(e){var t=n;e.transform&&(t=e.transform(n)),r.setProperty(e.targetElementId,e.targetProperty,t,{skipHistory:!0,skipWatchers:!0,immediate:!1})})}},{key:"watchProperty",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i="".concat(e,".").concat(t);this.propertyWatchers.has(i)||this.propertyWatchers.set(i,[]),this.propertyWatchers.get(i).push({callback:n,options:s({immediate:!1},r)}),r.immediate&&n(this.getProperty(e,t),void 0,{type:"initial"})}},{key:"unwatchProperty",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r="".concat(e,".").concat(t),i=this.propertyWatchers.get(r);if(i)if(n){var o=i.findIndex(function(e){return e.callback===n});-1!==o&&i.splice(o,1)}else this.propertyWatchers.delete(r)}},{key:"notifyWatchers",value:function(e,t,n,r){var i="".concat(e,".").concat(t),o=this.propertyWatchers.get(i);o&&o.forEach(function(i){try{i.callback(r,n,{elementId:e,propertyName:t,type:"change"})}catch(e){}})}},{key:"scheduleBulkUpdate",value:function(e){var t=this;this.debounceTimers.has(e)&&clearTimeout(this.debounceTimers.get(e));var n=setTimeout(function(){t.canvasInstance.render(),t.debounceTimers.delete(e)},this.config.debounceMs);this.debounceTimers.set(e,n)}},{key:"forceUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(this.debounceTimers.has(e)&&(clearTimeout(this.debounceTimers.get(e)),this.debounceTimers.delete(e)),this.canvasInstance.render()):(this.debounceTimers.forEach(function(e,t){clearTimeout(e)}),this.debounceTimers.clear(),this.canvasInstance.render())}},{key:"getPropertyHistory",value:function(e){return this.propertyHistory.get(e)||[]}},{key:"getPropertyBindings",value:function(e,t){var n="".concat(e,".").concat(t);return this.propertyBindings.get(n)||[]}},{key:"getPropertyWatchers",value:function(e,t){var n="".concat(e,".").concat(t);return this.propertyWatchers.get(n)||[]}},{key:"resetProperties",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.canvasInstance.elements.get(e);if(!n)return!1;var r=i.elementCustomizationService.getDefaultProperties(n.type),o=t||Object.keys(r),a={};return o.forEach(function(e){r.hasOwnProperty(e)&&(a[e]=r[e])}),this.setProperties(e,a)}},{key:"copyProperties",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.getProperties(e),o=this.canvasInstance.elements.get(t);if(!o)return!1;var a=n||Object.keys(i),s={};return a.forEach(function(e){i.hasOwnProperty(e)&&(0,r.isPropertyAllowed)(o.type,e)&&(s[e]=i[e])}),this.setProperties(t,s)}},{key:"configure",value:function(e){this.config=s(s({},this.config),e)}},{key:"getStats",value:function(){return{totalElements:this.canvasInstance.elements.size,totalHistoryEntries:Array.from(this.propertyHistory.values()).reduce(function(e,t){return e+t.length},0),totalBindings:Array.from(this.propertyBindings.values()).reduce(function(e,t){return e+t.length},0),totalWatchers:Array.from(this.propertyWatchers.values()).reduce(function(e,t){return e+t.length},0),pendingUpdates:this.debounceTimers.size}}},{key:"dispose",value:function(){this.debounceTimers.forEach(function(e){return clearTimeout(e)}),this.debounceTimers.clear(),this.propertyHistory.clear(),this.propertyBindings.clear(),this.propertyWatchers.clear(),this.bulkUpdateQueue.clear()}}],t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();t.default=f},703:function(e,t,n){function r(e){this.canvasInstance=e,this.isDragging=!1,this.dragElement=null,this.dragOffset=null,this.dropZones=new Map,this.init()}n.r(t),n.d(t,{PDFCanvasDragDropManager:function(){return r}}),e=n.hmd(e),r.prototype.init=function(){this.setupGlobalListeners()},r.prototype.setupGlobalListeners=function(){document.addEventListener("dragstart",this.handleDragStart.bind(this)),document.addEventListener("dragend",this.handleDragEnd.bind(this)),document.addEventListener("dragover",this.handleDragOver.bind(this)),document.addEventListener("drop",this.handleDrop.bind(this))},r.prototype.handleDragStart=function(e){var t=e.target.getAttribute("data-element-type");t&&(this.isDragging=!0,this.dragElement={type:t,properties:this.getDefaultPropertiesForType(t)},e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("application/json",JSON.stringify(this.dragElement)),document.body.classList.add("pdf-builder-dragging"))},r.prototype.handleDragEnd=function(e){this.isDragging=!1,this.dragElement=null,this.dragOffset=null,document.body.classList.remove("pdf-builder-dragging")},r.prototype.handleDragOver=function(e){try{if(!e||"function"!=typeof e.preventDefault)return;if(!this.isDragging||!this.canvasInstance||!this.canvasInstance.canvas)return;var t=this.canvasInstance.canvas.getBoundingClientRect();if(e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom){e.preventDefault(),e.dataTransfer.dropEffect="copy";var n=this.canvasInstance.getMousePosition(e);this.dragOffset=n,this.canvasInstance.render()}}catch(e){}},r.prototype.handleDrop=function(e){try{if(!(this.isDragging&&this.dragElement&&this.canvasInstance&&this.canvasInstance.canvas))return;var t=this.canvasInstance.canvas.getBoundingClientRect();if(!(e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom))return;e.preventDefault();var n=this.canvasInstance.getMousePosition(e),r=Object.assign({},this.dragElement.properties);r.x=n.x-(r.width||100)/2,r.y=n.y-(r.height||50)/2;var i=this.canvasInstance.addElement(this.dragElement.type,r);this.canvasInstance.selectElement(i),this.canvasInstance.emit("element-dropped",{elementId:i,elementType:this.dragElement.type,position:n}),this.isDragging=!1,this.dragElement=null,this.dragOffset=null}catch(e){}},r.prototype.getDefaultPropertiesForType=function(e){return{text:{content:"Nouveau texte",fontSize:14,fontFamily:"Arial",color:"#000000",width:200,height:50},rectangle:{fillColor:"#ffffff",strokeColor:"#000000",strokeWidth:1,width:100,height:100},circle:{fillColor:"#ffffff",strokeColor:"#000000",strokeWidth:1,radius:50},line:{strokeColor:"#000000",strokeWidth:2,x2:100,y2:0},image:{src:"",width:100,height:100},product_table:{x:50,y:100,width:500,height:200,showHeaders:!0,showBorders:!0,fontSize:12,backgroundColor:"#ffffff",borderColor:"#e5e7eb",borderWidth:1},customer_info:{x:50,y:50,width:250,height:120,showHeaders:!0,showBorders:!1,fontSize:12,backgroundColor:"transparent",layout:"vertical"},company_info:{x:320,y:50,width:250,height:120,showHeaders:!0,showBorders:!1,fontSize:12,backgroundColor:"transparent",layout:"vertical"},company_logo:{x:50,y:200,width:150,height:80,fit:"contain",alignment:"left"},order_number:{x:450,y:20,width:100,height:30,fontSize:14,fontFamily:"Arial",textAlign:"right",backgroundColor:"transparent"},"dynamic-text":{x:50,y:320,width:200,height:40,template:"Commande #{order_number}",fontSize:14,fontFamily:"Arial",backgroundColor:"transparent"},mentions:{x:50,y:380,width:500,height:60,fontSize:10,fontFamily:"Arial",textAlign:"left",backgroundColor:"transparent"}}[e]||{}},r.prototype.render=function(e){if(this.isDragging&&this.dragOffset&&this.dragElement){e.save(),e.globalAlpha=.7,e.strokeStyle="#007bff",e.lineWidth=2,e.setLineDash([5,5]);var t=this.dragElement.properties,n=this.dragOffset.x-(t.width||100)/2,r=this.dragOffset.y-(t.height||50)/2,i=t.width||100,o=t.height||50;e.strokeRect(n,r,i,o),e.globalAlpha=1,e.fillStyle="#007bff",e.font="12px Arial",e.textAlign="center",e.fillText(this.dragElement.type,n+i/2,r+o/2),e.restore()}},r.prototype.registerDropZone=function(e,t){this.dropZones.set(e,t)},r.prototype.unregisterDropZone=function(e){this.dropZones.delete(e)},r.prototype.dispose=function(){document.removeEventListener("dragstart",this.handleDragStart.bind(this)),document.removeEventListener("dragend",this.handleDragEnd.bind(this)),document.removeEventListener("dragover",this.handleDragOver.bind(this)),document.removeEventListener("drop",this.handleDrop.bind(this)),this.dropZones.clear()},e.exports&&(e.exports=r),t.default=r},718:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=h(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return(t=f(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.r(t),n.d(t,{PDFCanvasLayersManager:function(){return y}});var y=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasInstance=t,this.layers=new Map,this.layerOrder=[],this.activeLayerId=null,this.layerGroups=new Map,this.config={maxLayers:100,defaultLayerName:"Layer",autoCreateLayers:!0,showLayerBounds:!1,enableLayerLocking:!0,enableLayerVisibility:!0,snapToLayerBounds:!1},this.createLayer("default",{name:"Default Layer",visible:!0,locked:!1,opacity:100,blendMode:"normal"})},t=[{key:"createLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.layers.size>=this.config.maxLayers)throw new Error("Maximum number of layers (".concat(this.config.maxLayers,") reached"));if(this.layers.has(e))throw new Error('Layer with id "'.concat(e,'" already exists'));var n={id:e,name:t.name||"".concat(this.config.defaultLayerName," ").concat(this.layers.size+1),visible:!1!==t.visible,locked:t.locked||!1,opacity:t.opacity||100,blendMode:t.blendMode||"normal",elements:new Set,bounds:null,createdAt:Date.now(),updatedAt:Date.now(),metadata:t.metadata||{}};return this.layers.set(e,n),this.layerOrder.push(e),this.activeLayerId||(this.activeLayerId=e),this.emitLayerEvent("layer-created",n),n}},{key:"deleteLayer",value:function(e){var t=this,n=this.layers.get(e);if(!n)return!1;if(1===this.layers.size)throw new Error("Cannot delete the last remaining layer");var r=this.activeLayerId!==e?this.activeLayerId:"default";return this.layers.get(r)&&n.elements.forEach(function(e){t.moveElementToLayer(e,r)}),this.layers.delete(e),this.layerOrder=this.layerOrder.filter(function(t){return t!==e}),this.activeLayerId===e&&(this.activeLayerId=this.layerOrder[0]||null),this.emitLayerEvent("layer-deleted",{id:e}),this.canvasInstance.render(),!0}},{key:"getLayer",value:function(e){return this.layers.get(e)||null}},{key:"getAllLayers",value:function(){return Array.from(this.layers.values())}},{key:"getLayersInOrder",value:function(){var e=this;return this.layerOrder.map(function(t){return e.layers.get(t)}).filter(function(e){return e})}},{key:"setActiveLayer",value:function(e){if(!this.layers.has(e))throw new Error('Layer "'.concat(e,'" does not exist'));var t=this.activeLayerId;return this.activeLayerId=e,this.emitLayerEvent("active-layer-changed",{previous:t,current:e}),!0}},{key:"getActiveLayer",value:function(){return this.layers.get(this.activeLayerId)||null}},{key:"updateLayer",value:function(e,t){var n=this.layers.get(e);if(!n)return!1;for(var r={},i=0,o=Object.entries(t);i<o.length;i++){var a=l(o[i],2),c=a[0],h=a[1];n.hasOwnProperty(c)&&(r[c]=n[c],n[c]=h)}return n.updatedAt=Date.now(),this.emitLayerEvent("layer-updated",{id:e,changes:r,layer:s({},n)}),this.canvasInstance.render(),!0}},{key:"addElementToLayer",value:function(e,t){var n=this.layers.get(t);return!!n&&(this.removeElementFromLayer(e),n.elements.add(e),this.updateLayerBounds(t),this.emitLayerEvent("element-added-to-layer",{elementId:e,layerId:t}),!0)}},{key:"removeElementFromLayer",value:function(e){var t,n=o(this.layers.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.elements.has(e))return r.elements.delete(e),this.updateLayerBounds(r.id),this.emitLayerEvent("element-removed-from-layer",{elementId:e,layerId:r.id}),!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"moveElementToLayer",value:function(e,t){return this.addElementToLayer(e,t)}},{key:"getElementLayer",value:function(e){var t,n=o(this.layers);try{for(n.s();!(t=n.n()).done;){var r=l(t.value,2),i=(r[0],r[1]);if(i.elements.has(e))return i}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"getLayerElements",value:function(e){var t=this.layers.get(e);if(!t)return[];var n,r=[],i=o(t.elements);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=this.canvasInstance.elements.get(a);s&&r.push(s)}}catch(e){i.e(e)}finally{i.f()}return r}},{key:"reorderLayers",value:function(e){var t=new Set(this.layerOrder),n=new Set(e);if(t.size!==n.size||!e.every(function(e){return t.has(e)}))throw new Error("Invalid layer order: must contain all existing layer IDs");this.layerOrder=i(e),this.emitLayerEvent("layers-reordered",{newOrder:i(this.layerOrder)}),this.canvasInstance.render()}},{key:"moveLayerUp",value:function(e){var t=this.layerOrder.indexOf(e);if(t>0){var n=[this.layerOrder[t-1],this.layerOrder[t]];this.layerOrder[t]=n[0],this.layerOrder[t-1]=n[1],this.reorderLayers(this.layerOrder)}}},{key:"moveLayerDown",value:function(e){var t=this.layerOrder.indexOf(e);if(t<this.layerOrder.length-1){var n=[this.layerOrder[t+1],this.layerOrder[t]];this.layerOrder[t]=n[0],this.layerOrder[t+1]=n[1],this.reorderLayers(this.layerOrder)}}},{key:"bringLayerToFront",value:function(e){var t=this.layerOrder.indexOf(e);-1!==t&&t<this.layerOrder.length-1&&(this.layerOrder.splice(t,1),this.layerOrder.push(e),this.reorderLayers(this.layerOrder))}},{key:"sendLayerToBack",value:function(e){var t=this.layerOrder.indexOf(e);t>0&&(this.layerOrder.splice(t,1),this.layerOrder.unshift(e),this.reorderLayers(this.layerOrder))}},{key:"mergeLayers",value:function(e,t){var n=this,r=this.layers.get(e),i=this.layers.get(t);return!(!r||!i)&&(r.elements.forEach(function(e){n.moveElementToLayer(e,t)}),this.deleteLayer(e))}},{key:"duplicateLayer",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.layers.get(e);if(!r)return null;var i="layer_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),o=this.createLayer(i,{name:n||"".concat(r.name," Copy"),visible:r.visible,locked:r.locked,opacity:r.opacity,blendMode:r.blendMode,metadata:s({},r.metadata)});return r.elements.forEach(function(e){var n=t.canvasInstance.elements.get(e);if(n){var r=n.properties||{},o=t.canvasInstance.addElement(n.type,s(s({},r),{},{x:(r.x||0)+20,y:(r.y||0)+20}));t.addElementToLayer(o,i)}}),o}},{key:"createLayerGroup",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.layerGroups.has(e))throw new Error('Layer group "'.concat(e,'" already exists'));var o=t.filter(function(e){return!n.layers.has(e)});if(o.length>0)throw new Error("Invalid layer IDs: ".concat(o.join(", ")));var a={id:e,name:r.name||"Group ".concat(e),layerIds:i(t),visible:!1!==r.visible,locked:r.locked||!1,opacity:r.opacity||100,createdAt:Date.now(),metadata:r.metadata||{}};return this.layerGroups.set(e,a),this.emitLayerEvent("layer-group-created",a),a}},{key:"deleteLayerGroup",value:function(e){return!!this.layerGroups.has(e)&&(this.layerGroups.delete(e),this.emitLayerEvent("layer-group-deleted",{id:e}),!0)}},{key:"updateLayerBounds",value:function(e){var t=this.layers.get(e);if(t){var n=this.getLayerElements(e);if(0!==n.length){var r=1/0,i=1/0,o=-1/0,a=-1/0;n.forEach(function(e){var t=e.properties;r=Math.min(r,t.x),i=Math.min(i,t.y),o=Math.max(o,t.x+t.width),a=Math.max(a,t.y+t.height)}),t.bounds={x:r,y:i,width:o-r,height:a-a}}else t.bounds=null}}},{key:"updateAllLayerBounds",value:function(){var e,t=o(this.layers.keys());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.updateLayerBounds(n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"render",value:function(e){var t,n=o(this.getLayersInOrder());try{for(n.s();!(t=n.n()).done;){var r=t.value;r.visible&&(e.save(),r.opacity<100&&(e.globalAlpha=r.opacity/100),"normal"!==r.blendMode&&(e.globalCompositeOperation=r.blendMode),this.renderLayerElements(e,r),this.config.showLayerBounds&&r.bounds&&this.renderLayerBounds(e,r),e.restore())}}catch(e){n.e(e)}finally{n.f()}}},{key:"renderLayerElements",value:function(e,t){var n,r=o(t.elements);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=this.canvasInstance.elements.get(i);a&&this.canvasInstance.renderElement(a)}}catch(e){r.e(e)}finally{r.f()}}},{key:"renderLayerBounds",value:function(e,t){t.bounds&&(e.strokeStyle="#007bff",e.lineWidth=1,e.setLineDash([5,5]),e.strokeRect(t.bounds.x,t.bounds.y,t.bounds.width,t.bounds.height),e.setLineDash([]))}},{key:"isLayerVisible",value:function(e){var t=this.layers.get(e);return!!t&&t.visible}},{key:"isLayerLocked",value:function(e){var t=this.layers.get(e);return!!t&&t.locked}},{key:"getLayerStats",value:function(){var e,t={totalLayers:this.layers.size,visibleLayers:0,lockedLayers:0,totalElements:0,layerElementCounts:{},activeLayer:this.activeLayerId,layerGroups:this.layerGroups.size},n=o(this.layers);try{for(n.s();!(e=n.n()).done;){var r=l(e.value,2),i=r[0],a=r[1];a.visible&&t.visibleLayers++,a.locked&&t.lockedLayers++;var s=a.elements.size;t.totalElements+=s,t.layerElementCounts[i]=s}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"exportLayers",value:function(){return{layers:Array.from(this.layers.entries()),layerOrder:i(this.layerOrder),activeLayerId:this.activeLayerId,layerGroups:Array.from(this.layerGroups.entries()),config:s({},this.config)}}},{key:"importLayers",value:function(e){var t=this;try{return this.layers.clear(),this.layerOrder=[],this.layerGroups.clear(),e.layers.forEach(function(e){var n=l(e,2),r=n[0],i=n[1];t.layers.set(r,s(s({},i),{},{elements:new Set(i.elements)}))}),this.layerOrder=i(e.layerOrder),this.activeLayerId=e.activeLayerId,e.layerGroups.forEach(function(e){var n=l(e,2),r=n[0],i=n[1];t.layerGroups.set(r,s({},i))}),e.config&&(this.config=s(s({},this.config),e.config)),this.emitLayerEvent("layers-imported",e),!0}catch(e){return!1}}},{key:"emitLayerEvent",value:function(e,t){if(this.canvasInstance.canvas){var n=new CustomEvent("layer-".concat(e),{detail:t,bubbles:!0});this.canvasInstance.canvas.dispatchEvent(n)}}},{key:"configure",value:function(e){this.config=s(s({},this.config),e)}},{key:"dispose",value:function(){this.layers.clear(),this.layerOrder=[],this.layerGroups.clear(),this.activeLayerId=null}}],t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();t.default=y},730:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],c=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){h(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function h(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return d(l,"_invoke",function(n,r,i){var o,s,c,l=0,h=i||[],u=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,s=0,c=e,d.n=n,a}};function f(n,r){for(s=n,c=r,t=0;!u&&l&&!i&&t<h.length;t++){var i,o=h[t],f=d.p,y=o[2];n>3?(i=y===r)&&(c=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=f&&((i=n<2&&f<o[1])?(s=0,d.v=r,d.n=o[1]):f<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,d.n=y,s=0))}if(i||n>1)return a;throw u=!0,r}return function(i,h,y){if(l>1)throw TypeError("Generator is already running");for(u&&1===h&&f(h,y),s=h,c=y;(t=s<2?e:c)||!u;){o||(s?s<3?(s>1&&(d.n=-1),f(s,c)):d.n=c:d.v=c);try{if(l=2,o){if(s||(i="next"),t=o[i]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=o.return)&&t.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);o=e}else if((t=(u=d.n<0)?c:n.call(r,d))!==a)break}catch(t){o=e,s=1,c=t}finally{l=1}}return{value:t,done:u}}}(n,i,o),!0),l}var a={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var h=[][r]?t(t([][r]())):(d(t={},r,function(){return this}),t),f=l.prototype=s.prototype=Object.create(h);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,d(e,i,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=l,d(f,"constructor",l),d(l,"constructor",c),c.displayName="GeneratorFunction",d(l,i,"GeneratorFunction"),d(f),d(f,i,"Generator"),d(f,r,function(){return this}),d(f,"toString",function(){return"[object Generator]"}),(u=function(){return{w:o,m:y}})()}function d(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}d=function(e,t,n,r){function o(t,n){d(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},d(e,t,n,r)}function f(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function y(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){f(o,r,i,a,s,"next",e)}function s(e){f(o,r,i,a,s,"throw",e)}a(void 0)})}}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function m(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.r(t),n.d(t,{PDFCanvasExportManager:function(){return v}});var v=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasInstance=t,this.jspdf=null,this.config={format:"a4",orientation:"portrait",unit:"mm",quality:2,compression:"FAST",includeMetadata:!0,includeLayers:!0,backgroundColor:"#ffffff",margin:{top:10,right:10,bottom:10,left:10},dpi:300,filename:"pdf-builder-export.pdf"},this.isExporting=!1,this.exportProgress=0,this.exportCallbacks={onProgress:null,onComplete:null,onError:null}},t=[{key:"initializeJSPDF",value:(b=y(u().m(function e(){var t;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.jspdf){e.n=1;break}return e.a(2,this.jspdf);case 1:if(e.p=1,"undefined"==typeof window||window.jspdf){e.n=2;break}return e.n=2,this.loadJSPDF();case 2:return t=window.jspdf.jsPDF,this.jspdf=t,e.a(2,this.jspdf);case 3:throw e.p=3,e.v,new Error("jsPDF library is required for PDF export");case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return b.apply(this,arguments)})},{key:"loadJSPDF",value:(g=y(u().m(function e(){return u().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,t){var n=document.createElement("script");n.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js",n.onload=e,n.onerror=t,document.head.appendChild(n)}))},e)})),function(){return g.apply(this,arguments)})},{key:"exportToPDF",value:(v=y(u().m(function e(){var t,n,r,i,o,a,s,c,h,d,f,y,p,m,v,g,b,w,x=arguments;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=x.length>0&&void 0!==x[0]?x[0]:{},!this.isExporting){e.n=1;break}throw new Error("Export already in progress");case 1:return this.isExporting=!0,this.exportProgress=0,e.p=2,n=l(l({},this.config),t),e.n=3,this.initializeJSPDF();case 3:return r=new this.jspdf({orientation:n.orientation,unit:n.unit,format:n.format,compress:"NONE"!==n.compression}),i=r.internal.pageSize.getWidth(),o=r.internal.pageSize.getHeight(),a=i-n.margin.left-n.margin.right,s=o-n.margin.top-n.margin.bottom,c=this.getCanvasBounds(),h=a/c.width,d=s/c.height,f=Math.min(h,d)*n.quality,y=n.margin.left,p=n.margin.top,n.includeMetadata&&this.addPDFMetadata(r,n),e.n=4,this.convertLayersToImages(f,n);case 4:for(m=e.v,this.emitProgress(20),v=0;v<m.length;v++)g=m[v],v>0&&r.addPage(),r.addImage(g.data,g.format,y,p,g.width/n.quality,g.height/n.quality),this.emitProgress(20+v/m.length*60);return this.emitProgress(90),b=n.filename||this.config.filename,r.save(b),this.emitProgress(100),this.emitComplete({filename:b,pageCount:m.length}),e.a(2,{success:!0,filename:b,pageCount:m.length});case 5:throw e.p=5,w=e.v,this.emitError(w),w;case 6:return e.p=6,this.isExporting=!1,this.exportProgress=0,e.f(6);case 7:return e.a(2)}},e,this,[[2,5,6,7]])})),function(){return v.apply(this,arguments)})},{key:"convertLayersToImages",value:(m=y(u().m(function e(t,n){var r,i,a,s,c,l,h;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:r=this.canvasInstance.layersManager.getLayersInOrder(),i=[],a=o(r),e.p=1,a.s();case 2:if((s=a.n()).done){e.n=6;break}if((c=s.value).visible||!n.includeLayers){e.n=3;break}return e.a(3,5);case 3:return e.n=4,this.convertLayerToImage(c,t,n);case 4:(l=e.v)&&i.push(l);case 5:e.n=2;break;case 6:e.n=8;break;case 7:e.p=7,h=e.v,a.e(h);case 8:return e.p=8,a.f(),e.f(8);case 9:return e.a(2,i)}},e,this,[[1,7,8,9]])})),function(e,t){return m.apply(this,arguments)})},{key:"convertLayerToImage",value:(f=y(u().m(function e(t,n,r){var i,a,s,c,l,h,d,f,y;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:i=document.createElement("canvas"),a=i.getContext("2d"),s=this.getCanvasBounds(),i.width=s.width*n,i.height=s.height*n,a.scale(n,n),a.fillStyle=r.backgroundColor,a.fillRect(0,0,s.width,s.height),t.opacity<100&&(a.globalAlpha=t.opacity/100),"normal"!==t.blendMode&&(a.globalCompositeOperation=t.blendMode),c=this.canvasInstance.layersManager.getLayerElements(t.id),l=o(c),e.p=1,l.s();case 2:if((h=l.n()).done){e.n=4;break}return d=h.value,e.n=3,this.renderElementToCanvas(a,d);case 3:e.n=2;break;case 4:e.n=6;break;case 5:e.p=5,y=e.v,l.e(y);case 6:return e.p=6,l.f(),e.f(6);case 7:return f=i.toDataURL("image/png",.95),e.a(2,{data:f,format:"PNG",width:i.width,height:i.height,layerId:t.id,layerName:t.name})}},e,this,[[1,5,6,7]])})),function(e,t,n){return f.apply(this,arguments)})},{key:"renderElementToCanvas",value:(d=y(u().m(function e(t,n){var r,i;return u().w(function(e){for(;;)switch(e.n){case 0:r=n.properties,t.save(),r.rotation?(t.translate(r.x+r.width/2,r.y+r.height/2),t.rotate(r.rotation*Math.PI/180),t.translate(-r.width/2,-r.height/2)):t.translate(r.x,r.y),void 0!==r.opacity&&(t.globalAlpha=r.opacity/100),i=n.type,e.n="text"===i?1:"rectangle"===i?2:"circle"===i?3:"line"===i?4:"image"===i?5:7;break;case 1:return this.renderTextElement(t,r),e.a(3,8);case 2:return this.renderRectangleElement(t,r),e.a(3,8);case 3:return this.renderCircleElement(t,r),e.a(3,8);case 4:return this.renderLineElement(t,r),e.a(3,8);case 5:return e.n=6,this.renderImageElement(t,r);case 6:return e.a(3,8);case 7:this.canvasInstance.renderElement(n,t);case 8:t.restore();case 9:return e.a(2)}},e,this)})),function(e,t){return d.apply(this,arguments)})},{key:"renderTextElement",value:function(e,t){e.fillStyle=t.color||"#000000",e.font="".concat(t.fontSize||12,"px ").concat(t.fontFamily||"Arial"),t.bold&&(e.font="bold ".concat(e.font)),t.italic&&(e.font="italic ".concat(e.font)),e.textAlign=t.textAlign||"left",e.textBaseline="top";var n=(t.text||"").split("\n"),r=t.lineHeight||1.2,i=0;n.forEach(function(n){e.fillText(n,0,i),i+=(t.fontSize||12)*r})}},{key:"renderRectangleElement",value:function(e,t){e.fillStyle=t.fillColor||"transparent",e.strokeStyle=t.strokeColor||"#000000",e.lineWidth=t.strokeWidth||1,t.fillColor&&e.fillRect(0,0,t.width,t.height),t.strokeColor&&t.strokeWidth>0&&e.strokeRect(0,0,t.width,t.height)}},{key:"renderCircleElement",value:function(e,t){var n=t.width/2,r=t.height/2,i=Math.min(t.width,t.height)/2;e.beginPath(),e.arc(n,r,i,0,2*Math.PI),e.fillStyle=t.fillColor||"transparent",e.strokeStyle=t.strokeColor||"#000000",e.lineWidth=t.strokeWidth||1,t.fillColor&&e.fill(),t.strokeColor&&t.strokeWidth>0&&e.stroke()}},{key:"renderLineElement",value:function(e,t){e.strokeStyle=t.strokeColor||"#000000",e.lineWidth=t.strokeWidth||1,e.lineCap=t.lineCap||"butt",e.lineJoin=t.lineJoin||"miter",e.beginPath(),e.moveTo(0,0),e.lineTo(t.width,t.height),e.stroke()}},{key:"renderImageElement",value:(h=y(u().m(function e(t,n){var r;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n.imageSrc){e.n=1;break}return e.a(2);case 1:return e.p=1,r=new Image,e.n=2,new Promise(function(e,t){r.onload=e,r.onerror=t,r.src=n.imageSrc});case 2:t.drawImage(r,0,0,n.width,n.height),e.n=4;break;case 3:e.p=3,e.v,t.strokeStyle="#ff0000",t.lineWidth=2,t.strokeRect(0,0,n.width,n.height);case 4:return e.a(2)}},e,null,[[1,3]])})),function(e,t){return h.apply(this,arguments)})},{key:"getCanvasBounds",value:function(){var e=Array.from(this.canvasInstance.elements.values());if(0===e.length)return{x:0,y:0,width:800,height:600};var t=1/0,n=1/0,r=-1/0,i=-1/0;return e.forEach(function(e){var o=e.properties;t=Math.min(t,o.x),n=Math.min(n,o.y),r=Math.max(r,o.x+o.width),i=Math.max(i,o.y+o.height)}),{x:t,y:n,width:r-t,height:i-n}}},{key:"addPDFMetadata",value:function(e,t){var n=new Date;if(e.setProperties({title:"PDF Builder Export",subject:"Generated PDF Document",author:"PDF Builder Pro",creator:"PDF Builder Pro",creationDate:n,modDate:n}),t.includeMetadata){var r=this.canvasInstance.getStats();e.setKeywords(["elements: ".concat(r.totalElements),"layers: ".concat(r.totalLayers),"exported: ".concat(n.toISOString()),"pdf-builder-pro"])}}},{key:"exportToFormat",value:(c=y(u().m(function e(t){var n,r,i=arguments;return u().w(function(e){for(;;)switch(e.n){case 0:n=i.length>1&&void 0!==i[1]?i[1]:{},r=t.toLowerCase(),e.n="pdf"===r?1:"png"===r?3:"jpeg"===r||"jpg"===r?5:"svg"===r?7:9;break;case 1:return e.n=2,this.exportToPDF(n);case 2:case 4:case 6:case 8:return e.a(2,e.v);case 3:return e.n=4,this.exportToPNG(n);case 5:return e.n=6,this.exportToJPEG(n);case 7:return e.n=8,this.exportToSVG(n);case 9:throw new Error("Unsupported export format: ".concat(t));case 10:return e.a(2)}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"exportToPNG",value:(s=y(u().m(function e(){var t,n,r,i,o,a,s=arguments;return u().w(function(e){for(;;)if(0===e.n)return t=s.length>0&&void 0!==s[0]?s[0]:{},n=l(l({},this.config),t),r=this.canvasInstance.canvas,i=document.createElement("canvas"),o=i.getContext("2d"),i.width=r.width*n.quality,i.height=r.height*n.quality,o.scale(n.quality,n.quality),o.fillStyle=n.backgroundColor,o.fillRect(0,0,r.width,r.height),o.drawImage(r,0,0),a=i.toDataURL("image/png",.95),this.downloadDataURL(a,n.filename.replace(".pdf",".png")),e.a(2,{success:!0,format:"png"})},e,this)})),function(){return s.apply(this,arguments)})},{key:"exportToJPEG",value:(a=y(u().m(function e(){var t,n,r,i,o,a,s=arguments;return u().w(function(e){for(;;)if(0===e.n)return t=s.length>0&&void 0!==s[0]?s[0]:{},n=l(l({},this.config),t),r=this.canvasInstance.canvas,i=document.createElement("canvas"),o=i.getContext("2d"),i.width=r.width*n.quality,i.height=r.height*n.quality,o.scale(n.quality,n.quality),o.fillStyle=n.backgroundColor,o.fillRect(0,0,r.width,r.height),o.drawImage(r,0,0),a=i.toDataURL("image/jpeg",.95),this.downloadDataURL(a,n.filename.replace(".pdf",".jpg")),e.a(2,{success:!0,format:"jpeg"})},e,this)})),function(){return a.apply(this,arguments)})},{key:"exportToSVG",value:(r=y(u().m(function e(){var t,n,r,a,s,c,h,d,f,y,p=arguments;return u().w(function(e){for(;;)if(0===e.n){t=p.length>0&&void 0!==p[0]?p[0]:{},n=l(l({},this.config),t),r=this.getCanvasBounds(),a='<svg width="'.concat(r.width,'" height="').concat(r.height,'" xmlns="http://www.w3.org/2000/svg">'),a+='<rect width="100%" height="100%" fill="'.concat(n.backgroundColor,'"/>'),s=o(this.canvasInstance.elements);try{for(s.s();!(c=s.n()).done;)(h=i(c.value,2))[0],d=h[1],a+=this.elementToSVG(d)}catch(e){s.e(e)}finally{s.f()}return a+="</svg>",f=new Blob([a],{type:"image/svg+xml"}),y=URL.createObjectURL(f),this.downloadDataURL(y,n.filename.replace(".pdf",".svg")),e.a(2,{success:!0,format:"svg"})}},e,this)})),function(){return r.apply(this,arguments)})},{key:"elementToSVG",value:function(e){var t=e.properties;switch(e.type){case"rectangle":return'<rect x="'.concat(t.x,'" y="').concat(t.y,'" width="').concat(t.width,'" height="').concat(t.height,'" fill="').concat(t.fillColor||"transparent",'" stroke="').concat(t.strokeColor||"#000",'" stroke-width="').concat(t.strokeWidth||1,'"/>');case"circle":var n=t.x+t.width/2,r=t.y+t.height/2,i=Math.min(t.width,t.height)/2;return'<circle cx="'.concat(n,'" cy="').concat(r,'" r="').concat(i,'" fill="').concat(t.fillColor||"transparent",'" stroke="').concat(t.strokeColor||"#000",'" stroke-width="').concat(t.strokeWidth||1,'"/>');case"text":return'<text x="'.concat(t.x,'" y="').concat(t.y+(t.fontSize||12),'" font-family="').concat(t.fontFamily||"Arial",'" font-size="').concat(t.fontSize||12,'" fill="').concat(t.color||"#000",'">').concat(t.text||"","</text>");default:return""}}},{key:"downloadDataURL",value:function(e,t){var n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"configure",value:function(e){this.config=l(l({},this.config),e)}},{key:"setCallbacks",value:function(e){this.exportCallbacks=l(l({},this.exportCallbacks),e)}},{key:"emitProgress",value:function(e){this.exportProgress=e,this.exportCallbacks.onProgress&&this.exportCallbacks.onProgress(e)}},{key:"emitComplete",value:function(e){this.exportCallbacks.onComplete&&this.exportCallbacks.onComplete(e)}},{key:"emitError",value:function(e){this.exportCallbacks.onError&&this.exportCallbacks.onError(e)}},{key:"getSupportedFormats",value:function(){return["pdf","png","jpeg","jpg","svg"]}},{key:"getExportStats",value:function(){return{isExporting:this.isExporting,progress:this.exportProgress,supportedFormats:this.getSupportedFormats(),config:l({},this.config)}}},{key:"dispose",value:function(){this.exportCallbacks={onProgress:null,onComplete:null,onError:null},this.isExporting=!1,this.exportProgress=0}}],t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,a,s,c,h,d,f,m,v,g,b}();t.default=v},878:function(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function s(n,r,i,a){var s=r&&r.prototype instanceof l?r:l,h=Object.create(s.prototype);return o(h,"_invoke",function(n,r,i){var o,a,s,l=0,h=i||[],u=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,a=0,s=e,d.n=n,c}};function f(n,r){for(a=n,s=r,t=0;!u&&l&&!i&&t<h.length;t++){var i,o=h[t],f=d.p,y=o[2];n>3?(i=y===r)&&(s=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=f&&((i=n<2&&f<o[1])?(a=0,d.v=r,d.n=o[1]):f<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,d.n=y,a=0))}if(i||n>1)return c;throw u=!0,r}return function(i,h,y){if(l>1)throw TypeError("Generator is already running");for(u&&1===h&&f(h,y),a=h,s=y;(t=a<2?e:s)||!u;){o||(a?a<3?(a>1&&(d.n=-1),f(a,s)):d.n=s:d.v=s);try{if(l=2,o){if(a||(i="next"),t=o[i]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,a<2&&(a=0)}else 1===a&&(t=o.return)&&t.call(o),a<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=e}else if((t=(u=d.n<0)?s:n.call(r,d))!==c)break}catch(t){o=e,a=1,s=t}finally{l=1}}return{value:t,done:u}}}(n,i,a),!0),h}var c={};function l(){}function h(){}function u(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(o(t={},r,function(){return this}),t),f=u.prototype=l.prototype=Object.create(d);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,o(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return h.prototype=u,o(f,"constructor",u),o(u,"constructor",h),h.displayName="GeneratorFunction",o(u,a,"GeneratorFunction"),o(f),o(f,a,"Generator"),o(f,r,function(){return this}),o(f,"toString",function(){return"[object Generator]"}),(i=function(){return{w:s,m:y}})()}function o(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,t,n,r){function a(t,n){o(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},o(e,t,n,r)}function a(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n){return(t=u(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.r(t),n.d(t,{WooCommerceElementsManager:function(){return d},wooCommerceElementsManager:function(){return f}});var d=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elements=new Map,this.testMode=!0,this.orderId=null},t=[{key:"setTestMode",value:function(e){this.testMode=e}},{key:"setOrderId",value:function(e){this.orderId=e}},{key:"registerElement",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.elements.set(e,{type:t,data:n,lastUpdate:Date.now()})}},{key:"updateElementData",value:function(e,t){if(this.elements.has(e)){var n=this.elements.get(e);n.data=c(c({},n.data),t),n.lastUpdate=Date.now(),this.elements.set(e,n)}}},{key:"unregisterElement",value:function(e){this.elements.delete(e)}},{key:"getElementData",value:function(e){var t=this.elements.get(e);return t?t.data:null}},{key:"getElementDisplayText",value:function(e){return this.getTestData(e)}},{key:"getTestData",value:function(e){return{"woocommerce-invoice-number":"INV-001","woocommerce-invoice-date":(new Date).toISOString().split("T")[0],"woocommerce-order-number":"#1234","woocommerce-order-date":(new Date).toLocaleString(),"woocommerce-billing-address":"John Doe\n123 Main Street\nSpringfield, IL 62701\nUnited States","woocommerce-shipping-address":"John Doe\n456 Shipping Avenue\nSpringfield, IL 62702\nUnited States","woocommerce-customer-name":"John Doe","woocommerce-customer-email":"john.doe@example.com","woocommerce-payment-method":"Carte de crÃ©dit (Stripe)","woocommerce-order-status":"TraitÃ©e","woocommerce-products-table":this.formatProductsTable([{name:"Produit Exemple 1",quantity:1,price:"$10.00",total:"$10.00"},{name:"Produit Exemple 2",quantity:2,price:"$15.00",total:"$30.00"},{name:"Produit Exemple 3",quantity:1,price:"$5.00",total:"$5.00"}]),"woocommerce-subtotal":"$45.00","woocommerce-discount":"-$5.00","woocommerce-shipping":"$5.00","woocommerce-taxes":"$2.25","woocommerce-total":"$47.25","woocommerce-refund":"$0.00","woocommerce-fees":"$1.50","woocommerce-quote-number":"QUO-001","woocommerce-quote-date":(new Date).toISOString().split("T")[0],"woocommerce-quote-validity":"30 jours","woocommerce-quote-notes":"Conditions spÃ©ciales : paiement Ã  30 jours."}[e]||""}},{key:"formatProductsTable",value:function(e){return Array.isArray(e)?e.map(function(e){return"- ".concat(e.name," x").concat(e.quantity," ").concat(e.price)}).join("\n"):""}},{key:"loadWooCommerceData",value:(r=i().m(function e(){var t,n,r,o=arguments;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:null,!this.testMode&&t){e.n=1;break}return e.a(2,this.getAllTestData());case 1:return e.p=1,e.n=2,fetch("/wp-json/pdf-builder/v1/woocommerce-data/".concat(t),{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings?wpApiSettings.nonce:""}});case 2:if((n=e.v).ok){e.n=3;break}throw new Error("Erreur HTTP: ".concat(n.status));case 3:return e.n=4,n.json();case 4:return r=e.v,e.a(2,r);case 5:return e.p=5,e.v,e.a(2,this.getAllTestData())}},e,this,[[1,5]])}),o=function(){var e=this,t=arguments;return new Promise(function(n,i){var o=r.apply(e,t);function s(e){a(o,n,i,s,c,"next",e)}function c(e){a(o,n,i,s,c,"throw",e)}s(void 0)})},function(){return o.apply(this,arguments)})},{key:"getAllTestData",value:function(){var e=this,t={};return["woocommerce-invoice-number","woocommerce-invoice-date","woocommerce-order-number","woocommerce-order-date","woocommerce-billing-address","woocommerce-shipping-address","woocommerce-customer-name","woocommerce-customer-email","woocommerce-payment-method","woocommerce-order-status","woocommerce-products-table","woocommerce-subtotal","woocommerce-discount","woocommerce-shipping","woocommerce-taxes","woocommerce-total","woocommerce-refund","woocommerce-fees","woocommerce-quote-number","woocommerce-quote-date","woocommerce-quote-validity","woocommerce-quote-notes"].forEach(function(n){t[n]=e.getTestData(n)}),t}},{key:"validateElement",value:function(e,t){var n=this,r={"woocommerce-invoice-number":function(e){return"string"==typeof e&&e.length>0},"woocommerce-invoice-date":function(e){return n.isValidDate(e)},"woocommerce-order-number":function(e){return"string"==typeof e&&e.length>0},"woocommerce-order-date":function(e){return n.isValidDate(e)},"woocommerce-billing-address":function(e){return"string"==typeof e&&e.length>0},"woocommerce-shipping-address":function(e){return"string"==typeof e&&e.length>0},"woocommerce-customer-name":function(e){return"string"==typeof e&&e.length>0},"woocommerce-customer-email":function(e){return n.isValidEmail(e)},"woocommerce-payment-method":function(e){return"string"==typeof e},"woocommerce-order-status":function(e){return"string"==typeof e},"woocommerce-products-table":function(e){return"string"==typeof e},"woocommerce-subtotal":function(e){return"string"==typeof e},"woocommerce-discount":function(e){return"string"==typeof e},"woocommerce-shipping":function(e){return"string"==typeof e},"woocommerce-taxes":function(e){return"string"==typeof e},"woocommerce-total":function(e){return"string"==typeof e},"woocommerce-refund":function(e){return"string"==typeof e},"woocommerce-fees":function(e){return"string"==typeof e},"woocommerce-quote-number":function(e){return"string"==typeof e&&e.length>0},"woocommerce-quote-date":function(e){return n.isValidDate(e)},"woocommerce-quote-validity":function(e){return"string"==typeof e},"woocommerce-quote-notes":function(e){return"string"==typeof e}}[e];return!r||r(t)}},{key:"isValidDate",value:function(e){if("string"!=typeof e)return!1;var t=new Date(e);return!isNaN(t.getTime())}},{key:"isValidEmail",value:function(e){return"string"==typeof e&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}},{key:"getDefaultProperties",value:function(e){var t={width:200,height:60,fontSize:14,fontFamily:"Arial, sans-serif",color:"#333333",backgroundColor:"#ffffff",borderColor:"#dddddd",borderWidth:1,borderRadius:4,padding:8};switch(e){case"woocommerce-billing-address":case"woocommerce-shipping-address":t.height=100;break;case"woocommerce-products-table":t.width=400,t.height=150;break;case"woocommerce-invoice-number":case"woocommerce-order-number":case"woocommerce-quote-number":t.width=150,t.height=40}return t}},{key:"dispose",value:function(){this.elements.clear()}}],t&&h(e.prototype,t),n&&h(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o}(),f=new d},901:function(e,t,n){n.r(t),n.d(t,{ELEMENT_PROPERTY_RESTRICTIONS:function(){return r},ELEMENT_TYPE_MAPPING:function(){return i},fixInvalidProperty:function(){return c},getPropertyDefault:function(){return a},isPropertyAllowed:function(){return o},validateProperty:function(){return s}});var r={special:{backgroundColor:{disabled:!1,default:"transparent"},borderColor:{disabled:!1},borderWidth:{disabled:!1}},layout:{backgroundColor:{disabled:!1,default:"#f8fafc"},borderColor:{disabled:!1},borderWidth:{disabled:!1}},text:{backgroundColor:{disabled:!1,default:"transparent"},borderColor:{disabled:!1},borderWidth:{disabled:!1}},shape:{backgroundColor:{disabled:!1,default:"#e5e7eb"},borderColor:{disabled:!1},borderWidth:{disabled:!1}},media:{backgroundColor:{disabled:!1,default:"#f3f4f6"},borderColor:{disabled:!1},borderWidth:{disabled:!1}},dynamic:{backgroundColor:{disabled:!1,default:"transparent"},borderColor:{disabled:!1},borderWidth:{disabled:!1}}},i={product_table:"special",customer_info:"special",company_logo:"special",company_info:"special",order_number:"special",document_type:"special","progress-bar":"special","layout-header":"layout","layout-footer":"layout","layout-sidebar":"layout","layout-section":"layout","layout-container":"layout","layout-section-divider":"layout","layout-spacer":"layout","layout-two-column":"layout","layout-three-column":"layout",text:"text","dynamic-text":"text","conditional-text":"text",counter:"text","date-dynamic":"text",currency:"text",formula:"text",rectangle:"shape",line:"shape","shape-rectangle":"shape","shape-circle":"shape","shape-line":"shape","shape-arrow":"shape","shape-triangle":"shape","shape-star":"shape",divider:"shape",image:"media","image-upload":"media",logo:"media",barcode:"media",qrcode:"media","qrcode-dynamic":"media",icon:"media","table-dynamic":"dynamic","gradient-box":"dynamic","shadow-box":"dynamic","rounded-box":"dynamic","border-box":"dynamic","background-pattern":"dynamic",watermark:"dynamic","invoice-header":"layout","invoice-address-block":"layout","invoice-info-block":"layout","invoice-products-table":"special","invoice-totals-block":"layout","invoice-payment-terms":"layout","invoice-legal-footer":"layout","invoice-signature-block":"layout"},o=function(e,t){var n=i[e]||"text",o=r[n];return!o||!o[t]||!o[t].disabled},a=function(e,t){var n=i[e]||"text",o=r[n];return o&&o[t]&&void 0!==o[t].default?o[t].default:null},s=function(e,t,n){if(!o(e,t))return{valid:!1,reason:r[i[e]||"text"][t]&&r[i[e]||"text"][t].reason||"PropriÃ©tÃ© non autorisÃ©e"};switch(t){case"backgroundColor":if("string"!=typeof n)return{valid:!1,reason:"La couleur doit Ãªtre une chaÃ®ne"};break;case"borderWidth":if("number"!=typeof n||n<0)return{valid:!1,reason:"La largeur de bordure doit Ãªtre un nombre positif"};break;case"fontSize":if("number"!=typeof n||n<=0)return{valid:!1,reason:"La taille de police doit Ãªtre un nombre positif"};break;case"width":case"height":if("number"!=typeof n||n<=0)return{valid:!1,reason:"Les dimensions doivent Ãªtre positives"}}return{valid:!0}},c=function(e,t,n){var r={borderWidth:0,fontSize:14,width:100,height:50,padding:8};if(void 0!==r[t])return r[t];return{backgroundColor:"transparent",borderColor:"transparent",color:"#000000",fontFamily:"Arial, sans-serif"}[t]||n}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r](o,o.exports,n),o.loaded=!0,o.exports}n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.r(r),n.d(r,{default:function(){return E}});var i=n(287),o=n(483),a=n(57),s=n(52),c=n(557),l=n(718),h=n(730),u=n(878),d=n(351),f=n(349),y=n(451);function p(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var v={special:[{type:"product_table",label:"Tableau Produits",icon:"ðŸ“‹",description:"Tableau des produits commandÃ©s avec quantitÃ©s et prix",category:"special",defaultProps:{x:50,y:100,width:500,height:200,showHeaders:!0,showBorders:!0,fontSize:12,backgroundColor:"#ffffff",borderColor:"#e5e7eb",borderWidth:1}},{type:"customer_info",label:"Fiche Client",icon:"ðŸ‘¤",description:"Informations dÃ©taillÃ©es du client (nom, adresse, email)",category:"special",defaultProps:{x:50,y:50,width:250,height:120,showHeaders:!0,showBorders:!1,fontSize:12,backgroundColor:"transparent",layout:"vertical"}},{type:"company_info",label:"Informations Entreprise",icon:"[D]",description:"Nom, adresse, contact et TVA de l'entreprise",category:"special",defaultProps:{x:320,y:50,width:250,height:120,showHeaders:!0,showBorders:!1,fontSize:12,backgroundColor:"transparent",layout:"vertical"}},{type:"company_logo",label:"Logo Entreprise",icon:"ï¿½",description:"Logo et identitÃ© visuelle de l'entreprise",category:"special",defaultProps:{x:50,y:200,width:150,height:80,fit:"contain",alignment:"left"}},{type:"order_number",label:"NumÃ©ro de Commande",icon:"ðŸ”¢",description:"RÃ©fÃ©rence de commande avec date",category:"special",defaultProps:{x:450,y:20,width:100,height:30,fontSize:14,fontFamily:"Arial",textAlign:"right",backgroundColor:"transparent"}},{type:"dynamic-text",label:"Texte Dynamique",icon:"ðŸ“",description:"Texte avec variables dynamiques",category:"special",defaultProps:{x:50,y:320,width:200,height:40,template:"Commande #{order_number}",fontSize:14,fontFamily:"Arial",backgroundColor:"transparent"}},{type:"mentions",label:"Mentions lÃ©gales",icon:"ðŸ“„",description:"Informations lÃ©gales (email, SIRET, tÃ©lÃ©phone, etc.)",category:"special",defaultProps:{x:50,y:380,width:500,height:60,fontSize:10,fontFamily:"Arial",textAlign:"left",backgroundColor:"transparent"}}]},g=function(){return v},b=function(e){return v[e]||[]},w=function(e){for(var t in v){var n=v[t].find(function(t){return t.type===e});if(n)return n}return null},x=function(){var e=[];for(var t in v)e.push.apply(e,p(v[t]));return e},S=function(e){var t=x(),n=e.toLowerCase();return t.filter(function(e){return e.label.toLowerCase().includes(n)||e.description.toLowerCase().includes(n)||e.type.toLowerCase().includes(n)})},k={VanillaCanvas:i.default,CanvasRenderer:o.default,CanvasEvents:a.default,CanvasSelection:s.default,CanvasProperties:c.default,CanvasLayers:l.default,CanvasExport:h.default,WooCommerceElementsManager:u.WooCommerceElementsManager,wooCommerceElementsManager:u.wooCommerceElementsManager,ElementCustomizationService:d.ElementCustomizationService,elementCustomizationService:d.elementCustomizationService,CanvasOptimizer:f.default,CanvasTests:y.default,ELEMENT_LIBRARY:v,getAllElements:g,getElementsByCategory:b,getElementByType:w,getAllElementsFlat:x,searchElements:S,PDFCanvasVanilla:i.default,ElementLibrary:v,ToolbarManager:a.default,PropertiesPanel:c.default,init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return i.default&&"function"==typeof i.default.init&&i.default.init(e),a.default&&"function"==typeof a.default.init&&a.default.init(),!0}catch(e){return!1}}};window.PDFBuilderPro=k,window.VanillaCanvas=i.default,window.CanvasRenderer=o.default,window.CanvasEvents=a.default,window.CanvasSelection=s.default,window.CanvasProperties=c.default,window.CanvasLayers=l.default,window.CanvasExport=h.default,window.WooCommerceElementsManager=u.WooCommerceElementsManager,window.wooCommerceElementsManager=u.wooCommerceElementsManager,window.ElementCustomizationService=d.ElementCustomizationService,window.elementCustomizationService=d.elementCustomizationService,window.CanvasOptimizer=f.default,window.CanvasTests=y.default,window.ELEMENT_LIBRARY=v,window.getAllElements=g,window.getElementsByCategory=b,window.getElementByType=w,window.getAllElementsFlat=x,window.searchElements=S,window.PDFCanvasVanilla=i.default,window.ElementLibrary=v,window.PDFBuilderPro={PDFCanvasVanilla:i.default,getAllElements:g,getElementsByCategory:b,getElementByType:w,getAllElementsFlat:x,searchElements:S,ELEMENT_LIBRARY:v},window.ToolbarManager=a.default,window.PropertiesPanel=c.default;var E=k;return r=r.default}()});