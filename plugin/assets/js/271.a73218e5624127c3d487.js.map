{"version":3,"file":"js/271.a73218e5624127c3d487.js","mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACzFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AChSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AChpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC7JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACviCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACvIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACxOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACz9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACngBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/hBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACxKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/fA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/fA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACxlBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACnIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/tBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9jBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACzNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://PDFBuilder/./assets/js/pdf-builder-react/utils/debug.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/contexts/CanvasSettingsContext.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/contexts/builder/BuilderContext.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/hooks/useCanvasSettings.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/hooks/useCanvasDrop.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/hooks/useCanvasInteraction.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/hooks/useKeyboardShortcuts.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/utils/WooCommerceElementsManager.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/utils/ElementChangeTracker.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/utils/CanvasMonitoringDashboard.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/ui/ContextMenu.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/canvas/Canvas.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/constants/responsive.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/hooks/useResponsive.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/ui/Responsive.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/toolbar/Toolbar.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/ProductTableProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/CustomerInfoProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/CompanyInfoProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/CompanyLogoProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/OrderNumberProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/DynamicTextProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/MentionsProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/DocumentTypeProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/TextProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/ShapeProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/ImageProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/LineProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/ElementProperties.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/properties/PropertiesPanel.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/hooks/usePreview.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/header/Header.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/element-library/ElementLibrary.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/utils/elementNormalization.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/hooks/useTemplate.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/constants/canvas.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/utils/responsive.ts","webpack://PDFBuilder/./assets/js/pdf-builder-react/components/PDFBuilderContent.tsx","webpack://PDFBuilder/./assets/js/pdf-builder-react/PDFBuilder.tsx"],"sourcesContent":["// Fonction pour vrifier si on est sur la page de l'diteur PDF\r\nfunction isPDFEditorPage() {\r\n    // Vrifier si l'lment avec la classe 'pdf-builder' existe (composant PDFBuilderContent)\r\n    return typeof document !== 'undefined' &&\r\n        document.querySelector('.pdf-builder') !== null;\r\n}\r\n// Fonction pour vrifier si on est sur la page des paramtres\r\nfunction isSettingsPage() {\r\n    // Vrifier si on est sur la page des paramtres (admin.php?page=pdf-builder-settings)\r\n    return typeof window !== 'undefined' &&\r\n        typeof window.location !== 'undefined' &&\r\n        window.location.href.indexOf('pdf-builder-settings') !== -1;\r\n}\r\n// Fonction pour vrifier si le debug est activ\r\nfunction isDebugEnabled() {\r\n    var _a, _b;\r\n    // Debug activ si explicitement forc\r\n    if ((_b = (_a = window.location) === null || _a === void 0 ? void 0 : _a.search) === null || _b === void 0 ? void 0 : _b.includes('debug=force')) {\r\n        return true;\r\n    }\r\n    // Vrifier les paramtres de debug centraliss\r\n    if (typeof window.pdfBuilderDebugSettings !== 'undefined' &&\r\n        window.pdfBuilderDebugSettings &&\r\n        typeof window.pdfBuilderDebugSettings === 'object') {\r\n        return !!window.pdfBuilderDebugSettings.javascript;\r\n    }\r\n    // Fallback vers pdfBuilderCanvasSettings pour la compatibilit\r\n    if (typeof window.pdfBuilderCanvasSettings !== 'undefined' &&\r\n        window.pdfBuilderCanvasSettings &&\r\n        typeof window.pdfBuilderCanvasSettings === 'object') {\r\n        const debugSettings = window.pdfBuilderCanvasSettings.debug;\r\n        if (debugSettings && typeof debugSettings === 'object') {\r\n            return !!debugSettings.javascript;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n// Fonction de logging conditionnel\r\nexport function debugLog(...args) {\r\n    if (isDebugEnabled()) {\r\n        console.log(...args);\r\n    }\r\n}\r\n// Fonction de debug pour les sauvegardes (activable sparment)\r\nexport function debugSave(...args) {\r\n    if (isDebugEnabled()) {\r\n        console.log(...args);\r\n    }\r\n}\r\nexport function debugError(...args) {\r\n    if (isDebugEnabled()) {\r\n        console.error(...args);\r\n    }\r\n}\r\nexport function debugWarn(...args) {\r\n    if (isDebugEnabled()) {\r\n        console.warn(...args);\r\n    }\r\n}\r\nexport function debugTable(data) {\r\n    if (isDebugEnabled()) {\r\n        console.table(data);\r\n    }\r\n}\r\n// Keep an internal verbose flag in sync with window.pdfBuilderDebugSettings\r\nif (typeof window !== 'undefined') {\r\n    try {\r\n        window.PDF_BUILDER_VERBOSE = !!(window.pdfBuilderDebugSettings && window.pdfBuilderDebugSettings.javascript);\r\n    }\r\n    catch (e) {\r\n        // ignore\r\n    }\r\n    // Listener to update verbose flag at runtime\r\n    if (window.addEventListener) {\r\n        window.addEventListener('pdfBuilder:debugSettingsChanged', (e) => {\r\n            try {\r\n                const detail = e && e.detail ? e.detail : window.pdfBuilderDebugSettings;\r\n                window.PDF_BUILDER_VERBOSE = !!(detail && detail.javascript);\r\n                if (typeof window.console !== 'undefined' && window.PDF_BUILDER_VERBOSE) {\r\n                    console.log('[PDF Builder Debug] pdfBuilder:debugSettingsChanged, verbose set to', window.PDF_BUILDER_VERBOSE);\r\n                }\r\n            }\r\n            catch (err) {\r\n                if (typeof window.console !== 'undefined') {\r\n                    console.warn('[PDF Builder Debug] Error handling pdfBuilder:debugSettingsChanged', err);\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n","import { jsx as _jsx } from \"react/jsx-runtime\";\r\nimport { createContext, useContext, useEffect, useState, useRef } from 'react';\r\nimport { debugError } from '../utils/debug';\r\nconst CanvasSettingsContext = createContext(undefined);\r\n// Valeurs par dfaut\r\nconst DEFAULT_SETTINGS = {\r\n    canvasWidth: 210,\r\n    canvasHeight: 297,\r\n    canvasUnit: 'mm',\r\n    canvasOrientation: 'portrait',\r\n    canvasBackgroundColor: '#ffffff',\r\n    containerBackgroundColor: '#f8f9fa',\r\n    borderColor: '#cccccc',\r\n    borderWidth: 1,\r\n    shadowEnabled: false,\r\n    marginTop: 20,\r\n    marginRight: 20,\r\n    marginBottom: 20,\r\n    marginLeft: 20,\r\n    showMargins: false,\r\n    gridShow: true,\r\n    gridSize: 10,\r\n    gridColor: '#e5e7eb',\r\n    gridSnapEnabled: true,\r\n    gridSnapTolerance: 8,\r\n    guidesEnabled: true,\r\n    //  Zoom & Navigation\r\n    navigationEnabled: true,\r\n    zoomDefault: 100,\r\n    zoomMin: 10,\r\n    zoomMax: 500,\r\n    zoomStep: 25,\r\n    selectionDragEnabled: true,\r\n    selectionMultiSelectEnabled: true,\r\n    selectionRotationEnabled: false,\r\n    selectionCopyPasteEnabled: true,\r\n    selectionShowHandles: true,\r\n    selectionHandleSize: 8,\r\n    selectionHandleColor: '#0066cc',\r\n    canvasSelectionMode: 'click',\r\n    exportQuality: 100,\r\n    exportFormat: 'pdf',\r\n    exportCompression: true,\r\n    exportIncludeMetadata: true,\r\n    historyUndoLevels: 50,\r\n    historyRedoLevels: 50,\r\n    // Performance & Lazy Loading\r\n    lazyLoadingEditor: true,\r\n    lazyLoadingPlugin: true,\r\n    debugMode: false,\r\n    memoryLimitJs: 256,\r\n    isLoading: true,\r\n    isReady: false,\r\n    error: null,\r\n    refreshSettings: () => { }\r\n};\r\nfunction loadSettingsFromWindowObj() {\r\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0, _1;\r\n    try {\r\n        const windowSettings = ((_a = window.pdfBuilderData) === null || _a === void 0 ? void 0 : _a.canvasSettings) || window.pdfBuilderCanvasSettings;\r\n        // Debug: Check if window settings exist - FORCE LOG\r\n        if (typeof window !== 'undefined' && window.pdfBuilderCanvasSettings) {\r\n        }\r\n        else {\r\n        }\r\n        if (!windowSettings) {\r\n            return {\r\n                ...DEFAULT_SETTINGS,\r\n                isLoading: false,\r\n                isReady: true,\r\n                updateGridSettings: () => { },\r\n                saveGridSettings: async () => { }\r\n            };\r\n        }\r\n        // Mapper les paramtres depuis le format WordPress vers notre format\r\n        const newSettings = {\r\n            // Dimensions\r\n            canvasWidth: (_b = windowSettings.canvas_width) !== null && _b !== void 0 ? _b : DEFAULT_SETTINGS.canvasWidth,\r\n            canvasHeight: (_c = windowSettings.canvas_height) !== null && _c !== void 0 ? _c : DEFAULT_SETTINGS.canvasHeight,\r\n            canvasUnit: (_d = windowSettings.canvas_unit) !== null && _d !== void 0 ? _d : DEFAULT_SETTINGS.canvasUnit,\r\n            canvasOrientation: (_e = windowSettings.canvas_orientation) !== null && _e !== void 0 ? _e : DEFAULT_SETTINGS.canvasOrientation,\r\n            // Couleurs\r\n            canvasBackgroundColor: (_f = windowSettings.canvas_background_color) !== null && _f !== void 0 ? _f : DEFAULT_SETTINGS.canvasBackgroundColor,\r\n            containerBackgroundColor: (_g = windowSettings.container_background_color) !== null && _g !== void 0 ? _g : DEFAULT_SETTINGS.containerBackgroundColor,\r\n            borderColor: (_h = windowSettings.border_color) !== null && _h !== void 0 ? _h : DEFAULT_SETTINGS.borderColor,\r\n            borderWidth: (_j = windowSettings.border_width) !== null && _j !== void 0 ? _j : DEFAULT_SETTINGS.borderWidth,\r\n            shadowEnabled: windowSettings.shadow_enabled === true || windowSettings.shadow_enabled === '1',\r\n            // Marges\r\n            marginTop: (_k = windowSettings.margin_top) !== null && _k !== void 0 ? _k : DEFAULT_SETTINGS.marginTop,\r\n            marginRight: (_l = windowSettings.margin_right) !== null && _l !== void 0 ? _l : DEFAULT_SETTINGS.marginRight,\r\n            marginBottom: (_m = windowSettings.margin_bottom) !== null && _m !== void 0 ? _m : DEFAULT_SETTINGS.marginBottom,\r\n            marginLeft: (_o = windowSettings.margin_left) !== null && _o !== void 0 ? _o : DEFAULT_SETTINGS.marginLeft,\r\n            showMargins: windowSettings.show_margins === true || windowSettings.show_margins === '1',\r\n            // Grille\r\n            gridShow: windowSettings.show_grid === true || windowSettings.show_grid === '1',\r\n            gridSize: (windowSettings.show_grid === true || windowSettings.show_grid === '1')\r\n                ? ((_p = windowSettings.grid_size) !== null && _p !== void 0 ? _p : DEFAULT_SETTINGS.gridSize)\r\n                : 0,\r\n            gridColor: (_q = windowSettings.grid_color) !== null && _q !== void 0 ? _q : DEFAULT_SETTINGS.gridColor,\r\n            gridSnapEnabled: (windowSettings.show_grid === true || windowSettings.show_grid === '1') && (windowSettings.snap_to_grid === true || windowSettings.snap_to_grid === '1'),\r\n            gridSnapTolerance: (_r = windowSettings.snap_tolerance) !== null && _r !== void 0 ? _r : DEFAULT_SETTINGS.gridSnapTolerance,\r\n            guidesEnabled: windowSettings.show_guides === true || windowSettings.show_guides === '1',\r\n            //  Zoom & Navigation\r\n            navigationEnabled: windowSettings.navigation_enabled === true || windowSettings.navigation_enabled === '1',\r\n            zoomDefault: (() => {\r\n                var _a, _b, _c;\r\n                const minZoom = Math.max(1, (_a = windowSettings.min_zoom) !== null && _a !== void 0 ? _a : DEFAULT_SETTINGS.zoomMin);\r\n                const maxZoom = Math.max(minZoom, (_b = windowSettings.max_zoom) !== null && _b !== void 0 ? _b : DEFAULT_SETTINGS.zoomMax);\r\n                const defaultZoom = (_c = windowSettings.default_zoom) !== null && _c !== void 0 ? _c : DEFAULT_SETTINGS.zoomDefault;\r\n                return Math.max(minZoom, Math.min(maxZoom, defaultZoom));\r\n            })(),\r\n            zoomMin: Math.max(1, (_s = windowSettings.min_zoom) !== null && _s !== void 0 ? _s : DEFAULT_SETTINGS.zoomMin),\r\n            zoomMax: (() => {\r\n                var _a, _b;\r\n                const minZoom = Math.max(1, (_a = windowSettings.min_zoom) !== null && _a !== void 0 ? _a : DEFAULT_SETTINGS.zoomMin);\r\n                const maxZoom = (_b = windowSettings.max_zoom) !== null && _b !== void 0 ? _b : DEFAULT_SETTINGS.zoomMax;\r\n                return Math.max(minZoom, maxZoom);\r\n            })(),\r\n            zoomStep: Math.max(1, (_t = windowSettings.zoom_step) !== null && _t !== void 0 ? _t : DEFAULT_SETTINGS.zoomStep),\r\n            // Slection\r\n            selectionDragEnabled: windowSettings.drag_enabled === true || windowSettings.drag_enabled === '1',\r\n            selectionMultiSelectEnabled: windowSettings.multi_select === true || windowSettings.multi_select === '1',\r\n            selectionRotationEnabled: windowSettings.enable_rotation === true || windowSettings.enable_rotation === '1',\r\n            selectionCopyPasteEnabled: windowSettings.copy_paste_enabled === true || windowSettings.copy_paste_enabled === '1',\r\n            selectionShowHandles: windowSettings.show_resize_handles === true || windowSettings.show_resize_handles === '1',\r\n            selectionHandleSize: (_u = windowSettings.handle_size) !== null && _u !== void 0 ? _u : DEFAULT_SETTINGS.selectionHandleSize,\r\n            selectionHandleColor: (_v = windowSettings.handle_color) !== null && _v !== void 0 ? _v : DEFAULT_SETTINGS.selectionHandleColor,\r\n            canvasSelectionMode: (_w = windowSettings.canvas_selection_mode) !== null && _w !== void 0 ? _w : DEFAULT_SETTINGS.canvasSelectionMode,\r\n            // Export\r\n            exportQuality: (_x = windowSettings.image_quality) !== null && _x !== void 0 ? _x : DEFAULT_SETTINGS.exportQuality,\r\n            exportFormat: (_y = windowSettings.export_format) !== null && _y !== void 0 ? _y : DEFAULT_SETTINGS.exportFormat,\r\n            exportCompression: windowSettings.compress_images === true || windowSettings.compress_images === '1',\r\n            exportIncludeMetadata: windowSettings.include_metadata === true || windowSettings.include_metadata === '1',\r\n            // Historique\r\n            historyUndoLevels: (_z = windowSettings.history_undo_levels) !== null && _z !== void 0 ? _z : DEFAULT_SETTINGS.historyUndoLevels,\r\n            historyRedoLevels: (_0 = windowSettings.history_redo_levels) !== null && _0 !== void 0 ? _0 : DEFAULT_SETTINGS.historyRedoLevels,\r\n            // Performance & Lazy Loading\r\n            lazyLoadingEditor: windowSettings.lazy_loading_editor === true || windowSettings.lazy_loading_editor === '1',\r\n            lazyLoadingPlugin: windowSettings.lazy_loading_plugin === true || windowSettings.lazy_loading_plugin === '1',\r\n            debugMode: windowSettings.debug_mode === true || windowSettings.debug_mode === '1',\r\n            memoryLimitJs: (_1 = windowSettings.memory_limit_js) !== null && _1 !== void 0 ? _1 : DEFAULT_SETTINGS.memoryLimitJs,\r\n            isLoading: false,\r\n            isReady: true,\r\n            error: null,\r\n            refreshSettings: () => { },\r\n            updateGridSettings: () => { },\r\n            saveGridSettings: async () => { }\r\n        };\r\n        return newSettings;\r\n    }\r\n    catch (_err) {\r\n        const errorMsg = _err instanceof Error ? _err.message : 'Unknown error';\r\n        return {\r\n            ...DEFAULT_SETTINGS,\r\n            isLoading: false,\r\n            isReady: false,\r\n            error: errorMsg,\r\n            refreshSettings: () => { },\r\n            updateGridSettings: () => { },\r\n            saveGridSettings: async () => { }\r\n        };\r\n    }\r\n}\r\nexport function CanvasSettingsProvider({ children }) {\r\n    const [settings, setSettings] = useState(() => {\r\n        // Try to load from window object first\r\n        const windowSettings = loadSettingsFromWindowObj();\r\n        return windowSettings;\r\n    });\r\n    //  CORRECTION: Flag pour viter les boucles infinies lors des mises  jour d'vnements\r\n    const isUpdatingFromEventRef = useRef(false);\r\n    const hasInitializedRef = useRef(false);\r\n    // Function to refresh settings from window object\r\n    const handleRefresh = () => {\r\n        const windowSettings = loadSettingsFromWindowObj();\r\n        setSettings(windowSettings);\r\n    };\r\n    // Load settings from server on mount - simplified - ONLY ONCE\r\n    useEffect(() => {\r\n        if (hasInitializedRef.current)\r\n            return; // viter les doublons au montage\r\n        hasInitializedRef.current = true;\r\n        // For now, just use window settings - AJAX calls can be added later if needed\r\n        const windowSettings = loadSettingsFromWindowObj();\r\n        setSettings(windowSettings);\r\n    }, []);\r\n    // Listen for settings update events\r\n    useEffect(() => {\r\n        const handleSettingsUpdate = () => {\r\n            if (isUpdatingFromEventRef.current)\r\n                return; // viter les boucles infinies\r\n            isUpdatingFromEventRef.current = true;\r\n            const windowSettings = loadSettingsFromWindowObj();\r\n            setSettings(windowSettings);\r\n            // Reset flag after a short delay\r\n            setTimeout(() => {\r\n                isUpdatingFromEventRef.current = false;\r\n            }, 100);\r\n        };\r\n        window.addEventListener('pdfBuilderCanvasSettingsUpdated', handleSettingsUpdate, { passive: true });\r\n        return () => window.removeEventListener('pdfBuilderCanvasSettingsUpdated', handleSettingsUpdate);\r\n    }, []);\r\n    // Synchronisation automatique : si gridShow est dsactiv, dsactiver gridSnapEnabled et gridSize\r\n    // Comment pour viter les boucles infinies de rendu\r\n    // useEffect(() => {\r\n    //   if (!settings.gridShow) {\r\n    //     let needsUpdate = false;\r\n    //     const updates: Partial<CanvasSettingsContextType> = {};\r\n    //     if (settings.gridSnapEnabled) {\r\n    //       updates.gridSnapEnabled = false;\r\n    //       needsUpdate = true;\r\n    //     }\r\n    //     if (settings.gridSize !== 0) {\r\n    //       updates.gridSize = 0;\r\n    //       needsUpdate = true;\r\n    //     }\r\n    //     if (needsUpdate) {\r\n    //       setSettings(prev => ({\r\n    //         ...prev,\r\n    //         ...updates\r\n    //       }));\r\n    //     }\r\n    //   }\r\n    // }, [settings.gridShow, settings.gridSnapEnabled, settings.gridSize]);\r\n    // Ajouter la fonction refreshSettings au contexte final\r\n    const contextValue = {\r\n        ...settings,\r\n        updateGridSettings: (newSettings) => {\r\n            setSettings(prev => ({ ...prev, ...newSettings }));\r\n        },\r\n        saveGridSettings: async (newSettings) => {\r\n            var _a, _b;\r\n            try {\r\n                // Appliquer la synchronisation automatique\r\n                const syncedSettings = { ...newSettings };\r\n                if (newSettings.gridShow === false) {\r\n                    syncedSettings.gridSize = 0;\r\n                    syncedSettings.gridSnapEnabled = false;\r\n                }\r\n                // Prparer les donnes pour l'AJAX\r\n                const formData = new URLSearchParams();\r\n                formData.append('action', 'pdf_builder_save_canvas_settings');\r\n                formData.append('nonce', ((_a = window.pdfBuilderAjax) === null || _a === void 0 ? void 0 : _a.nonce) || '');\r\n                if (syncedSettings.gridShow !== undefined) {\r\n                    formData.append('canvas_grid_enabled', syncedSettings.gridShow ? '1' : '0');\r\n                }\r\n                if (syncedSettings.gridSize !== undefined) {\r\n                    formData.append('canvas_grid_size', syncedSettings.gridSize.toString());\r\n                }\r\n                if (syncedSettings.gridSnapEnabled !== undefined) {\r\n                    formData.append('canvas_snap_to_grid', syncedSettings.gridSnapEnabled ? '1' : '0');\r\n                }\r\n                // Sauvegarder ct serveur\r\n                const response = await fetch(((_b = window.pdfBuilderAjax) === null || _b === void 0 ? void 0 : _b.ajax_url) || '/wp-admin/admin-ajax.php', {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/x-www-form-urlencoded',\r\n                    },\r\n                    body: formData\r\n                });\r\n                if (response.ok) {\r\n                    const result = await response.json();\r\n                    if (result.success) {\r\n                        // Mettre  jour l'tat local\r\n                        setSettings(prev => ({ ...prev, ...syncedSettings }));\r\n                    }\r\n                    else {\r\n                        debugError('Erreur lors de la sauvegarde des paramtres de grille:', result.message);\r\n                    }\r\n                }\r\n                else {\r\n                    debugError('Erreur HTTP lors de la sauvegarde des paramtres de grille');\r\n                }\r\n            }\r\n            catch (error) {\r\n                debugError('Erreur lors de la sauvegarde des paramtres de grille:', error);\r\n            }\r\n        },\r\n        refreshSettings: handleRefresh\r\n    };\r\n    return (_jsx(CanvasSettingsContext.Provider, { value: contextValue, children: children }));\r\n}\r\nexport function useCanvasSettings() {\r\n    const context = useContext(CanvasSettingsContext);\r\n    if (context === undefined) {\r\n        throw new Error('useCanvasSettings must be used within CanvasSettingsProvider');\r\n    }\r\n    return context;\r\n}\r\n","import { jsx as _jsx } from \"react/jsx-runtime\";\r\nimport { createContext, useContext, useReducer, useEffect, useRef } from 'react';\r\nimport { useCanvasSettings } from '../CanvasSettingsContext';\r\nimport { debugWarn } from '../../utils/debug';\r\n// Fonction helper pour corriger les positions des lments hors limites\r\n//  BUGFIX-014: Accept canvas dimensions as parameters for dynamic sizing\r\nconst clampElementPositions = (elements, canvasWidth = 794, canvasHeight = 1123) => {\r\n    return elements.map(element => {\r\n        let newX = element.x;\r\n        let newY = element.y;\r\n        // Clamp X position (laisser au moins 5px visible)\r\n        const minVisibleWidth = Math.min(15, element.width * 0.3);\r\n        if (newX < 0)\r\n            newX = 0;\r\n        if (newX + minVisibleWidth > canvasWidth)\r\n            newX = Math.max(0, canvasWidth - minVisibleWidth);\r\n        // Clamp Y position (laisser au moins 5px visible)\r\n        const minVisibleHeight = Math.min(10, element.height * 0.3);\r\n        if (newY < 0)\r\n            newY = 0;\r\n        if (newY + minVisibleHeight > canvasHeight)\r\n            newY = Math.max(0, canvasHeight - minVisibleHeight);\r\n        if (newX !== element.x || newY !== element.y) {\r\n            return { ...element, x: newX, y: newY };\r\n        }\r\n        return element;\r\n    });\r\n};\r\n// Fonction helper pour rparer les proprits des lments product_table\r\nconst repairProductTableProperties = (elements) => {\r\n    const defaultProperties = {\r\n        // Fonctionnalits de base\r\n        showHeaders: true,\r\n        showBorders: true,\r\n        showAlternatingRows: true,\r\n        showSku: true,\r\n        showDescription: true,\r\n        showQuantity: true,\r\n        // Style et apparence\r\n        fontSize: 11,\r\n        currency: '',\r\n        tableStyle: 'default',\r\n        // Alignements\r\n        textAlign: 'left',\r\n        verticalAlign: 'top',\r\n        // Couleurs\r\n        backgroundColor: '#ffffff',\r\n        headerBackgroundColor: '#f9fafb',\r\n        headerTextColor: '#111827',\r\n        alternateRowColor: '#f9fafb',\r\n        borderColor: '#e5e7eb',\r\n        textColor: '#374151'\r\n    };\r\n    return elements.map(element => {\r\n        if (element.type !== 'product_table')\r\n            return element;\r\n        const repairedElement = { ...element };\r\n        // Ajouter les proprits manquantes\r\n        Object.keys(defaultProperties).forEach(prop => {\r\n            if (!(prop in repairedElement)) {\r\n                repairedElement[prop] = defaultProperties[prop];\r\n            }\r\n        });\r\n        // Validation des boolens\r\n        const booleanProps = ['showHeaders', 'showBorders', 'showAlternatingRows', 'showSku', 'showDescription', 'showQuantity'];\r\n        booleanProps.forEach(prop => {\r\n            if (typeof repairedElement[prop] !== 'boolean') {\r\n                repairedElement[prop] = defaultProperties[prop];\r\n            }\r\n        });\r\n        // Validation des nombres\r\n        const numberProps = ['fontSize'];\r\n        numberProps.forEach(prop => {\r\n            if (typeof repairedElement[prop] !== 'number') {\r\n                repairedElement[prop] = defaultProperties[prop];\r\n            }\r\n        });\r\n        // Validation des alignements\r\n        const validHorizontalAligns = ['left', 'center', 'right'];\r\n        if (!validHorizontalAligns.includes(repairedElement.textAlign)) {\r\n            repairedElement.textAlign = defaultProperties.textAlign;\r\n        }\r\n        const validVerticalAligns = ['top', 'middle', 'bottom'];\r\n        if (!validVerticalAligns.includes(repairedElement.verticalAlign)) {\r\n            repairedElement.verticalAlign = defaultProperties.verticalAlign;\r\n        }\r\n        // Validation des couleurs (format hexadcimal)\r\n        const colorProperties = ['backgroundColor', 'headerBackgroundColor', 'alternateRowColor', 'borderColor', 'headerTextColor', 'textColor'];\r\n        colorProperties.forEach(prop => {\r\n            if (repairedElement[prop] && !/^#[0-9A-Fa-f]{6}$/.test(repairedElement[prop])) {\r\n                repairedElement[prop] = defaultProperties[prop];\r\n            }\r\n        });\r\n        // Validation de la devise\r\n        if (!repairedElement.currency || typeof repairedElement.currency !== 'string') {\r\n            repairedElement.currency = defaultProperties.currency;\r\n        }\r\n        return repairedElement;\r\n    });\r\n};\r\n// tat initial\r\nconst initialCanvasState = {\r\n    zoom: 100,\r\n    pan: { x: 0, y: 0 },\r\n    showGrid: false,\r\n    gridSize: 20,\r\n    snapToGrid: true,\r\n    backgroundColor: '#ffffff'\r\n};\r\nconst initialSelectionState = {\r\n    selectedElements: [],\r\n    isSelecting: false\r\n};\r\nconst initialDragState = {\r\n    isDragging: false,\r\n    draggedElements: []\r\n};\r\nconst initialHistoryState = {\r\n    past: [],\r\n    present: {\r\n        elements: [],\r\n        canvas: initialCanvasState,\r\n        selection: initialSelectionState,\r\n        drag: initialDragState,\r\n        mode: 'select',\r\n        template: {\r\n            isNew: true,\r\n            isModified: false,\r\n            isSaving: false,\r\n            isLoading: true //  Start as loading\r\n        },\r\n        previewMode: 'editor',\r\n        history: {\r\n            past: [],\r\n            present: null,\r\n            future: [],\r\n            canUndo: false,\r\n            canRedo: false\r\n        }\r\n    },\r\n    future: [],\r\n    canUndo: false,\r\n    canRedo: false\r\n};\r\nconst initialState = {\r\n    elements: [],\r\n    canvas: initialCanvasState,\r\n    selection: initialSelectionState,\r\n    drag: initialDragState,\r\n    mode: 'select',\r\n    template: {\r\n        isNew: true,\r\n        isModified: false,\r\n        isSaving: false,\r\n        isLoading: true,\r\n        name: 'Nouveau template',\r\n        description: '',\r\n        tags: [],\r\n        canvasWidth: 794,\r\n        canvasHeight: 1123,\r\n        marginTop: 28,\r\n        marginBottom: 28,\r\n        showGuides: true,\r\n        snapToGrid: false\r\n    },\r\n    previewMode: 'editor',\r\n    history: initialHistoryState\r\n};\r\n// Reducer\r\nfunction builderReducer(state, action) {\r\n    var _a, _b;\r\n    switch (action.type) {\r\n        case 'ADD_ELEMENT': {\r\n            return {\r\n                ...state,\r\n                elements: [...state.elements, action.payload],\r\n                template: {\r\n                    ...state.template,\r\n                    isModified: true\r\n                },\r\n                history: updateHistory(state, {\r\n                    ...state,\r\n                    elements: [...state.elements, action.payload]\r\n                })\r\n            };\r\n        }\r\n        case 'UPDATE_ELEMENT': {\r\n            //  BUGFIX-003: Comprehensive property preservation\r\n            // Ensure ALL existing properties are retained when updating\r\n            const updateElement = (element) => {\r\n                if (element.id !== action.payload.id)\r\n                    return element;\r\n                // Merge updates while preserving all existing properties\r\n                const updated = {\r\n                    ...element,\r\n                    ...action.payload.updates,\r\n                    updatedAt: new Date() // Always update timestamp\r\n                };\r\n                return updated;\r\n            };\r\n            const updatedElements = state.elements.map(updateElement);\r\n            return {\r\n                ...state,\r\n                elements: updatedElements,\r\n                template: {\r\n                    ...state.template,\r\n                    isModified: true\r\n                },\r\n                history: updateHistory(state, {\r\n                    ...state,\r\n                    elements: updatedElements\r\n                })\r\n            };\r\n        }\r\n        case 'REMOVE_ELEMENT': {\r\n            return {\r\n                ...state,\r\n                elements: state.elements.filter(el => el.id !== action.payload),\r\n                selection: {\r\n                    ...state.selection,\r\n                    selectedElements: state.selection.selectedElements.filter(id => id !== action.payload)\r\n                },\r\n                template: {\r\n                    ...state.template,\r\n                    isModified: true\r\n                },\r\n                history: updateHistory(state, {\r\n                    ...state,\r\n                    elements: state.elements.filter(el => el.id !== action.payload),\r\n                    selection: {\r\n                        ...state.selection,\r\n                        selectedElements: state.selection.selectedElements.filter(id => id !== action.payload)\r\n                    }\r\n                })\r\n            };\r\n        }\r\n        case 'SET_ELEMENTS': {\r\n            return {\r\n                ...state,\r\n                elements: action.payload,\r\n                history: updateHistory(state, { ...state, elements: action.payload })\r\n            };\r\n        }\r\n        case 'SET_SELECTION': {\r\n            return {\r\n                ...state,\r\n                selection: {\r\n                    ...state.selection,\r\n                    selectedElements: action.payload,\r\n                    selectionBounds: calculateSelectionBounds(action.payload, state.elements)\r\n                }\r\n            };\r\n        }\r\n        case 'CLEAR_SELECTION': {\r\n            return {\r\n                ...state,\r\n                selection: {\r\n                    ...state.selection,\r\n                    selectedElements: [],\r\n                    selectionBounds: undefined\r\n                }\r\n            };\r\n        }\r\n        case 'SET_CANVAS': {\r\n            return {\r\n                ...state,\r\n                canvas: { ...state.canvas, ...action.payload }\r\n            };\r\n        }\r\n        case 'SET_MODE': {\r\n            return {\r\n                ...state,\r\n                mode: action.payload\r\n            };\r\n        }\r\n        case 'SET_DRAG_STATE': {\r\n            return {\r\n                ...state,\r\n                drag: { ...state.drag, ...action.payload }\r\n            };\r\n        }\r\n        case 'SET_PREVIEW_MODE': {\r\n            return {\r\n                ...state,\r\n                previewMode: action.payload\r\n            };\r\n        }\r\n        case 'SET_ORDER_ID': {\r\n            return {\r\n                ...state,\r\n                orderId: action.payload\r\n            };\r\n        }\r\n        case 'UNDO': {\r\n            if (!state.history.canUndo)\r\n                return state;\r\n            const previousState = state.history.past[state.history.past.length - 1];\r\n            return {\r\n                ...previousState,\r\n                history: {\r\n                    past: state.history.past.slice(0, -1),\r\n                    present: previousState,\r\n                    future: [state, ...state.history.future],\r\n                    canUndo: state.history.past.length > 1,\r\n                    canRedo: true\r\n                }\r\n            };\r\n        }\r\n        case 'REDO': {\r\n            if (!state.history.canRedo)\r\n                return state;\r\n            const nextState = state.history.future[0];\r\n            return {\r\n                ...nextState,\r\n                history: {\r\n                    past: [...state.history.past, state],\r\n                    present: nextState,\r\n                    future: state.history.future.slice(1),\r\n                    canUndo: true,\r\n                    canRedo: state.history.future.length > 1\r\n                }\r\n            };\r\n        }\r\n        case 'RESET': {\r\n            return initialState;\r\n        }\r\n        case 'SAVE_TEMPLATE': {\r\n            return {\r\n                ...state,\r\n                template: {\r\n                    ...state.template,\r\n                    isNew: false,\r\n                    isModified: false,\r\n                    isSaving: false,\r\n                    lastSaved: new Date(),\r\n                    id: ((_a = action.payload) === null || _a === void 0 ? void 0 : _a.id) || state.template.id,\r\n                    name: ((_b = action.payload) === null || _b === void 0 ? void 0 : _b.name) || state.template.name\r\n                }\r\n            };\r\n        }\r\n        case 'SET_TEMPLATE_MODIFIED': {\r\n            return {\r\n                ...state,\r\n                template: {\r\n                    ...state.template,\r\n                    isModified: action.payload\r\n                }\r\n            };\r\n        }\r\n        case 'SET_TEMPLATE_SAVING':\r\n            return {\r\n                ...state,\r\n                template: {\r\n                    ...state.template,\r\n                    isSaving: action.payload\r\n                }\r\n            };\r\n        case 'UPDATE_TEMPLATE_SETTINGS':\r\n            return {\r\n                ...state,\r\n                template: {\r\n                    ...state.template,\r\n                    ...action.payload,\r\n                    isModified: true\r\n                }\r\n            };\r\n        case 'SET_TEMPLATE_LOADING':\r\n            return {\r\n                ...state,\r\n                template: {\r\n                    ...state.template,\r\n                    isLoading: action.payload\r\n                }\r\n            };\r\n        case 'TOGGLE_GUIDES':\r\n            return {\r\n                ...state,\r\n                template: {\r\n                    ...state.template,\r\n                    showGuides: !state.template.showGuides\r\n                    // Note: isModified is NOT set to true for guides toggle\r\n                }\r\n            };\r\n        case 'LOAD_TEMPLATE': {\r\n            const rawElements = action.payload.elements || [];\r\n            const repairedElements = repairProductTableProperties(rawElements);\r\n            // Ne pas convertir, garder les PX directement\r\n            const clampedElements = clampElementPositions(repairedElements);\r\n            // Garder les dimensions du canvas si prsentes\r\n            const canvasData = action.payload.canvas ?\r\n                { ...state.canvas, ...action.payload.canvas } :\r\n                state.canvas;\r\n            const newState = {\r\n                ...state,\r\n                elements: clampedElements,\r\n                canvas: canvasData,\r\n                template: {\r\n                    ...state.template,\r\n                    id: action.payload.id,\r\n                    name: action.payload.name,\r\n                    isNew: false,\r\n                    isModified: false,\r\n                    isSaving: false,\r\n                    isLoading: false,\r\n                    lastSaved: action.payload.lastSaved\r\n                },\r\n                history: updateHistory(state, {\r\n                    ...state,\r\n                    elements: clampedElements,\r\n                    canvas: canvasData\r\n                })\r\n            };\r\n            return newState;\r\n        }\r\n        case 'NEW_TEMPLATE': {\r\n            return {\r\n                ...initialState,\r\n                template: {\r\n                    isNew: true,\r\n                    isModified: false,\r\n                    isSaving: false,\r\n                    isLoading: false //  New template ready immediately\r\n                }\r\n            };\r\n        }\r\n        default: {\r\n            return state;\r\n        }\r\n    }\r\n}\r\n// Fonctions utilitaires\r\nfunction updateHistory(currentState, newState) {\r\n    //  BUGFIX-011: Deep copy the state before storing in history to ensure immutability\r\n    const stateCopy = {\r\n        ...currentState,\r\n        elements: currentState.elements.map(el => ({ ...el })),\r\n        canvas: { ...currentState.canvas },\r\n        selection: { ...currentState.selection, selectedElements: [...currentState.selection.selectedElements] },\r\n        drag: { ...currentState.drag },\r\n        template: { ...currentState.template },\r\n        history: currentState.history // Don't deep copy history recursively\r\n    };\r\n    return {\r\n        past: [...currentState.history.past, stateCopy],\r\n        present: newState,\r\n        future: [],\r\n        canUndo: true,\r\n        canRedo: false\r\n    };\r\n}\r\nfunction calculateSelectionBounds(selectedIds, elements) {\r\n    if (selectedIds.length === 0)\r\n        return undefined;\r\n    const selectedElements = elements.filter(el => selectedIds.includes(el.id));\r\n    if (selectedElements.length === 0)\r\n        return undefined;\r\n    let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n    selectedElements.forEach(el => {\r\n        minX = Math.min(minX, el.x);\r\n        minY = Math.min(minY, el.y);\r\n        maxX = Math.max(maxX, el.x + el.width);\r\n        maxY = Math.max(maxY, el.y + el.height);\r\n    });\r\n    return {\r\n        x: minX,\r\n        y: minY,\r\n        width: maxX - minX,\r\n        height: maxY - minY\r\n    };\r\n}\r\nconst BuilderContext = createContext(undefined);\r\nexport function BuilderProvider({ children, initialState: initialStateProp }) {\r\n    // fusionne l'tat par dfaut avec l'ventuel initialState pass en prop\r\n    const mergedInitialState = {\r\n        ...initialState,\r\n        ...(initialStateProp || {})\r\n    };\r\n    const [state, dispatch] = useReducer(builderReducer, mergedInitialState);\r\n    const canvasSettings = useCanvasSettings();\r\n    //  CORRECTION: Flags pour viter les boucles infinies\r\n    const zoomInitializedRef = useRef(false);\r\n    const gridInitializedRef = useRef(false);\r\n    // Appliquer les paramtres de zoom depuis Canvas Settings au dmarrage\r\n    useEffect(() => {\r\n        // Appliquer le zoom par dfaut depuis les paramtres UNIQUEMENT au dmarrage\r\n        // Le zoom initial du state est 100, donc appliquer seulement si diffrent et prt\r\n        const initialZoom = 100; // Valeur initiale du state\r\n        if (canvasSettings.isReady && canvasSettings.zoomDefault !== initialZoom && !zoomInitializedRef.current) {\r\n            zoomInitializedRef.current = true;\r\n            dispatch({\r\n                type: 'SET_CANVAS',\r\n                payload: {\r\n                    zoom: Math.max(canvasSettings.zoomMin, Math.min(canvasSettings.zoomDefault, canvasSettings.zoomMax))\r\n                }\r\n            });\r\n        }\r\n    }, [canvasSettings.zoomDefault, canvasSettings.zoomMax, canvasSettings.zoomMin, canvasSettings.isReady]);\r\n    // Synchroniser les paramtres de grille depuis CanvasSettingsContext (uniquement  l'initialisation)\r\n    useEffect(() => {\r\n        if (!canvasSettings.isReady || gridInitializedRef.current)\r\n            return;\r\n        const updates = {};\r\n        // Ne synchroniser que si c'est la premire fois ou si les paramtres ont chang dans les settings\r\n        // mais pas si l'utilisateur a chang manuellement l'tat\r\n        if (canvasSettings.gridSize !== state.canvas.gridSize) {\r\n            updates.gridSize = canvasSettings.gridSize;\r\n        }\r\n        // Pour showGrid et snapToGrid, ne synchroniser que si l'tat actuel correspond aux paramtres par dfaut\r\n        // (c'est--dire au chargement initial)\r\n        if (state.canvas.showGrid === canvasSettings.gridShow && canvasSettings.gridShow !== state.canvas.showGrid) {\r\n            updates.showGrid = canvasSettings.gridShow;\r\n        }\r\n        if (state.canvas.snapToGrid === canvasSettings.gridSnapEnabled && canvasSettings.gridSnapEnabled !== state.canvas.snapToGrid) {\r\n            updates.snapToGrid = canvasSettings.gridSnapEnabled;\r\n        }\r\n        if (Object.keys(updates).length > 0) {\r\n            gridInitializedRef.current = true;\r\n            dispatch({ type: 'SET_CANVAS', payload: updates });\r\n        }\r\n    }, [canvasSettings.gridSize, canvasSettings.gridShow, canvasSettings.gridSnapEnabled, canvasSettings.isReady, state.canvas.gridSize, state.canvas.showGrid, state.canvas.snapToGrid]);\r\n    //  DISABLED: Template loading is now EXCLUSIVELY handled by useTemplate hook\r\n    // which reads template_id from URL/localized data and calls AJAX GET\r\n    // This prevents duplicate/race condition loads which caused double canvas renders\r\n    // Previously: BuilderContext useEffect loaded  dispatch  Canvas renders\r\n    //             useTemplate hook also loaded  dispatch  Canvas renders AGAIN (1/10th sec later)\r\n    // Now: Only useTemplate.ts loads the template, ensuring single source of truth\r\n    // couteur pour le chargement de template via API globale\r\n    useEffect(() => {\r\n        const handleLoadTemplate = (event) => {\r\n            const templateData = event.detail;\r\n            if (templateData) {\r\n                dispatch({\r\n                    type: 'LOAD_TEMPLATE',\r\n                    payload: templateData\r\n                });\r\n            }\r\n            else {\r\n                debugWarn('[BuilderContext] No template data in event detail');\r\n            }\r\n        };\r\n        document.addEventListener('pdfBuilderLoadTemplate', handleLoadTemplate, { passive: true });\r\n        return () => {\r\n            document.removeEventListener('pdfBuilderLoadTemplate', handleLoadTemplate);\r\n        };\r\n    }, []);\r\n    // Actions helpers\r\n    const addElement = (element) => {\r\n        dispatch({ type: 'ADD_ELEMENT', payload: element });\r\n    };\r\n    const updateElement = (id, updates) => {\r\n        dispatch({ type: 'UPDATE_ELEMENT', payload: { id, updates } });\r\n    };\r\n    const removeElement = (id) => {\r\n        dispatch({ type: 'REMOVE_ELEMENT', payload: id });\r\n    };\r\n    const setSelection = (ids) => {\r\n        dispatch({ type: 'SET_SELECTION', payload: ids });\r\n    };\r\n    const clearSelection = () => {\r\n        dispatch({ type: 'CLEAR_SELECTION' });\r\n    };\r\n    const setCanvas = (canvas) => {\r\n        dispatch({ type: 'SET_CANVAS', payload: canvas });\r\n    };\r\n    const setMode = (mode) => {\r\n        dispatch({ type: 'SET_MODE', payload: mode });\r\n    };\r\n    const undo = () => {\r\n        dispatch({ type: 'UNDO' });\r\n    };\r\n    const redo = () => {\r\n        dispatch({ type: 'REDO' });\r\n    };\r\n    const reset = () => {\r\n        dispatch({ type: 'RESET' });\r\n    };\r\n    const toggleGrid = () => {\r\n        setCanvas({ showGrid: !state.canvas.showGrid });\r\n    };\r\n    const toggleGuides = () => {\r\n        dispatch({ type: 'TOGGLE_GUIDES' });\r\n    };\r\n    const value = {\r\n        state,\r\n        dispatch,\r\n        addElement,\r\n        updateElement,\r\n        removeElement,\r\n        setSelection,\r\n        clearSelection,\r\n        setCanvas,\r\n        setMode,\r\n        undo,\r\n        redo,\r\n        reset,\r\n        toggleGrid: toggleGrid,\r\n        toggleGuides: toggleGuides\r\n    };\r\n    return (_jsx(BuilderContext.Provider, { value: value, children: children }));\r\n}\r\n// Hook pour utiliser le contexte\r\nexport function useBuilder() {\r\n    const context = useContext(BuilderContext);\r\n    if (context === undefined) {\r\n        throw new Error('useBuilder must be used within a BuilderProvider');\r\n    }\r\n    return context;\r\n}\r\n// Hook spcialis pour les lments\r\nexport function useElements() {\r\n    const { state, addElement, updateElement, removeElement } = useBuilder();\r\n    return {\r\n        elements: state.elements,\r\n        addElement,\r\n        updateElement,\r\n        removeElement,\r\n        getElement: (id) => state.elements.find(el => el.id === id),\r\n        getElementsByType: (type) => state.elements.filter(el => el.type === type)\r\n    };\r\n}\r\n// Hook spcialis pour la slection\r\nexport function useSelection() {\r\n    const { state, setSelection, clearSelection } = useBuilder();\r\n    return {\r\n        selectedElements: state.selection.selectedElements,\r\n        selectionBounds: state.selection.selectionBounds,\r\n        isSelecting: state.selection.isSelecting,\r\n        setSelection,\r\n        clearSelection,\r\n        isSelected: (id) => state.selection.selectedElements.includes(id),\r\n        toggleSelection: (id) => {\r\n            const isSelected = state.selection.selectedElements.includes(id);\r\n            if (isSelected) {\r\n                setSelection(state.selection.selectedElements.filter(selectedId => selectedId !== id));\r\n            }\r\n            else {\r\n                setSelection([...state.selection.selectedElements, id]);\r\n            }\r\n        }\r\n    };\r\n}\r\n// Hook spcialis pour le canvas\r\nexport function useCanvas() {\r\n    const { state, setCanvas } = useBuilder();\r\n    const canvasSettings = useCanvasSettings();\r\n    return {\r\n        canvas: state.canvas,\r\n        setCanvas,\r\n        zoomIn: () => setCanvas({ zoom: Math.min(state.canvas.zoom * 1.2, canvasSettings.zoomMax) }),\r\n        zoomOut: () => setCanvas({ zoom: Math.max(state.canvas.zoom / 1.2, canvasSettings.zoomMin) }),\r\n        setZoom: (zoom) => setCanvas({ zoom: Math.max(canvasSettings.zoomMin, Math.min(zoom, canvasSettings.zoomMax)) }),\r\n        resetZoom: () => setCanvas({ zoom: Math.max(canvasSettings.zoomMin, Math.min(canvasSettings.zoomDefault, canvasSettings.zoomMax)) }),\r\n        toggleGrid: () => setCanvas({ showGrid: !state.canvas.showGrid }),\r\n        setBackgroundColor: (color) => setCanvas({ backgroundColor: color })\r\n    };\r\n}\r\nexport { BuilderContext };\r\n","import { useMemo, useState, useEffect } from 'react';\r\nimport { debugWarn } from '../utils/debug';\r\n/**\r\n * Hook pour accder aux paramtres du canvas\r\n * Retourne tous les paramtres canvas depuis les options WordPress\r\n * Se met  jour automatiquement quand les paramtres changent\r\n *\r\n * @returns {Object} Les paramtres du canvas\r\n */\r\nexport const useCanvasSettings = () => {\r\n    const [settings, setSettings] = useState(() => window.pdfBuilderCanvasSettings || getDefaultCanvasSettings());\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    // couter les changements de paramtres\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n        const fetchSettings = async () => {\r\n            var _a, _b;\r\n            if (isLoading)\r\n                return; // viter les appels multiples\r\n            try {\r\n                setIsLoading(true);\r\n                const ajaxUrl = ((_a = window.pdfBuilderData) === null || _a === void 0 ? void 0 : _a.ajaxUrl) || '/wp-admin/admin-ajax.php';\r\n                const response = await fetch(ajaxUrl, {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Content-Type': 'application/x-www-form-urlencoded',\r\n                    },\r\n                    body: new URLSearchParams({\r\n                        action: 'pdf_builder_get_canvas_settings',\r\n                        nonce: ((_b = window.pdfBuilderData) === null || _b === void 0 ? void 0 : _b.nonce) || ''\r\n                    })\r\n                });\r\n                if (!isMounted)\r\n                    return;\r\n                const data = await response.json();\r\n                if (data.success && data.data) {\r\n                    window.pdfBuilderCanvasSettings = {\r\n                        ...window.pdfBuilderCanvasSettings,\r\n                        ...data.data\r\n                    };\r\n                    setSettings(window.pdfBuilderCanvasSettings);\r\n                }\r\n                else {\r\n                    debugWarn('REACT: Invalid AJAX response:', data);\r\n                }\r\n            }\r\n            catch (error) {\r\n                if (isMounted) {\r\n                    debugWarn('REACT: Failed to fetch updated settings:', error);\r\n                }\r\n            }\r\n            finally {\r\n                if (isMounted) {\r\n                    setIsLoading(false);\r\n                }\r\n            }\r\n        };\r\n        const handleSettingsUpdate = () => {\r\n            if (isMounted) {\r\n                setSettings(window.pdfBuilderCanvasSettings);\r\n            }\r\n        };\r\n        const handleStorageChange = async (event) => {\r\n            if (event.key === 'pdfBuilderSettingsUpdated' && isMounted) {\r\n                await fetchSettings();\r\n            }\r\n        };\r\n        // Ne fetch que si les settings ne sont pas dj chargs\r\n        if (!window.pdfBuilderCanvasSettings) {\r\n            fetchSettings();\r\n        }\r\n        // Check if settings were updated while this tab was closed\r\n        if (localStorage.getItem('pdfBuilderSettingsUpdated')) {\r\n            fetchSettings();\r\n        }\r\n        window.addEventListener('canvasSettingsUpdated', handleSettingsUpdate);\r\n        window.addEventListener('storage', handleStorageChange);\r\n        return () => {\r\n            isMounted = false;\r\n            window.removeEventListener('canvasSettingsUpdated', handleSettingsUpdate);\r\n            window.removeEventListener('storage', handleStorageChange);\r\n        };\r\n    }, []); // Dpendances vides pour un seul appel au montage\r\n    return settings;\r\n};\r\n/**\r\n * Hook pour accder  un paramtre canvas spcifique\r\n *\r\n * @param {string} key - Cl du paramtre\r\n * @param {unknown} defaultValue - Valeur par dfaut\r\n * @returns {unknown} La valeur du paramtre\r\n */\r\nexport const useCanvasSetting = (key, defaultValue = null) => {\r\n    const settings = useCanvasSettings();\r\n    return useMemo(() => {\r\n        const value = key in settings ? settings[key] : defaultValue;\r\n        return value;\r\n    }, [key, settings, defaultValue]);\r\n};\r\n/**\r\n * Hook pour accder aux dimensions du canvas\r\n *\r\n * @returns {Object} Les dimensions (width, height, unit, orientation)\r\n */\r\nexport const useCanvasDimensions = () => {\r\n    const settings = useCanvasSettings();\r\n    return useMemo(() => ({\r\n        width: settings.default_canvas_width || 794,\r\n        height: settings.default_canvas_height || 1123,\r\n        unit: settings.default_canvas_unit || 'px',\r\n        orientation: settings.default_orientation || 'portrait',\r\n    }), [settings]);\r\n};\r\n/**\r\n * Hook pour accder aux marges du canvas\r\n *\r\n * @returns {Object} Les marges (top, right, bottom, left)\r\n */\r\nexport const useCanvasMargins = () => {\r\n    const settings = useCanvasSettings();\r\n    return useMemo(() => ({\r\n        top: settings.margin_top || 28,\r\n        right: settings.margin_right || 28,\r\n        bottom: settings.margin_bottom || 10,\r\n        left: settings.margin_left || 10,\r\n    }), [settings]);\r\n};\r\n/**\r\n * Hook pour accder aux paramtres de grille\r\n *\r\n * @returns {Object} Les paramtres de grille\r\n */\r\nexport const useGridSettings = () => {\r\n    const settings = useCanvasSettings();\r\n    return useMemo(() => ({\r\n        show: settings.show_grid || false,\r\n        size: settings.grid_size || 10,\r\n        color: settings.grid_color || '#e0e0e0',\r\n        snapEnabled: settings.snap_to_grid || false,\r\n        snapTolerance: settings.snap_tolerance || 5,\r\n    }), [settings]);\r\n};\r\n/**\r\n * Hook pour accder aux paramtres de zoom\r\n *\r\n * @returns {Object} Les paramtres de zoom\r\n */\r\nexport const useZoomSettings = () => {\r\n    const settings = useCanvasSettings();\r\n    return useMemo(() => ({\r\n        default: settings.default_zoom || 100,\r\n        step: settings.zoom_step || 25,\r\n        min: settings.min_zoom || 10,\r\n        max: settings.max_zoom || 500,\r\n        wheelEnabled: settings.zoom_with_wheel || false,\r\n    }), [settings]);\r\n};\r\n/**\r\n * Hook pour accder aux paramtres de slection\r\n *\r\n * @returns {Object} Les paramtres de slection\r\n */\r\nexport const useSelectionSettings = () => {\r\n    const settings = useCanvasSettings();\r\n    return useMemo(() => ({\r\n        multiSelect: settings.multi_select || false,\r\n        copyPaste: settings.copy_paste_enabled || false,\r\n        rotation: settings.enable_rotation || false,\r\n        rotationStep: settings.rotation_step || 15,\r\n        showHandles: settings.show_resize_handles || false,\r\n        handleSize: settings.handle_size || 8,\r\n    }), [settings]);\r\n};\r\n/**\r\n * Hook pour accder aux paramtres d'export\r\n *\r\n * @returns {Object} Les paramtres d'export\r\n */\r\nexport const useExportSettings = () => {\r\n    const settings = useCanvasSettings();\r\n    return useMemo(() => ({\r\n        quality: settings.export_quality || 'print',\r\n        format: settings.export_format || 'pdf',\r\n        compressImages: settings.compress_images || true,\r\n        imageQuality: settings.image_quality || 85,\r\n        maxImageSize: settings.max_image_size || 2048,\r\n        includeMetadata: settings.include_metadata || true,\r\n    }), [settings]);\r\n};\r\n/**\r\n * Hook pour accder aux paramtres d'historique\r\n *\r\n * @returns {Object} Les paramtres d'historique\r\n */\r\nexport const useHistorySettings = () => {\r\n    const settings = useCanvasSettings();\r\n    return useMemo(() => ({\r\n        undoLevels: settings.undo_levels || 50,\r\n        redoLevels: settings.redo_levels || 50,\r\n    }), [settings]);\r\n};\r\n/**\r\n * Retourne les paramtres par dfaut du canvas\r\n *\r\n * @returns {Object} Paramtres par dfaut\r\n */\r\nexport const getDefaultCanvasSettings = () => ({\r\n    default_canvas_width: 794,\r\n    default_canvas_height: 1123,\r\n    default_canvas_unit: 'px',\r\n    default_orientation: 'portrait',\r\n    canvas_background_color: '#ffffff',\r\n    canvas_show_transparency: false,\r\n    container_background_color: '#f8f9fa',\r\n    container_show_transparency: false,\r\n    margin_top: 28,\r\n    margin_right: 28,\r\n    margin_bottom: 10,\r\n    margin_left: 10,\r\n    show_margins: false,\r\n    show_grid: false,\r\n    grid_size: 10,\r\n    grid_color: '#e0e0e0',\r\n    snap_to_grid: false,\r\n    snap_to_elements: false,\r\n    snap_tolerance: 5,\r\n    show_guides: false,\r\n    default_zoom: 100,\r\n    zoom_step: 25,\r\n    min_zoom: 10,\r\n    max_zoom: 500,\r\n    zoom_with_wheel: false,\r\n    pan_with_mouse: false,\r\n    show_resize_handles: false,\r\n    handle_size: 8,\r\n    handle_color: '#007cba',\r\n    enable_rotation: false,\r\n    rotation_step: 15,\r\n    multi_select: false,\r\n    copy_paste_enabled: false,\r\n    export_quality: 'print',\r\n    export_format: 'pdf',\r\n    compress_images: true,\r\n    image_quality: 85,\r\n    max_image_size: 2048,\r\n    include_metadata: true,\r\n    pdf_author: 'PDF Builder Pro',\r\n    pdf_subject: '',\r\n    auto_crop: false,\r\n    embed_fonts: true,\r\n    optimize_for_web: true,\r\n    enable_hardware_acceleration: true,\r\n    limit_fps: true,\r\n    max_fps: 60,\r\n    auto_save_enabled: true,\r\n    auto_save_interval: 5,\r\n    auto_save_versions: 10,\r\n    undo_levels: 50,\r\n    redo_levels: 50,\r\n    enable_keyboard_shortcuts: true,\r\n    debug_mode: false,\r\n    show_fps: false,\r\n});\r\n","import { useCallback, useState } from 'react';\r\nimport { useBuilder } from '../contexts/builder/BuilderContext';\r\nimport { debugLog, debugError, debugWarn } from '../utils/debug';\r\nexport const useCanvasDrop = ({ canvasRef, canvasWidth, canvasHeight, elements, dragEnabled = true }) => {\r\n    const { state, dispatch } = useBuilder();\r\n    const [isDragOver, setIsDragOver] = useState(false);\r\n    //  Validation des donnes de drag\r\n    const validateDragData = useCallback((data) => {\r\n        if (!data || typeof data !== 'object')\r\n            return false;\r\n        const dragData = data;\r\n        return (typeof dragData.type === 'string' &&\r\n            typeof dragData.label === 'string' &&\r\n            typeof dragData.defaultProps === 'object' &&\r\n            dragData.defaultProps !== null);\r\n    }, []);\r\n    //  Calcul correct des coordonnes avec zoom/pan\r\n    const calculateDropPosition = useCallback((clientX, clientY, elementWidth = 100, elementHeight = 50) => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) {\r\n            throw new Error('Canvas ref not available');\r\n        }\r\n        const rect = canvas.getBoundingClientRect();\r\n        // Validation du rectangle canvas\r\n        if (rect.width <= 0 || rect.height <= 0) {\r\n            throw new Error('Invalid canvas dimensions');\r\n        }\r\n        // Calcul des coordonnes dans l'espace canvas (avant transformation)\r\n        const canvasX = clientX - rect.left;\r\n        const canvasY = clientY - rect.top;\r\n        // Validation des coordonnes\r\n        if (canvasX < 0 || canvasY < 0 || canvasX > rect.width || canvasY > rect.height) {\r\n        }\r\n        // Appliquer la transformation inverse (zoom/pan)\r\n        // Note: zoom est en pourcentage (100 = 100%), donc diviser par 100\r\n        const zoomScale = state.canvas.zoom / 100;\r\n        // Position dans l'espace canvas transform\r\n        const transformedX = (canvasX - state.canvas.pan.x) / zoomScale;\r\n        const transformedY = (canvasY - state.canvas.pan.y) / zoomScale;\r\n        // Centrer l'lment sur le point de drop\r\n        const centeredX = Math.max(0, transformedX - elementWidth / 2);\r\n        const centeredY = Math.max(0, transformedY - elementHeight / 2);\r\n        // S'assurer que l'lment reste dans les limites du canvas\r\n        const clampedX = Math.max(0, Math.min(centeredX, canvasWidth - elementWidth));\r\n        const clampedY = Math.max(0, Math.min(centeredY, canvasHeight - elementHeight));\r\n        return {\r\n            x: clampedX,\r\n            y: clampedY,\r\n            originalCanvasX: canvasX,\r\n            originalCanvasY: canvasY,\r\n            transformedX,\r\n            transformedY\r\n        };\r\n    }, [canvasRef, canvasWidth, canvasHeight, state.canvas]);\r\n    //  Gnration d'ID unique pour les lments\r\n    const generateElementId = useCallback((type) => {\r\n        const timestamp = Date.now();\r\n        const random = Math.random().toString(36).substr(2, 9);\r\n        return `element_${type}_${timestamp}_${random}`;\r\n    }, []);\r\n    //  Cration d'lment avec validation\r\n    const createElementFromDragData = useCallback((dragData, position) => {\r\n        const elementId = generateElementId(dragData.type);\r\n        // S'assurer que width et height sont dfinis\r\n        const width = dragData.defaultProps.width || 100;\r\n        const height = dragData.defaultProps.height || 50;\r\n        // Fusion des proprits par dfaut avec les proprits calcules\r\n        const element = {\r\n            id: elementId,\r\n            type: dragData.type,\r\n            // Proprits par dfaut (peuvent tre overriden par position)\r\n            ...dragData.defaultProps,\r\n            // Position calcule (override x, y des defaultProps)\r\n            x: position.x,\r\n            y: position.y,\r\n            width,\r\n            height,\r\n            // Proprits systme requises\r\n            visible: true,\r\n            locked: false,\r\n            createdAt: new Date(),\r\n            updatedAt: new Date()\r\n        };\r\n        return element;\r\n    }, [generateElementId]);\r\n    const handleDrop = useCallback((e) => {\r\n        if (!dragEnabled) {\r\n            debugLog('[CanvasDrop] Drop ignored - drag disabled');\r\n            return;\r\n        }\r\n        e.preventDefault();\r\n        setIsDragOver(false);\r\n        debugLog('[CanvasDrop] Processing drop event');\r\n        try {\r\n            // Parsing des donnes de drag\r\n            const rawData = e.dataTransfer.getData('application/json');\r\n            if (!rawData) {\r\n                throw new Error('No drag data received');\r\n            }\r\n            const dragData = JSON.parse(rawData);\r\n            debugLog(`[CanvasDrop] Parsed drag data: ${dragData.type} (${dragData.label})`);\r\n            // Validation des donnes\r\n            if (!validateDragData(dragData)) {\r\n                throw new Error('Invalid drag data structure');\r\n            }\r\n            // Calcul de la position avec zoom/pan\r\n            const elementWidth = dragData.defaultProps.width || 100;\r\n            const elementHeight = dragData.defaultProps.height || 50;\r\n            const position = calculateDropPosition(e.clientX, e.clientY, elementWidth, elementHeight);\r\n            debugLog(`[CanvasDrop] Calculated drop position: (${position.x}, ${position.y}) from client coords (${e.clientX}, ${e.clientY})`);\r\n            // Cration de l'lment\r\n            const newElement = createElementFromDragData(dragData, position);\r\n            debugLog(`[CanvasDrop] Created element: ${newElement.id} (${newElement.type})`);\r\n            // Vrification des conflits d'ID\r\n            const existingElement = elements.find(el => el.id === newElement.id);\r\n            if (existingElement) {\r\n                newElement.id = generateElementId(dragData.type);\r\n                debugWarn(`[CanvasDrop] ID conflict resolved, new ID: ${newElement.id}`);\r\n            }\r\n            // Ajout au state\r\n            dispatch({ type: 'ADD_ELEMENT', payload: newElement });\r\n            debugLog(`[CanvasDrop] Element added to canvas successfully`);\r\n        }\r\n        catch (error) {\r\n            debugError(`[CanvasDrop] Drop failed:`, error);\r\n        }\r\n    }, [validateDragData, calculateDropPosition, createElementFromDragData, elements, dispatch, generateElementId, dragEnabled]);\r\n    const handleDragOver = useCallback((e) => {\r\n        if (!dragEnabled) {\r\n            debugLog('[CanvasDrop] Drag over ignored - drag disabled');\r\n            return;\r\n        }\r\n        e.preventDefault();\r\n        e.dataTransfer.dropEffect = 'copy';\r\n        if (!isDragOver) {\r\n            debugLog('[CanvasDrop] Drag over started');\r\n            setIsDragOver(true);\r\n        }\r\n    }, [isDragOver, dragEnabled]);\r\n    const handleDragLeave = useCallback((e) => {\r\n        if (!dragEnabled) {\r\n            debugLog('[CanvasDrop] Drag leave ignored - drag disabled');\r\n            return;\r\n        }\r\n        // Simple check - if we have a relatedTarget, assume drag is leaving\r\n        // This is a simplified approach to avoid DOM type issues\r\n        if (e.relatedTarget) {\r\n            debugLog('[CanvasDrop] Drag leave detected');\r\n            setIsDragOver(false);\r\n        }\r\n    }, [dragEnabled]);\r\n    return {\r\n        handleDrop,\r\n        handleDragOver,\r\n        handleDragLeave,\r\n        isDragOver\r\n    };\r\n};\r\n","import { useCallback, useRef, useEffect, useState } from 'react';\r\nimport { useBuilder } from '../contexts/builder/BuilderContext';\r\nimport { useCanvasSettings } from '../contexts/CanvasSettingsContext';\r\nimport { debugLog } from '../utils/debug';\r\nexport const useCanvasInteraction = ({ canvasRef, canvasWidth = 794, canvasHeight = 1123 }) => {\r\n    const { state, dispatch } = useBuilder();\r\n    const canvasSettings = useCanvasSettings();\r\n    // Dterminer le mode de slection effectif : si slection multiple dsactive, forcer le mode 'click'\r\n    const selectionMode = canvasSettings.selectionMultiSelectEnabled ? canvasSettings.canvasSelectionMode : 'click';\r\n    // tat pour dclencher le re-rendu du canvas pendant la slection\r\n    const [selectionUpdateTrigger, setSelectionUpdateTrigger] = useState(0);\r\n    // tats pour le drag et resize\r\n    const isDraggingRef = useRef(false);\r\n    const isResizingRef = useRef(false);\r\n    const isRotatingRef = useRef(false);\r\n    const dragStartRef = useRef({}); // Pour drag multiple : positions initiales de tous les lments\r\n    const dragMouseStartRef = useRef({ x: 0, y: 0 }); // Position souris au dbut du drag\r\n    const resizeMouseStartRef = useRef({ x: 0, y: 0 }); // Position souris au dbut du resize\r\n    const rotationMouseStartRef = useRef({ x: 0, y: 0 }); // Position souris au dbut de la rotation\r\n    const rotationStartRef = useRef({}); // Rotations initiales des lments\r\n    const selectedElementRef = useRef(null);\r\n    const selectedElementsRef = useRef([]); //  Track locally instead of relying on stale state\r\n    const resizeHandleRef = useRef(null);\r\n    const currentCursorRef = useRef('default');\r\n    // tats pour les modes de slection avancs\r\n    const isSelectingRef = useRef(false); // En cours de slection lasso/rectangle\r\n    const selectionStartRef = useRef({ x: 0, y: 0 }); // Point de dpart de la slection\r\n    const selectionPointsRef = useRef([]); // Points pour le lasso\r\n    const selectionRectRef = useRef({ x: 0, y: 0, width: 0, height: 0 }); // Rectangle de slection\r\n    // Refs pour les event listeners globaux pendant la slection\r\n    const globalMouseMoveRef = useRef(null);\r\n    const globalMouseUpRef = useRef(null);\r\n    //  OPTIMISATION FLUIDIT: requestAnimationFrame pour synchroniser avec le refresh rate\r\n    const rafIdRef = useRef(null);\r\n    const pendingDragUpdateRef = useRef(null);\r\n    const pendingRotationUpdateRef = useRef(null);\r\n    //  CORRECTION 5: Dernier state connu pour viter closure stale\r\n    const lastKnownStateRef = useRef(state);\r\n    // Fonctions pour grer les vnements globaux pendant la slection\r\n    const startGlobalSelectionListeners = useCallback(() => {\r\n        if (globalMouseMoveRef.current || globalMouseUpRef.current)\r\n            return; // Dj actifs\r\n        globalMouseMoveRef.current = (event) => {\r\n            const canvas = canvasRef.current;\r\n            if (!canvas)\r\n                return;\r\n            const rect = canvas.getBoundingClientRect();\r\n            const zoomScale = state.canvas.zoom / 100;\r\n            // Calcul des coordonnes mme si la souris est hors du canvas\r\n            const canvasRelativeX = event.clientX - rect.left;\r\n            const canvasRelativeY = event.clientY - rect.top;\r\n            const x = (canvasRelativeX - state.canvas.pan.x) / zoomScale;\r\n            const y = (canvasRelativeY - state.canvas.pan.y) / zoomScale;\r\n            // Mettre  jour la slection\r\n            if (selectionMode === 'lasso') {\r\n                selectionPointsRef.current.push({ x, y });\r\n                setSelectionUpdateTrigger(prev => prev + 1);\r\n            }\r\n            else if (selectionMode === 'rectangle') {\r\n                const startX = Math.min(selectionStartRef.current.x, x);\r\n                const startY = Math.min(selectionStartRef.current.y, y);\r\n                const width = Math.abs(x - selectionStartRef.current.x);\r\n                const height = Math.abs(y - selectionStartRef.current.y);\r\n                selectionRectRef.current = { x: startX, y: startY, width, height };\r\n                setSelectionUpdateTrigger(prev => prev + 1);\r\n            }\r\n        };\r\n        globalMouseUpRef.current = () => {\r\n            stopGlobalSelectionListeners();\r\n            // Terminer la slection directement ici\r\n            if (isSelectingRef.current) {\r\n                let selectedElementIds = [];\r\n                if (selectionMode === 'lasso' && selectionPointsRef.current.length > 2) {\r\n                    // Utiliser la mme logique que isElementInLasso\r\n                    selectedElementIds = state.elements\r\n                        .filter(element => {\r\n                        const centerX = element.x + element.width / 2;\r\n                        const centerY = element.y + element.height / 2;\r\n                        // Logique de isPointInPolygon duplique\r\n                        let inside = false;\r\n                        const polygon = selectionPointsRef.current;\r\n                        for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {\r\n                            const xi = polygon[i].x, yi = polygon[i].y;\r\n                            const xj = polygon[j].x, yj = polygon[j].y;\r\n                            if (((yi > centerY) !== (yj > centerY)) && (centerX < (xj - xi) * (centerY - yi) / (yj - yi) + xi)) {\r\n                                inside = !inside;\r\n                            }\r\n                        }\r\n                        return inside;\r\n                    })\r\n                        .map(element => element.id);\r\n                }\r\n                else if (selectionMode === 'rectangle' && selectionRectRef.current.width > 0 && selectionRectRef.current.height > 0) {\r\n                    // Utiliser la mme logique que isElementInRectangle\r\n                    selectedElementIds = state.elements\r\n                        .filter(element => {\r\n                        const elementRight = element.x + element.width;\r\n                        const elementBottom = element.y + element.height;\r\n                        const rectRight = selectionRectRef.current.x + selectionRectRef.current.width;\r\n                        const rectBottom = selectionRectRef.current.y + selectionRectRef.current.height;\r\n                        return !(element.x > rectRight || elementRight < selectionRectRef.current.x || element.y > rectBottom || elementBottom < selectionRectRef.current.y);\r\n                    })\r\n                        .map(element => element.id);\r\n                }\r\n                if (selectedElementIds.length > 0) {\r\n                    dispatch({ type: 'SET_SELECTION', payload: selectedElementIds });\r\n                }\r\n                else {\r\n                    dispatch({ type: 'CLEAR_SELECTION' });\r\n                }\r\n                // Rinitialiser l'tat de slection\r\n                isSelectingRef.current = false;\r\n                selectionPointsRef.current = [];\r\n                selectionRectRef.current = { x: 0, y: 0, width: 0, height: 0 };\r\n            }\r\n        };\r\n        document.addEventListener('mousemove', globalMouseMoveRef.current, { passive: false });\r\n        document.addEventListener('mouseup', globalMouseUpRef.current, { passive: false });\r\n    }, [canvasRef, state.canvas.zoom, state.canvas.pan, state.elements, selectionMode, dispatch]);\r\n    const stopGlobalSelectionListeners = useCallback(() => {\r\n        if (globalMouseMoveRef.current) {\r\n            document.removeEventListener('mousemove', globalMouseMoveRef.current);\r\n            globalMouseMoveRef.current = null;\r\n        }\r\n        if (globalMouseUpRef.current) {\r\n            document.removeEventListener('mouseup', globalMouseUpRef.current);\r\n            globalMouseUpRef.current = null;\r\n        }\r\n    }, []);\r\n    //  OPTIMISATION FLUIDIT: Fonction pour effectuer les updates de drag avec RAF\r\n    const performDragUpdate = useCallback(() => {\r\n        if (!pendingDragUpdateRef.current) {\r\n            rafIdRef.current = null;\r\n            return;\r\n        }\r\n        const { x: currentMouseX, y: currentMouseY } = pendingDragUpdateRef.current;\r\n        const lastState = lastKnownStateRef.current;\r\n        //  MODIFICATION: Grer le drag multiple\r\n        const selectedIds = lastState.selection.selectedElements;\r\n        if (selectedIds.length === 0) {\r\n            rafIdRef.current = null;\r\n            return;\r\n        }\r\n        // Calculer le delta de dplacement de la souris depuis le dbut du drag\r\n        const mouseDeltaX = currentMouseX - dragMouseStartRef.current.x;\r\n        const mouseDeltaY = currentMouseY - dragMouseStartRef.current.y;\r\n        // Mettre  jour tous les lments slectionns\r\n        selectedIds.forEach(elementId => {\r\n            const element = lastState.elements.find(el => el.id === elementId);\r\n            if (!element)\r\n                return;\r\n            // Rcuprer la position de dpart de cet lment spcifique\r\n            const elementStartPos = dragStartRef.current[elementId];\r\n            if (!elementStartPos)\r\n                return;\r\n            // Calculer la nouvelle position en appliquant le delta de la souris  la position de dpart\r\n            let finalX = elementStartPos.x + mouseDeltaX;\r\n            let finalY = elementStartPos.y + mouseDeltaY;\r\n            //  AJOUT: Logique d'accrochage  la grille\r\n            if (lastState.canvas.snapToGrid && lastState.canvas.gridSize > 0) {\r\n                const gridSize = lastState.canvas.gridSize;\r\n                const snapTolerance = 5; // Tolrance de 5px pour l'accrochage\r\n                // Calculer la distance  la grille la plus proche\r\n                const nearestGridX = Math.round(finalX / gridSize) * gridSize;\r\n                const nearestGridY = Math.round(finalY / gridSize) * gridSize;\r\n                // Appliquer l'accrochage seulement si on est assez proche de la grille\r\n                if (Math.abs(finalX - nearestGridX) <= snapTolerance) {\r\n                    finalX = nearestGridX;\r\n                }\r\n                if (Math.abs(finalY - nearestGridY) <= snapTolerance) {\r\n                    finalY = nearestGridY;\r\n                }\r\n            }\r\n            // S'assurer que l'lment reste dans les limites du canvas\r\n            const canvasWidthPx = canvasWidth;\r\n            const canvasHeightPx = canvasHeight;\r\n            // Clamp X position (laisser au moins 20px visible)\r\n            const minVisibleWidth = Math.min(50, element.width * 0.3);\r\n            if (finalX < 0)\r\n                finalX = 0;\r\n            if (finalX + minVisibleWidth > canvasWidthPx)\r\n                finalX = canvasWidthPx - minVisibleWidth;\r\n            // Clamp Y position (laisser au moins 20px visible)\r\n            const minVisibleHeight = Math.min(30, element.height * 0.3);\r\n            if (finalY < 0)\r\n                finalY = 0;\r\n            if (finalY + minVisibleHeight > canvasHeightPx)\r\n                finalY = canvasHeightPx - minVisibleHeight;\r\n            //  CORRECTION 6: Amliorer la prservation des proprits\r\n            const completeUpdates = { x: finalX, y: finalY };\r\n            //  Prserver TOUTES les proprits\r\n            const elementAsRecord = element;\r\n            Object.keys(elementAsRecord).forEach(key => {\r\n                if (key !== 'x' && key !== 'y' && key !== 'updatedAt') {\r\n                    completeUpdates[key] = elementAsRecord[key];\r\n                }\r\n            });\r\n            //  CRITICAL: Explicitement prserver ces proprits critiques\r\n            if ('src' in elementAsRecord) {\r\n                completeUpdates.src = elementAsRecord.src;\r\n            }\r\n            if ('logoUrl' in elementAsRecord) {\r\n                completeUpdates.logoUrl = elementAsRecord.logoUrl;\r\n            }\r\n            if ('alignment' in elementAsRecord) {\r\n                completeUpdates.alignment = elementAsRecord.alignment;\r\n            }\r\n            dispatch({\r\n                type: 'UPDATE_ELEMENT',\r\n                payload: {\r\n                    id: elementId,\r\n                    updates: completeUpdates\r\n                }\r\n            });\r\n        });\r\n        pendingDragUpdateRef.current = null;\r\n        rafIdRef.current = null;\r\n    }, [dispatch, canvasWidth, canvasHeight]);\r\n    //  OPTIMISATION FLUIDIT: Fonction pour effectuer les updates de rotation avec RAF\r\n    const performRotationUpdate = useCallback(() => {\r\n        if (!pendingRotationUpdateRef.current) {\r\n            rafIdRef.current = null;\r\n            return;\r\n        }\r\n        const { x: currentMouseX, y: currentMouseY } = pendingRotationUpdateRef.current;\r\n        const lastState = lastKnownStateRef.current;\r\n        //  MODIFICATION: Grer la rotation multiple\r\n        const selectedIds = lastState.selection.selectedElements;\r\n        if (selectedIds.length === 0) {\r\n            rafIdRef.current = null;\r\n            return;\r\n        }\r\n        // Calculer le centre de rotation (centre de la slection)\r\n        const selectedElements = lastState.elements.filter(el => selectedIds.includes(el.id));\r\n        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n        selectedElements.forEach(el => {\r\n            minX = Math.min(minX, el.x);\r\n            minY = Math.min(minY, el.y);\r\n            maxX = Math.max(maxX, el.x + el.width);\r\n            maxY = Math.max(maxY, el.y + el.height);\r\n        });\r\n        const centerX = (minX + maxX) / 2;\r\n        const centerY = (minY + maxY) / 2;\r\n        // Calculer l'angle de rotation bas sur la position de la souris\r\n        const startAngle = Math.atan2(rotationMouseStartRef.current.y - centerY, rotationMouseStartRef.current.x - centerX);\r\n        const currentAngle = Math.atan2(currentMouseY - centerY, currentMouseX - centerX);\r\n        // Calculer la diffrence angulaire avec gestion du wrap-around\r\n        let angleDelta = currentAngle - startAngle;\r\n        // Normaliser l'angle entre - et  pour viter les sauts\r\n        while (angleDelta > Math.PI)\r\n            angleDelta -= 2 * Math.PI;\r\n        while (angleDelta < -Math.PI)\r\n            angleDelta += 2 * Math.PI;\r\n        // Ajuster la sensibilit de la rotation (moins violent)\r\n        angleDelta *= 1.3; // Multiplier par 1.3 pour une rotation douce mais perceptible\r\n        // Convertir en degrs\r\n        let totalRotationDegrees = (angleDelta * 180) / Math.PI;\r\n        //  AJOUT: Snap magntique ULTRA SIMPLE - forcer  0 quand proche\r\n        const zeroSnapTolerance = 8; // 8 degrees (moins agressif)\r\n        // Calculer la rotation actuelle pour chaque lment\r\n        selectedIds.forEach(elementId => {\r\n            const element = lastState.elements.find(el => el.id === elementId);\r\n            if (element) {\r\n                const initialRotation = rotationStartRef.current[elementId] || 0;\r\n                let currentRotation = initialRotation + totalRotationDegrees;\r\n                // Normaliser l'angle entre -180 et 180\r\n                let normalizedRotation = currentRotation % 360;\r\n                if (normalizedRotation > 180)\r\n                    normalizedRotation -= 360;\r\n                if (normalizedRotation < -180)\r\n                    normalizedRotation += 360;\r\n                // Distance  0\r\n                const distanceToZero = Math.abs(normalizedRotation);\r\n                // SI PROCHE DE 0, FORCER totalRotationDegrees pour que la rotation finale soit 0\r\n                if (distanceToZero <= zeroSnapTolerance) {\r\n                    // Forcer totalRotationDegrees pour que newRotation = 0\r\n                    totalRotationDegrees = -initialRotation;\r\n                }\r\n            }\r\n        });\r\n        // Mettre  jour la rotation de tous les lments slectionns\r\n        selectedIds.forEach(elementId => {\r\n            const element = lastState.elements.find(el => el.id === elementId);\r\n            if (element) {\r\n                const initialRotation = rotationStartRef.current[elementId] || 0;\r\n                let newRotation = initialRotation + totalRotationDegrees;\r\n                dispatch({\r\n                    type: 'UPDATE_ELEMENT',\r\n                    payload: {\r\n                        id: elementId,\r\n                        updates: { rotation: newRotation }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        pendingRotationUpdateRef.current = null;\r\n        rafIdRef.current = null;\r\n    }, [dispatch]); //  CORRECTION 3: Throttling pour handleMouseMove - optimis pour fluidit maximale\r\n    const lastMouseMoveTimeRef = useRef(0);\r\n    const MOUSEMOVE_THROTTLE_MS = 8; // Rduit de 100ms  8ms pour fluidit maximale (120Hz)\r\n    // Fonction utilitaire pour dtecter les poignes de redimensionnement\r\n    //  BUGFIX-018: Consistent margin for hit detection across all element types\r\n    const getResizeHandleAtPosition = useCallback((x, y, selectedIds, elements) => {\r\n        const handleSize = 8;\r\n        const handleMargin = 6; // Consistent margin for all elements\r\n        const selectedElements = elements.filter(el => selectedIds.includes(el.id));\r\n        for (const element of selectedElements) {\r\n            // Calculer les positions des poignes (8 poignes : 4 coins + 4 milieux)\r\n            const handles = [\r\n                // Coins\r\n                { name: 'nw', x: element.x - handleSize / 2, y: element.y - handleSize / 2 },\r\n                { name: 'ne', x: element.x + element.width - handleSize / 2, y: element.y - handleSize / 2 },\r\n                { name: 'sw', x: element.x - handleSize / 2, y: element.y + element.height - handleSize / 2 },\r\n                { name: 'se', x: element.x + element.width - handleSize / 2, y: element.y + element.height - handleSize / 2 },\r\n                // Milieux des cts\r\n                { name: 'n', x: element.x + element.width / 2 - handleSize / 2, y: element.y - handleSize / 2 },\r\n                { name: 's', x: element.x + element.width / 2 - handleSize / 2, y: element.y + element.height - handleSize / 2 },\r\n                { name: 'w', x: element.x - handleSize / 2, y: element.y + element.height / 2 - handleSize / 2 },\r\n                { name: 'e', x: element.x + element.width - handleSize / 2, y: element.y + element.height / 2 - handleSize / 2 }\r\n            ];\r\n            for (const handle of handles) {\r\n                // Use consistent margin for all element types\r\n                if (x >= handle.x - handleMargin && x <= handle.x + handleSize + handleMargin &&\r\n                    y >= handle.y - handleMargin && y <= handle.y + handleSize + handleMargin) {\r\n                    return { elementId: element.id, handle: handle.name };\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }, []);\r\n    // Fonction pour crer un lment selon le mode  une position donne\r\n    const createElementAtPosition = useCallback((x, y, mode) => {\r\n        const elementId = `element_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n        //  AJOUT: Appliquer le snap  la grille lors de la cration d'lments\r\n        let finalX = x;\r\n        let finalY = y;\r\n        if (state.canvas.snapToGrid && state.canvas.gridSize > 0) {\r\n            const gridSize = state.canvas.gridSize;\r\n            finalX = Math.round(x / gridSize) * gridSize;\r\n            finalY = Math.round(y / gridSize) * gridSize;\r\n        }\r\n        let newElement;\r\n        switch (mode) {\r\n            case 'rectangle':\r\n                newElement = {\r\n                    id: elementId,\r\n                    type: 'rectangle',\r\n                    x: finalX - 50,\r\n                    y: finalY - 50,\r\n                    width: 100,\r\n                    height: 100,\r\n                    fillColor: '#ffffff',\r\n                    strokeColor: '#000000',\r\n                    strokeWidth: 1,\r\n                    borderRadius: 0,\r\n                    rotation: 0,\r\n                    visible: true,\r\n                    locked: false,\r\n                    createdAt: new Date(),\r\n                    updatedAt: new Date()\r\n                };\r\n                break;\r\n            case 'circle':\r\n                newElement = {\r\n                    id: elementId,\r\n                    type: 'circle',\r\n                    x: finalX - 50,\r\n                    y: finalY - 50,\r\n                    width: 100,\r\n                    height: 100,\r\n                    fillColor: '#ffffff',\r\n                    strokeColor: '#000000',\r\n                    strokeWidth: 1,\r\n                    rotation: 0,\r\n                    visible: true,\r\n                    locked: false,\r\n                    createdAt: new Date(),\r\n                    updatedAt: new Date()\r\n                };\r\n                break;\r\n            case 'line':\r\n                newElement = {\r\n                    id: elementId,\r\n                    type: 'line',\r\n                    x: finalX - 50,\r\n                    y: finalY - 1,\r\n                    width: 100,\r\n                    height: 2,\r\n                    strokeColor: '#000000',\r\n                    strokeWidth: 2,\r\n                    rotation: 0,\r\n                    visible: true,\r\n                    locked: false,\r\n                    createdAt: new Date(),\r\n                    updatedAt: new Date()\r\n                };\r\n                break;\r\n            case 'text':\r\n                newElement = {\r\n                    id: elementId,\r\n                    type: 'text',\r\n                    x: finalX - 50,\r\n                    y: finalY - 10,\r\n                    width: 100,\r\n                    height: 30,\r\n                    text: 'Texte',\r\n                    fontSize: 16,\r\n                    color: '#000000',\r\n                    align: 'left',\r\n                    rotation: 0,\r\n                    visible: true,\r\n                    locked: false,\r\n                    createdAt: new Date(),\r\n                    updatedAt: new Date()\r\n                };\r\n                break;\r\n            case 'image':\r\n                newElement = {\r\n                    id: elementId,\r\n                    type: 'image',\r\n                    x: finalX - 50,\r\n                    y: finalY - 50,\r\n                    width: 100,\r\n                    height: 100,\r\n                    src: '',\r\n                    rotation: 0,\r\n                    visible: true,\r\n                    locked: false,\r\n                    createdAt: new Date(),\r\n                    updatedAt: new Date()\r\n                };\r\n                break;\r\n            default:\r\n                return;\r\n        }\r\n        // Ajouter l'lment au state\r\n        dispatch({ type: 'ADD_ELEMENT', payload: newElement });\r\n        // Slectionner le nouvel lment\r\n        dispatch({ type: 'SET_SELECTION', payload: [elementId] });\r\n        selectedElementRef.current = elementId;\r\n        // Remettre en mode slection aprs cration\r\n        dispatch({ type: 'SET_MODE', payload: 'select' });\r\n    }, [dispatch, state.canvas.snapToGrid, state.canvas.gridSize]);\r\n    //  Syncer la ref avec l'tat Redux (correction: viter la dpendance sur state entier)\r\n    useEffect(() => {\r\n        selectedElementsRef.current = state.selection.selectedElements;\r\n        //  CORRECTION 5: Garder un snapshot du state courant\r\n        lastKnownStateRef.current = state;\r\n    }, [state.selection.selectedElements, state.elements, state.canvas]); // Dpendances spcifiques au lieu de state entier\r\n    //  CORRECTION 4: Fonction helper pour vrifier que rect est valide\r\n    const validateCanvasRect = (rect) => {\r\n        // Vrifier que rect a des dimensions positives et que left/top sont raisonnables\r\n        if (!rect || rect.width <= 0 || rect.height <= 0) {\r\n            return false;\r\n        }\r\n        // Si rect.left ou rect.top sont trs ngatifs (canvas hors-cran), c'est OK\r\n        // Mais si ils sont NaN, c'est un problme\r\n        if (isNaN(rect.left) || isNaN(rect.top) || isNaN(rect.right) || isNaN(rect.bottom)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    // Gestionnaire de clic pour la slection et cration d'lments\r\n    // Fonction utilitaire pour vrifier si un point est dans la hitbox d'un lment (avec marge pour les lignes)\r\n    const isPointInElement = (x, y, element) => {\r\n        // Pour les lignes, ajouter une marge RDUITE pour faciliter la slection sans overlap excessif\r\n        // Pour les autres lments, pas de marge\r\n        let hitboxMargin = 0;\r\n        if (element.type === 'line') {\r\n            // Marge trs rduite: 1-2px max pour les lignes fines\r\n            hitboxMargin = Math.max(1, Math.min(2, element.height * 0.5));\r\n        }\r\n        const left = element.x - hitboxMargin;\r\n        const right = element.x + element.width + hitboxMargin;\r\n        const top = element.y - hitboxMargin;\r\n        const bottom = element.y + element.height + hitboxMargin;\r\n        return x >= left && x <= right && y >= top && y <= bottom;\r\n    };\r\n    const handleCanvasClick = useCallback((event) => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas)\r\n            return;\r\n        const rect = canvas.getBoundingClientRect();\r\n        //  BUGFIX-008: Validate rect BEFORE using it\r\n        if (!validateCanvasRect(rect)) {\r\n            return;\r\n        }\r\n        // Note: zoom est en pourcentage (100%), donc diviser par 100 pour obtenir le facteur d'chelle\r\n        const zoomScale = state.canvas.zoom / 100;\r\n        const x = (event.clientX - rect.left - state.canvas.pan.x) / zoomScale;\r\n        const y = (event.clientY - rect.top - state.canvas.pan.y) / zoomScale;\r\n        //  CORRECTION: Vrifier qu'aucun lment n'est cliqu (pour viter duplication avec handleMouseDown)\r\n        // Note: On cherche du dernier vers le premier pour cohrence avec handleMouseDown\r\n        const clickedElement = [...state.elements].reverse().find(el => isPointInElement(x, y, el));\r\n        // Ne crer un lment que si on clique dans le vide ET qu'on n'est pas en mode slection\r\n        if (!clickedElement && state.mode !== 'select') {\r\n            createElementAtPosition(x, y, state.mode);\r\n        }\r\n        // Note: La slection est gre exclusivement par handleMouseDown\r\n    }, [state, canvasRef, createElementAtPosition]);\r\n    // Gestionnaire de mouse down pour commencer le drag ou resize\r\n    const handleMouseDown = useCallback((event) => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) {\r\n            debugLog('[CanvasInteraction] Mouse down ignored - canvas ref null');\r\n            return;\r\n        }\r\n        const rect = canvas.getBoundingClientRect();\r\n        //  CORRECTION 4: Vrifier que rect est valide avant de l'utiliser\r\n        if (!validateCanvasRect(rect)) {\r\n            debugLog('[CanvasInteraction] Mouse down ignored - invalid canvas rect');\r\n            return;\r\n        }\r\n        // Note: zoom est en pourcentage (100%), donc diviser par 100 pour obtenir le facteur d'chelle\r\n        const zoomScale = state.canvas.zoom / 100;\r\n        // Calcul des coordonnes du canvas:\r\n        // 1. (event.clientX - rect.left) = position relative au canvas en viewport space\r\n        // 2. - state.canvas.pan.x = appliquer le pan (qui est en canvas space)\r\n        // 3. / zoomScale = appliquer le zoom\r\n        const canvasRelativeX = event.clientX - rect.left;\r\n        const canvasRelativeY = event.clientY - rect.top;\r\n        const x = (canvasRelativeX - state.canvas.pan.x) / zoomScale;\r\n        const y = (canvasRelativeY - state.canvas.pan.y) / zoomScale;\r\n        debugLog(`[CanvasInteraction] Mouse down at canvas coords (${x.toFixed(1)}, ${y.toFixed(1)}), zoom: ${zoomScale}, pan: (${state.canvas.pan.x.toFixed(1)}, ${state.canvas.pan.y.toFixed(1)})`);\r\n        //  Chercher n'importe quel lment au clic (slectionn ou pas)\r\n        // Note: On cherche du dernier vers le premier pour slectionner l'lment rendu au-dessus\r\n        const clickedElement = [...state.elements].reverse().find(el => {\r\n            const isIn = isPointInElement(x, y, el);\r\n            return isIn;\r\n        });\r\n        // Si on a cliqu sur un lment\r\n        if (clickedElement) {\r\n            debugLog(`[CanvasInteraction] Clicked element: ${clickedElement.type} (${clickedElement.id})`);\r\n            //  Utiliser state.selection directement (plus fiable que ref)\r\n            const isAlreadySelected = state.selection.selectedElements.includes(clickedElement.id);\r\n            //  Vrifier si la slection multiple est active et si Ctrl est enfonc\r\n            const isMultiSelect = canvasSettings.selectionMultiSelectEnabled && event.ctrlKey;\r\n            if (isMultiSelect) {\r\n                debugLog(`[CanvasInteraction] Multi-select mode - ${isAlreadySelected ? 'removing' : 'adding'} element ${clickedElement.id}`);\r\n                //  Mode slection multiple\r\n                if (isAlreadySelected) {\r\n                    // Retirer l'lment de la slection\r\n                    const newSelection = state.selection.selectedElements.filter(id => id !== clickedElement.id);\r\n                    dispatch({ type: 'SET_SELECTION', payload: newSelection });\r\n                }\r\n                else {\r\n                    // Ajouter l'lment  la slection\r\n                    const newSelection = [...state.selection.selectedElements, clickedElement.id];\r\n                    dispatch({ type: 'SET_SELECTION', payload: newSelection });\r\n                }\r\n                event.preventDefault();\r\n                return;\r\n            }\r\n            else {\r\n                //  Mode slection simple (comportement actuel)\r\n                if (!isAlreadySelected) {\r\n                    debugLog(`[CanvasInteraction] Selecting element ${clickedElement.id}`);\r\n                    dispatch({ type: 'SET_SELECTION', payload: [clickedElement.id] });\r\n                    //  CORRECTION: Prparer le drag immdiatement pour permettre drag aprs slection\r\n                    isDraggingRef.current = true;\r\n                    // Stocker les positions de dpart de tous les lments slectionns\r\n                    dragStartRef.current = { [clickedElement.id]: { x: clickedElement.x, y: clickedElement.y } };\r\n                    dragMouseStartRef.current = { x, y }; // Position souris\r\n                    selectedElementRef.current = clickedElement.id;\r\n                    event.preventDefault();\r\n                    return;\r\n                }\r\n                //  L'lment est dj slectionn - prparer le drag\r\n                debugLog(`[CanvasInteraction] Starting drag for ${state.selection.selectedElements.length} selected elements`);\r\n                isDraggingRef.current = true;\r\n                // Stocker les positions de dpart de tous les lments slectionns\r\n                const startPositions = {};\r\n                state.selection.selectedElements.forEach(id => {\r\n                    const element = state.elements.find(el => el.id === id);\r\n                    if (element) {\r\n                        startPositions[id] = { x: element.x, y: element.y };\r\n                    }\r\n                });\r\n                dragStartRef.current = startPositions;\r\n                dragMouseStartRef.current = { x, y }; // Position souris\r\n                selectedElementRef.current = clickedElement.id;\r\n                event.preventDefault();\r\n                return;\r\n            }\r\n        }\r\n        // Vrifier si on clique sur une poigne de redimensionnement\r\n        const resizeHandle = getResizeHandleAtPosition(x, y, state.selection.selectedElements, state.elements);\r\n        if (resizeHandle) {\r\n            debugLog(`[CanvasInteraction] Starting resize - element: ${resizeHandle.elementId}, handle: ${resizeHandle.handle}`);\r\n            isResizingRef.current = true;\r\n            resizeHandleRef.current = resizeHandle.handle;\r\n            selectedElementRef.current = resizeHandle.elementId;\r\n            resizeMouseStartRef.current = { x, y }; // Position souris au dbut du resize\r\n            event.preventDefault();\r\n            return;\r\n        }\r\n        // Vrifier si on clique sur une poigne de rotation\r\n        if ((canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.selectionRotationEnabled) && state.selection.selectedElements.length > 0) {\r\n            const selectedElements = state.elements.filter(el => state.selection.selectedElements.includes(el.id));\r\n            if (selectedElements.length > 0) {\r\n                // Calculer les bounds de slection\r\n                let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n                selectedElements.forEach(el => {\r\n                    minX = Math.min(minX, el.x);\r\n                    minY = Math.min(minY, el.y);\r\n                    maxX = Math.max(maxX, el.x + el.width);\r\n                    maxY = Math.max(maxY, el.y + el.height);\r\n                });\r\n                // Position de la poigne de rotation\r\n                const centerX = (minX + maxX) / 2;\r\n                const rotationHandleY = minY - 20;\r\n                const rotationHandleSize = 8;\r\n                // Vrifier si on est sur la poigne de rotation\r\n                const distance = Math.sqrt((x - centerX) ** 2 + (y - rotationHandleY) ** 2);\r\n                if (distance <= rotationHandleSize / 2) {\r\n                    debugLog(`[CanvasInteraction] Starting rotation for ${state.selection.selectedElements.length} elements`);\r\n                    isRotatingRef.current = true;\r\n                    rotationMouseStartRef.current = { x, y };\r\n                    // Stocker les rotations initiales de tous les lments slectionns\r\n                    const initialRotations = {};\r\n                    state.selection.selectedElements.forEach(elementId => {\r\n                        const element = state.elements.find(el => el.id === elementId);\r\n                        if (element) {\r\n                            initialRotations[elementId] = element.rotation || 0;\r\n                        }\r\n                    });\r\n                    rotationStartRef.current = initialRotations;\r\n                    event.preventDefault();\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        //  Sinon on a cliqu sur le vide - grer selon le mode de slection\r\n        if (selectionMode === 'lasso' || selectionMode === 'rectangle') {\r\n            debugLog(`[CanvasInteraction] Starting ${selectionMode} selection at (${x.toFixed(1)}, ${y.toFixed(1)})`);\r\n            // Commencer une nouvelle slection\r\n            isSelectingRef.current = true;\r\n            selectionStartRef.current = { x, y };\r\n            selectionPointsRef.current = [{ x, y }];\r\n            if (selectionMode === 'rectangle') {\r\n                selectionRectRef.current = { x, y, width: 0, height: 0 };\r\n            }\r\n            // Dmarrer les listeners globaux pour permettre la slection hors canvas\r\n            startGlobalSelectionListeners();\r\n            // Ne pas dslectionner immdiatement, attendre la fin de la slection\r\n            event.preventDefault();\r\n            return;\r\n        }\r\n        else {\r\n            // Mode clic simple - dslectionner\r\n            if (state.selection.selectedElements.length > 0) {\r\n                debugLog(`[CanvasInteraction] Clearing selection (${state.selection.selectedElements.length} elements)`);\r\n                dispatch({ type: 'CLEAR_SELECTION' });\r\n                selectedElementRef.current = null;\r\n            }\r\n        }\r\n    }, [state, canvasRef, dispatch, getResizeHandleAtPosition]);\r\n    // Gestionnaire de mouse up pour terminer le drag ou resize\r\n    const handleMouseUp = useCallback(() => {\r\n        debugLog(`[CanvasInteraction] Mouse up - ending interactions (dragging: ${isDraggingRef.current}, resizing: ${isResizingRef.current}, rotating: ${isRotatingRef.current}, selecting: ${isSelectingRef.current})`);\r\n        // Annuler tout RAF en cours et effectuer un dernier update si ncessaire\r\n        if (rafIdRef.current !== null) {\r\n            cancelAnimationFrame(rafIdRef.current);\r\n            rafIdRef.current = null;\r\n            // Effectuer un dernier update si il y en a un en attente\r\n            if (pendingDragUpdateRef.current) {\r\n                performDragUpdate();\r\n            }\r\n            if (pendingRotationUpdateRef.current) {\r\n                performRotationUpdate();\r\n            }\r\n        }\r\n        //  AJOUT: Snap final ultra simple\r\n        const lastState = lastKnownStateRef.current;\r\n        const selectedIds = lastState.selection.selectedElements;\r\n        if (selectedIds.length > 0 && isRotatingRef.current) {\r\n            selectedIds.forEach(elementId => {\r\n                const element = lastState.elements.find(el => el.id === elementId);\r\n                if (element) {\r\n                    let currentRotation = element.rotation || 0;\r\n                    // Normaliser\r\n                    let normalizedRotation = currentRotation % 360;\r\n                    if (normalizedRotation > 180)\r\n                        normalizedRotation -= 360;\r\n                    if (normalizedRotation < -180)\r\n                        normalizedRotation += 360;\r\n                    // Si dans les 10, forcer  0\r\n                    const finalSnapThreshold = 10; // 10 degrees (moins agressif)\r\n                    if (Math.abs(normalizedRotation) <= finalSnapThreshold) {\r\n                        dispatch({\r\n                            type: 'UPDATE_ELEMENT',\r\n                            payload: {\r\n                                id: elementId,\r\n                                updates: { rotation: 0 }\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        // Finaliser la slection lasso/rectangle si en cours\r\n        if (isSelectingRef.current) {\r\n            let selectedElementIds = [];\r\n            if (selectionMode === 'lasso' && selectionPointsRef.current.length > 2) {\r\n                // Slection lasso : vrifier quels lments sont  l'intrieur du polygone\r\n                selectedElementIds = state.elements\r\n                    .filter(element => isElementInLasso(element, selectionPointsRef.current))\r\n                    .map(element => element.id);\r\n                debugLog(`[CanvasInteraction] Lasso selection completed - ${selectedElementIds.length} elements selected`);\r\n            }\r\n            else if (selectionMode === 'rectangle' && selectionRectRef.current.width > 0 && selectionRectRef.current.height > 0) {\r\n                // Slection rectangle : vrifier quels lments intersectent le rectangle\r\n                selectedElementIds = state.elements\r\n                    .filter(element => isElementInRectangle(element, selectionRectRef.current))\r\n                    .map(element => element.id);\r\n                debugLog(`[CanvasInteraction] Rectangle selection completed - ${selectedElementIds.length} elements selected`);\r\n            }\r\n            // Appliquer la slection\r\n            if (selectedElementIds.length > 0) {\r\n                debugLog(`[CanvasInteraction] Applying selection: ${selectedElementIds.join(', ')}`);\r\n                dispatch({ type: 'SET_SELECTION', payload: selectedElementIds });\r\n            }\r\n            else {\r\n                debugLog(`[CanvasInteraction] No elements selected - clearing selection`);\r\n                dispatch({ type: 'CLEAR_SELECTION' });\r\n            }\r\n            // Rinitialiser l'tat de slection\r\n            isSelectingRef.current = false;\r\n            selectionPointsRef.current = [];\r\n            selectionRectRef.current = { x: 0, y: 0, width: 0, height: 0 };\r\n        }\r\n        isDraggingRef.current = false;\r\n        isResizingRef.current = false;\r\n        isRotatingRef.current = false;\r\n        resizeHandleRef.current = null;\r\n        selectedElementRef.current = null;\r\n        rotationStartRef.current = {};\r\n        pendingRotationUpdateRef.current = null;\r\n    }, [performDragUpdate, performRotationUpdate, dispatch]);\r\n    // Fonction pour obtenir le curseur de redimensionnement selon la poigne\r\n    const getResizeCursor = (handle) => {\r\n        switch (handle) {\r\n            case 'nw':\r\n            case 'se':\r\n                return 'nw-resize';\r\n            case 'ne':\r\n            case 'sw':\r\n                return 'ne-resize';\r\n            case 'n':\r\n                return 'n-resize';\r\n            case 's':\r\n                return 's-resize';\r\n            case 'w':\r\n                return 'w-resize';\r\n            case 'e':\r\n                return 'e-resize';\r\n            default:\r\n                return 'default';\r\n        }\r\n    };\r\n    // Fonction pour dterminer le curseur appropri selon la position\r\n    const getCursorAtPosition = useCallback((x, y) => {\r\n        // Si on est en train de draguer ou redimensionner, garder le curseur appropri\r\n        if (isDraggingRef.current) {\r\n            return 'grabbing';\r\n        }\r\n        if (isResizingRef.current) {\r\n            return getResizeCursor(resizeHandleRef.current);\r\n        }\r\n        if (isRotatingRef.current) {\r\n            return 'grabbing';\r\n        }\r\n        // Vrifier si on est sur une poigne de rotation\r\n        if ((canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.selectionRotationEnabled) && state.selection.selectedElements.length > 0) {\r\n            const selectedElements = state.elements.filter(el => state.selection.selectedElements.includes(el.id));\r\n            if (selectedElements.length > 0) {\r\n                // Calculer les bounds de slection\r\n                let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n                selectedElements.forEach(el => {\r\n                    minX = Math.min(minX, el.x);\r\n                    minY = Math.min(minY, el.y);\r\n                    maxX = Math.max(maxX, el.x + el.width);\r\n                    maxY = Math.max(maxY, el.y + el.height);\r\n                });\r\n                // Position de la poigne de rotation\r\n                const centerX = (minX + maxX) / 2;\r\n                const rotationHandleY = minY - 20;\r\n                const rotationHandleSize = 8;\r\n                // Vrifier si on est sur la poigne de rotation\r\n                const distance = Math.sqrt((x - centerX) ** 2 + (y - rotationHandleY) ** 2);\r\n                if (distance <= rotationHandleSize / 2) {\r\n                    return 'grab';\r\n                }\r\n            }\r\n        }\r\n        // Vrifier si on est sur une poigne de redimensionnement\r\n        const resizeHandle = getResizeHandleAtPosition(x, y, state.selection.selectedElements, state.elements);\r\n        if (resizeHandle) {\r\n            return getResizeCursor(resizeHandle.handle);\r\n        }\r\n        // Vrifier si on est sur un lment slectionn (pour le dplacement)\r\n        if (state.selection.selectedElements.length > 0) {\r\n            const elementUnderMouse = state.elements.find(el => state.selection.selectedElements.includes(el.id) &&\r\n                isPointInElement(x, y, el));\r\n            if (elementUnderMouse) {\r\n                return 'grab';\r\n            }\r\n        }\r\n        // Curseur par dfaut\r\n        return 'default';\r\n    }, [state.selection.selectedElements, state.elements, getResizeHandleAtPosition, canvasSettings.selectionRotationEnabled]);\r\n    // Fonction pour mettre  jour le curseur du canvas\r\n    const updateCursor = useCallback((cursor) => {\r\n        const canvas = canvasRef.current;\r\n        if (canvas && cursor !== currentCursorRef.current) {\r\n            canvas.style.cursor = cursor;\r\n            currentCursorRef.current = cursor;\r\n        }\r\n    }, [canvasRef]);\r\n    // Fonction utilitaire pour calculer le redimensionnement\r\n    const calculateResize = useCallback((element, handle, currentX, currentY, _startPos) => {\r\n        const updates = {};\r\n        const MIN_SIZE = 20;\r\n        switch (handle) {\r\n            case 'se': { // Sud-Est (coin bas-droit) - coin suit directement la souris\r\n                updates.width = Math.max(MIN_SIZE, currentX - element.x);\r\n                updates.height = Math.max(MIN_SIZE, currentY - element.y);\r\n                break;\r\n            }\r\n            case 'sw': { // Sud-Ouest (coin bas-gauche)\r\n                const newX = Math.min(currentX, element.x + element.width - MIN_SIZE);\r\n                updates.width = Math.max(MIN_SIZE, element.x + element.width - newX);\r\n                updates.x = newX;\r\n                updates.height = Math.max(MIN_SIZE, currentY - element.y);\r\n                break;\r\n            }\r\n            case 'ne': { // Nord-Est (coin haut-droit)\r\n                const newY = Math.min(currentY, element.y + element.height - MIN_SIZE);\r\n                updates.width = Math.max(MIN_SIZE, currentX - element.x);\r\n                updates.height = Math.max(MIN_SIZE, element.y + element.height - newY);\r\n                updates.y = newY;\r\n                break;\r\n            }\r\n            case 'nw': { // Nord-Ouest (coin haut-gauche) - coin suit directement la souris\r\n                const newX = Math.min(currentX, element.x + element.width - MIN_SIZE);\r\n                const newY = Math.min(currentY, element.y + element.height - MIN_SIZE);\r\n                updates.width = Math.max(MIN_SIZE, element.x + element.width - newX);\r\n                updates.height = Math.max(MIN_SIZE, element.y + element.height - newY);\r\n                updates.x = newX;\r\n                updates.y = newY;\r\n                break;\r\n            }\r\n            case 'n': { // Nord (haut)\r\n                const newY = Math.min(currentY, element.y + element.height - MIN_SIZE);\r\n                updates.height = Math.max(MIN_SIZE, element.y + element.height - newY);\r\n                updates.y = newY;\r\n                break;\r\n            }\r\n            case 's': { // Sud (bas) - coin suit directement la souris\r\n                updates.height = Math.max(MIN_SIZE, currentY - element.y);\r\n                break;\r\n            }\r\n            case 'w': { // Ouest (gauche)\r\n                const newX = Math.min(currentX, element.x + element.width - MIN_SIZE);\r\n                updates.width = Math.max(MIN_SIZE, element.x + element.width - newX);\r\n                updates.x = newX;\r\n                break;\r\n            }\r\n            case 'e': { // Est (droite) - coin suit directement la souris\r\n                updates.width = Math.max(MIN_SIZE, currentX - element.x);\r\n                break;\r\n            }\r\n        }\r\n        //  AJOUT: Appliquer le snap  la grille pour les positions lors du redimensionnement\r\n        if (state.canvas.snapToGrid && state.canvas.gridSize > 0) {\r\n            const gridSize = state.canvas.gridSize;\r\n            const snapTolerance = 5;\r\n            if (updates.x !== undefined) {\r\n                const nearestGridX = Math.round(updates.x / gridSize) * gridSize;\r\n                if (Math.abs(updates.x - nearestGridX) <= snapTolerance) {\r\n                    updates.x = nearestGridX;\r\n                }\r\n            }\r\n            if (updates.y !== undefined) {\r\n                const nearestGridY = Math.round(updates.y / gridSize) * gridSize;\r\n                if (Math.abs(updates.y - nearestGridY) <= snapTolerance) {\r\n                    updates.y = nearestGridY;\r\n                }\r\n            }\r\n        }\r\n        return updates;\r\n    }, [state.canvas.snapToGrid, state.canvas.gridSize]);\r\n    // Gestionnaire de mouse move pour le drag, resize et curseur\r\n    const handleMouseMove = useCallback((event) => {\r\n        //  CORRECTION 3: Throttling - limiter la frquence des updates\r\n        const now = Date.now();\r\n        if (now - lastMouseMoveTimeRef.current < MOUSEMOVE_THROTTLE_MS) {\r\n            return; // Skip cet event, trop rapide\r\n        }\r\n        lastMouseMoveTimeRef.current = now;\r\n        const canvas = canvasRef.current;\r\n        if (!canvas)\r\n            return;\r\n        const rect = canvas.getBoundingClientRect();\r\n        // Note: zoom est en pourcentage (100%), donc diviser par 100 pour obtenir le facteur d'chelle\r\n        const zoomScale = state.canvas.zoom / 100;\r\n        // Calcul correct des coordonnes avec zoom et pan\r\n        const canvasRelativeX = event.clientX - rect.left;\r\n        const canvasRelativeY = event.clientY - rect.top;\r\n        const x = (canvasRelativeX - state.canvas.pan.x) / zoomScale;\r\n        const y = (canvasRelativeY - state.canvas.pan.y) / zoomScale;\r\n        // Mettre  jour le curseur\r\n        const cursor = getCursorAtPosition(x, y);\r\n        updateCursor(cursor);\r\n        // Grer la slection lasso/rectangle en cours\r\n        // Note: Si les listeners globaux sont actifs, la gestion se fait dans globalMouseMoveRef\r\n        if (isSelectingRef.current && !globalMouseMoveRef.current) {\r\n            if (selectionMode === 'lasso') {\r\n                // Ajouter le point actuel au lasso\r\n                selectionPointsRef.current.push({ x, y });\r\n                // Forcer le re-rendu pour afficher le lasso en temps rel\r\n                setSelectionUpdateTrigger(prev => prev + 1);\r\n            }\r\n            else if (selectionMode === 'rectangle') {\r\n                // Mettre  jour le rectangle de slection\r\n                const startX = Math.min(selectionStartRef.current.x, x);\r\n                const startY = Math.min(selectionStartRef.current.y, y);\r\n                const width = Math.abs(x - selectionStartRef.current.x);\r\n                const height = Math.abs(y - selectionStartRef.current.y);\r\n                selectionRectRef.current = { x: startX, y: startY, width, height };\r\n                // Forcer le re-rendu pour afficher le rectangle en temps rel\r\n                setSelectionUpdateTrigger(prev => prev + 1);\r\n            }\r\n            return;\r\n        }\r\n        if (isDraggingRef.current && selectedElementRef.current) {\r\n            //  OPTIMISATION FLUIDIT: Pour le drag multiple, passer directement les coordonnes actuelles de la souris\r\n            // performDragUpdate calculera la nouvelle position pour chaque lment individuellement\r\n            pendingDragUpdateRef.current = { x, y };\r\n            // Programmer l'update avec RAF si pas dj programm\r\n            if (rafIdRef.current === null) {\r\n                rafIdRef.current = requestAnimationFrame(performDragUpdate);\r\n            }\r\n        }\r\n        else if (isResizingRef.current && selectedElementRef.current && resizeHandleRef.current) {\r\n            debugLog(`[CanvasInteraction] Resizing element ${selectedElementRef.current} with handle ${resizeHandleRef.current} at (${x.toFixed(1)}, ${y.toFixed(1)})`);\r\n            //  BALANCED: Preserve essential properties without overkill\r\n            const lastState = lastKnownStateRef.current;\r\n            const element = lastState.elements.find(el => el.id === selectedElementRef.current);\r\n            if (!element)\r\n                return;\r\n            const resizeUpdates = calculateResize(element, resizeHandleRef.current, x, y, resizeMouseStartRef.current);\r\n            //  Preserve essential visual properties (corners, styling, etc.)\r\n            const essentialUpdates = { ...resizeUpdates };\r\n            // Keep all properties except the ones we're updating and updatedAt\r\n            const elementAsRecord = element;\r\n            Object.keys(elementAsRecord).forEach(key => {\r\n                if (!(key in resizeUpdates) && key !== 'updatedAt') {\r\n                    essentialUpdates[key] = elementAsRecord[key];\r\n                }\r\n            });\r\n            dispatch({\r\n                type: 'UPDATE_ELEMENT',\r\n                payload: {\r\n                    id: selectedElementRef.current,\r\n                    updates: essentialUpdates\r\n                }\r\n            });\r\n        }\r\n        else if (isRotatingRef.current && state.selection.selectedElements.length > 0) {\r\n            debugLog(`[CanvasInteraction] Rotating ${state.selection.selectedElements.length} elements at mouse position (${x.toFixed(1)}, ${y.toFixed(1)})`);\r\n            //  OPTIMISATION FLUIDIT: Pour la rotation, passer les coordonnes actuelles de la souris\r\n            // performRotationUpdate calculera la rotation pour tous les lments\r\n            pendingRotationUpdateRef.current = { x, y };\r\n            // Programmer l'update avec RAF si pas dj programm\r\n            if (rafIdRef.current === null) {\r\n                rafIdRef.current = requestAnimationFrame(performRotationUpdate);\r\n            }\r\n        }\r\n    }, [dispatch, canvasRef, getCursorAtPosition, updateCursor, calculateResize, state.canvas, performDragUpdate]);\r\n    // Cleanup des listeners globaux au dmontage du composant\r\n    useEffect(() => {\r\n        return () => {\r\n            stopGlobalSelectionListeners();\r\n        };\r\n    }, [stopGlobalSelectionListeners]);\r\n    // Gestionnaire de clic droit pour afficher le menu contextuel\r\n    const handleContextMenu = useCallback((event, onContextMenu) => {\r\n        event.preventDefault(); // Empcher le menu contextuel par dfaut du navigateur\r\n        const canvas = canvasRef.current;\r\n        if (!canvas)\r\n            return;\r\n        // Pour le menu contextuel, nous utilisons les coordonnes absolues de la souris\r\n        // (pas les coordonnes transformes du canvas)\r\n        const menuX = event.clientX;\r\n        const menuY = event.clientY;\r\n        // Pour la dtection d'lment, nous utilisons les coordonnes du canvas\r\n        // Les lments sont stocks dans l'espace monde (avec pan et zoom)\r\n        // Pour la dtection, utilisons les coordonnes dans l'espace canvas\r\n        const rect = canvas.getBoundingClientRect();\r\n        const rawCanvasX = event.clientX - rect.left;\r\n        const rawCanvasY = event.clientY - rect.top;\r\n        // Transformer en coordonnes monde (inverse des transformations du canvas)\r\n        // Note: zoom est en pourcentage (100%), donc diviser par 100 pour obtenir le facteur d'chelle\r\n        const zoomScale = state.canvas.zoom / 100;\r\n        const canvasX = (rawCanvasX - state.canvas.pan.x) / zoomScale;\r\n        const canvasY = (rawCanvasY - state.canvas.pan.y) / zoomScale;\r\n        // Trouver l'lment cliqu (avec hitbox adapte)\r\n        const clickedElement = state.elements.find(el => isPointInElement(canvasX, canvasY, el));\r\n        if (clickedElement) {\r\n            // Ouvrir le menu contextuel pour l'lment\r\n            onContextMenu(menuX, menuY, clickedElement.id);\r\n        }\r\n        else {\r\n            // Ouvrir le menu contextuel gnral du canvas\r\n            onContextMenu(menuX, menuY);\r\n        }\r\n    }, [state, canvasRef]);\r\n    // Fonctions helper pour la slection avance\r\n    const isElementInRectangle = useCallback((element, rect) => {\r\n        // Vrifier si l'lment intersecte ou est contenu dans le rectangle\r\n        const elementRight = element.x + element.width;\r\n        const elementBottom = element.y + element.height;\r\n        const rectRight = rect.x + rect.width;\r\n        const rectBottom = rect.y + rect.height;\r\n        // Vrifier l'intersection\r\n        return !(element.x > rectRight || elementRight < rect.x || element.y > rectBottom || elementBottom < rect.y);\r\n    }, []);\r\n    const isElementInLasso = useCallback((element, points) => {\r\n        if (points.length < 3)\r\n            return false;\r\n        // Utiliser l'algorithme du point dans le polygone (ray casting)\r\n        // Vrifier si le centre de l'lment est dans le lasso\r\n        const centerX = element.x + element.width / 2;\r\n        const centerY = element.y + element.height / 2;\r\n        return isPointInPolygon(centerX, centerY, points);\r\n    }, []);\r\n    const isPointInPolygon = (x, y, polygon) => {\r\n        let inside = false;\r\n        for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {\r\n            const xi = polygon[i].x, yi = polygon[i].y;\r\n            const xj = polygon[j].x, yj = polygon[j].y;\r\n            if (((yi > y) !== (yj > y)) && (x < (xj - xi) * (y - yi) / (yj - yi) + xi)) {\r\n                inside = !inside;\r\n            }\r\n        }\r\n        return inside;\r\n    };\r\n    return {\r\n        handleCanvasClick,\r\n        handleMouseDown,\r\n        handleMouseMove,\r\n        handleMouseUp,\r\n        handleContextMenu,\r\n        // Informations pour le rendu visuel de la slection\r\n        selectionState: {\r\n            isSelecting: isSelectingRef.current,\r\n            selectionMode,\r\n            selectionRect: selectionRectRef.current,\r\n            selectionPoints: selectionPointsRef.current,\r\n            updateTrigger: selectionUpdateTrigger\r\n        }\r\n    };\r\n};\r\n","import { useEffect, useCallback, useRef } from 'react';\r\nimport { useBuilder } from '../contexts/builder/BuilderContext';\r\nimport { useCanvasSetting } from './useCanvasSettings';\r\nimport { debugLog } from '../utils/debug';\r\n/**\r\n * Hook pour grer les raccourcis clavier du canvas\r\n * Implmente les raccourcis configurables via les paramtres canvas\r\n */\r\nexport const useKeyboardShortcuts = () => {\r\n    const { state, dispatch } = useBuilder();\r\n    const keyboardShortcutsEnabled = useCanvasSetting('enable_keyboard_shortcuts', true);\r\n    // Rfrences pour viter les closures stale\r\n    const stateRef = useRef(state);\r\n    const dispatchRef = useRef(dispatch);\r\n    // Mettre  jour les rfrences\r\n    useEffect(() => {\r\n        stateRef.current = state;\r\n        dispatchRef.current = dispatch;\r\n    }, [state, dispatch]);\r\n    /**\r\n     * Gre les vnements clavier\r\n     */\r\n    const handleKeyDown = useCallback((event) => {\r\n        const keyboardEvent = event;\r\n        // Ne pas traiter si les raccourcis sont dsactivs\r\n        if (!keyboardShortcutsEnabled) {\r\n            debugLog('[KeyboardShortcuts] Shortcuts disabled - ignoring key event');\r\n            return;\r\n        }\r\n        // Ne pas traiter si on est dans un champ de saisie\r\n        const target = event.target;\r\n        if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA' || target.contentEditable === 'true') {\r\n            debugLog('[KeyboardShortcuts] Ignoring key event in input field');\r\n            return;\r\n        }\r\n        const { ctrlKey, metaKey, key, shiftKey } = keyboardEvent;\r\n        const isCtrlOrCmd = ctrlKey || metaKey;\r\n        const shortcut = `${isCtrlOrCmd ? (ctrlKey ? 'Ctrl' : 'Cmd') : ''}${shiftKey ? '+Shift' : ''}+${key.toUpperCase()}`;\r\n        debugLog(`[KeyboardShortcuts] Key pressed: ${shortcut}`);\r\n        switch (key.toLowerCase()) {\r\n            case 'z':\r\n                if (isCtrlOrCmd) {\r\n                    event.preventDefault();\r\n                    if (shiftKey) {\r\n                        // Ctrl+Y ou Cmd+Shift+Z pour redo\r\n                        debugLog('[KeyboardShortcuts] Executing redo (Ctrl+Shift+Z)');\r\n                        dispatchRef.current({ type: 'REDO' });\r\n                    }\r\n                    else {\r\n                        // Ctrl+Z pour undo\r\n                        debugLog('[KeyboardShortcuts] Executing undo (Ctrl+Z)');\r\n                        dispatchRef.current({ type: 'UNDO' });\r\n                    }\r\n                }\r\n                break;\r\n            case 'y':\r\n                if (isCtrlOrCmd && !shiftKey) {\r\n                    event.preventDefault();\r\n                    // Ctrl+Y pour redo\r\n                    debugLog('[KeyboardShortcuts] Executing redo (Ctrl+Y)');\r\n                    dispatchRef.current({ type: 'REDO' });\r\n                }\r\n                break;\r\n            case 'a':\r\n                if (isCtrlOrCmd) {\r\n                    event.preventDefault();\r\n                    // Ctrl+A pour tout slectionner\r\n                    const allElementIds = stateRef.current.elements.map(el => el.id);\r\n                    debugLog(`[KeyboardShortcuts] Selecting all elements (${allElementIds.length} elements)`);\r\n                    dispatchRef.current({\r\n                        type: 'SET_SELECTION',\r\n                        payload: allElementIds\r\n                    });\r\n                }\r\n                break;\r\n            case 'delete':\r\n            case 'backspace':\r\n                // Supprimer les lments slectionns\r\n                if (stateRef.current.selection.selectedElements.length > 0) {\r\n                    event.preventDefault();\r\n                    debugLog(`[KeyboardShortcuts] Deleting ${stateRef.current.selection.selectedElements.length} selected elements`);\r\n                    // Supprimer tous les lments slectionns\r\n                    stateRef.current.selection.selectedElements.forEach(elementId => {\r\n                        dispatchRef.current({\r\n                            type: 'REMOVE_ELEMENT',\r\n                            payload: elementId\r\n                        });\r\n                    });\r\n                    // Vider la slection aprs suppression\r\n                    dispatchRef.current({ type: 'CLEAR_SELECTION' });\r\n                }\r\n                break;\r\n            case 'c':\r\n                if (isCtrlOrCmd) {\r\n                    event.preventDefault();\r\n                    // Ctrl+C pour copier (si des lments sont slectionns)\r\n                    if (stateRef.current.selection.selectedElements.length > 0) {\r\n                        debugLog(`[KeyboardShortcuts] Copying ${stateRef.current.selection.selectedElements.length} selected elements`);\r\n                        // TODO: Implmenter la logique de copie\r\n                    }\r\n                }\r\n                break;\r\n            case 'v':\r\n                if (isCtrlOrCmd) {\r\n                    event.preventDefault();\r\n                    // Ctrl+V pour coller\r\n                    debugLog('[KeyboardShortcuts] Pasting elements');\r\n                    // TODO: Implmenter la logique de collage\r\n                }\r\n                break;\r\n            case 'd':\r\n                if (isCtrlOrCmd) {\r\n                    event.preventDefault();\r\n                    // Ctrl+D pour dupliquer (optionnel)\r\n                    if (stateRef.current.selection.selectedElements.length > 0) {\r\n                        debugLog(`[KeyboardShortcuts] Duplicating ${stateRef.current.selection.selectedElements.length} selected elements`);\r\n                        // TODO: Implmenter la logique de duplication\r\n                    }\r\n                }\r\n                break;\r\n            default:\r\n                // Autres raccourcis peuvent tre ajouts ici\r\n                debugLog(`[KeyboardShortcuts] Unhandled key: ${shortcut}`);\r\n                break;\r\n        }\r\n    }, [keyboardShortcutsEnabled]);\r\n    /**\r\n     * Configure les couteurs d'vnements\r\n     */\r\n    useEffect(() => {\r\n        if (!keyboardShortcutsEnabled) {\r\n            debugLog('[KeyboardShortcuts] Keyboard shortcuts disabled');\r\n            return;\r\n        }\r\n        debugLog('[KeyboardShortcuts] Initializing keyboard shortcuts');\r\n        // Ajouter l'couteur d'vnements\r\n        document.addEventListener('keydown', handleKeyDown);\r\n        // Nettoyer l'couteur\r\n        return () => {\r\n            debugLog('[KeyboardShortcuts] Cleaning up keyboard shortcuts');\r\n            document.removeEventListener('keydown', handleKeyDown);\r\n        };\r\n    }, [handleKeyDown, keyboardShortcutsEnabled]);\r\n    // Retourner des informations sur l'tat des raccourcis\r\n    return {\r\n        keyboardShortcutsEnabled,\r\n        hasSelection: state.selection.selectedElements.length > 0,\r\n        canUndo: state.history.past.length > 0,\r\n        canRedo: state.history.future.length > 0,\r\n    };\r\n};\r\n","export class WooCommerceElementsManager {\r\n    constructor() {\r\n        this.orderData = null;\r\n        this.customerData = null;\r\n    }\r\n    /**\r\n     * Charge les donnes de commande WooCommerce\r\n     */\r\n    async loadOrderData(orderId) {\r\n        // Simulation d'un appel API WooCommerce\r\n        // En production, ceci ferait un appel  l'API REST WooCommerce\r\n        const response = await this.mockFetchOrderData(orderId);\r\n        this.orderData = response;\r\n        return response;\r\n    }\r\n    /**\r\n     * Charge les donnes client WooCommerce\r\n     */\r\n    async loadCustomerData(customerId) {\r\n        // Simulation d'un appel API WooCommerce\r\n        const response = await this.mockFetchCustomerData(customerId);\r\n        this.customerData = response;\r\n        return response;\r\n    }\r\n    /**\r\n     * Obtient les donnes de commande actuelles\r\n     */\r\n    getOrderData() {\r\n        return this.orderData;\r\n    }\r\n    /**\r\n     * Obtient les donnes client actuelles\r\n     */\r\n    getCustomerData() {\r\n        return this.customerData;\r\n    }\r\n    /**\r\n     * Obtient le numro de commande format\r\n     */\r\n    getOrderNumber() {\r\n        if (!this.orderData)\r\n            return 'CMD-XXXX-XXXX';\r\n        return this.orderData.order_number || `CMD-${this.orderData.id}`;\r\n    }\r\n    /**\r\n     * Obtient les informations client formates\r\n     */\r\n    getCustomerInfo() {\r\n        var _a, _b;\r\n        if (!this.customerData && !this.orderData) {\r\n            return {\r\n                name: 'Client Inconnu',\r\n                address: 'Adresse non disponible',\r\n                email: 'email@inconnu.com',\r\n                phone: '+33 0 00 00 00 00'\r\n            };\r\n        }\r\n        const billing = ((_a = this.customerData) === null || _a === void 0 ? void 0 : _a.billing) || ((_b = this.orderData) === null || _b === void 0 ? void 0 : _b.billing);\r\n        if (!billing) {\r\n            return {\r\n                name: 'Client Inconnu',\r\n                address: 'Adresse non disponible',\r\n                email: 'email@inconnu.com',\r\n                phone: '+33 0 00 00 00 00'\r\n            };\r\n        }\r\n        const fullName = `${billing.first_name} ${billing.last_name}`.trim();\r\n        const address = [\r\n            billing.address_1,\r\n            billing.address_2,\r\n            `${billing.postcode} ${billing.city}`,\r\n            billing.country\r\n        ].filter(Boolean).join(', ');\r\n        return {\r\n            name: fullName || 'Client Inconnu',\r\n            address: address || 'Adresse non disponible',\r\n            email: billing.email || 'email@inconnu.com',\r\n            phone: billing.phone || '+33 0 00 00 00 00'\r\n        };\r\n    }\r\n    /**\r\n     * Obtient les articles de commande formats pour l'affichage\r\n     */\r\n    getOrderItems() {\r\n        if (!this.orderData) {\r\n            return [];\r\n        }\r\n        return this.orderData.line_items.map(item => ({\r\n            sku: item.sku || `SKU-${item.product_id}`,\r\n            name: item.name,\r\n            description: this.getProductDescription(item),\r\n            qty: item.quantity,\r\n            price: parseFloat(item.subtotal) / item.quantity,\r\n            discount: this.calculateItemDiscount(item),\r\n            total: parseFloat(item.total)\r\n        }));\r\n    }\r\n    /**\r\n     * Calcule les totaux de commande\r\n     */\r\n    getOrderTotals() {\r\n        if (!this.orderData) {\r\n            return {\r\n                subtotal: 0,\r\n                discount: 0,\r\n                shipping: 0,\r\n                tax: 0,\r\n                total: 0,\r\n                currency: 'EUR'\r\n            };\r\n        }\r\n        const subtotal = parseFloat(this.orderData.subtotal);\r\n        const discount = parseFloat(this.orderData.discount_total);\r\n        const shipping = parseFloat(this.orderData.shipping_total);\r\n        const tax = parseFloat(this.orderData.total_tax);\r\n        const total = parseFloat(this.orderData.total);\r\n        return {\r\n            subtotal,\r\n            discount,\r\n            shipping,\r\n            tax,\r\n            total,\r\n            currency: this.orderData.currency\r\n        };\r\n    }\r\n    /**\r\n     * Obtient la date de commande formate\r\n     */\r\n    getOrderDate() {\r\n        if (!this.orderData)\r\n            return new Date().toLocaleDateString('fr-FR');\r\n        return new Date(this.orderData.date_created).toLocaleDateString('fr-FR');\r\n    }\r\n    /**\r\n     * Rinitialise les donnes\r\n     */\r\n    reset() {\r\n        this.orderData = null;\r\n        this.customerData = null;\r\n    }\r\n    // Mthodes prives\r\n    getProductDescription(item) {\r\n        // Recherche dans les meta_data pour une description\r\n        const descriptionMeta = item.meta_data.find(meta => meta.key === '_description');\r\n        return (descriptionMeta === null || descriptionMeta === void 0 ? void 0 : descriptionMeta.value) || 'Description non disponible';\r\n    }\r\n    calculateItemDiscount(item) {\r\n        const subtotal = parseFloat(item.subtotal);\r\n        const total = parseFloat(item.total);\r\n        return Math.max(0, subtotal - total);\r\n    }\r\n    // Mthodes de simulation ( remplacer par de vrais appels API)\r\n    async mockFetchOrderData(orderId) {\r\n        // Simulation d'un dlai rseau\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n        // Donnes fictives ralistes\r\n        return {\r\n            id: parseInt(orderId),\r\n            order_number: `CMD-2024-${orderId.padStart(4, '0')}`,\r\n            status: 'completed',\r\n            currency: 'EUR',\r\n            date_created: new Date().toISOString(),\r\n            date_modified: new Date().toISOString(),\r\n            total: '279.96',\r\n            subtotal: '259.96',\r\n            total_tax: '20.00',\r\n            shipping_total: '8.50',\r\n            discount_total: '15.00',\r\n            customer_id: 123,\r\n            billing: {\r\n                first_name: 'Marie',\r\n                last_name: 'Dupont',\r\n                company: '',\r\n                address_1: '15 rue des Lilas',\r\n                address_2: '',\r\n                city: 'Paris',\r\n                state: '',\r\n                postcode: '75001',\r\n                country: 'FR',\r\n                email: 'marie.dupont@email.com',\r\n                phone: '+33 6 12 34 56 78'\r\n            },\r\n            shipping: {\r\n                first_name: 'Marie',\r\n                last_name: 'Dupont',\r\n                company: '',\r\n                address_1: '15 rue des Lilas',\r\n                address_2: '',\r\n                city: 'Paris',\r\n                state: '',\r\n                postcode: '75001',\r\n                country: 'FR'\r\n            },\r\n            line_items: [\r\n                {\r\n                    id: 1,\r\n                    name: 'T-shirt Premium Bio',\r\n                    product_id: 123,\r\n                    variation_id: 0,\r\n                    quantity: 2,\r\n                    tax_class: '',\r\n                    subtotal: '59.98',\r\n                    subtotal_tax: '11.996',\r\n                    total: '59.98',\r\n                    total_tax: '11.996',\r\n                    taxes: [{ id: 1, total: '11.996', subtotal: '11.996' }],\r\n                    meta_data: [],\r\n                    sku: 'TSHIRT-001',\r\n                    price: 29.99\r\n                },\r\n                {\r\n                    id: 2,\r\n                    name: 'Jean Slim Fit Noir',\r\n                    product_id: 456,\r\n                    variation_id: 0,\r\n                    quantity: 1,\r\n                    tax_class: '',\r\n                    subtotal: '89.99',\r\n                    subtotal_tax: '17.998',\r\n                    total: '79.99',\r\n                    total_tax: '15.998',\r\n                    taxes: [{ id: 1, total: '15.998', subtotal: '17.998' }],\r\n                    meta_data: [],\r\n                    sku: 'JEAN-045',\r\n                    price: 89.99\r\n                }\r\n            ],\r\n            shipping_lines: [{\r\n                    id: 1,\r\n                    method_title: 'Livraison Standard',\r\n                    method_id: 'flat_rate',\r\n                    total: '8.50',\r\n                    total_tax: '0.00',\r\n                    taxes: []\r\n                }],\r\n            tax_lines: [{\r\n                    id: 1,\r\n                    rate_code: 'FR-TVA-20',\r\n                    rate_id: 1,\r\n                    label: 'TVA (20%)',\r\n                    compound: false,\r\n                    tax_total: '20.00',\r\n                    shipping_tax_total: '0.00',\r\n                    rate_percent: 20\r\n                }],\r\n            coupon_lines: [{\r\n                    id: 1,\r\n                    code: 'ETE2024',\r\n                    discount: '15.00',\r\n                    discount_tax: '0.00'\r\n                }]\r\n        };\r\n    }\r\n    async mockFetchCustomerData(customerId) {\r\n        // Simulation d'un dlai rseau\r\n        await new Promise(resolve => setTimeout(resolve, 50));\r\n        return {\r\n            id: customerId,\r\n            date_created: new Date().toISOString(),\r\n            date_modified: new Date().toISOString(),\r\n            email: 'marie.dupont@email.com',\r\n            first_name: 'Marie',\r\n            last_name: 'Dupont',\r\n            role: 'customer',\r\n            username: 'marie_dupont',\r\n            billing: {\r\n                first_name: 'Marie',\r\n                last_name: 'Dupont',\r\n                company: '',\r\n                address_1: '15 rue des Lilas',\r\n                address_2: '',\r\n                city: 'Paris',\r\n                state: '',\r\n                postcode: '75001',\r\n                country: 'FR',\r\n                email: 'marie.dupont@email.com',\r\n                phone: '+33 6 12 34 56 78'\r\n            },\r\n            shipping: {\r\n                first_name: 'Marie',\r\n                last_name: 'Dupont',\r\n                company: '',\r\n                address_1: '15 rue des Lilas',\r\n                address_2: '',\r\n                city: 'Paris',\r\n                state: '',\r\n                postcode: '75001',\r\n                country: 'FR'\r\n            }\r\n        };\r\n    }\r\n}\r\n// Instance singleton\r\nexport const wooCommerceManager = new WooCommerceElementsManager();\r\n","/**\r\n *  REAL-TIME ELEMENT & PROPERTY CHANGE TRACKER\r\n *\r\n * Tracks all element changes, property modifications, and canvas updates\r\n * in real-time with detailed logging and diff detection.\r\n */\r\nexport class ElementChangeTracker {\r\n    constructor() {\r\n        this.previousSnapshots = new Map();\r\n        this.changeHistory = [];\r\n        this.maxHistorySize = 500;\r\n        this.listeners = [];\r\n        this.debugEnabled = false; // Set to true to enable logging\r\n    }\r\n    /**\r\n     * Track element state at a specific point in time\r\n     */\r\n    trackElements(elements) {\r\n        const currentSnapshots = new Map();\r\n        const changes = [];\r\n        elements.forEach((element) => {\r\n            const snapshot = {\r\n                ...element,\r\n                timestamp: Date.now()\r\n            };\r\n            currentSnapshots.set(element.id, snapshot);\r\n            const previousSnapshot = this.previousSnapshots.get(element.id);\r\n            if (!previousSnapshot) {\r\n                // Element created\r\n                changes.push({\r\n                    elementId: element.id,\r\n                    property: '__created__',\r\n                    oldValue: undefined,\r\n                    newValue: snapshot,\r\n                    timestamp: snapshot.timestamp,\r\n                    changeType: 'created'\r\n                });\r\n            }\r\n            else {\r\n                // Check for property changes\r\n                this.detectPropertyChanges(previousSnapshot, snapshot, changes);\r\n            }\r\n        });\r\n        // Check for deleted elements\r\n        this.previousSnapshots.forEach((snapshot, elementId) => {\r\n            if (!currentSnapshots.has(elementId)) {\r\n                changes.push({\r\n                    elementId,\r\n                    property: '__deleted__',\r\n                    oldValue: snapshot,\r\n                    newValue: undefined,\r\n                    timestamp: Date.now(),\r\n                    changeType: 'deleted'\r\n                });\r\n            }\r\n        });\r\n        this.previousSnapshots = currentSnapshots;\r\n        this.addChangesToHistory(changes);\r\n        this.notifyListeners(changes);\r\n        return changes;\r\n    }\r\n    /**\r\n     * Detect all property changes between two snapshots\r\n     */\r\n    detectPropertyChanges(previous, current, changes) {\r\n        const allKeys = new Set([\r\n            ...Object.keys(previous),\r\n            ...Object.keys(current)\r\n        ]);\r\n        allKeys.forEach(key => {\r\n            if (key === 'timestamp')\r\n                return;\r\n            const oldValue = previous[key];\r\n            const newValue = current[key];\r\n            // Deep comparison for objects/arrays\r\n            if (JSON.stringify(oldValue) !== JSON.stringify(newValue)) {\r\n                changes.push({\r\n                    elementId: previous.id,\r\n                    property: key,\r\n                    oldValue,\r\n                    newValue,\r\n                    timestamp: current.timestamp,\r\n                    changeType: 'property_changed'\r\n                });\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Get emoji for different property types\r\n     */\r\n    getPropertyEmoji(property) {\r\n        const emojiMap = {\r\n            x: '',\r\n            y: '',\r\n            width: '',\r\n            height: '',\r\n            rotation: '',\r\n            opacity: '',\r\n            visible: '',\r\n            locked: '',\r\n            color: '',\r\n            fillColor: '',\r\n            strokeColor: '',\r\n            fontSize: '',\r\n            fontFamily: '',\r\n            text: '',\r\n            src: '',\r\n            url: '',\r\n            backgroundColor: '',\r\n            textColor: '',\r\n            borderColor: '',\r\n            borderRadius: '',\r\n            showHeaders: '',\r\n            showBorders: '',\r\n            showAlternatingRows: ''\r\n        };\r\n        return emojiMap[property] || '';\r\n    }\r\n    /**\r\n     * Determine the type of property\r\n     */\r\n    getPropertyType(value) {\r\n        if (value === null)\r\n            return 'null';\r\n        if (Array.isArray(value))\r\n            return `array[${value.length}]`;\r\n        if (typeof value === 'object')\r\n            return `object{${Object.keys(value).length}}`;\r\n        return typeof value;\r\n    }\r\n    /**\r\n     * Format value for logging\r\n     */\r\n    formatValue(value, maxLength = 50) {\r\n        if (value === undefined)\r\n            return 'undefined';\r\n        if (value === null)\r\n            return 'null';\r\n        if (typeof value === 'boolean')\r\n            return value ? ' true' : ' false';\r\n        if (typeof value === 'number')\r\n            return value.toFixed(2);\r\n        if (typeof value === 'string') {\r\n            const truncated = value.length > maxLength ? value.slice(0, maxLength) + '...' : value;\r\n            return `\"${truncated}\"`;\r\n        }\r\n        if (Array.isArray(value))\r\n            return `[${value.length} items]`;\r\n        if (typeof value === 'object')\r\n            return `{${Object.keys(value).length} props}`;\r\n        return String(value);\r\n    }\r\n    /**\r\n     * Add changes to history with size limit\r\n     */\r\n    addChangesToHistory(changes) {\r\n        this.changeHistory.push(...changes);\r\n        if (this.changeHistory.length > this.maxHistorySize) {\r\n            this.changeHistory = this.changeHistory.slice(-this.maxHistorySize);\r\n        }\r\n    }\r\n    /**\r\n     * Notify all registered listeners\r\n     */\r\n    notifyListeners(changes) {\r\n        changes.forEach(change => {\r\n            this.listeners.forEach(listener => listener(change));\r\n        });\r\n    }\r\n    /**\r\n     * Subscribe to changes\r\n     */\r\n    onChange(callback) {\r\n        this.listeners.push(callback);\r\n        return () => {\r\n            this.listeners = this.listeners.filter(l => l !== callback);\r\n        };\r\n    }\r\n    /**\r\n     * Get change history\r\n     */\r\n    getHistory() {\r\n        return [...this.changeHistory];\r\n    }\r\n    /**\r\n     * Get changes for a specific element\r\n     */\r\n    getElementHistory(elementId) {\r\n        return this.changeHistory.filter(c => c.elementId === elementId);\r\n    }\r\n    /**\r\n     * Get all changes for a specific property\r\n     */\r\n    getPropertyHistory(property) {\r\n        return this.changeHistory.filter(c => c.property === property || c.changeType === 'created');\r\n    }\r\n    /**\r\n     * Get changes within a time range\r\n     */\r\n    getChangesBetween(startTime, endTime) {\r\n        return this.changeHistory.filter(c => c.timestamp >= startTime && c.timestamp <= endTime);\r\n    }\r\n    /**\r\n     * Reset history (but keep current snapshots)\r\n     */\r\n    clearHistory() {\r\n        this.changeHistory = [];\r\n    }\r\n    /**\r\n     * Get current snapshots\r\n     */\r\n    getSnapshots() {\r\n        return new Map(this.previousSnapshots);\r\n    }\r\n    /**\r\n     * Generate a detailed report\r\n     */\r\n    generateReport() {\r\n        const totalChanges = this.changeHistory.length;\r\n        const elementsTracked = this.previousSnapshots.size;\r\n        const changeSummary = this.changeHistory.reduce((acc, change) => {\r\n            acc[change.changeType] = (acc[change.changeType] || 0) + 1;\r\n            return acc;\r\n        }, {});\r\n        return `\r\n ELEMENT TRACKER REPORT\r\n========================\r\nTotal Changes: ${totalChanges}\r\nElements Tracked: ${elementsTracked}\r\nChange Breakdown:\r\n  - Created: ${changeSummary.created || 0}\r\n  - Updated: ${changeSummary.updated || 0}\r\n  - Deleted: ${changeSummary.deleted || 0}\r\n  - Property Changes: ${changeSummary.property_changed || 0}\r\n========================\r\n    `.trim();\r\n    }\r\n}\r\n// Export singleton instance\r\nexport const elementChangeTracker = new ElementChangeTracker();\r\n","/**\r\n *  CANVAS MONITORING DASHBOARD\r\n *\r\n * Provides real-time monitoring, visualization, and debugging tools\r\n * for element changes, renders, and performance metrics.\r\n */\r\nimport { elementChangeTracker } from './ElementChangeTracker';\r\nexport class CanvasMonitoringDashboard {\r\n    /**\r\n     * Initialize and start monitoring\r\n     */\r\n    static initialize() {\r\n        this.monitoringEnabled = true;\r\n        this.startTime = Date.now();\r\n        // Silent initialization - dashboard is available via showDashboard()\r\n    }\r\n    /**\r\n     * Increment render counter\r\n     */\r\n    static recordRender() {\r\n        if (this.monitoringEnabled) {\r\n            this.renderCount++;\r\n        }\r\n    }\r\n    /**\r\n     * Record element changes\r\n     */\r\n    static recordChanges(count) {\r\n        if (this.monitoringEnabled) {\r\n            this.elementChanges += count;\r\n        }\r\n    }\r\n    /**\r\n     * Get formatted history\r\n     */\r\n    static getHistory() {\r\n        return elementChangeTracker.getHistory();\r\n    }\r\n    /**\r\n     * Get history for specific element\r\n     */\r\n    static getElementHistory(elementId) {\r\n        return elementChangeTracker.getElementHistory(elementId);\r\n    }\r\n    /**\r\n     * Get history for specific property\r\n     */\r\n    static getPropertyHistory(property) {\r\n        return elementChangeTracker.getPropertyHistory(property);\r\n    }\r\n    /**\r\n     * Generate detailed report\r\n     */\r\n    static generateReport() {\r\n        const history = elementChangeTracker.getHistory();\r\n        const snapshots = elementChangeTracker.getSnapshots();\r\n        let report = '\\n DETAILED MONITORING REPORT\\n';\r\n        report += '\\n';\r\n        report += `Total Events: ${history.length}\\n`;\r\n        report += `Elements: ${snapshots.size}\\n\\n`;\r\n        // Recent changes\r\n        report += 'Recent Changes (last 10):\\n';\r\n        history.slice(-10).forEach(change => {\r\n            const time = new Date(change.timestamp).toLocaleTimeString();\r\n            if (change.changeType === 'created') {\r\n                report += `  [${time}]  Created: ${change.elementId}\\n`;\r\n            }\r\n            else if (change.changeType === 'deleted') {\r\n                report += `  [${time}]  Deleted: ${change.elementId}\\n`;\r\n            }\r\n            else {\r\n                report += `  [${time}]  ${change.elementId}.${change.property}: ${change.oldValue}  ${change.newValue}\\n`;\r\n            }\r\n        });\r\n        return report;\r\n    }\r\n    /**\r\n     * Get emoji for change type\r\n     */\r\n    static getChangeTypeEmoji(type) {\r\n        const emojiMap = {\r\n            created: '',\r\n            deleted: '',\r\n            updated: '',\r\n            property_changed: ''\r\n        };\r\n        return emojiMap[type] || '';\r\n    }\r\n    /**\r\n     * Get emoji for property\r\n     */\r\n    static getPropertyEmoji(prop) {\r\n        const emojiMap = {\r\n            x: '',\r\n            y: '',\r\n            width: '',\r\n            height: '',\r\n            rotation: '',\r\n            opacity: '',\r\n            visible: '',\r\n            locked: '',\r\n            color: '',\r\n            fillColor: '',\r\n            strokeColor: '',\r\n            fontSize: '',\r\n            fontFamily: '',\r\n            text: ''\r\n        };\r\n        return emojiMap[prop] || '';\r\n    }\r\n    /**\r\n     * Export history as JSON\r\n     */\r\n    static exportHistory() {\r\n        return JSON.stringify({\r\n            timestamp: new Date().toISOString(),\r\n            history: elementChangeTracker.getHistory(),\r\n            snapshots: Array.from(elementChangeTracker.getSnapshots().values())\r\n        }, null, 2);\r\n    }\r\n    /**\r\n     * Clear all history\r\n     */\r\n    static clearHistory() {\r\n        elementChangeTracker.clearHistory();\r\n        this.renderCount = 0;\r\n        this.elementChanges = 0;\r\n    }\r\n}\r\nCanvasMonitoringDashboard.monitoringEnabled = false;\r\nCanvasMonitoringDashboard.startTime = 0;\r\nCanvasMonitoringDashboard.renderCount = 0;\r\nCanvasMonitoringDashboard.elementChanges = 0;\r\nif (typeof window !== 'undefined') {\r\n    window.CanvasMonitoringDashboard = CanvasMonitoringDashboard;\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport { useEffect, useRef, useMemo, useState, useLayoutEffect } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport './ContextMenu.css';\r\nexport const ContextMenu = ({ items, position, onClose, isVisible }) => {\r\n    const menuRef = useRef(null);\r\n    const [hoveredItem, setHoveredItem] = useState(null);\r\n    const [openSubmenu, setOpenSubmenu] = useState(null);\r\n    const [submenuPosition, setSubmenuPosition] = useState(null);\r\n    const closeTimeoutRef = useRef(null);\r\n    // Calculer la position corrige pour garder le menu  l'cran\r\n    const adjustedPosition = useMemo(() => {\r\n        let adjustedX = position.x;\r\n        let adjustedY = position.y;\r\n        if (typeof window !== 'undefined') {\r\n            // Largeur et hauteur estimes du menu compact\r\n            const menuWidth = 160; // Max width du menu compact\r\n            // Calculer la hauteur relle en fonction du type d'lments\r\n            let menuHeight = 0;\r\n            items.forEach(item => {\r\n                if (item.section) {\r\n                    menuHeight += 14; // Hauteur des sections avec padding\r\n                }\r\n                else if (item.separator) {\r\n                    menuHeight += 3; // Hauteur des sparateurs avec margin\r\n                }\r\n                else {\r\n                    menuHeight += 18; // Hauteur des lments normaux\r\n                }\r\n            });\r\n            menuHeight += 2; // Padding vertical du menu\r\n            // Vrifier si le menu sort  droite\r\n            if (adjustedX + menuWidth > window.innerWidth) {\r\n                adjustedX = window.innerWidth - menuWidth - 10;\r\n            }\r\n            // Vrifier si le menu sort en bas\r\n            if (adjustedY + menuHeight > window.innerHeight) {\r\n                adjustedY = window.innerHeight - menuHeight - 10;\r\n            }\r\n            // Vrifier si le menu sort en haut (aprs ajustement vers le bas)\r\n            if (adjustedY < 0) {\r\n                adjustedY = 10; // Positionner en haut avec une marge\r\n            }\r\n            // Vrifier les limites  gauche\r\n            if (adjustedX < 0)\r\n                adjustedX = 10;\r\n        }\r\n        return { x: adjustedX, y: adjustedY };\r\n    }, [position, items]);\r\n    // Nettoyer les timeouts quand le composant se dmonte\r\n    useEffect(() => {\r\n        return () => {\r\n            if (closeTimeoutRef.current) {\r\n                clearTimeout(closeTimeoutRef.current);\r\n            }\r\n        };\r\n    }, []);\r\n    // Calculer la position du sous-menu quand il s'ouvre\r\n    useLayoutEffect(() => {\r\n        if (openSubmenu && menuRef.current) {\r\n            const menuElement = menuRef.current;\r\n            const parentItem = menuElement.querySelector(`[data-item-id=\"${openSubmenu}\"]`);\r\n            if (parentItem) {\r\n                const menuRect = menuElement.getBoundingClientRect();\r\n                const parentRect = parentItem.getBoundingClientRect();\r\n                let submenuX = menuRect.right - 2; // Positionner  droite du menu parent\r\n                let submenuY = parentRect.top; // Aligner avec l'lment parent\r\n                // Vrifier si le sous-menu sort  droite de l'cran\r\n                const submenuWidth = 160;\r\n                if (submenuX + submenuWidth > window.innerWidth) {\r\n                    submenuX = menuRect.left - submenuWidth + 2; // Positionner  gauche\r\n                }\r\n                // Vrifier si le sous-menu sort en bas de l'cran\r\n                const submenuHeight = 200; // Estimation\r\n                if (submenuY + submenuHeight > window.innerHeight) {\r\n                    submenuY = window.innerHeight - submenuHeight - 10;\r\n                }\r\n                // Vrifier si le sous-menu sort en haut\r\n                if (submenuY < 0) {\r\n                    submenuY = 10;\r\n                }\r\n                setSubmenuPosition(_prev => ({ x: submenuX, y: submenuY }));\r\n            }\r\n        }\r\n        else {\r\n            setSubmenuPosition(null);\r\n        }\r\n    }, [openSubmenu]);\r\n    useEffect(() => {\r\n        if (!isVisible)\r\n            return;\r\n        const handleClickOutside = (event) => {\r\n            // Petite attente pour permettre au menu de s'ouvrir d'abord\r\n            setTimeout(() => {\r\n                if (!menuRef.current)\r\n                    return;\r\n                const mouseEvent = event;\r\n                // Ne pas fermer si c'est un clic droit (pour viter de fermer immdiatement)\r\n                if (mouseEvent.button === 2)\r\n                    return;\r\n                // Vrifier si le clic est en dehors du menu\r\n                if (!menuRef.current.contains(event.target)) {\r\n                    onClose();\r\n                }\r\n            }, 10);\r\n        };\r\n        const handleContextMenu = (event) => {\r\n            // Empcher l'ouverture d'un nouveau menu contextuel sur le menu existant\r\n            if (menuRef.current && menuRef.current.contains(event.target)) {\r\n                event.preventDefault();\r\n            }\r\n        };\r\n        const handleEscape = (event) => {\r\n            const keyboardEvent = event;\r\n            if (keyboardEvent.key === 'Escape') {\r\n                onClose();\r\n            }\r\n        };\r\n        // Dlai minimal pour permettre au menu de se rendre\r\n        const timer = setTimeout(() => {\r\n            document.addEventListener('mousedown', handleClickOutside, { passive: true });\r\n            document.addEventListener('contextmenu', handleContextMenu, { passive: true });\r\n            document.addEventListener('keydown', handleEscape, { passive: true });\r\n        }, 50);\r\n        return () => {\r\n            clearTimeout(timer);\r\n            document.removeEventListener('mousedown', handleClickOutside);\r\n            document.removeEventListener('contextmenu', handleContextMenu);\r\n            document.removeEventListener('keydown', handleEscape);\r\n        };\r\n    }, [isVisible, onClose]);\r\n    if (!isVisible) {\r\n        return null;\r\n    }\r\n    const handleItemClick = (item) => {\r\n        if (!item.disabled && !item.separator && item.action) {\r\n            item.action();\r\n            onClose();\r\n        }\r\n    };\r\n    const menuElement = (_jsx(\"div\", { ref: menuRef, className: \"context-menu\", onMouseLeave: () => {\r\n            // Dlai plus long pour permettre la navigation vers les sous-menus\r\n            if (closeTimeoutRef.current) {\r\n                clearTimeout(closeTimeoutRef.current);\r\n            }\r\n            closeTimeoutRef.current = window.setTimeout(() => {\r\n                setOpenSubmenu(null);\r\n                setHoveredItem(null);\r\n            }, 300);\r\n        }, onMouseEnter: () => {\r\n            // Annuler la fermeture si on revient dans le menu\r\n            if (closeTimeoutRef.current) {\r\n                clearTimeout(closeTimeoutRef.current);\r\n                closeTimeoutRef.current = null;\r\n            }\r\n        }, style: {\r\n            position: 'fixed',\r\n            left: `${adjustedPosition.x}px`,\r\n            top: `${adjustedPosition.y}px`,\r\n            opacity: 1,\r\n            visibility: 'visible',\r\n            pointerEvents: 'auto',\r\n            zIndex: 999999,\r\n            background: 'linear-gradient(145deg, #ffffff 0%, #f8fafc 100%)',\r\n            border: '1px solid #e2e8f0',\r\n            WebkitBorderRadius: '8px',\r\n            MozBorderRadius: '8px',\r\n            borderRadius: '8px',\r\n            WebkitBoxShadow: '0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.04)',\r\n            MozBoxShadow: '0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.04)',\r\n            boxShadow: '0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.04)',\r\n            minWidth: '120px',\r\n            maxWidth: '160px',\r\n            padding: '1px 0',\r\n            WebkitTransition: 'opacity 0.15s ease-in-out',\r\n            MozTransition: 'opacity 0.15s ease-in-out',\r\n            OTransition: 'opacity 0.15s ease-in-out',\r\n            transition: 'opacity 0.15s ease-in-out',\r\n            WebkitTransformOrigin: 'top left',\r\n            MozTransformOrigin: 'top left',\r\n            msTransformOrigin: 'top left',\r\n            OTransformOrigin: 'top left',\r\n            transformOrigin: 'top left',\r\n        }, children: items.map((item) => (_jsx(\"div\", { children: item.section ? (_jsx(\"div\", { className: \"context-menu-section\", style: { padding: '2px 6px 1px' }, children: _jsx(\"div\", { className: \"context-menu-section-title\", style: { fontSize: '8px', fontWeight: '600', color: '#64748b', textTransform: 'uppercase', letterSpacing: '0.5px', padding: '0px', marginBottom: '0px' }, children: item.section }) })) : item.separator ? (_jsx(\"div\", { className: \"context-menu-separator\", style: { height: '1px', background: 'linear-gradient(90deg, transparent 0%, #e2e8f0 20%, #e2e8f0 80%, transparent 100%)', margin: '1px 0', border: 'none' } })) : (_jsxs(\"div\", { className: `context-menu-item ${item.disabled ? 'disabled' : ''}`, \"data-item-id\": item.id, onClick: () => handleItemClick(item), onMouseEnter: () => {\r\n                    setHoveredItem(item.id);\r\n                    if (item.children && item.children.length > 0) {\r\n                        setOpenSubmenu(item.id);\r\n                    }\r\n                    else {\r\n                        setOpenSubmenu(null);\r\n                    }\r\n                }, style: {\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    padding: '1px 4px',\r\n                    cursor: item.disabled ? 'not-allowed' : 'pointer',\r\n                    userSelect: 'none',\r\n                    transition: 'all 0.15s cubic-bezier(0.4, 0, 0.2, 1)',\r\n                    position: 'relative',\r\n                    minHeight: '16px',\r\n                    border: 'none',\r\n                    background: hoveredItem === item.id ? '#f1f5f9' : 'transparent',\r\n                    color: item.disabled ? '#94a3b8' : '#334155',\r\n                    fontSize: '11px',\r\n                    fontWeight: '500',\r\n                }, children: [item.icon && _jsx(\"span\", { className: \"context-menu-item-icon\", style: { width: '10px', height: '10px', marginRight: '3px', display: 'flex', alignItems: 'center', justifyContent: 'center', color: item.disabled ? '#94a3b8' : '#64748b', fontSize: '9px' }, children: item.icon }), item.label && _jsx(\"span\", { className: \"context-menu-item-text\", style: { flex: '1', fontSize: '10px', fontWeight: '500', color: item.disabled ? '#94a3b8' : '#334155' }, children: item.label }), item.shortcut && _jsx(\"span\", { className: \"context-menu-item-shortcut\", style: { fontSize: '8px', fontWeight: '500', color: item.disabled ? '#94a3b8' : '#64748b', background: 'rgba(148, 163, 184, 0.1)', padding: '0px 1px', borderRadius: '1px', marginLeft: '3px' }, children: item.shortcut }), item.children && item.children.length > 0 && (_jsx(\"span\", { className: \"context-menu-submenu-arrow\", style: { marginLeft: '4px', color: '#64748b', fontSize: '8px' }, children: \"\\u25B6\" }))] })) }, item.id))) }));\r\n    // Rendre les sous-menus ouverts\r\n    const renderSubmenus = () => {\r\n        if (!openSubmenu || !submenuPosition)\r\n            return null;\r\n        const parentItem = items.find(item => item.id === openSubmenu);\r\n        if (!parentItem || !parentItem.children)\r\n            return null;\r\n        return (_jsx(\"div\", { onMouseEnter: () => {\r\n                // Annuler la fermeture si on entre dans le sous-menu\r\n                if (closeTimeoutRef.current) {\r\n                    clearTimeout(closeTimeoutRef.current);\r\n                    closeTimeoutRef.current = null;\r\n                }\r\n            }, onMouseLeave: () => {\r\n                // Dlai pour permettre le retour au menu principal\r\n                if (closeTimeoutRef.current) {\r\n                    clearTimeout(closeTimeoutRef.current);\r\n                }\r\n                closeTimeoutRef.current = window.setTimeout(() => {\r\n                    setOpenSubmenu(null);\r\n                    setHoveredItem(null);\r\n                }, 300);\r\n            }, children: _jsx(ContextMenu, { items: parentItem.children, position: submenuPosition, onClose: () => setOpenSubmenu(null), isVisible: true }) }));\r\n    };\r\n    // Utiliser un Portal pour rendre le menu au niveau du document body\r\n    return createPortal(_jsxs(_Fragment, { children: [menuElement, renderSubmenus()] }), document.body);\r\n};\r\n","import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"react/jsx-runtime\";\r\nimport { useRef, useEffect, useCallback, useState, useMemo } from 'react';\r\nimport { useBuilder } from '../../contexts/builder/BuilderContext';\r\nimport { useCanvasSettings } from '../../contexts/CanvasSettingsContext';\r\nimport { useCanvasSetting } from '../../hooks/useCanvasSettings';\r\nimport { useCanvasDrop } from '../../hooks/useCanvasDrop';\r\nimport { useCanvasInteraction } from '../../hooks/useCanvasInteraction';\r\nimport { useKeyboardShortcuts } from '../../hooks/useKeyboardShortcuts';\r\nimport { wooCommerceManager } from '../../utils/WooCommerceElementsManager';\r\nimport { debugWarn, debugError, debugLog } from '../../utils/debug';\r\n// Fonctions utilitaires pour la gestion mmoire des images\r\nconst estimateImageMemorySize = (img) => {\r\n    // Estimation base sur les dimensions et le nombre de canaux (RGBA = 4 octets par pixel)\r\n    const bytesPerPixel = 4;\r\n    return img.naturalWidth * img.naturalHeight * bytesPerPixel;\r\n};\r\nconst cleanupImageCache = (imageCache) => {\r\n    const cache = imageCache.current;\r\n    if (cache.size <= 100)\r\n        return; // Max 100 images\r\n    // Trier par date d'utilisation et supprimer les plus anciennes\r\n    const entries = Array.from(cache.entries()).sort(([, a], [, b]) => a.lastUsed - b.lastUsed);\r\n    const toRemove = entries.slice(0, Math.ceil(cache.size * 0.2)); // Supprimer 20%\r\n    toRemove.forEach(([url]) => cache.delete(url));\r\n};\r\nimport { CanvasMonitoringDashboard } from '../../utils/CanvasMonitoringDashboard';\r\nimport { ContextMenu } from '../ui/ContextMenu';\r\n// Fonctions utilitaires de dessin (dplaces en dehors du composant pour viter les avertissements React Compiler)\r\n// Fonction helper pour normaliser les couleurs\r\nconst normalizeColor = (color) => {\r\n    if (!color || color === 'transparent') {\r\n        return 'rgba(0,0,0,0)'; // Transparent\r\n    }\r\n    return color;\r\n};\r\n// Fonction utilitaire pour rectangle arrondi\r\nconst roundedRect = (ctx, x, y, width, height, radius) => {\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + radius, y);\r\n    ctx.lineTo(x + width - radius, y);\r\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\r\n    ctx.lineTo(x + width, y + height - radius);\r\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\r\n    ctx.lineTo(x + radius, y + height);\r\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\r\n    ctx.lineTo(x, y + radius);\r\n    ctx.quadraticCurveTo(x, y, x + radius, y);\r\n    ctx.closePath();\r\n};\r\n// Fonctions de dessin pour les lments\r\nconst drawRectangle = (ctx, element) => {\r\n    const props = element;\r\n    const fillColor = normalizeColor(props.fillColor || '#ffffff');\r\n    const strokeColor = normalizeColor(props.strokeColor || '#000000');\r\n    const strokeWidth = props.strokeWidth || 1;\r\n    const borderRadius = props.borderRadius || 0;\r\n    ctx.fillStyle = fillColor;\r\n    ctx.strokeStyle = strokeColor;\r\n    ctx.lineWidth = strokeWidth;\r\n    if (borderRadius > 0) {\r\n        roundedRect(ctx, 0, 0, element.width, element.height, borderRadius);\r\n        ctx.fill();\r\n        ctx.stroke();\r\n    }\r\n    else {\r\n        ctx.fillRect(0, 0, element.width, element.height);\r\n        ctx.strokeRect(0, 0, element.width, element.height);\r\n    }\r\n};\r\nconst drawCircle = (ctx, element) => {\r\n    const props = element;\r\n    const fillColor = normalizeColor(props.fillColor || '#ffffff');\r\n    const strokeColor = normalizeColor(props.strokeColor || '#000000');\r\n    const strokeWidth = props.strokeWidth || 1;\r\n    const centerX = element.width / 2;\r\n    const centerY = element.height / 2;\r\n    const radius = Math.min(centerX, centerY);\r\n    ctx.fillStyle = fillColor;\r\n    ctx.strokeStyle = strokeColor;\r\n    ctx.lineWidth = strokeWidth;\r\n    ctx.beginPath();\r\n    ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\r\n    ctx.fill();\r\n    ctx.stroke();\r\n};\r\nconst drawText = (ctx, element) => {\r\n    const props = element;\r\n    const text = props.text || 'Text';\r\n    const fontSize = props.fontSize || 16;\r\n    const color = normalizeColor(props.color || '#000000');\r\n    const align = props.align || 'left';\r\n    ctx.fillStyle = color;\r\n    ctx.font = `${fontSize}px Arial`;\r\n    ctx.textAlign = align;\r\n    const x = align === 'center' ? element.width / 2 : align === 'right' ? element.width : 0;\r\n    ctx.fillText(text, x, fontSize);\r\n};\r\nconst drawLine = (ctx, element) => {\r\n    const props = element;\r\n    const strokeColor = normalizeColor(props.strokeColor || '#000000');\r\n    const strokeWidth = props.strokeWidth || 2;\r\n    ctx.strokeStyle = strokeColor;\r\n    ctx.lineWidth = strokeWidth;\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, element.height / 2); // Centre verticalement\r\n    ctx.lineTo(element.width, element.height / 2); // Ligne horizontale droite\r\n    ctx.stroke();\r\n};\r\n// Fonction pour dessiner une image\r\nconst drawImage = (ctx, element, imageCache) => {\r\n    const props = element;\r\n    const imageUrl = props.src || '';\r\n    if (!imageUrl) {\r\n        // Pas d'URL, dessiner un placeholder\r\n        ctx.fillStyle = '#f0f0f0';\r\n        ctx.fillRect(0, 0, element.width, element.height);\r\n        ctx.strokeStyle = '#cccccc';\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeRect(0, 0, element.width, element.height);\r\n        ctx.fillStyle = '#999999';\r\n        ctx.font = '14px Arial';\r\n        ctx.textAlign = 'center';\r\n        ctx.textBaseline = 'middle';\r\n        ctx.fillText('Image', element.width / 2, element.height / 2);\r\n        return;\r\n    }\r\n    // Vrifier si l'image est en cache\r\n    let cachedImage = imageCache.current.get(imageUrl);\r\n    if (!cachedImage) {\r\n        // Crer une nouvelle image et la mettre en cache\r\n        const img = document.createElement('img');\r\n        img.crossOrigin = 'anonymous';\r\n        img.src = imageUrl;\r\n        // Attendre que l'image soit charge pour calculer sa taille mmoire\r\n        img.onload = () => {\r\n            const size = estimateImageMemorySize(img);\r\n            imageCache.current.set(imageUrl, {\r\n                image: img,\r\n                size: size,\r\n                lastUsed: Date.now()\r\n            });\r\n            // Dclencher un nettoyage aprs ajout\r\n            cleanupImageCache(imageCache);\r\n        };\r\n        img.onerror = () => {\r\n            debugWarn(`[Canvas] Failed to load image: ${imageUrl}`);\r\n        };\r\n        // Retourner temporairement pour viter les erreurs\r\n        return;\r\n    }\r\n    const img = cachedImage.image;\r\n    // Mettre  jour la date d'utilisation\r\n    cachedImage.lastUsed = Date.now();\r\n    // Si l'image est charge, la dessiner\r\n    if (img.complete && img.naturalHeight !== 0) {\r\n        // Appliquer object-fit\r\n        const objectFit = props.objectFit || 'cover';\r\n        let drawX = 0, drawY = 0, drawWidth = element.width, drawHeight = element.height;\r\n        let sourceX = 0, sourceY = 0, sourceWidth = img.naturalWidth, sourceHeight = img.naturalHeight;\r\n        if (objectFit === 'contain') {\r\n            const ratio = Math.min(element.width / img.naturalWidth, element.height / img.naturalHeight);\r\n            drawWidth = img.naturalWidth * ratio;\r\n            drawHeight = img.naturalHeight * ratio;\r\n            drawX = (element.width - drawWidth) / 2;\r\n            drawY = (element.height - drawHeight) / 2;\r\n        }\r\n        else if (objectFit === 'cover') {\r\n            const ratio = Math.max(element.width / img.naturalWidth, element.height / img.naturalHeight);\r\n            sourceWidth = element.width / ratio;\r\n            sourceHeight = element.height / ratio;\r\n            sourceX = (img.naturalWidth - sourceWidth) / 2;\r\n            sourceY = (img.naturalHeight - sourceHeight) / 2;\r\n        }\r\n        else if (objectFit === 'fill') {\r\n            // Utiliser les dimensions de l'lment directement\r\n        }\r\n        else if (objectFit === 'scale-down') {\r\n            if (img.naturalWidth > element.width || img.naturalHeight > element.height) {\r\n                const ratio = Math.min(element.width / img.naturalWidth, element.height / img.naturalHeight);\r\n                drawWidth = img.naturalWidth * ratio;\r\n                drawHeight = img.naturalHeight * ratio;\r\n                drawX = (element.width - drawWidth) / 2;\r\n                drawY = (element.height - drawHeight) / 2;\r\n            }\r\n        }\r\n        ctx.drawImage(img, sourceX, sourceY, sourceWidth, sourceHeight, drawX, drawY, drawWidth, drawHeight);\r\n    }\r\n    else {\r\n        // Image en cours de chargement ou erreur, dessiner un placeholder\r\n        ctx.fillStyle = '#e0e0e0';\r\n        ctx.fillRect(0, 0, element.width, element.height);\r\n        ctx.strokeStyle = '#999999';\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeRect(0, 0, element.width, element.height);\r\n        ctx.fillStyle = '#666666';\r\n        ctx.font = '12px Arial';\r\n        ctx.textAlign = 'center';\r\n        ctx.textBaseline = 'middle';\r\n        ctx.fillText(img.complete ? 'Erreur' : 'Chargement...', element.width / 2, element.height / 2);\r\n    }\r\n};\r\n// Fonctions de rendu WooCommerce avec donnes fictives ou relles selon le mode\r\nconst drawProductTable = (ctx, element, state) => {\r\n    var _a, _b, _c;\r\n    const props = element;\r\n    //  BUGFIX-020: Validate element has minimum size for rendering\r\n    const minWidth = 100;\r\n    const minHeight = 50;\r\n    if (element.width < minWidth || element.height < minHeight) {\r\n        // Element too small, draw placeholder\r\n        ctx.fillStyle = '#f0f0f0';\r\n        ctx.fillRect(0, 0, element.width, element.height);\r\n        ctx.fillStyle = '#999999';\r\n        ctx.font = '12px Arial';\r\n        ctx.textAlign = 'center';\r\n        ctx.fillText('Trop petit', element.width / 2, element.height / 2);\r\n        return;\r\n    }\r\n    const showHeaders = props.showHeaders !== false;\r\n    const showBorders = props.showBorders !== false;\r\n    const showAlternatingRows = props.showAlternatingRows !== false;\r\n    const fontSize = props.fontSize || 11;\r\n    const fontFamily = props.fontFamily || 'Arial';\r\n    const fontWeight = props.fontWeight || 'normal';\r\n    const fontStyle = props.fontStyle || 'normal';\r\n    const showSku = props.showSku !== false;\r\n    const showDescription = props.showDescription !== false;\r\n    const showQuantity = props.showQuantity !== false;\r\n    const showShipping = props.showShipping !== false;\r\n    const showTax = props.showTax !== false;\r\n    const showGlobalDiscount = props.showGlobalDiscount !== false;\r\n    const textColor = normalizeColor(props.textColor || '#000000');\r\n    const borderRadius = props.borderRadius || 0;\r\n    let products;\r\n    let shippingCost;\r\n    let taxRate;\r\n    let globalDiscount;\r\n    let orderFees;\r\n    let currency;\r\n    // Utiliser les donnes WooCommerce si en mode commande, sinon donnes fictives\r\n    //  BUGFIX-015: Validate WooCommerceManager access safely\r\n    if (state.previewMode === 'command' && ((_a = wooCommerceManager === null || wooCommerceManager === void 0 ? void 0 : wooCommerceManager.getOrderData) === null || _a === void 0 ? void 0 : _a.call(wooCommerceManager))) {\r\n        const orderData = wooCommerceManager.getOrderData();\r\n        if (orderData) {\r\n            const orderItems = ((_b = wooCommerceManager.getOrderItems) === null || _b === void 0 ? void 0 : _b.call(wooCommerceManager)) || [];\r\n            const orderTotals = ((_c = wooCommerceManager.getOrderTotals) === null || _c === void 0 ? void 0 : _c.call(wooCommerceManager)) || { shipping: 0, tax: 0, subtotal: 0, discount: 0 };\r\n            products = orderItems;\r\n            shippingCost = orderTotals.shipping;\r\n            taxRate = orderTotals.tax > 0 ? (orderTotals.tax / orderTotals.subtotal) * 100 : 20;\r\n            globalDiscount = orderTotals.discount;\r\n            orderFees = 0; // Les frais de commande sont dj inclus dans les items\r\n            currency = orderData.currency || '';\r\n        }\r\n        else {\r\n            // Fallback if orderData is null despite passing the check - use demo data\r\n            shippingCost = props.shippingCost || 8.50;\r\n            taxRate = props.taxRate || 20;\r\n            globalDiscount = props.globalDiscount || 5;\r\n            orderFees = props.orderFees || 2.50;\r\n            currency = '';\r\n            products = [\r\n                {\r\n                    sku: 'DEMO-001',\r\n                    name: 'Sample Product',\r\n                    description: 'Demo product',\r\n                    qty: 1,\r\n                    price: 29.99,\r\n                    discount: 0,\r\n                    total: 29.99\r\n                }\r\n            ];\r\n        }\r\n    }\r\n    else {\r\n        // Donnes fictives pour le mode diteur\r\n        shippingCost = props.shippingCost || 8.50;\r\n        taxRate = props.taxRate || 20;\r\n        globalDiscount = props.globalDiscount || 5;\r\n        orderFees = props.orderFees || 2.50;\r\n        currency = '';\r\n        products = [\r\n            {\r\n                sku: 'TSHIRT-001',\r\n                name: 'T-shirt Premium Bio',\r\n                description: 'T-shirt en coton biologique, coupe slim',\r\n                qty: 2,\r\n                price: 29.99,\r\n                discount: 0,\r\n                total: 59.98\r\n            },\r\n            {\r\n                sku: 'JEAN-045',\r\n                name: 'Jean Slim Fit Noir',\r\n                description: 'Jean stretch confort, taille haute',\r\n                qty: 1,\r\n                price: 89.99,\r\n                discount: 10.00,\r\n                total: 79.99\r\n            },\r\n            {\r\n                sku: 'SHOES-089',\r\n                name: 'Chaussures Running Pro',\r\n                description: 'Chaussures de running avec semelle amortissante',\r\n                qty: 1,\r\n                price: 129.99,\r\n                discount: 0,\r\n                total: 129.99\r\n            },\r\n            {\r\n                sku: 'HOODIE-112',\r\n                name: 'Sweat  Capuche',\r\n                description: 'Sweat molletonn, capuche ajustable',\r\n                qty: 1,\r\n                price: 49.99,\r\n                discount: 5.00,\r\n                total: 44.99\r\n            }\r\n        ];\r\n    }\r\n    // Calcul du total avec remises (mme logique pour donnes fictives et relles)\r\n    const subtotal = products.reduce((sum, product) => sum + (product.price * product.qty), 0);\r\n    const itemDiscounts = products.reduce((sum, product) => sum + product.discount, 0);\r\n    const subtotalAfterItemDiscounts = subtotal - itemDiscounts;\r\n    // Sous-total incluant les frais de commande\r\n    const subtotalWithOrderFees = subtotalAfterItemDiscounts + orderFees;\r\n    // Appliquer la remise globale sur le sous-total incluant les frais de commande (seulement si affiche)\r\n    const globalDiscountAmount = (globalDiscount > 0 && showGlobalDiscount) ? (subtotalWithOrderFees * globalDiscount / 100) : 0;\r\n    const subtotalAfterGlobalDiscount = subtotalWithOrderFees - globalDiscountAmount; // Ajouter les frais de port (seulement si affichs)\r\n    const subtotalWithShipping = subtotalAfterGlobalDiscount + (showShipping ? shippingCost : 0);\r\n    // Calculer les taxes (seulement si affiches)\r\n    const taxAmount = (taxRate > 0 && showTax) ? (subtotalWithShipping * taxRate / 100) : 0;\r\n    // Total final\r\n    const finalTotal = subtotalWithShipping + taxAmount;\r\n    const columns = [];\r\n    columns.push({ key: 'name', label: 'Produit', width: showSku && showDescription ? 0.35 : showSku || showDescription ? 0.45 : 0.55, align: 'left', x: 0 });\r\n    if (showSku)\r\n        columns.push({ key: 'sku', label: 'SKU', width: 0.15, align: 'left', x: 0 });\r\n    if (showDescription)\r\n        columns.push({ key: 'description', label: 'Description', width: 0.25, align: 'left', x: 0 });\r\n    if (showQuantity)\r\n        columns.push({ key: 'qty', label: 'Qt', width: 0.08, align: 'center', x: 0 });\r\n    columns.push({ key: 'price', label: 'Prix', width: 0.12, align: 'right', x: 0 });\r\n    columns.push({ key: 'total', label: 'Total', width: 0.12, align: 'right', x: 0 });\r\n    // Normaliser les largeurs\r\n    const totalWidth = columns.reduce((sum, col) => sum + col.width, 0);\r\n    columns.forEach(col => col.width = col.width / totalWidth);\r\n    // Calcul des positions X des colonnes\r\n    let currentX = 8;\r\n    columns.forEach(col => {\r\n        col.x = currentX;\r\n        currentX += col.width * (element.width - 16);\r\n    });\r\n    //  Appliquer l'alignement vertical seulement (plus simple et moins risqu)\r\n    const verticalAlign = props.verticalAlign || 'top';\r\n    // Calculer la hauteur totale du tableau pour l'alignement vertical\r\n    const rowHeight = showDescription ? 50 : 35;\r\n    const headerHeight = showHeaders ? 35 : 0;\r\n    const productsCount = products.length;\r\n    const tableHeight = headerHeight + (productsCount * (rowHeight + 4)) + 60; // +60 pour les totaux\r\n    // Offset vertical seulement\r\n    let offsetY = 0;\r\n    // Alignement vertical - dplace le point d'origine vertical du tableau\r\n    if (verticalAlign === 'middle') {\r\n        offsetY = Math.max(0, (element.height - tableHeight) / 2);\r\n    }\r\n    else if (verticalAlign === 'bottom') {\r\n        offsetY = Math.max(0, element.height - tableHeight - 10);\r\n    }\r\n    // Fond\r\n    ctx.fillStyle = props.backgroundColor || '#ffffff';\r\n    ctx.fillRect(0, 0, element.width, element.height);\r\n    // Bordure extrieure\r\n    if (showBorders) {\r\n        ctx.strokeStyle = props.borderColor || '#d1d5db';\r\n        ctx.lineWidth = props.borderWidth || 1;\r\n        if (borderRadius > 0) {\r\n            roundedRect(ctx, 0, 0, element.width, element.height, borderRadius);\r\n            ctx.stroke();\r\n        }\r\n        else {\r\n            ctx.strokeRect(0, 0, element.width, element.height);\r\n        }\r\n    }\r\n    ctx.textAlign = 'left';\r\n    let currentY = (showHeaders ? 25 : 15) + offsetY;\r\n    // En-ttes avec style professionnel\r\n    if (showHeaders) {\r\n        ctx.fillStyle = props.headerBackgroundColor || '#f9fafb';\r\n        // Utiliser roundedRect si borderRadius > 0, sinon fillRect normal\r\n        if (borderRadius > 0) {\r\n            roundedRect(ctx, 1, 1 + offsetY, element.width - 2, 32, borderRadius);\r\n            ctx.fill();\r\n        }\r\n        else {\r\n            ctx.fillRect(1, 1 + offsetY, element.width - 2, 32);\r\n        }\r\n        ctx.fillStyle = props.headerTextColor || '#374151';\r\n        ctx.font = `${fontStyle} ${fontWeight} ${fontSize + 1}px ${fontFamily}`;\r\n        ctx.textBaseline = 'top';\r\n        columns.forEach(col => {\r\n            ctx.textAlign = col.align;\r\n            const textX = col.align === 'right' ? col.x + col.width * (element.width - 16) - 4 :\r\n                col.align === 'center' ? col.x + (col.width * (element.width - 16)) / 2 :\r\n                    col.x;\r\n            ctx.fillText(col.label, textX, 10 + offsetY); // Ajust pour centrer dans la hauteur plus grande\r\n        });\r\n        // Ligne de sparation sous les en-ttes\r\n        ctx.strokeStyle = '#e5e7eb';\r\n        ctx.lineWidth = 1;\r\n        ctx.beginPath();\r\n        ctx.moveTo(4, 34 + offsetY); // Ajust pour la nouvelle hauteur\r\n        ctx.lineTo(element.width - 4, 34 + offsetY);\r\n        ctx.stroke();\r\n        currentY = 42 + offsetY; // Ajust pour la nouvelle hauteur d'entte\r\n    }\r\n    else {\r\n        currentY = 15 + offsetY;\r\n    }\r\n    // Produits avec alternance de couleurs\r\n    ctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\r\n    ctx.textBaseline = 'middle';\r\n    products.forEach((product, index) => {\r\n        // Calcul de la position Y absolue pour cette ligne\r\n        const rowY = currentY + index * (rowHeight + 4);\r\n        // Fond altern pour les lignes (sans bordures)\r\n        if (showAlternatingRows && index % 2 === 1) {\r\n            ctx.fillStyle = props.alternateRowColor || '#f9fafb';\r\n            // Utiliser roundedRect si borderRadius > 0\r\n            if (borderRadius > 0) {\r\n                roundedRect(ctx, 1, rowY, element.width - 2, rowHeight, borderRadius);\r\n                ctx.fill();\r\n            }\r\n            else {\r\n                ctx.fillRect(1, rowY, element.width - 2, rowHeight);\r\n            }\r\n        }\r\n        ctx.fillStyle = textColor; // Utiliser la couleur du texte depuis les proprits\r\n        columns.forEach(col => {\r\n            ctx.textAlign = col.align;\r\n            const textX = col.align === 'right' ? col.x + col.width * (element.width - 16) - 4 :\r\n                col.align === 'center' ? col.x + (col.width * (element.width - 16)) / 2 :\r\n                    col.x;\r\n            let text = '';\r\n            switch (col.key) {\r\n                case 'name':\r\n                    text = product.name;\r\n                    break;\r\n                case 'sku':\r\n                    text = product.sku;\r\n                    break;\r\n                case 'description':\r\n                    text = product.description;\r\n                    break;\r\n                case 'qty':\r\n                    text = product.qty.toString();\r\n                    break;\r\n                case 'price':\r\n                    text = `${product.price.toFixed(2)}${currency}`;\r\n                    break;\r\n                case 'discount':\r\n                    text = product.discount > 0 ? `${product.discount.toFixed(2)}${currency}` : '-';\r\n                    break;\r\n                case 'total':\r\n                    text = `${product.total.toFixed(2)}${currency}`;\r\n                    break;\r\n            }\r\n            // Gestion du texte qui dpasse\r\n            const maxWidth = col.width * (element.width - 16) - 8;\r\n            if (ctx.measureText(text).width > maxWidth && col.key === 'name') {\r\n                // Tronquer avec \"...\"\r\n                let truncated = text;\r\n                while (ctx.measureText(truncated + '...').width > maxWidth && truncated.length > 0) {\r\n                    truncated = truncated.slice(0, -1);\r\n                }\r\n                text = truncated + '...';\r\n            }\r\n            ctx.fillText(text, textX, rowY + rowHeight / 2);\r\n        });\r\n    });\r\n    // Positionnement pour la section des totaux (aprs toutes les lignes de produits)\r\n    currentY = 55 + products.length * (rowHeight + 4) + 8;\r\n    // Section des totaux\r\n    // Ligne de sparation avant les totaux\r\n    ctx.strokeStyle = '#d1d5db';\r\n    ctx.lineWidth = 1;\r\n    ctx.beginPath();\r\n    ctx.moveTo(element.width - 200, currentY);\r\n    ctx.lineTo(element.width - 8, currentY);\r\n    ctx.stroke();\r\n    currentY += 20;\r\n    // Affichage des totaux\r\n    ctx.font = `bold ${fontSize}px Arial`;\r\n    ctx.fillStyle = textColor; // Utiliser la couleur du texte\r\n    ctx.textAlign = 'left';\r\n    const totalsY = currentY;\r\n    ctx.fillText('Sous-total:', element.width - 200, totalsY);\r\n    ctx.textAlign = 'right';\r\n    ctx.fillText(`${subtotalWithOrderFees.toFixed(2)}${currency}`, element.width - 8, totalsY);\r\n    currentY += 18;\r\n    // Remises combines (articles + globale) - proviennent de coupons WooCommerce\r\n    const totalDiscounts = itemDiscounts + (showGlobalDiscount ? globalDiscountAmount : 0);\r\n    if (totalDiscounts > 0) {\r\n        ctx.textAlign = 'left';\r\n        ctx.fillStyle = '#059669'; // Garder le vert pour la remise (couleur spciale)\r\n        ctx.fillText('Coupon:', element.width - 200, currentY);\r\n        ctx.textAlign = 'right';\r\n        ctx.fillText(`-${totalDiscounts.toFixed(2)}${currency}`, element.width - 8, currentY);\r\n        currentY += 18;\r\n    }\r\n    // Frais de port\r\n    if (shippingCost > 0 && showShipping) {\r\n        ctx.textAlign = 'left';\r\n        ctx.fillStyle = textColor; // Utiliser la couleur du texte\r\n        ctx.fillText('Frais de port:', element.width - 200, currentY);\r\n        ctx.textAlign = 'right';\r\n        ctx.fillText(`${shippingCost.toFixed(2)}${currency}`, element.width - 8, currentY);\r\n        currentY += 18;\r\n    }\r\n    // Taxes\r\n    if (taxAmount > 0 && showTax) {\r\n        ctx.textAlign = 'left';\r\n        ctx.fillStyle = textColor; // Utiliser la couleur du texte\r\n        ctx.fillText(`TVA (${taxRate}%):`, element.width - 200, currentY);\r\n        ctx.textAlign = 'right';\r\n        ctx.fillText(`${taxAmount.toFixed(2)}${currency}`, element.width - 8, currentY);\r\n        currentY += 18;\r\n    }\r\n    currentY += 8; // Plus d'espace avant la ligne de sparation du total\r\n    ctx.strokeStyle = textColor; // Utiliser la couleur du texte pour la ligne\r\n    ctx.lineWidth = 2;\r\n    ctx.beginPath();\r\n    ctx.moveTo(element.width - 200, currentY - 5);\r\n    ctx.lineTo(element.width - 8, currentY - 5);\r\n    ctx.stroke();\r\n    currentY += 8; // Plus d'espace aprs la ligne de sparation\r\n    ctx.font = `${fontStyle} bold ${fontSize + 2}px ${fontFamily}`;\r\n    ctx.fillStyle = textColor; // Utiliser la couleur du texte pour le total\r\n    ctx.textAlign = 'left';\r\n    ctx.fillText('TOTAL:', element.width - 200, currentY);\r\n    ctx.textAlign = 'right';\r\n    ctx.fillText(`${finalTotal.toFixed(2)}${currency}`, element.width - 8, currentY);\r\n};\r\n// Fonctions de rendu WooCommerce avec donnes fictives ou relles selon le mode\r\nconst drawCustomerInfo = (ctx, element, state) => {\r\n    const props = element;\r\n    const fontSize = props.fontSize || 12;\r\n    const fontFamily = props.fontFamily || 'Arial';\r\n    const fontWeight = props.fontWeight || 'normal';\r\n    const fontStyle = props.fontStyle || 'normal';\r\n    // Proprits de police pour l'en-tte\r\n    const headerFontSize = props.headerFontSize || fontSize + 2;\r\n    const headerFontFamily = props.headerFontFamily || fontFamily;\r\n    const headerFontWeight = props.headerFontWeight || fontWeight;\r\n    const headerFontStyle = props.headerFontStyle || fontStyle;\r\n    // Proprits de police pour le corps du texte\r\n    const bodyFontSize = props.bodyFontSize || fontSize;\r\n    const bodyFontFamily = props.bodyFontFamily || fontFamily;\r\n    const bodyFontWeight = props.bodyFontWeight || fontWeight;\r\n    const bodyFontStyle = props.bodyFontStyle || fontStyle;\r\n    const layout = props.layout || 'vertical';\r\n    const showHeaders = props.showHeaders !== false;\r\n    const showBorders = props.showBorders !== false;\r\n    const showFullName = props.showFullName !== false;\r\n    const showAddress = props.showAddress !== false;\r\n    const showEmail = props.showEmail !== false;\r\n    const showPhone = props.showPhone !== false;\r\n    const showPaymentMethod = props.showPaymentMethod !== false;\r\n    const showTransactionId = props.showTransactionId !== false;\r\n    // Fond\r\n    if (props.showBackground !== false) {\r\n        ctx.fillStyle = props.backgroundColor || '#ffffff';\r\n        ctx.fillRect(0, 0, element.width, element.height);\r\n    }\r\n    // Bordures\r\n    if (showBorders) {\r\n        ctx.strokeStyle = props.borderColor || '#e5e7eb';\r\n        ctx.lineWidth = 1;\r\n        ctx.strokeRect(0, 0, element.width, element.height);\r\n    }\r\n    ctx.fillStyle = normalizeColor(props.textColor || '#000000');\r\n    ctx.font = `${headerFontStyle} ${headerFontWeight} ${headerFontSize}px ${headerFontFamily}`;\r\n    ctx.textAlign = 'left';\r\n    let y = showHeaders ? 25 : 15;\r\n    // En-tte\r\n    if (showHeaders) {\r\n        ctx.fillStyle = normalizeColor(props.headerTextColor || '#111827');\r\n        ctx.fillText('Informations Client', 10, y);\r\n        y += 20;\r\n        ctx.fillStyle = normalizeColor(props.textColor || '#000000');\r\n    }\r\n    // Informations client fictives ou relles selon le mode\r\n    let customerData;\r\n    if (state.previewMode === 'command') {\r\n        customerData = wooCommerceManager.getCustomerInfo();\r\n    }\r\n    else {\r\n        // Donnes fictives pour le mode diteur\r\n        customerData = {\r\n            name: 'Marie Dupont',\r\n            address: '15 rue des Lilas, 75001 Paris',\r\n            email: 'marie.dupont@email.com',\r\n            phone: '+33 6 12 34 56 78'\r\n        };\r\n    }\r\n    ctx.font = `${bodyFontStyle} ${bodyFontWeight} ${bodyFontSize}px ${bodyFontFamily}`;\r\n    if (layout === 'vertical') {\r\n        if (showFullName) {\r\n            ctx.fillText(customerData.name, 10, y);\r\n            y += 18;\r\n        }\r\n        if (showAddress) {\r\n            ctx.fillText(customerData.address, 10, y);\r\n            y += 18;\r\n        }\r\n        if (showEmail) {\r\n            ctx.fillText(customerData.email, 10, y);\r\n            y += 18;\r\n        }\r\n        if (showPhone) {\r\n            ctx.fillText(customerData.phone, 10, y);\r\n            y += 18;\r\n        }\r\n        if (showPaymentMethod) {\r\n            ctx.fillText('Paiement: Carte bancaire', 10, y);\r\n            y += 18;\r\n        }\r\n        if (showTransactionId) {\r\n            ctx.fillText('ID: TXN123456789', 10, y);\r\n        }\r\n    }\r\n    else if (layout === 'horizontal') {\r\n        let text = '';\r\n        if (showFullName)\r\n            text += customerData.name;\r\n        if (showEmail)\r\n            text += (text ? ' - ' : '') + customerData.email;\r\n        if (text)\r\n            ctx.fillText(text, 10, y);\r\n        if (showPhone) {\r\n            ctx.fillText(customerData.phone, element.width - ctx.measureText(customerData.phone).width - 10, y);\r\n        }\r\n    }\r\n    else if (layout === 'compact') {\r\n        let compactText = '';\r\n        if (showFullName)\r\n            compactText += customerData.name;\r\n        if (showAddress)\r\n            compactText += (compactText ? '  ' : '') + customerData.address.split(',')[0];\r\n        if (showEmail)\r\n            compactText += (compactText ? '  ' : '') + customerData.email;\r\n        if (showPhone)\r\n            compactText += (compactText ? '  ' : '') + customerData.phone;\r\n        // Wrap text if too long\r\n        const maxWidth = element.width - 20;\r\n        const words = compactText.split(' ');\r\n        let line = '';\r\n        let compactY = y;\r\n        for (let i = 0; i < words.length; i++) {\r\n            const testLine = line + words[i] + ' ';\r\n            const metrics = ctx.measureText(testLine);\r\n            if (metrics.width > maxWidth && i > 0) {\r\n                ctx.fillText(line, 10, compactY);\r\n                line = words[i] + ' ';\r\n                compactY += 16;\r\n            }\r\n            else {\r\n                line = testLine;\r\n            }\r\n        }\r\n        ctx.fillText(line, 10, compactY);\r\n    }\r\n};\r\nconst drawCompanyInfo = (ctx, element, canvasSettings) => {\r\n    const props = element;\r\n    const fontSize = props.fontSize || 12;\r\n    const fontFamily = props.fontFamily || 'Arial';\r\n    const fontWeight = props.fontWeight || 'normal';\r\n    const fontStyle = props.fontStyle || 'normal';\r\n    // Proprits de police pour l'en-tte (nom de l'entreprise)\r\n    const headerFontSize = props.headerFontSize || Math.round(fontSize * 1.2);\r\n    const headerFontFamily = props.headerFontFamily || fontFamily;\r\n    const headerFontWeight = props.headerFontWeight || 'bold';\r\n    const headerFontStyle = props.headerFontStyle || fontStyle;\r\n    // Proprits de police pour le corps du texte\r\n    const bodyFontSize = props.bodyFontSize || fontSize;\r\n    const bodyFontFamily = props.bodyFontFamily || fontFamily;\r\n    const bodyFontWeight = props.bodyFontWeight || fontWeight;\r\n    const bodyFontStyle = props.bodyFontStyle || fontStyle;\r\n    const textAlign = 'left'; // Forcer alignement  gauche pour company_info\r\n    const theme = (props.theme || 'corporate');\r\n    const showBackground = props.showBackground !== false; // Par dfaut true\r\n    const showBorders = props.showBorders !== false; // Par dfaut true\r\n    const showCompanyName = props.showCompanyName !== false; // Par dfaut true\r\n    const showAddress = props.showAddress !== false; // Par dfaut true\r\n    const showPhone = props.showPhone !== false; // Par dfaut true\r\n    const showEmail = props.showEmail !== false; // Par dfaut true\r\n    const showSiret = props.showSiret !== false; // Par dfaut true\r\n    const showVat = props.showVat !== false; // Par dfaut true\r\n    const showRcs = props.showRcs !== false; // Par dfaut true\r\n    const showCapital = props.showCapital !== false; // Par dfaut true\r\n    // Dfinition des thmes\r\n    const themes = {\r\n        corporate: {\r\n            backgroundColor: '#ffffff',\r\n            borderColor: '#1f2937',\r\n            textColor: '#374151',\r\n            headerTextColor: '#111827'\r\n        },\r\n        modern: {\r\n            backgroundColor: '#ffffff',\r\n            borderColor: '#3b82f6',\r\n            textColor: '#1e40af',\r\n            headerTextColor: '#1e3a8a'\r\n        },\r\n        elegant: {\r\n            backgroundColor: '#ffffff',\r\n            borderColor: '#8b5cf6',\r\n            textColor: '#6d28d9',\r\n            headerTextColor: '#581c87'\r\n        },\r\n        minimal: {\r\n            backgroundColor: '#ffffff',\r\n            borderColor: '#e5e7eb',\r\n            textColor: '#374151',\r\n            headerTextColor: '#111827'\r\n        },\r\n        professional: {\r\n            backgroundColor: '#ffffff',\r\n            borderColor: '#059669',\r\n            textColor: '#047857',\r\n            headerTextColor: '#064e3b'\r\n        }\r\n    };\r\n    const currentTheme = themes[theme] || themes.corporate;\r\n    // Utiliser les couleurs depuis les props de l'lment ou le thme (PAS les paramtres canvas globaux)\r\n    const bgColor = normalizeColor(props.backgroundColor || currentTheme.backgroundColor);\r\n    const borderCol = normalizeColor(props.borderColor || currentTheme.borderColor);\r\n    const txtColor = normalizeColor(props.textColor || currentTheme.textColor);\r\n    const headerTxtColor = normalizeColor(props.headerTextColor || currentTheme.headerTextColor);\r\n    // Appliquer le fond si demand\r\n    if (showBackground) {\r\n        ctx.fillStyle = bgColor;\r\n        ctx.fillRect(0, 0, element.width, element.height);\r\n    }\r\n    // Appliquer les bordures si demand\r\n    if (showBorders) {\r\n        ctx.strokeStyle = borderCol;\r\n        ctx.lineWidth = props.borderWidth || 1;\r\n        ctx.strokeRect(0, 0, element.width, element.height);\r\n    }\r\n    ctx.fillStyle = txtColor;\r\n    ctx.textAlign = textAlign;\r\n    // Calcul de la position X (toujours align  gauche pour company_info)\r\n    let x = 10;\r\n    let y = 20;\r\n    // Informations entreprise hybrides : props configurables + valeurs par dfaut\r\n    const companyData = {\r\n        name: props.companyName || 'Ma Boutique En Ligne',\r\n        address: props.companyAddress || '25 avenue des Commerants',\r\n        city: props.companyCity || '69000 Lyon',\r\n        siret: props.companySiret || 'SIRET: 123 456 789 00012',\r\n        tva: props.companyTva || 'TVA: FR 12 345 678 901',\r\n        rcs: props.companyRcs || 'RCS: Lyon B 123 456 789',\r\n        capital: props.companyCapital || 'Capital social: 10 000 ',\r\n        email: props.companyEmail || 'contact@maboutique.com',\r\n        phone: props.companyPhone || '+33 4 12 34 56 78'\r\n    };\r\n    // Afficher le nom de l'entreprise si demand\r\n    if (showCompanyName) {\r\n        ctx.fillStyle = headerTxtColor;\r\n        ctx.font = `${headerFontStyle} ${headerFontWeight} ${headerFontSize}px ${headerFontFamily}`;\r\n        ctx.fillText(companyData.name, x, y);\r\n        y += Math.round(fontSize * 1.5);\r\n        ctx.fillStyle = txtColor;\r\n    }\r\n    // Police normale pour les autres lments\r\n    ctx.font = `${bodyFontStyle} ${bodyFontWeight} ${bodyFontSize}px ${bodyFontFamily}`;\r\n    // Afficher l'adresse si demande\r\n    if (showAddress) {\r\n        ctx.fillText(companyData.address, x, y);\r\n        y += Math.round(fontSize * 1.2);\r\n        ctx.fillText(companyData.city, x, y);\r\n        y += Math.round(fontSize * 1.5);\r\n    }\r\n    // Afficher le SIRET si demand\r\n    if (showSiret) {\r\n        ctx.fillText(companyData.siret, x, y);\r\n        y += Math.round(fontSize * 1.2);\r\n    }\r\n    // Afficher la TVA si demande\r\n    if (showVat) {\r\n        ctx.fillText(companyData.tva, x, y);\r\n        y += Math.round(fontSize * 1.2);\r\n    }\r\n    // Afficher le RCS si demand\r\n    if (showRcs) {\r\n        ctx.fillText(companyData.rcs, x, y);\r\n        y += Math.round(fontSize * 1.2);\r\n    }\r\n    // Afficher le Capital social si demand\r\n    if (showCapital) {\r\n        ctx.fillText(companyData.capital, x, y);\r\n        y += Math.round(fontSize * 1.2);\r\n    }\r\n    // Afficher l'email si demand\r\n    if (showEmail) {\r\n        ctx.fillText(companyData.email, x, y);\r\n        y += Math.round(fontSize * 1.2);\r\n    }\r\n    // Afficher le tlphone si demand\r\n    if (showPhone) {\r\n        ctx.fillText(companyData.phone, x, y);\r\n    }\r\n};\r\nconst drawOrderNumber = (ctx, element, state) => {\r\n    const props = element;\r\n    const fontSize = props.fontSize || 14;\r\n    const fontFamily = props.fontFamily || 'Arial';\r\n    const fontWeight = props.fontWeight || 'normal';\r\n    const fontStyle = props.fontStyle || 'normal';\r\n    // Proprits de police pour le label\r\n    const labelFontSize = props.headerFontSize || fontSize;\r\n    const labelFontFamily = props.headerFontFamily || fontFamily;\r\n    const labelFontWeight = props.headerFontWeight || 'bold';\r\n    const labelFontStyle = props.headerFontStyle || fontStyle;\r\n    // Proprits de police pour le numro\r\n    const numberFontSize = props.numberFontSize || fontSize;\r\n    const numberFontFamily = props.numberFontFamily || fontFamily;\r\n    const numberFontWeight = props.numberFontWeight || fontWeight;\r\n    const numberFontStyle = props.numberFontStyle || fontStyle;\r\n    // Proprits de police pour la date\r\n    const dateFontSize = props.dateFontSize || (fontSize - 2);\r\n    const dateFontFamily = props.dateFontFamily || fontFamily;\r\n    const dateFontWeight = props.dateFontWeight || fontWeight;\r\n    const dateFontStyle = props.dateFontStyle || fontStyle;\r\n    // const textAlign = props.textAlign || 'left'; // left, center, right\r\n    // Proprits d'alignement spcifiques\r\n    // const labelTextAlign = props.labelTextAlign || textAlign;\r\n    // const numberTextAlign = props.numberTextAlign || textAlign;\r\n    // const dateTextAlign = props.dateTextAlign || textAlign;\r\n    const contentAlign = props.contentAlign || 'left'; // Alignement gnral du contenu dans l'lment\r\n    const showLabel = props.showLabel !== false; // Par dfaut true\r\n    const showDate = props.showDate !== false; // Par dfaut true\r\n    const labelPosition = props.labelPosition || 'above'; // above, left, right, below\r\n    const labelText = props.labelText || 'N de commande:'; // Texte personnalisable du libell\r\n    // Fonction helper pour calculer la position X selon l'alignement gnral du contenu\r\n    // const calculateContentX = (align: string) => {\r\n    //   if (align === 'left') {\r\n    //     return 10;\r\n    //   } else if (align === 'center') {\r\n    //     return element.width / 2;\r\n    //   } else { // right\r\n    //     return element.width - 10;\r\n    //   }\r\n    // };\r\n    // Fonction helper pour calculer la position X selon l'alignement du texte\r\n    // const calculateX = (align: string) => {\r\n    //   if (align === 'left') {\r\n    //     return 10;\r\n    //   } else if (align === 'center') {\r\n    //     return element.width / 2;\r\n    //   } else { // right\r\n    //     return element.width - 10;\r\n    //   }\r\n    // };\r\n    // Appliquer le fond seulement si showBackground est activ\r\n    if (props.showBackground !== false) {\r\n        ctx.fillStyle = props.backgroundColor || '#e5e7eb';\r\n        ctx.fillRect(0, 0, element.width, element.height);\r\n    }\r\n    ctx.fillStyle = '#000000';\r\n    // Numro de commande et date fictifs ou rels selon le mode\r\n    let orderNumber;\r\n    let orderDate;\r\n    if (state.previewMode === 'command') {\r\n        orderNumber = wooCommerceManager.getOrderNumber();\r\n        orderDate = wooCommerceManager.getOrderDate();\r\n    }\r\n    else {\r\n        // Utiliser les donnes WooCommerce si disponibles, sinon valeurs par dfaut\r\n        orderNumber = wooCommerceManager.getOrderNumber() || 'CMD-2024-01234';\r\n        orderDate = wooCommerceManager.getOrderDate() || '27/10/2024';\r\n    }\r\n    let y = 20;\r\n    // Calculer la largeur totale du contenu pour l'alignement gnral\r\n    let totalContentWidth = 0;\r\n    if (showLabel) {\r\n        if (labelPosition === 'above' || labelPosition === 'below') {\r\n            // Pour les positions verticales, prendre la largeur maximale\r\n            ctx.font = `${labelFontStyle} ${labelFontWeight} ${labelFontSize}px ${labelFontFamily}`;\r\n            const labelWidth = ctx.measureText(labelText).width;\r\n            ctx.font = `${numberFontStyle} ${numberFontWeight} ${numberFontSize}px ${numberFontFamily}`;\r\n            const numberWidth = ctx.measureText(orderNumber).width;\r\n            totalContentWidth = Math.max(labelWidth, numberWidth);\r\n        }\r\n        else {\r\n            // Pour les positions latrales, calculer la largeur combine\r\n            ctx.font = `${labelFontStyle} ${labelFontWeight} ${labelFontSize}px ${labelFontFamily}`;\r\n            const labelWidth = ctx.measureText(labelText).width;\r\n            ctx.font = `${numberFontStyle} ${numberFontWeight} ${numberFontSize}px ${numberFontFamily}`;\r\n            const numberWidth = ctx.measureText(orderNumber).width;\r\n            totalContentWidth = labelWidth + numberWidth + 15; // 15px d'espace\r\n        }\r\n    }\r\n    else {\r\n        // Juste le numro\r\n        ctx.font = `${numberFontStyle} ${numberFontWeight} ${numberFontSize}px ${numberFontFamily}`;\r\n        totalContentWidth = ctx.measureText(orderNumber).width;\r\n    }\r\n    // Calculer le dcalage pour l'alignement gnral du contenu\r\n    let contentOffsetX = 0;\r\n    if (contentAlign === 'center') {\r\n        contentOffsetX = (element.width - totalContentWidth) / 2 - 10; // -10 car on commence  10\r\n    }\r\n    else if (contentAlign === 'right') {\r\n        contentOffsetX = element.width - totalContentWidth - 20; // -20 pour les marges\r\n    }\r\n    if (showLabel) {\r\n        if (labelPosition === 'above') {\r\n            // Libell au-dessus, numro en-dessous - utiliser l'alignement gnral du contenu\r\n            ctx.font = `${labelFontStyle} ${labelFontWeight} ${labelFontSize}px ${labelFontFamily}`;\r\n            ctx.textAlign = contentAlign;\r\n            const labelX = contentAlign === 'left' ? 10 + contentOffsetX :\r\n                contentAlign === 'center' ? element.width / 2 :\r\n                    element.width - 10;\r\n            ctx.fillText(labelText, labelX, y);\r\n            y += 18;\r\n            ctx.font = `${numberFontStyle} ${numberFontWeight} ${numberFontSize}px ${numberFontFamily}`;\r\n            ctx.textAlign = contentAlign;\r\n            const numberX = contentAlign === 'left' ? 10 + contentOffsetX :\r\n                contentAlign === 'center' ? element.width / 2 :\r\n                    element.width - 10;\r\n            ctx.fillText(orderNumber, numberX, y);\r\n        }\r\n        else if (labelPosition === 'below') {\r\n            // Numro au-dessus, libell en-dessous - utiliser l'alignement gnral du contenu\r\n            ctx.font = `${numberFontStyle} ${numberFontWeight} ${numberFontSize}px ${numberFontFamily}`;\r\n            ctx.textAlign = contentAlign;\r\n            const numberX = contentAlign === 'left' ? 10 + contentOffsetX :\r\n                contentAlign === 'center' ? element.width / 2 :\r\n                    element.width - 10;\r\n            ctx.fillText(orderNumber, numberX, y);\r\n            y += 18;\r\n            ctx.font = `${labelFontStyle} ${labelFontWeight} ${labelFontSize}px ${labelFontFamily}`;\r\n            ctx.textAlign = contentAlign;\r\n            const labelX = contentAlign === 'left' ? 10 + contentOffsetX :\r\n                contentAlign === 'center' ? element.width / 2 :\r\n                    element.width - 10;\r\n            ctx.fillText(labelText, labelX, y);\r\n        }\r\n        else if (labelPosition === 'left') {\r\n            // Libell  gauche, numro  droite - avec espacement optimal et alignement gnral\r\n            ctx.font = `${labelFontStyle} ${labelFontWeight} ${labelFontSize}px ${labelFontFamily}`;\r\n            ctx.textAlign = 'left';\r\n            const labelX = 10 + contentOffsetX;\r\n            ctx.fillText(labelText, labelX, y);\r\n            // Calculer l'espace disponible pour centrer le numro ou l'aligner intelligemment\r\n            const labelWidth = ctx.measureText(labelText).width;\r\n            const numberX = labelX + labelWidth + 15; // 15px d'espace aprs le libell\r\n            ctx.font = `${numberFontStyle} ${numberFontWeight} ${numberFontSize}px ${numberFontFamily}`;\r\n            ctx.textAlign = 'left';\r\n            ctx.fillText(orderNumber, numberX, y);\r\n        }\r\n        else if (labelPosition === 'right') {\r\n            // Numro  gauche, libell  droite - avec espacement optimal et alignement gnral\r\n            ctx.font = `${numberFontStyle} ${numberFontWeight} ${numberFontSize}px ${numberFontFamily}`;\r\n            ctx.textAlign = 'left';\r\n            const numberX = 10 + contentOffsetX;\r\n            ctx.fillText(orderNumber, numberX, y);\r\n            // Calculer la position du libell aprs le numro\r\n            const numberWidth = ctx.measureText(orderNumber).width;\r\n            const labelX = numberX + numberWidth + 15; // 15px d'espace aprs le numro\r\n            ctx.font = `${labelFontStyle} ${labelFontWeight} ${labelFontSize}px ${labelFontFamily}`;\r\n            ctx.textAlign = 'left';\r\n            ctx.fillText(labelText, labelX, y);\r\n        }\r\n    }\r\n    else {\r\n        // Pas de libell, juste le numro avec alignement gnral du contenu\r\n        ctx.font = `${numberFontStyle} ${numberFontWeight} ${numberFontSize}px ${numberFontFamily}`;\r\n        ctx.textAlign = contentAlign;\r\n        // Pour le cas sans libell, utiliser directement calculateContentX sans contentOffsetX\r\n        // car contentOffsetX est calcul pour centrer le contenu total, mais ici on n'a que le numro\r\n        if (contentAlign === 'left') {\r\n            ctx.fillText(orderNumber, 10, y);\r\n        }\r\n        else if (contentAlign === 'center') {\r\n            ctx.fillText(orderNumber, element.width / 2, y);\r\n        }\r\n        else { // right\r\n            ctx.fillText(orderNumber, element.width - 10, y);\r\n        }\r\n    }\r\n    // Afficher la date sur une nouvelle ligne avec le mme alignement gnral\r\n    if (showDate) {\r\n        ctx.font = `${dateFontStyle} ${dateFontWeight} ${dateFontSize}px ${dateFontFamily}`;\r\n        ctx.textAlign = contentAlign;\r\n        // Pour la date, utiliser directement calculateContentX sans contentOffsetX\r\n        // car contentOffsetX est calcul pour centrer le contenu total\r\n        if (contentAlign === 'left') {\r\n            ctx.fillText(`Date: ${orderDate}`, 10, y + 20);\r\n        }\r\n        else if (contentAlign === 'center') {\r\n            ctx.fillText(`Date: ${orderDate}`, element.width / 2, y + 20);\r\n        }\r\n        else { // right\r\n            ctx.fillText(`Date: ${orderDate}`, element.width - 10, y + 20);\r\n        }\r\n    }\r\n};\r\nconst drawDocumentType = (ctx, element, state) => {\r\n    const props = element;\r\n    const fontSize = props.fontSize || 18;\r\n    const fontFamily = props.fontFamily || 'Arial';\r\n    const fontWeight = props.fontWeight || 'bold';\r\n    const fontStyle = props.fontStyle || 'normal';\r\n    const textAlign = props.textAlign || 'left';\r\n    const textColor = props.textColor || '#000000';\r\n    // Appliquer le fond seulement si showBackground est activ\r\n    if (props.showBackground !== false) {\r\n        ctx.fillStyle = props.backgroundColor || '#e5e7eb';\r\n        ctx.fillRect(0, 0, element.width, element.height);\r\n    }\r\n    ctx.fillStyle = textColor;\r\n    ctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\r\n    ctx.textAlign = textAlign;\r\n    // Type de document fictif ou rel selon le mode\r\n    let documentType;\r\n    if (state.previewMode === 'command') {\r\n        // En mode commande rel, on pourrait rcuprer le type depuis WooCommerce\r\n        // Pour l'instant, on utilise la valeur configure ou une valeur par dfaut\r\n        documentType = props.documentType || 'FACTURE';\r\n    }\r\n    else {\r\n        // Donnes fictives pour le mode diteur\r\n        documentType = props.documentType || 'FACTURE';\r\n    }\r\n    // Convertir les valeurs techniques en texte lisible\r\n    const documentTypeLabels = {\r\n        'FACTURE': 'FACTURE',\r\n        'DEVIS': 'DEVIS',\r\n        'BON_COMMANDE': 'BON DE COMMANDE',\r\n        'AVOIR': 'AVOIR',\r\n        'RELEVE': 'RELEVE',\r\n        'CONTRAT': 'CONTRAT'\r\n    };\r\n    documentType = documentTypeLabels[documentType] || documentType;\r\n    const x = textAlign === 'center' ? element.width / 2 : textAlign === 'right' ? element.width - 10 : 10;\r\n    const y = element.height / 2 + fontSize / 3; // Centrer verticalement\r\n    ctx.fillText(documentType, x, y);\r\n};\r\n// Flag global pour afficher les logs dtaills des lments (debug)\r\n// Debug flags - set to true to enable verbose logging\r\n// Constantes pour le cache des images\r\nconst MAX_CACHE_ITEMS = 100; // Max 100 images in cache\r\nexport const Canvas = function Canvas({ width, height, className }) {\r\n    var _a;\r\n    const canvasRef = useRef(null);\r\n    //  Track derniers lments rendus pour viter double rendu\r\n    const lastRenderedElementsRef = useRef('');\r\n    const renderCountRef = useRef(0);\r\n    const { state, dispatch } = useBuilder();\r\n    const canvasSettings = useCanvasSettings();\r\n    debugLog(' Canvas: Component initialized with props:', { width, height, className });\r\n    debugLog(' Canvas: Initial state:', { elements: state.elements.length, selection: state.selection.selectedElements.length, zoom: state.canvas.zoom });\r\n    debugLog(`[Canvas] Component initialized - Dimensions: ${width}x${height}, Settings loaded: ${!!canvasSettings}`);\r\n    // Force re-render when canvas settings change (comment pour viter les boucles)\r\n    // const [, forceUpdate] = useState({});\r\n    // useEffect(() => {\r\n    //   forceUpdate({});\r\n    // }, [canvasSettings.canvasBackgroundColor, canvasSettings.borderColor, canvasSettings.borderWidth, canvasSettings.shadowEnabled, canvasSettings.containerBackgroundColor]);\r\n    // tat pour le menu contextuel\r\n    const [contextMenu, setContextMenu] = useState({\r\n        isVisible: false,\r\n        position: { x: 0, y: 0 }\r\n    });\r\n    //  STATE for image loading - force redraw when images load\r\n    const [imageLoadCount, setImageLoadCount] = useState(0);\r\n    // Rcuprer la limite mmoire JavaScript depuis les paramtres\r\n    const memoryLimitJs = useCanvasSetting('memory_limit_js', 256); // En MB, dfaut 256MB\r\n    //  LAZY LOADING: Rcuprer le paramtre depuis les settings\r\n    const lazyLoadingEnabled = canvasSettings.lazyLoadingEditor;\r\n    //  LAZY LOADING: tat pour tracker les lments visibles\r\n    const [visibleElements, setVisibleElements] = useState(new Set());\r\n    const [viewportBounds, setViewportBounds] = useState({ x: 0, y: 0, width: width, height: height });\r\n    //  LAZY LOADING: Fonction pour dterminer si un lment est visible dans le viewport\r\n    const isElementVisible = useCallback((element, viewport) => {\r\n        // Calculer les bounds de l'lment (simplifi - on pourrait amliorer avec rotation, etc.)\r\n        const elementBounds = {\r\n            x: element.x,\r\n            y: element.y,\r\n            width: element.width,\r\n            height: element.height\r\n        };\r\n        // Vrifier si l'lment intersecte le viewport (avec une marge de 100px)\r\n        const margin = 100;\r\n        return !(elementBounds.x + elementBounds.width < viewportBounds.x - margin ||\r\n            elementBounds.x > viewportBounds.x + viewportBounds.width + margin ||\r\n            elementBounds.y + elementBounds.height < viewportBounds.y - margin ||\r\n            elementBounds.y > viewportBounds.y + viewportBounds.height + margin);\r\n    }, [viewportBounds]); //  LAZY LOADING: Filtrer les lments visibles\r\n    const visibleElementsList = useMemo(() => {\r\n        if (!lazyLoadingEnabled) {\r\n            return state.elements; // Tous les lments si lazy loading dsactiv\r\n        }\r\n        // Toujours inclure les 5 premiers lments pour viter les sauts visuels\r\n        const alwaysVisible = state.elements.slice(0, 5);\r\n        const potentiallyVisible = state.elements.slice(5).filter(element => isElementVisible(element, viewportBounds));\r\n        return [...alwaysVisible, ...potentiallyVisible];\r\n    }, [state.elements, lazyLoadingEnabled, viewportBounds, isElementVisible]);\r\n    // Cache pour les images charges avec mtadonnes de mmoire\r\n    const imageCache = useRef(new Map());\r\n    //  LAZY LOADING: Hook pour mettre  jour le viewport quand le canvas change\r\n    useEffect(() => {\r\n        if (!canvasRef.current)\r\n            return;\r\n        const updateViewport = () => {\r\n            const canvas = canvasRef.current;\r\n            if (!canvas)\r\n                return;\r\n            const rect = canvas.getBoundingClientRect();\r\n            setViewportBounds({\r\n                x: -rect.left,\r\n                y: -rect.top,\r\n                width: window.innerWidth,\r\n                height: window.innerHeight\r\n            });\r\n        };\r\n        // Mettre  jour initialement\r\n        updateViewport();\r\n        // couter les changements de scroll et resize avec passive: true\r\n        window.addEventListener('scroll', updateViewport, { passive: true });\r\n        window.addEventListener('resize', updateViewport, { passive: true });\r\n        return () => {\r\n            window.removeEventListener('scroll', updateViewport);\r\n            window.removeEventListener('resize', updateViewport);\r\n        };\r\n    }, []);\r\n    //  CORRECTION 7: Tracker les URLs rendues pour dtecter changements\r\n    const renderedLogoUrlsRef = useRef(new Map()); // elementId -> logoUrl\r\n    //  Flag: Track if we've done initial render check for images\r\n    const initialImageCheckDoneRef = useRef(false);\r\n    // Fonction pour estimer la taille mmoire d'une image (approximation)\r\n    const estimateImageMemorySize = useCallback((img) => {\r\n        // Estimation base sur : largeur * hauteur * 4 octets (RGBA) + overhead\r\n        const pixelData = img.naturalWidth * img.naturalHeight * 4;\r\n        const overhead = 1024; // Overhead approximatif par image\r\n        return pixelData + overhead;\r\n    }, []);\r\n    // Fonction pour calculer l'usage mmoire total du cache\r\n    const calculateCacheMemoryUsage = useCallback(() => {\r\n        let totalSize = 0;\r\n        for (const [, data] of imageCache.current) {\r\n            totalSize += data.size;\r\n        }\r\n        return totalSize / (1024 * 1024); // Convertir en MB\r\n    }, []);\r\n    // Fonction pour vrifier si la limite mmoire est dpasse\r\n    const isMemoryLimitExceeded = useCallback(() => {\r\n        const currentUsage = calculateCacheMemoryUsage();\r\n        const limit = memoryLimitJs;\r\n        // Vrifier aussi la mmoire globale du navigateur si disponible\r\n        if ('memory' in performance) {\r\n            const perfMemory = performance.memory;\r\n            const browserMemoryUsage = perfMemory.usedJSHeapSize / (1024 * 1024); // MB\r\n            const browserLimit = perfMemory.jsHeapSizeLimit / (1024 * 1024); // MB\r\n            // Si le navigateur approche sa limite, tre plus agressif\r\n            if (browserMemoryUsage > browserLimit * 0.8) {\r\n                debugWarn(`[Canvas Memory] Browser memory usage high: ${browserMemoryUsage.toFixed(1)}MB / ${browserLimit.toFixed(1)}MB`);\r\n                return true;\r\n            }\r\n        }\r\n        return currentUsage > limit * 0.8; // Dclencher le nettoyage  80% de la limite\r\n    }, [calculateCacheMemoryUsage, memoryLimitJs]);\r\n    //  CORRECTION 2: Fonction pour nettoyer le cache des images avec gestion mmoire\r\n    const cleanupImageCache = useCallback(() => {\r\n        const cache = imageCache.current;\r\n        const currentMemoryUsage = calculateCacheMemoryUsage();\r\n        const memoryLimit = memoryLimitJs;\r\n        debugLog(`[Canvas Memory] Starting cache cleanup - Current usage: ${currentMemoryUsage.toFixed(2)}MB, Limit: ${memoryLimit}MB, Items: ${cache.size}`);\r\n        // Nettoyer si limite dpasse ou trop d'lments\r\n        if (isMemoryLimitExceeded() || cache.size > MAX_CACHE_ITEMS) {\r\n            // Trier par date d'utilisation (LRU - Least Recently Used)\r\n            const entries = Array.from(cache.entries()).sort(([, a], [, b]) => a.lastUsed - b.lastUsed);\r\n            // Calculer combien supprimer pour revenir sous 70% de la limite\r\n            const targetMemoryUsage = memoryLimit * 0.7;\r\n            let memoryToFree = Math.max(0, currentMemoryUsage - targetMemoryUsage);\r\n            let itemsToRemove = Math.min(20, Math.ceil(cache.size * 0.2)); // Au moins 20% des lments ou 20 lments max\r\n            let removed = 0;\r\n            let memoryFreed = 0;\r\n            for (const [url, data] of entries) {\r\n                if (removed >= itemsToRemove && memoryFreed >= memoryToFree)\r\n                    break;\r\n                cache.delete(url);\r\n                memoryFreed += data.size / (1024 * 1024); // MB\r\n                removed++;\r\n                debugLog(`[Canvas Memory] Removed image from cache: ${url.split('/').pop()}, Freed: ${(data.size / (1024 * 1024)).toFixed(2)}MB`);\r\n            }\r\n            debugLog(`[Canvas Memory] Cache cleanup completed - Removed ${removed} items, Freed ${memoryFreed.toFixed(2)}MB, New usage: ${(currentMemoryUsage - memoryFreed).toFixed(2)}MB`);\r\n        }\r\n        else {\r\n            debugLog(`[Canvas Memory] Cache cleanup not needed - Usage within limits`);\r\n        }\r\n    }, [calculateCacheMemoryUsage, memoryLimitJs, isMemoryLimitExceeded]);\r\n    // Fonction pour forcer un nettoyage manuel (utile pour le dbogage)\r\n    const forceCacheCleanup = useCallback(() => {\r\n        cleanupImageCache();\r\n    }, [cleanupImageCache]);\r\n    // Exposer les fonctions de gestion mmoire globalement pour le dbogage\r\n    useEffect(() => {\r\n        window.canvasMemoryDebug = {\r\n            getCacheStats: () => ({\r\n                itemCount: imageCache.current.size,\r\n                memoryUsage: calculateCacheMemoryUsage(),\r\n                memoryLimit: memoryLimitJs,\r\n                items: Array.from(imageCache.current.entries()).map(([url, data]) => ({\r\n                    url: url.split('/').pop(),\r\n                    size: (data.size / (1024 * 1024)).toFixed(2) + 'MB',\r\n                    lastUsed: new Date(data.lastUsed).toLocaleTimeString()\r\n                }))\r\n            }),\r\n            forceCleanup: forceCacheCleanup,\r\n            getBrowserMemory: () => {\r\n                if ('memory' in performance) {\r\n                    const perfMemory = performance.memory;\r\n                    return {\r\n                        used: (perfMemory.usedJSHeapSize / (1024 * 1024)).toFixed(1) + 'MB',\r\n                        total: (perfMemory.totalJSHeapSize / (1024 * 1024)).toFixed(1) + 'MB',\r\n                        limit: (perfMemory.jsHeapSizeLimit / (1024 * 1024)).toFixed(1) + 'MB'\r\n                    };\r\n                }\r\n                return { error: 'Performance.memory not available' };\r\n            }\r\n        };\r\n        return () => {\r\n            delete window.canvasMemoryDebug;\r\n        };\r\n    }, [calculateCacheMemoryUsage, memoryLimitJs, forceCacheCleanup]); // Surveillance priodique de la mmoire globale du navigateur\r\n    useEffect(() => {\r\n        const memoryCheckInterval = setInterval(() => {\r\n            if ('memory' in performance) {\r\n                const perfMemory = performance.memory;\r\n                const browserMemoryUsage = perfMemory.usedJSHeapSize / (1024 * 1024); // MB\r\n                const browserLimit = perfMemory.jsHeapSizeLimit / (1024 * 1024); // MB\r\n                const cacheMemoryUsage = calculateCacheMemoryUsage();\r\n                // Log dtaill de la mmoire si activ\r\n                if (canvasSettings.debugMode) {\r\n                }\r\n                // Nettoyage d'urgence si mmoire critique\r\n                if (browserMemoryUsage > browserLimit * 0.9) {\r\n                    debugWarn(`[Canvas Memory] Critical memory usage! Forcing cache cleanup...`);\r\n                    cleanupImageCache();\r\n                }\r\n            }\r\n        }, 10000); // Vrification toutes les 10 secondes\r\n        return () => clearInterval(memoryCheckInterval);\r\n    }, [calculateCacheMemoryUsage, memoryLimitJs, cleanupImageCache, canvasSettings.debugMode]);\r\n    // couter les changements de couleur de fond depuis les paramtres\r\n    useEffect(() => {\r\n        debugLog(`[Canvas] Background color change detected: ${canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.canvasBackgroundColor}`);\r\n        const handleBgColorChange = (event) => {\r\n            debugLog(`[Canvas] Custom background color change event received:`, event.detail);\r\n            // Forcer le re-rendu du canvas avec la nouvelle couleur\r\n            renderCountRef.current += 1;\r\n            // Le canvas se re-rendra automatiquement grce aux dpendances du useEffect principal\r\n        };\r\n        window.addEventListener('pdfBuilderCanvasBgColorChanged', handleBgColorChange, { passive: true });\r\n        return () => {\r\n            window.removeEventListener('pdfBuilderCanvasBgColorChanged', handleBgColorChange);\r\n        };\r\n    }, [canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.canvasBackgroundColor]);\r\n    // Utiliser les hooks pour les interactions\r\n    const { handleDrop, handleDragOver, handleDragLeave, isDragOver } = useCanvasDrop({\r\n        canvasRef,\r\n        canvasWidth: width,\r\n        canvasHeight: height,\r\n        elements: state.elements || [],\r\n        dragEnabled: (_a = canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.selectionDragEnabled) !== null && _a !== void 0 ? _a : true\r\n    });\r\n    const { handleCanvasClick, handleMouseDown, handleMouseMove, handleMouseUp, handleContextMenu, selectionState } = useCanvasInteraction({\r\n        canvasRef,\r\n        canvasWidth: width,\r\n        canvasHeight: height\r\n    });\r\n    // Hook pour les raccourcis clavier\r\n    const keyboardShortcutInfo = useKeyboardShortcuts();\r\n    // Fonctions de rendu WooCommerce avec donnes fictives ou relles selon le mode\r\n    // Fonction helper pour dessiner un placeholder de logo\r\n    const drawLogoPlaceholder = useCallback((ctx, element, alignment, text) => {\r\n        const logoWidth = Math.min(element.width - 20, 120);\r\n        const logoHeight = Math.min(element.height - 20, 60);\r\n        let x = 10;\r\n        if (alignment === 'center') {\r\n            x = (element.width - logoWidth) / 2;\r\n        }\r\n        else if (alignment === 'right') {\r\n            x = element.width - logoWidth - 10;\r\n        }\r\n        const y = (element.height - logoHeight) / 2;\r\n        // Rectangle du logo\r\n        ctx.fillStyle = '#f0f0f0';\r\n        ctx.strokeStyle = '#ccc';\r\n        ctx.lineWidth = 1;\r\n        ctx.fillRect(x, y, logoWidth, logoHeight);\r\n        ctx.strokeRect(x, y, logoWidth, logoHeight);\r\n        // Texte du placeholder\r\n        ctx.fillStyle = '#666';\r\n        ctx.font = '12px Arial';\r\n        ctx.textAlign = 'center';\r\n        ctx.fillText(text, x + logoWidth / 2, y + logoHeight / 2 + 4);\r\n    }, []);\r\n    const drawCompanyLogo = useCallback((ctx, element) => {\r\n        const props = element;\r\n        const logoUrl = props.src || props.logoUrl || '';\r\n        //  FIX: If no logo URL, show a better placeholder\r\n        if (!logoUrl) {\r\n            drawLogoPlaceholder(ctx, element, 'center', 'Configurez le logo entreprise');\r\n            return;\r\n        }\r\n        // const fit = props.fit || 'contain';\r\n        const alignment = props.alignment || 'left';\r\n        //  CORRECTION 7: Dtecter si l'URL a chang\r\n        const lastRenderedUrl = renderedLogoUrlsRef.current.get(element.id);\r\n        if (logoUrl !== lastRenderedUrl) {\r\n            renderedLogoUrlsRef.current.set(element.id, logoUrl);\r\n        }\r\n        // Fond transparent\r\n        ctx.fillStyle = 'transparent';\r\n        ctx.fillRect(0, 0, element.width, element.height);\r\n        if (logoUrl) {\r\n            // Vrifier si l'image est en cache\r\n            let cachedImage = imageCache.current.get(logoUrl);\r\n            if (!cachedImage) {\r\n                const img = document.createElement('img');\r\n                img.crossOrigin = 'anonymous';\r\n                img.src = logoUrl;\r\n                // Grer les erreurs de chargement\r\n                img.onerror = () => {\r\n                    debugError(' [LOGO] Image failed to load:', logoUrl);\r\n                };\r\n                //  CRITICAL: Quand l'image se charge, redessiner le canvas\r\n                img.onload = () => {\r\n                    const size = estimateImageMemorySize(img);\r\n                    imageCache.current.set(logoUrl, {\r\n                        image: img,\r\n                        size: size,\r\n                        lastUsed: Date.now()\r\n                    });\r\n                    // Dclencher un nettoyage aprs ajout\r\n                    cleanupImageCache();\r\n                    // Incrmenter le counter pour forcer un redraw\r\n                    setImageLoadCount(prev => prev + 1);\r\n                };\r\n                // Retourner temporairement pour viter les erreurs\r\n                return;\r\n            }\r\n            const img = cachedImage.image;\r\n            // Mettre  jour la date d'utilisation\r\n            cachedImage.lastUsed = Date.now();\r\n            //  APPROCHE PLUS DIRECTE: Vrifier img.complete au rendu au lieu de compter sur onload\r\n            // Rendre l'image si elle a une URL valide, mme si elle n'est pas encore compltement charge\r\n            const shouldRenderImage = logoUrl && logoUrl.trim() !== '';\r\n            // DEBUG: Log detailed breakdown of shouldRenderImage condition\r\n            // DEBUG: Log image state with more details\r\n            if (shouldRenderImage) {\r\n                try {\r\n                    // Appliquer la rotation si dfinie\r\n                    const rotation = element.rotation || 0;\r\n                    const opacity = element.opacity !== undefined ? element.opacity : 1;\r\n                    const borderRadius = element.borderRadius || 0;\r\n                    const objectFit = element.objectFit || 'contain';\r\n                    // Calculer les dimensions et position selon objectFit\r\n                    const containerWidth = element.width - 20;\r\n                    const containerHeight = element.height - 20;\r\n                    // Si l'image n'est pas encore charge, utiliser des dimensions par dfaut ou essayer de deviner\r\n                    let imageAspectRatio;\r\n                    if (img.naturalWidth > 0 && img.naturalHeight > 0) {\r\n                        imageAspectRatio = img.naturalWidth / img.naturalHeight;\r\n                    }\r\n                    else {\r\n                        // Estimation par dfaut pour les logos d'entreprise (gnralement rectangulaires)\r\n                        imageAspectRatio = 2; // 2:1 ratio par dfaut\r\n                    }\r\n                    const containerAspectRatio = containerWidth / containerHeight;\r\n                    let logoWidth;\r\n                    let logoHeight;\r\n                    let offsetX = 0;\r\n                    let offsetY = 0;\r\n                    switch (objectFit) {\r\n                        case 'contain':\r\n                            // Respecte les proportions, image tient entirement dans le conteneur\r\n                            if (containerAspectRatio > imageAspectRatio) {\r\n                                logoHeight = containerHeight;\r\n                                logoWidth = logoHeight * imageAspectRatio;\r\n                            }\r\n                            else {\r\n                                logoWidth = containerWidth;\r\n                                logoHeight = logoWidth / imageAspectRatio;\r\n                            }\r\n                            break;\r\n                        case 'cover':\r\n                            // Respecte les proportions, image couvre entirement le conteneur\r\n                            if (containerAspectRatio > imageAspectRatio) {\r\n                                logoWidth = containerWidth;\r\n                                logoHeight = logoWidth / imageAspectRatio;\r\n                                offsetY = (containerHeight - logoHeight) / 2;\r\n                            }\r\n                            else {\r\n                                logoHeight = containerHeight;\r\n                                logoWidth = logoHeight * imageAspectRatio;\r\n                                offsetX = (containerWidth - logoWidth) / 2;\r\n                            }\r\n                            break;\r\n                        case 'fill':\r\n                            // tire l'image pour remplir exactement le conteneur\r\n                            logoWidth = containerWidth;\r\n                            logoHeight = containerHeight;\r\n                            break;\r\n                        case 'none':\r\n                            // Taille originale, centre\r\n                            if (img.naturalWidth > 0 && img.naturalHeight > 0) {\r\n                                logoWidth = img.naturalWidth;\r\n                                logoHeight = img.naturalHeight;\r\n                            }\r\n                            else {\r\n                                // Taille par dfaut si pas encore charge\r\n                                logoWidth = Math.min(containerWidth, 120);\r\n                                logoHeight = Math.min(containerHeight, 60);\r\n                            }\r\n                            break;\r\n                        case 'scale-down': {\r\n                            // Taille originale ou contain, selon ce qui est plus petit\r\n                            const originalWidth = img.naturalWidth || 120; // Dfaut si pas charg\r\n                            const originalHeight = img.naturalHeight || 60; // Dfaut si pas charg\r\n                            if (originalWidth <= containerWidth && originalHeight <= containerHeight) {\r\n                                // Taille originale tient, l'utiliser\r\n                                logoWidth = originalWidth;\r\n                                logoHeight = originalHeight;\r\n                            }\r\n                            else {\r\n                                // Utiliser contain\r\n                                if (containerAspectRatio > imageAspectRatio) {\r\n                                    logoHeight = containerHeight;\r\n                                    logoWidth = logoHeight * imageAspectRatio;\r\n                                }\r\n                                else {\r\n                                    logoWidth = containerWidth;\r\n                                    logoHeight = logoWidth / imageAspectRatio;\r\n                                }\r\n                            }\r\n                            break;\r\n                        }\r\n                        default:\r\n                            // Par dfaut contain\r\n                            if (containerAspectRatio > imageAspectRatio) {\r\n                                logoHeight = containerHeight;\r\n                                logoWidth = logoHeight * imageAspectRatio;\r\n                            }\r\n                            else {\r\n                                logoWidth = containerWidth;\r\n                                logoHeight = logoWidth / imageAspectRatio;\r\n                            }\r\n                    }\r\n                    // Calculer la position de base selon l'alignement\r\n                    let x = 10;\r\n                    if (alignment === 'center') {\r\n                        x = (element.width - containerWidth) / 2;\r\n                    }\r\n                    else if (alignment === 'right') {\r\n                        x = element.width - containerWidth - 10;\r\n                    }\r\n                    const y = (element.height - containerHeight) / 2;\r\n                    // Ajuster pour centrer l'image dans son conteneur selon objectFit\r\n                    const imageX = x + (containerWidth - logoWidth) / 2 + offsetX;\r\n                    const imageY = y + (containerHeight - logoHeight) / 2 + offsetY;\r\n                    // Sauvegarder le contexte\r\n                    ctx.save();\r\n                    // Appliquer l'opacit\r\n                    if (opacity < 1) {\r\n                        ctx.globalAlpha = opacity;\r\n                    }\r\n                    // Appliquer la rotation\r\n                    if (rotation !== 0) {\r\n                        const centerX = x + logoWidth / 2;\r\n                        const centerY = y + logoHeight / 2;\r\n                        ctx.translate(centerX, centerY);\r\n                        ctx.rotate((rotation * Math.PI) / 180);\r\n                        ctx.translate(-centerX, -centerY);\r\n                    }\r\n                    // Si borderRadius > 0, crer un chemin arrondi\r\n                    if (borderRadius > 0) {\r\n                        ctx.beginPath();\r\n                        roundedRect(ctx, x, y, logoWidth, logoHeight, borderRadius);\r\n                        ctx.clip();\r\n                    }\r\n                    // Essayer de dessiner l'image - si elle n'est pas charge, cela ne fera rien\r\n                    // mais au moins on aura essay\r\n                    ctx.drawImage(img, imageX, imageY, logoWidth, logoHeight);\r\n                    // Restaurer le contexte\r\n                    ctx.restore();\r\n                }\r\n                catch (error) {\r\n                    debugError(` [LOGO] Error rendering image ${logoUrl}:`, error);\r\n                    // En cas d'erreur, dessiner un placeholder\r\n                    drawLogoPlaceholder(ctx, element, alignment, 'Erreur de chargement');\r\n                }\r\n            }\r\n            else {\r\n                // Pas d'URL valide, dessiner un placeholder\r\n                drawLogoPlaceholder(ctx, element, alignment, 'URL manquante');\r\n            }\r\n        }\r\n        else {\r\n            // Pas d'URL, dessiner un placeholder\r\n            drawLogoPlaceholder(ctx, element, alignment, 'Company_logo');\r\n        }\r\n    }, [drawLogoPlaceholder, cleanupImageCache, estimateImageMemorySize]); //  BUGFIX-008: REMOVED setImageLoadCounter\r\n    //  BUGFIX-007: Memoize drawDynamicText to prevent recreation on every render\r\n    const drawDynamicText = useCallback((ctx, element) => {\r\n        const props = element;\r\n        const text = props.text || 'Texte personnalisable';\r\n        const fontSize = props.fontSize || 14;\r\n        const fontFamily = props.fontFamily || 'Arial';\r\n        const fontWeight = props.fontWeight || 'normal';\r\n        const fontStyle = props.fontStyle || 'normal';\r\n        const autoWrap = props.autoWrap !== false; // Par dfaut activ\r\n        // Appliquer le fond seulement si showBackground est activ\r\n        if (props.showBackground !== false) {\r\n            ctx.fillStyle = props.backgroundColor || '#e5e7eb';\r\n            ctx.fillRect(0, 0, element.width, element.height);\r\n        }\r\n        ctx.fillStyle = '#000000';\r\n        ctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\r\n        ctx.textAlign = 'left';\r\n        // Remplacer les variables gnriques par des valeurs par dfaut\r\n        const processedText = text\r\n            .replace(/\\[date\\]/g, new Date().toLocaleDateString('fr-FR'))\r\n            .replace(/\\[nom\\]/g, 'Dupont')\r\n            .replace(/\\[prenom\\]/g, 'Marie')\r\n            .replace(/\\[entreprise\\]/g, 'Ma Socit')\r\n            .replace(/\\[telephone\\]/g, '+33 1 23 45 67 89')\r\n            .replace(/\\[email\\]/g, 'contact@masociete.com')\r\n            .replace(/\\[site\\]/g, 'www.masociete.com')\r\n            .replace(/\\[ville\\]/g, 'Paris')\r\n            .replace(/\\[siret\\]/g, '123 456 789 00012')\r\n            .replace(/\\[tva\\]/g, 'FR 12 345 678 901')\r\n            .replace(/\\[capital\\]/g, '10 000')\r\n            .replace(/\\[rcs\\]/g, 'Paris B 123 456 789');\r\n        if (autoWrap) {\r\n            // Fonction pour diviser le texte en lignes selon la largeur disponible\r\n            const wrapText = (text, maxWidth) => {\r\n                const words = text.split(' ');\r\n                const lines = [];\r\n                let currentLine = '';\r\n                for (const word of words) {\r\n                    const testLine = currentLine + (currentLine ? ' ' : '') + word;\r\n                    const metrics = ctx.measureText(testLine);\r\n                    if (metrics.width > maxWidth && currentLine) {\r\n                        lines.push(currentLine);\r\n                        currentLine = word;\r\n                    }\r\n                    else {\r\n                        currentLine = testLine;\r\n                    }\r\n                }\r\n                if (currentLine) {\r\n                    lines.push(currentLine);\r\n                }\r\n                return lines;\r\n            };\r\n            // Grer les sauts de ligne existants (\\n)\r\n            const paragraphs = processedText.split('\\n');\r\n            let y = 25;\r\n            paragraphs.forEach((paragraph) => {\r\n                if (paragraph.trim()) {\r\n                    const lines = wrapText(paragraph, element.width - 20); // Marge de 10px de chaque ct\r\n                    lines.forEach((line) => {\r\n                        ctx.fillText(line, 10, y);\r\n                        y += fontSize + 4; // Espacement entre lignes\r\n                    });\r\n                }\r\n                else {\r\n                    y += fontSize + 4; // Ligne vide\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            // Comportement original : grer uniquement les \\n existants\r\n            const lines = processedText.split('\\n');\r\n            let y = 25;\r\n            lines.forEach((line) => {\r\n                ctx.fillText(line, 10, y);\r\n                y += fontSize + 4;\r\n            });\r\n        }\r\n    }, []); // No deps - pure function\r\n    //  BUGFIX-007: Memoize drawMentions to prevent recreation on every render\r\n    const drawMentions = useCallback((ctx, element) => {\r\n        const props = element;\r\n        const fontSizeRaw = props.fontSize || 10;\r\n        //  BUGFIX-021: Robust font size parsing for various formats\r\n        let fontSize;\r\n        if (typeof fontSizeRaw === 'number') {\r\n            fontSize = fontSizeRaw;\r\n        }\r\n        else if (typeof fontSizeRaw === 'string') {\r\n            // Try removing 'px', 'em', 'rem', 'pt' suffixes\r\n            const numStr = fontSizeRaw.replace(/px|em|rem|pt|%/g, '').trim();\r\n            fontSize = parseFloat(numStr) || 10;\r\n            // If it's 'em' or 'rem', convert to approximate px (1em  16px)\r\n            if (fontSizeRaw.includes('em') || fontSizeRaw.includes('rem')) {\r\n                fontSize = fontSize * 16;\r\n            }\r\n        }\r\n        else {\r\n            fontSize = 10;\r\n        }\r\n        // Ensure fontSize is reasonable\r\n        fontSize = Math.max(6, Math.min(72, fontSize));\r\n        const fontFamily = props.fontFamily || 'Arial';\r\n        const fontWeight = props.fontWeight || 'normal';\r\n        const fontStyle = props.fontStyle || 'normal';\r\n        const textAlign = props.textAlign || 'left';\r\n        const text = props.text || 'SARL au capital de 10 000 - RCS Lyon 123 456 789\\nTVA FR 12 345 678 901 - SIRET 123 456 789 00012\\ncontact@maboutique.com - +33 4 12 34 56 78';\r\n        const showSeparator = props.showSeparator !== false;\r\n        const separatorStyle = props.separatorStyle || 'solid';\r\n        const theme = (props.theme || 'legal');\r\n        // Dfinition des thmes pour les mentions\r\n        const themes = {\r\n            legal: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#6b7280',\r\n                textColor: '#374151',\r\n                headerTextColor: '#111827'\r\n            },\r\n            subtle: {\r\n                backgroundColor: '#f9fafb',\r\n                borderColor: '#e5e7eb',\r\n                textColor: '#6b7280',\r\n                headerTextColor: '#374151'\r\n            },\r\n            minimal: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#f3f4f6',\r\n                textColor: '#9ca3af',\r\n                headerTextColor: '#6b7280'\r\n            }\r\n        };\r\n        const currentTheme = themes[theme] || themes.legal;\r\n        // Utiliser les couleurs personnalises si dfinies, sinon utiliser le thme\r\n        const bgColor = normalizeColor(props.backgroundColor || currentTheme.backgroundColor);\r\n        const txtColor = normalizeColor(props.textColor || currentTheme.textColor);\r\n        // Appliquer le fond seulement si showBackground est activ\r\n        if (props.showBackground !== false) {\r\n            ctx.fillStyle = bgColor;\r\n            ctx.fillRect(0, 0, element.width, element.height);\r\n        }\r\n        ctx.fillStyle = txtColor;\r\n        let y = 15;\r\n        // Dessiner le sparateur si activ\r\n        if (showSeparator) {\r\n            ctx.strokeStyle = txtColor;\r\n            ctx.lineWidth = 1;\r\n            if (separatorStyle === 'double') {\r\n                ctx.beginPath();\r\n                ctx.moveTo(10, y - 5);\r\n                ctx.lineTo(element.width - 10, y - 5);\r\n                ctx.stroke();\r\n                ctx.beginPath();\r\n                ctx.moveTo(10, y - 2);\r\n                ctx.lineTo(element.width - 10, y - 2);\r\n                ctx.stroke();\r\n            }\r\n            else {\r\n                ctx.setLineDash(separatorStyle === 'dashed' ? [5, 5] : separatorStyle === 'dotted' ? [2, 2] : []);\r\n                ctx.beginPath();\r\n                ctx.moveTo(10, y - 5);\r\n                ctx.lineTo(element.width - 10, y - 5);\r\n                ctx.stroke();\r\n                ctx.setLineDash([]); // Reset line dash\r\n            }\r\n            y += 10; // Espace aprs le sparateur\r\n        }\r\n        ctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\r\n        ctx.textAlign = textAlign;\r\n        // Fonction de wrapping du texte\r\n        const wrapText = (text, maxWidth) => {\r\n            if (!text)\r\n                return [''];\r\n            // Traiter chaque paragraphe sparment (spar par \\n)\r\n            const paragraphs = text.split('\\n');\r\n            const wrappedParagraphs = [];\r\n            for (const paragraph of paragraphs) {\r\n                if (paragraph.trim() === '') {\r\n                    // Ligne vide (sparateur), on la garde telle quelle\r\n                    wrappedParagraphs.push('');\r\n                    continue;\r\n                }\r\n                // Wrapper le paragraphe comme avant\r\n                const words = paragraph.split(' ');\r\n                const lines = [];\r\n                let currentLine = '';\r\n                for (const word of words) {\r\n                    const testLine = currentLine ? currentLine + ' ' + word : word;\r\n                    const metrics = ctx.measureText(testLine);\r\n                    if (metrics.width > maxWidth && currentLine) {\r\n                        // Le mot ne rentre pas, on passe  la ligne\r\n                        lines.push(currentLine);\r\n                        currentLine = word;\r\n                    }\r\n                    else {\r\n                        currentLine = testLine;\r\n                    }\r\n                }\r\n                if (currentLine) {\r\n                    lines.push(currentLine);\r\n                }\r\n                wrappedParagraphs.push(...lines);\r\n            }\r\n            return wrappedParagraphs;\r\n        };\r\n        // Wrapper le texte selon la largeur disponible\r\n        const maxWidth = element.width - 20; // Marge de 20px\r\n        const wrappedLines = wrapText(text, maxWidth);\r\n        // Calculer le nombre maximum de lignes qui peuvent tenir\r\n        const lineHeight = fontSize + 2;\r\n        const maxLines = Math.floor((element.height - (showSeparator ? 25 : 15)) / lineHeight);\r\n        // Rendre seulement les lignes qui tiennent\r\n        wrappedLines.slice(0, maxLines).forEach((line, index) => {\r\n            const x = textAlign === 'center' ? element.width / 2 : textAlign === 'right' ? element.width - 10 : 10;\r\n            const lineY = (showSeparator ? 25 : 15) + index * lineHeight;\r\n            ctx.fillText(line, x, lineY);\r\n        });\r\n    }, []); // No deps - pure function\r\n    //  BUGFIX-001/004: Memoize drawElement but pass state as parameter to avoid dependency cycle\r\n    const drawElement = useCallback((ctx, element, currentState) => {\r\n        // Vrifier si l'lment est visible\r\n        if (element.visible === false) {\r\n            debugLog(`[Canvas] Skipping invisible element: ${element.type} (${element.id})`);\r\n            return;\r\n        }\r\n        debugLog(`[Canvas] Drawing element: ${element.type} (${element.id}) - Position: (${element.x}, ${element.y}), Size: ${element.width}x${element.height}, Rotation: ${element.rotation || 0}`);\r\n        ctx.save();\r\n        // Appliquer transformation de l'lment\r\n        if (element.rotation) {\r\n            // Rotation autour du centre de l'lment\r\n            const centerX = element.width / 2;\r\n            const centerY = element.height / 2;\r\n            ctx.translate(element.x + centerX, element.y + centerY);\r\n            ctx.rotate((element.rotation * Math.PI) / 180);\r\n            ctx.translate(-centerX, -centerY);\r\n        }\r\n        else {\r\n            // Pas de rotation, translation normale\r\n            ctx.translate(element.x, element.y);\r\n        }\r\n        // Dessiner selon le type d'lment\r\n        switch (element.type) {\r\n            case 'rectangle':\r\n                debugLog(`[Canvas] Rendering rectangle element: ${element.id}`);\r\n                drawRectangle(ctx, element);\r\n                break;\r\n            case 'circle':\r\n                debugLog(`[Canvas] Rendering circle element: ${element.id}`);\r\n                drawCircle(ctx, element);\r\n                break;\r\n            case 'text':\r\n                debugLog(`[Canvas] Rendering text element: ${element.id}`);\r\n                drawText(ctx, element);\r\n                break;\r\n            case 'line':\r\n                debugLog(`[Canvas] Rendering line element: ${element.id}`);\r\n                drawLine(ctx, element);\r\n                break;\r\n            case 'product_table':\r\n                debugLog(`[Canvas] Rendering product table element: ${element.id}`);\r\n                drawProductTable(ctx, element, currentState);\r\n                break;\r\n            case 'customer_info':\r\n                debugLog(`[Canvas] Rendering customer info element: ${element.id}`);\r\n                drawCustomerInfo(ctx, element, currentState);\r\n                break;\r\n            case 'company_info':\r\n                debugLog(`[Canvas] Rendering company info element: ${element.id}`);\r\n                drawCompanyInfo(ctx, element, canvasSettings);\r\n                break;\r\n            case 'company_logo':\r\n                debugLog(`[Canvas] Rendering company logo element: ${element.id}`);\r\n                drawCompanyLogo(ctx, element);\r\n                break;\r\n            case 'order-number':\r\n            case 'order_number':\r\n                debugLog(`[Canvas] Rendering order number element: ${element.id}`);\r\n                drawOrderNumber(ctx, element, currentState);\r\n                break;\r\n            case 'document_type':\r\n                debugLog(`[Canvas] Rendering document type element: ${element.id}`);\r\n                drawDocumentType(ctx, element, currentState);\r\n                break;\r\n            case 'dynamic-text':\r\n                debugLog(`[Canvas] Rendering dynamic text element: ${element.id}`);\r\n                drawDynamicText(ctx, element);\r\n                break;\r\n            case 'mentions':\r\n                debugLog(`[Canvas] Rendering mentions element: ${element.id}`);\r\n                drawMentions(ctx, element);\r\n                break;\r\n            case 'image':\r\n                debugLog(`[Canvas] Rendering image element: ${element.id}`);\r\n                drawImage(ctx, element, imageCache);\r\n                break;\r\n            default:\r\n                debugWarn(`[Canvas] Unknown element type: ${element.type} for element ${element.id}`);\r\n                // lment gnrique - dessiner un rectangle simple\r\n                ctx.strokeStyle = '#000000';\r\n                ctx.lineWidth = 1;\r\n                ctx.strokeRect(0, 0, element.width, element.height);\r\n        }\r\n        ctx.restore();\r\n    }, [drawCompanyLogo, drawDynamicText, drawMentions, canvasSettings]); //  BUGFIX-007: Include memoized draw functions\r\n    // Fonction pour dessiner la slection\r\n    const drawSelection = useCallback((ctx, selectedIds, elements) => {\r\n        const selectedElements = elements.filter(el => selectedIds.includes(el.id));\r\n        if (selectedElements.length === 0) {\r\n            debugLog('[Canvas] Selection cleared - no elements selected');\r\n            return;\r\n        }\r\n        debugLog(`[Canvas] Drawing selection for ${selectedElements.length} element(s):`, selectedIds);\r\n        // Calculer les bounds de slection\r\n        let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\r\n        selectedElements.forEach(el => {\r\n            minX = Math.min(minX, el.x);\r\n            minY = Math.min(minY, el.y);\r\n            maxX = Math.max(maxX, el.x + el.width);\r\n            maxY = Math.max(maxY, el.y + el.height);\r\n        });\r\n        // Rectangle de slection\r\n        ctx.strokeStyle = '#007acc';\r\n        ctx.lineWidth = 1;\r\n        ctx.setLineDash([5, 5]);\r\n        ctx.strokeRect(minX - 2, minY - 2, maxX - minX + 4, maxY - minY + 4);\r\n        // Poignes de redimensionnement (conditionnes par les settings)\r\n        if (canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.selectionShowHandles) {\r\n            const handleSize = 6;\r\n            ctx.fillStyle = '#007acc';\r\n            ctx.setLineDash([]);\r\n            // Coins\r\n            ctx.fillRect(minX - handleSize / 2, minY - handleSize / 2, handleSize, handleSize);\r\n            ctx.fillRect(maxX - handleSize / 2, minY - handleSize / 2, handleSize, handleSize);\r\n            ctx.fillRect(minX - handleSize / 2, maxY - handleSize / 2, handleSize, handleSize);\r\n            ctx.fillRect(maxX - handleSize / 2, maxY - handleSize / 2, handleSize, handleSize);\r\n            // Centres des cts\r\n            const midX = (minX + maxX) / 2;\r\n            const midY = (minY + maxY) / 2;\r\n            ctx.fillRect(midX - handleSize / 2, minY - handleSize / 2, handleSize, handleSize);\r\n            ctx.fillRect(midX - handleSize / 2, maxY - handleSize / 2, handleSize, handleSize);\r\n            ctx.fillRect(minX - handleSize / 2, midY - handleSize / 2, handleSize, handleSize);\r\n            ctx.fillRect(maxX - handleSize / 2, midY - handleSize / 2, handleSize, handleSize);\r\n        }\r\n        // Poignes de rotation (conditionnes par les settings)\r\n        if (canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.selectionRotationEnabled) {\r\n            const rotationHandleSize = 8;\r\n            const rotationHandleDistance = 20;\r\n            // Vrifier si au moins un lment a une rotation proche de 0\r\n            // Utiliser la mme logique de normalisation que dans useCanvasInteraction.ts\r\n            const hasZeroRotation = selectedElements.some(el => {\r\n                const rotation = el.rotation || 0;\r\n                // Normaliser l'angle entre -180 et 180 (mme logique que le snap)\r\n                let normalizedRotation = rotation % 360;\r\n                if (normalizedRotation > 180)\r\n                    normalizedRotation -= 360;\r\n                if (normalizedRotation < -180)\r\n                    normalizedRotation += 360;\r\n                // Utiliser la tolrance pour 0 (10) pour cohrence avec le snap ultra simple\r\n                return Math.abs(normalizedRotation - 0) <= 10;\r\n            });\r\n            // Couleur diffrente pour indiquer le snap  0\r\n            const handleColor = hasZeroRotation ? '#00cc44' : '#007acc';\r\n            ctx.fillStyle = handleColor;\r\n            ctx.strokeStyle = handleColor;\r\n            ctx.lineWidth = 2;\r\n            ctx.setLineDash([]);\r\n            // Centre de la slection\r\n            const centerX = (minX + maxX) / 2;\r\n            const centerY = (minY + maxY) / 2;\r\n            // Position de la poigne de rotation (au-dessus du centre)\r\n            const rotationHandleX = centerX;\r\n            const rotationHandleY = minY - rotationHandleDistance;\r\n            // Cercle pour la poigne de rotation\r\n            ctx.beginPath();\r\n            ctx.arc(rotationHandleX, rotationHandleY, rotationHandleSize / 2, 0, 2 * Math.PI);\r\n            ctx.fill();\r\n            // Ligne reliant la poigne au centre\r\n            ctx.beginPath();\r\n            ctx.moveTo(centerX, centerY);\r\n            ctx.lineTo(rotationHandleX, rotationHandleY);\r\n            ctx.stroke();\r\n        }\r\n        // Afficher les dimensions pour chaque lment slectionn\r\n        selectedElements.forEach(el => {\r\n            if (selectedIds.includes(el.id)) {\r\n                // Coordonnes\r\n                const x = el.x;\r\n                const y = el.y;\r\n                const width = el.width;\r\n                const height = el.height;\r\n                // Afficher les dimensions en pixels sur le coin suprieur droit\r\n                ctx.font = '11px Arial';\r\n                ctx.fillStyle = '#007acc';\r\n                ctx.textAlign = 'right';\r\n                ctx.textBaseline = 'top';\r\n                const dimensionText = `${(width * 1).toFixed(1)}${(height * 1).toFixed(1)}px`;\r\n                const padding = 4;\r\n                const textWidth = ctx.measureText(dimensionText).width;\r\n                // Fond blanc pour meilleure lisibilit\r\n                ctx.fillStyle = 'white';\r\n                ctx.fillRect(x + width - textWidth - padding * 2, y - 20, textWidth + padding * 2, 18);\r\n                // Texte\r\n                ctx.fillStyle = '#007acc';\r\n                ctx.font = 'bold 11px Arial';\r\n                ctx.fillText(dimensionText, x + width - padding, y - 16);\r\n            }\r\n        });\r\n    }, [canvasSettings]);\r\n    // Fonctions pour grer le menu contextuel\r\n    const showContextMenu = useCallback((x, y, elementId) => {\r\n        setContextMenu({\r\n            isVisible: true,\r\n            position: { x, y },\r\n            elementId\r\n        });\r\n    }, []);\r\n    const hideContextMenu = useCallback(() => {\r\n        setContextMenu(prev => ({ ...prev, isVisible: false }));\r\n    }, []);\r\n    const handleContextMenuAction = useCallback((action, elementId) => {\r\n        debugLog(`[Canvas] Context menu action: ${action} on element ${elementId || 'none'}`);\r\n        if (!elementId)\r\n            return;\r\n        switch (action) {\r\n            case 'bring-to-front': {\r\n                debugLog(`[Canvas] Bringing element ${elementId} to front`);\r\n                // Dplacer l'lment  la fin du tableau (devant tous les autres)\r\n                const elementIndex = state.elements.findIndex(el => el.id === elementId);\r\n                if (elementIndex !== -1) {\r\n                    const element = state.elements[elementIndex];\r\n                    const newElements = [\r\n                        ...state.elements.slice(0, elementIndex),\r\n                        ...state.elements.slice(elementIndex + 1),\r\n                        element\r\n                    ];\r\n                    dispatch({ type: 'SET_ELEMENTS', payload: newElements });\r\n                }\r\n                break;\r\n            }\r\n            case 'send-to-back': {\r\n                debugLog(`[Canvas] Sending element ${elementId} to back`);\r\n                // Dplacer l'lment au dbut du tableau (derrire tous les autres)\r\n                const elementIndex = state.elements.findIndex(el => el.id === elementId);\r\n                if (elementIndex !== -1) {\r\n                    const element = state.elements[elementIndex];\r\n                    const newElements = [\r\n                        element,\r\n                        ...state.elements.slice(0, elementIndex),\r\n                        ...state.elements.slice(elementIndex + 1)\r\n                    ];\r\n                    dispatch({ type: 'SET_ELEMENTS', payload: newElements });\r\n                }\r\n                break;\r\n            }\r\n            case 'bring-forward': {\r\n                debugLog(`[Canvas] Bringing element ${elementId} forward`);\r\n                // Dplacer l'lment d'une position vers l'avant\r\n                const elementIndex = state.elements.findIndex(el => el.id === elementId);\r\n                if (elementIndex !== -1 && elementIndex < state.elements.length - 1) {\r\n                    const newElements = [...state.elements];\r\n                    [newElements[elementIndex], newElements[elementIndex + 1]] =\r\n                        [newElements[elementIndex + 1], newElements[elementIndex]];\r\n                    dispatch({ type: 'SET_ELEMENTS', payload: newElements });\r\n                }\r\n                break;\r\n            }\r\n            case 'send-backward': {\r\n                debugLog(`[Canvas] Sending element ${elementId} backward`);\r\n                // Dplacer l'lment d'une position vers l'arrire\r\n                const elementIndex = state.elements.findIndex(el => el.id === elementId);\r\n                if (elementIndex > 0) {\r\n                    const newElements = [...state.elements];\r\n                    [newElements[elementIndex], newElements[elementIndex - 1]] =\r\n                        [newElements[elementIndex - 1], newElements[elementIndex]];\r\n                    dispatch({ type: 'SET_ELEMENTS', payload: newElements });\r\n                }\r\n                break;\r\n            }\r\n            case 'duplicate': {\r\n                debugLog(`[Canvas] Duplicating element ${elementId}`);\r\n                // Dupliquer l'lment avec un nouvel ID et un lger dcalage\r\n                const element = state.elements.find(el => el.id === elementId);\r\n                if (element) {\r\n                    const duplicatedElement = {\r\n                        ...element,\r\n                        id: `element_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n                        x: element.x + 10,\r\n                        y: element.y + 10,\r\n                        createdAt: new Date(),\r\n                        updatedAt: new Date()\r\n                    };\r\n                    dispatch({ type: 'ADD_ELEMENT', payload: duplicatedElement });\r\n                }\r\n                break;\r\n            }\r\n            case 'copy': {\r\n                debugLog(`[Canvas] Copying element ${elementId}`);\r\n                // Copier l'lment dans le presse-papiers interne\r\n                const element = state.elements.find(el => el.id === elementId);\r\n                if (element) {\r\n                    // TODO: Implmenter le presse-papiers interne\r\n                }\r\n                break;\r\n            }\r\n            case 'cut': {\r\n                debugLog(`[Canvas] Cutting element ${elementId}`);\r\n                // Couper l'lment (copier puis supprimer)\r\n                const element = state.elements.find(el => el.id === elementId);\r\n                if (element) {\r\n                    // TODO: Implmenter le presse-papiers interne\r\n                    // dispatch({ type: 'REMOVE_ELEMENT', payload: elementId });\r\n                }\r\n                break;\r\n            }\r\n            case 'reset-size': {\r\n                debugLog(`[Canvas] Resetting size for element ${elementId}`);\r\n                // Rinitialiser la taille de l'lment  ses dimensions par dfaut\r\n                const element = state.elements.find(el => el.id === elementId);\r\n                if (element) {\r\n                    const defaultSizes = {\r\n                        rectangle: { width: 100, height: 100 },\r\n                        circle: { width: 100, height: 100 },\r\n                        text: { width: 100, height: 30 },\r\n                        line: { width: 100, height: 2 },\r\n                        product_table: { width: 400, height: 200 },\r\n                        customer_info: { width: 300, height: 80 },\r\n                        company_info: { width: 300, height: 120 },\r\n                        company_logo: { width: 150, height: 80 },\r\n                        'order-number': { width: 200, height: 40 },\r\n                        document_type: { width: 150, height: 30 },\r\n                        'dynamic-text': { width: 200, height: 60 },\r\n                        mentions: { width: 400, height: 80 }\r\n                    };\r\n                    const defaultSize = defaultSizes[element.type] || { width: 100, height: 100 };\r\n                    dispatch({\r\n                        type: 'UPDATE_ELEMENT',\r\n                        payload: {\r\n                            id: elementId,\r\n                            updates: { width: defaultSize.width, height: defaultSize.height }\r\n                        }\r\n                    });\r\n                }\r\n                break;\r\n            }\r\n            case 'fit-to-content': {\r\n                debugLog(`[Canvas] Fitting element ${elementId} to content`);\r\n                // Ajuster la taille de l'lment  son contenu (pour le texte principalement)\r\n                const element = state.elements.find(el => el.id === elementId);\r\n                if (element && (element.type === 'text' || element.type === 'dynamic-text')) {\r\n                    // Pour les lments texte, ajuster la hauteur selon le contenu\r\n                    const canvas = document.createElement('canvas');\r\n                    const ctx = canvas.getContext('2d');\r\n                    if (ctx) {\r\n                        const props = element;\r\n                        const fontSize = props.fontSize || 14;\r\n                        const fontFamily = props.fontFamily || 'Arial';\r\n                        const fontWeight = props.fontWeight || 'normal';\r\n                        const fontStyle = props.fontStyle || 'normal';\r\n                        ctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\r\n                        const text = props.text || 'Texte';\r\n                        const lines = text.split('\\n');\r\n                        const lineHeight = fontSize + 4;\r\n                        const contentHeight = lines.length * lineHeight + 20; // Marges\r\n                        dispatch({\r\n                            type: 'UPDATE_ELEMENT',\r\n                            payload: {\r\n                                id: elementId,\r\n                                updates: { height: Math.max(contentHeight, 30) }\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n                break;\r\n            }\r\n            case 'delete':\r\n                debugLog(`[Canvas] Deleting element ${elementId}`);\r\n                dispatch({ type: 'REMOVE_ELEMENT', payload: elementId });\r\n                break;\r\n            case 'lock': {\r\n                debugLog(`[Canvas] Toggling lock for element ${elementId}`);\r\n                // Basculer l'tat verrouill de l'lment\r\n                const element = state.elements.find(el => el.id === elementId);\r\n                if (element) {\r\n                    dispatch({\r\n                        type: 'UPDATE_ELEMENT',\r\n                        payload: {\r\n                            id: elementId,\r\n                            updates: { locked: !element.locked }\r\n                        }\r\n                    });\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }, [state.elements, dispatch]);\r\n    const getContextMenuItems = useCallback((elementId) => {\r\n        if (!elementId) {\r\n            // Menu contextuel pour le canvas vide\r\n            return [\r\n                {\r\n                    id: 'section-edit',\r\n                    section: 'DITION'\r\n                },\r\n                {\r\n                    id: 'paste',\r\n                    label: 'Coller',\r\n                    icon: '',\r\n                    shortcut: 'Ctrl+V',\r\n                    action: () => {\r\n                        // TODO: Implmenter le collage depuis le presse-papiers\r\n                    },\r\n                    disabled: true // Dsactiver jusqu' implmentation\r\n                },\r\n                {\r\n                    id: 'select-all',\r\n                    label: 'Tout slectionner',\r\n                    icon: '',\r\n                    shortcut: 'Ctrl+A',\r\n                    action: () => {\r\n                        // Slectionner tous les lments\r\n                        const allElementIds = state.elements.map(el => el.id);\r\n                        dispatch({ type: 'SET_SELECTION', payload: allElementIds });\r\n                    }\r\n                }\r\n            ];\r\n        }\r\n        // Menu contextuel pour un lment\r\n        const element = state.elements.find(el => el.id === elementId);\r\n        const isLocked = (element === null || element === void 0 ? void 0 : element.locked) || false;\r\n        const items = [\r\n            // Section Ordre des calques\r\n            {\r\n                id: 'section-layers',\r\n                section: 'CALQUES'\r\n            },\r\n            {\r\n                id: 'layer-order',\r\n                label: 'Ordre des calques',\r\n                icon: '',\r\n                children: [\r\n                    {\r\n                        id: 'bring-to-front',\r\n                        label: 'Premier plan',\r\n                        icon: '',\r\n                        shortcut: 'Ctrl+',\r\n                        action: () => handleContextMenuAction('bring-to-front', elementId),\r\n                        disabled: isLocked\r\n                    },\r\n                    {\r\n                        id: 'send-to-back',\r\n                        label: 'Arrire plan',\r\n                        icon: '',\r\n                        shortcut: 'Ctrl+',\r\n                        action: () => handleContextMenuAction('send-to-back', elementId),\r\n                        disabled: isLocked\r\n                    },\r\n                    {\r\n                        id: 'bring-forward',\r\n                        label: 'Avancer d\\'un plan',\r\n                        icon: '',\r\n                        shortcut: 'Ctrl+Shift+',\r\n                        action: () => handleContextMenuAction('bring-forward', elementId),\r\n                        disabled: isLocked\r\n                    },\r\n                    {\r\n                        id: 'send-backward',\r\n                        label: 'Reculer d\\'un plan',\r\n                        icon: '',\r\n                        shortcut: 'Ctrl+Shift+',\r\n                        action: () => handleContextMenuAction('send-backward', elementId),\r\n                        disabled: isLocked\r\n                    }\r\n                ]\r\n            },\r\n            { id: 'separator1', separator: true },\r\n            // Section dition\r\n            {\r\n                id: 'section-edit',\r\n                section: 'DITION'\r\n            },\r\n            {\r\n                id: 'duplicate',\r\n                label: 'Dupliquer',\r\n                icon: '',\r\n                shortcut: 'Ctrl+D',\r\n                action: () => handleContextMenuAction('duplicate', elementId),\r\n                disabled: isLocked,\r\n                children: [\r\n                    {\r\n                        id: 'duplicate-here',\r\n                        label: 'Dupliquer ici',\r\n                        icon: '',\r\n                        action: () => handleContextMenuAction('duplicate', elementId),\r\n                        disabled: isLocked\r\n                    },\r\n                    {\r\n                        id: 'duplicate-multiple',\r\n                        label: 'Dupliquer plusieurs...',\r\n                        icon: '',\r\n                        action: () => handleContextMenuAction('duplicate-multiple', elementId),\r\n                        disabled: isLocked\r\n                    }\r\n                ]\r\n            },\r\n            {\r\n                id: 'clipboard',\r\n                label: 'Presse-papiers',\r\n                icon: '',\r\n                children: [\r\n                    {\r\n                        id: 'copy',\r\n                        label: 'Copier',\r\n                        icon: '',\r\n                        shortcut: 'Ctrl+C',\r\n                        action: () => handleContextMenuAction('copy', elementId),\r\n                        disabled: false\r\n                    },\r\n                    {\r\n                        id: 'cut',\r\n                        label: 'Couper',\r\n                        icon: '',\r\n                        shortcut: 'Ctrl+X',\r\n                        action: () => handleContextMenuAction('cut', elementId),\r\n                        disabled: isLocked\r\n                    }\r\n                ]\r\n            },\r\n            { id: 'separator2', separator: true },\r\n            // Section Taille\r\n            {\r\n                id: 'section-size',\r\n                section: 'TAILLE'\r\n            },\r\n            {\r\n                id: 'reset-size',\r\n                label: 'Taille par dfaut',\r\n                icon: '',\r\n                shortcut: 'Ctrl+0',\r\n                action: () => handleContextMenuAction('reset-size', elementId),\r\n                disabled: isLocked\r\n            },\r\n            {\r\n                id: 'fit-to-content',\r\n                label: 'Ajuster au contenu',\r\n                icon: '',\r\n                shortcut: 'Ctrl+Shift+F',\r\n                action: () => handleContextMenuAction('fit-to-content', elementId),\r\n                disabled: isLocked || !((element === null || element === void 0 ? void 0 : element.type) === 'text' || (element === null || element === void 0 ? void 0 : element.type) === 'dynamic-text')\r\n            },\r\n            { id: 'separator3', separator: true },\r\n            // Section tat\r\n            {\r\n                id: 'section-state',\r\n                section: 'TAT'\r\n            },\r\n            {\r\n                id: 'lock',\r\n                label: isLocked ? 'Dverrouiller' : 'Verrouiller',\r\n                icon: isLocked ? '' : '',\r\n                shortcut: isLocked ? 'Ctrl+Shift+L' : 'Ctrl+L',\r\n                action: () => handleContextMenuAction('lock', elementId)\r\n            },\r\n            { id: 'separator4', separator: true },\r\n            // Section Danger\r\n            {\r\n                id: 'section-danger',\r\n                section: 'SUPPRESSION'\r\n            },\r\n            {\r\n                id: 'delete',\r\n                label: 'Supprimer',\r\n                icon: '',\r\n                shortcut: 'Suppr',\r\n                action: () => handleContextMenuAction('delete', elementId),\r\n                disabled: false\r\n            }\r\n        ];\r\n        return items;\r\n    }, [state.elements, handleContextMenuAction, dispatch]);\r\n    // Fonction pour dessiner la grille\r\n    const drawGrid = useCallback((ctx, w, h, size, color) => {\r\n        ctx.strokeStyle = color;\r\n        ctx.lineWidth = 1;\r\n        for (let x = 0; x <= w; x += size) {\r\n            ctx.beginPath();\r\n            ctx.moveTo(x, 0);\r\n            ctx.lineTo(x, h);\r\n            ctx.stroke();\r\n        }\r\n        for (let y = 0; y <= h; y += size) {\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, y);\r\n            ctx.lineTo(w, y);\r\n            ctx.stroke();\r\n        }\r\n    }, []); // No deps - pure function\r\n    // Fonction pour dessiner les guides\r\n    const drawGuides = useCallback((ctx, canvasWidth, canvasHeight) => {\r\n        ctx.save();\r\n        ctx.strokeStyle = '#007acc';\r\n        ctx.lineWidth = 1;\r\n        ctx.setLineDash([5, 5]);\r\n        // Guide horizontal au milieu\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, canvasHeight / 2);\r\n        ctx.lineTo(canvasWidth, canvasHeight / 2);\r\n        ctx.stroke();\r\n        // Guide vertical au milieu\r\n        ctx.beginPath();\r\n        ctx.moveTo(canvasWidth / 2, 0);\r\n        ctx.lineTo(canvasWidth / 2, canvasHeight);\r\n        ctx.stroke();\r\n        ctx.restore();\r\n    }, []);\r\n    // Gestionnaire de clic droit pour le canvas\r\n    const handleCanvasContextMenu = useCallback((event) => {\r\n        event.preventDefault();\r\n        debugLog(` Canvas: Context menu triggered at (${event.clientX}, ${event.clientY})`);\r\n        debugLog(`[Canvas] Context menu triggered at (${event.clientX}, ${event.clientY})`);\r\n        handleContextMenu(event, (x, y, elementId) => {\r\n            debugLog(` Canvas: Context menu callback - Element: ${elementId || 'canvas'}, Position: (${x}, ${y})`);\r\n            debugLog(`[Canvas] Context menu callback - Element: ${elementId || 'canvas'}, Position: (${x}, ${y})`);\r\n            showContextMenu(x, y, elementId);\r\n        });\r\n    }, [handleContextMenu, showContextMenu]);\r\n    // Fonction de rendu du canvas\r\n    const renderCanvas = useCallback(() => {\r\n        const startTime = Date.now();\r\n        renderCountRef.current += 1;\r\n        debugLog(` Canvas: Render #${renderCountRef.current} started - Elements: ${state.elements.length}, Zoom: ${state.canvas.zoom}%, Selection: ${state.selection.selectedElements.length} items`);\r\n        debugLog(`[Canvas] Render #${renderCountRef.current} started - Elements: ${state.elements.length}, Zoom: ${state.canvas.zoom}%, Pan: (${state.canvas.pan.x.toFixed(1)}, ${state.canvas.pan.y.toFixed(1)}), Selection: ${state.selection.selectedElements.length} items`);\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) {\r\n            debugLog(' Canvas: Render cancelled - canvas ref is null');\r\n            debugLog('[Canvas] Render cancelled - canvas ref is null');\r\n            return;\r\n        }\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) {\r\n            debugLog(' Canvas: Render cancelled - canvas context unavailable');\r\n            debugLog('[Canvas] Render cancelled - canvas context unavailable');\r\n            return;\r\n        }\r\n        // Clear canvas with background color from settings (matching PDF background)\r\n        const canvasBgColor = normalizeColor((canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.canvasBackgroundColor) || '#ffffff');\r\n        debugLog(` Canvas: Clearing canvas with background color: ${canvasBgColor}`);\r\n        debugLog(`[Canvas] Clearing canvas with background color: ${canvasBgColor}`);\r\n        ctx.fillStyle = canvasBgColor;\r\n        ctx.fillRect(0, 0, width, height);\r\n        // Note: Canvas border is now handled by CSS styling based on settings\r\n        // DEBUG: Log elements\r\n        if (state.elements.length === 0) {\r\n            // Pas d'lments  dessiner\r\n        }\r\n        else {\r\n            // lments prsents\r\n        }\r\n        // Appliquer transformation (pan uniquement - zoom gr par CSS)\r\n        ctx.save();\r\n        ctx.translate(state.canvas.pan.x, state.canvas.pan.y);\r\n        // Note: Zoom is now handled by CSS display size, no need for ctx.scale()\r\n        // NOTE: Les marges seront ractives aprs que le rendu des lments soit fix\r\n        // const showMargins = canvasSettings.showMargins;\r\n        // if (showMargins && canvasSettings) {\r\n        //   const marginTopPx = (canvasSettings.marginTop || 0) * 3.78;\r\n        //   const marginLeftPx = (canvasSettings.marginLeft || 0) * 3.78;\r\n        //   ctx.translate(marginLeftPx, marginTopPx);\r\n        // }\r\n        // Dessiner la grille si active (utiliser les paramtres Canvas Settings et l'tat du toggle)\r\n        if ((canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.gridShow) && state.canvas.showGrid) {\r\n            drawGrid(ctx, width, height, (canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.gridSize) || 20, (canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.gridColor) || '#e0e0e0');\r\n        }\r\n        // Dessiner les guides si activs (utiliser les paramtres Canvas Settings et l'tat du template)\r\n        if ((canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.guidesEnabled) && state.template.showGuides) {\r\n            drawGuides(ctx, width, height);\r\n        }\r\n        // Dessiner les lments\r\n        debugLog(` Canvas: Rendering ${visibleElementsList.length} visible elements (lazy loading: ${lazyLoadingEnabled})`);\r\n        debugLog(`[Canvas] Rendering ${visibleElementsList.length} visible elements (lazy loading: ${lazyLoadingEnabled})`);\r\n        visibleElementsList.forEach((element) => {\r\n            debugLog(` Canvas: Drawing element: ${element.type} (${element.id}) at (${element.x}, ${element.y}) ${element.width}x${element.height}`);\r\n            debugLog(`[Canvas] Drawing element: ${element.type} (${element.id}) at (${element.x}, ${element.y}) ${element.width}x${element.height}`);\r\n            drawElement(ctx, element, state); //  BUGFIX-001/004: Pass state as parameter\r\n        });\r\n        // Dessiner la slection temporaire (rectangle/lasso en cours)\r\n        if (selectionState === null || selectionState === void 0 ? void 0 : selectionState.isSelecting) {\r\n            if (selectionState.selectionMode === 'rectangle' && selectionState.selectionRect.width > 0 && selectionState.selectionRect.height > 0) {\r\n                // Dessiner le rectangle de slection\r\n                ctx.save();\r\n                ctx.strokeStyle = '#0066cc';\r\n                ctx.lineWidth = 1;\r\n                ctx.setLineDash([5, 5]);\r\n                ctx.strokeRect(selectionState.selectionRect.x, selectionState.selectionRect.y, selectionState.selectionRect.width, selectionState.selectionRect.height);\r\n                // Remplir avec une couleur semi-transparente\r\n                ctx.fillStyle = 'rgba(0, 102, 204, 0.1)';\r\n                ctx.fillRect(selectionState.selectionRect.x, selectionState.selectionRect.y, selectionState.selectionRect.width, selectionState.selectionRect.height);\r\n                ctx.restore();\r\n            }\r\n            else if (selectionState.selectionMode === 'lasso' && selectionState.selectionPoints.length > 1) {\r\n                // Dessiner le lasso\r\n                ctx.save();\r\n                ctx.strokeStyle = '#0066cc';\r\n                ctx.lineWidth = 1;\r\n                ctx.setLineDash([5, 5]);\r\n                ctx.beginPath();\r\n                ctx.moveTo(selectionState.selectionPoints[0].x, selectionState.selectionPoints[0].y);\r\n                for (let i = 1; i < selectionState.selectionPoints.length; i++) {\r\n                    ctx.lineTo(selectionState.selectionPoints[i].x, selectionState.selectionPoints[i].y);\r\n                }\r\n                ctx.closePath();\r\n                ctx.stroke();\r\n                // Remplir avec une couleur semi-transparente\r\n                ctx.fillStyle = 'rgba(0, 102, 204, 0.1)';\r\n                ctx.fill();\r\n                ctx.restore();\r\n            }\r\n        }\r\n        // Dessiner la slection\r\n        if (state.selection.selectedElements.length > 0) {\r\n            drawSelection(ctx, state.selection.selectedElements, state.elements);\r\n        }\r\n        ctx.restore();\r\n        // Log rendu termin avec mtriques de performance\r\n        const renderTime = Date.now() - startTime;\r\n        debugLog(` Canvas: Render #${renderCountRef.current} completed in ${renderTime}ms - ${state.elements.length} elements rendered`);\r\n        debugLog(`[Canvas] Render #${renderCountRef.current} completed in ${renderTime}ms - ${state.elements.length} elements rendered`);\r\n        // Log avertissement si le rendu prend trop de temps\r\n        if (renderTime > 100) {\r\n            debugWarn(` Canvas: Slow render detected: ${renderTime}ms for ${state.elements.length} elements`);\r\n            debugWarn(`[Canvas] Slow render detected: ${renderTime}ms for ${state.elements.length} elements`);\r\n        }\r\n    }, [width, height, canvasSettings, state, drawElement, drawGrid, drawGuides, selectionState, drawSelection, visibleElementsList]); //  Include memoized drawGrid and drawGuides\r\n    // Redessiner quand l'tat change - CORRECTION: Supprimer renderCanvas des dpendances pour viter les boucles\r\n    useEffect(() => {\r\n        debugLog(` Canvas: State change detected - triggering render. Elements: ${state.elements.length}, Selection: ${state.selection.selectedElements.length}, Zoom: ${state.canvas.zoom}%`);\r\n        debugLog(`[Canvas] State change detected - triggering render. Elements: ${state.elements.length}, Selection: ${state.selection.selectedElements.length}, Zoom: ${state.canvas.zoom}%`);\r\n        renderCanvas();\r\n    }, [state, canvasSettings, imageLoadCount, selectionState === null || selectionState === void 0 ? void 0 : selectionState.updateTrigger, visibleElementsList]); // Dpendances directes au lieu de renderCanvas\r\n    // Rendu initial - REMOVED: Redondant avec l'effet principal ci-dessus\r\n    //  Force initial render when elements first load (for cached images)\r\n    useEffect(() => {\r\n        if (state.elements.length > 0 && !initialImageCheckDoneRef.current) {\r\n            debugLog(`[Canvas] Initial elements loaded (${state.elements.length} elements) - scheduling image loading checks`);\r\n            initialImageCheckDoneRef.current = true;\r\n            // Force multiple renders to ensure images are displayed\r\n            const timer1 = setTimeout(() => {\r\n                debugLog(`[Canvas] Image loading check #1`);\r\n                setImageLoadCount(prev => prev + 1);\r\n            }, 100);\r\n            const timer2 = setTimeout(() => {\r\n                debugLog(`[Canvas] Image loading check #2`);\r\n                setImageLoadCount(prev => prev + 1);\r\n            }, 500);\r\n            const timer3 = setTimeout(() => {\r\n                debugLog(`[Canvas] Image loading check #3`);\r\n                setImageLoadCount(prev => prev + 1);\r\n            }, 1000);\r\n            // Add longer timeout for slow-loading images\r\n            const timer4 = setTimeout(() => {\r\n                debugLog(`[Canvas] Image loading check #4 (final)`);\r\n                setImageLoadCount(prev => prev + 1);\r\n            }, 2000);\r\n            return () => {\r\n                clearTimeout(timer1);\r\n                clearTimeout(timer2);\r\n                clearTimeout(timer3);\r\n                clearTimeout(timer4);\r\n            };\r\n        }\r\n    }, [state.elements.length]);\r\n    //  CORRECTION 1: Ajouter beforeunload event pour avertir des changements non-sauvegards\r\n    useEffect(() => {\r\n        const handleBeforeUnload = (e) => {\r\n            if (state.template.isModified) {\r\n                e.preventDefault();\r\n            }\r\n        };\r\n        window.addEventListener('beforeunload', handleBeforeUnload, { passive: true });\r\n        return () => window.removeEventListener('beforeunload', handleBeforeUnload);\r\n    }, [state.template.isModified]);\r\n    //  Initialize monitoring dashboard\r\n    useEffect(() => {\r\n        CanvasMonitoringDashboard.initialize();\r\n        // Silent initialization\r\n    }, []);\r\n    // Calculate border style based on canvas settings\r\n    const borderStyle = isDragOver\r\n        ? '2px solid #007acc'\r\n        : ((canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.borderWidth) && canvasSettings.borderWidth > 0)\r\n            ? `${canvasSettings.borderWidth}px solid ${(canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.borderColor) || '#cccccc'}`\r\n            : 'none';\r\n    // Calculate canvas display size based on zoom\r\n    const zoomScale = state.canvas.zoom / 100;\r\n    const displayWidth = width * zoomScale;\r\n    const displayHeight = height * zoomScale;\r\n    debugLog(`[Canvas] Rendering canvas element - Display size: ${displayWidth}x${displayHeight}, Border: ${borderStyle}, Drag over: ${isDragOver}`);\r\n    return (_jsxs(_Fragment, { children: [_jsx(\"canvas\", { ref: canvasRef, width: width, height: height, className: className, onClick: handleCanvasClick, onMouseDown: handleMouseDown, onMouseMove: handleMouseMove, onMouseUp: handleMouseUp, onContextMenu: handleCanvasContextMenu, onDrop: handleDrop, onDragOver: handleDragOver, onDragLeave: handleDragLeave, style: {\r\n                    width: `${displayWidth}px`,\r\n                    height: `${displayHeight}px`,\r\n                    border: borderStyle,\r\n                    cursor: 'crosshair',\r\n                    backgroundColor: (canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.canvasBackgroundColor) || '#ffffff',\r\n                    boxShadow: (canvasSettings === null || canvasSettings === void 0 ? void 0 : canvasSettings.shadowEnabled) ? '2px 8px 16px rgba(0, 0, 0, 0.3), 0 4px 8px rgba(0, 0, 0, 0.2)' : 'none',\r\n                    transition: 'border-color 0.2s ease, box-shadow 0.2s ease'\r\n                } }), contextMenu.isVisible && (_jsx(ContextMenu, { items: getContextMenuItems(contextMenu.elementId), position: contextMenu.position, onClose: hideContextMenu, isVisible: contextMenu.isVisible }))] }));\r\n};\r\n","/**\r\n * Responsive Design Constants\r\n * Breakpoints et utilitaires pour le design responsive\r\n */\r\nexport const BREAKPOINTS = {\r\n    // Mobile first approach\r\n    xs: 480,\r\n    sm: 768,\r\n    md: 992,\r\n    lg: 1200,\r\n    xl: 1440, // Extra large devices (large desktops, >= 1440px)\r\n};\r\nexport const MEDIA_QUERIES = {\r\n    xs: `(max-width: ${BREAKPOINTS.xs - 1}px)`,\r\n    sm: `(max-width: ${BREAKPOINTS.sm - 1}px)`,\r\n    md: `(max-width: ${BREAKPOINTS.md - 1}px)`,\r\n    lg: `(max-width: ${BREAKPOINTS.lg - 1}px)`,\r\n    xl: `(min-width: ${BREAKPOINTS.xl}px)`,\r\n    // Ranges\r\n    xsOnly: `(max-width: ${BREAKPOINTS.xs - 1}px)`,\r\n    smOnly: `(min-width: ${BREAKPOINTS.xs}px) and (max-width: ${BREAKPOINTS.sm - 1}px)`,\r\n    mdOnly: `(min-width: ${BREAKPOINTS.sm}px) and (max-width: ${BREAKPOINTS.md - 1}px)`,\r\n    lgOnly: `(min-width: ${BREAKPOINTS.md}px) and (max-width: ${BREAKPOINTS.lg - 1}px)`,\r\n    xlOnly: `(min-width: ${BREAKPOINTS.lg}px)`,\r\n};\r\n","import { useState, useEffect } from 'react';\r\nimport { MEDIA_QUERIES } from '../constants/responsive';\r\n/**\r\n * Hook personnalis pour dtecter les media queries\r\n * @param query - La media query  vrifier\r\n * @returns boolean - True si la media query correspond\r\n */\r\nexport function useMediaQuery(query) {\r\n    const [matches, setMatches] = useState(false);\r\n    useEffect(() => {\r\n        const mediaQuery = window.matchMedia(MEDIA_QUERIES[query]);\r\n        // Fonction de callback pour les changements\r\n        const handleChange = (event) => {\r\n            setMatches(event.matches);\r\n        };\r\n        // Vrifier initialement\r\n        setMatches(mediaQuery.matches);\r\n        // couter les changements\r\n        mediaQuery.addEventListener('change', handleChange);\r\n        // Cleanup\r\n        return () => {\r\n            mediaQuery.removeEventListener('change', handleChange);\r\n        };\r\n    }, [query]);\r\n    return matches;\r\n}\r\n/**\r\n * Hook pour obtenir le breakpoint actuel\r\n * @returns Le breakpoint actuel ('xs', 'sm', 'md', 'lg', 'xl')\r\n */\r\nexport function useBreakpoint() {\r\n    const isXs = useMediaQuery('xsOnly');\r\n    const isSm = useMediaQuery('smOnly');\r\n    const isMd = useMediaQuery('mdOnly');\r\n    const isLg = useMediaQuery('lgOnly');\r\n    const isXl = useMediaQuery('xlOnly');\r\n    if (isXs)\r\n        return 'xs';\r\n    if (isSm)\r\n        return 'sm';\r\n    if (isMd)\r\n        return 'md';\r\n    if (isLg)\r\n        return 'lg';\r\n    return 'xl'; // Default to xl for very large screens\r\n}\r\n/**\r\n * Hook pour vrifier si l'cran est mobile\r\n * @returns boolean - True si mobile (xs ou sm)\r\n */\r\nexport function useIsMobile() {\r\n    const breakpoint = useBreakpoint();\r\n    return breakpoint === 'xs' || breakpoint === 'sm';\r\n}\r\n/**\r\n * Hook pour vrifier si l'cran est desktop\r\n * @returns boolean - True si desktop (lg ou xl)\r\n */\r\nexport function useIsDesktop() {\r\n    const breakpoint = useBreakpoint();\r\n    return breakpoint === 'lg' || breakpoint === 'xl';\r\n}\r\n/**\r\n * Hook pour vrifier si l'cran est tablette\r\n * @returns boolean - True si tablette (md)\r\n */\r\nexport function useIsTablet() {\r\n    const breakpoint = useBreakpoint();\r\n    return breakpoint === 'md';\r\n}\r\n","import { jsx as _jsx } from \"react/jsx-runtime\";\r\nimport { useBreakpoint, useIsMobile, useIsTablet, useIsDesktop } from '../../hooks/useResponsive';\r\n/**\r\n * Composant Responsive - Affiche du contenu diffrent selon le breakpoint\r\n */\r\nexport function Responsive({ children, breakpoint, mobile, tablet, desktop, className = '' }) {\r\n    const currentBreakpoint = useBreakpoint();\r\n    const isMobile = useIsMobile();\r\n    const isTablet = useIsTablet();\r\n    const isDesktop = useIsDesktop();\r\n    // Si un breakpoint spcifique est demand\r\n    if (breakpoint && currentBreakpoint === breakpoint) {\r\n        return _jsx(\"div\", { className: className, children: children });\r\n    }\r\n    // Contenu spcifique selon le type d'appareil\r\n    if (isMobile && mobile) {\r\n        return _jsx(\"div\", { className: className, children: mobile });\r\n    }\r\n    if (isTablet && tablet) {\r\n        return _jsx(\"div\", { className: className, children: tablet });\r\n    }\r\n    if (isDesktop && desktop) {\r\n        return _jsx(\"div\", { className: className, children: desktop });\r\n    }\r\n    // Contenu par dfaut\r\n    return _jsx(\"div\", { className: className, children: children });\r\n}\r\n/**\r\n * Conteneur responsive qui applique des classes CSS diffrentes selon l'appareil\r\n */\r\nexport function ResponsiveContainer({ children, className = '', mobileClass = '', tabletClass = '', desktopClass = '' }) {\r\n    const isMobile = useIsMobile();\r\n    const isTablet = useIsTablet();\r\n    const isDesktop = useIsDesktop();\r\n    let responsiveClass = className;\r\n    if (isMobile && mobileClass) {\r\n        responsiveClass += ` ${mobileClass}`;\r\n    }\r\n    else if (isTablet && tabletClass) {\r\n        responsiveClass += ` ${tabletClass}`;\r\n    }\r\n    else if (isDesktop && desktopClass) {\r\n        responsiveClass += ` ${desktopClass}`;\r\n    }\r\n    return (_jsx(\"div\", { className: responsiveClass.trim(), children: children }));\r\n}\r\n/**\r\n * Composant Hidden - Cache le contenu sur certains breakpoints\r\n */\r\nexport function Hidden({ children, on = [], className = '' }) {\r\n    const currentBreakpoint = useBreakpoint();\r\n    if (on.includes(currentBreakpoint)) {\r\n        return null;\r\n    }\r\n    return _jsx(\"div\", { className: className, children: children });\r\n}\r\n/**\r\n * Composant Visible - Affiche le contenu seulement sur certains breakpoints\r\n */\r\nexport function Visible({ children, on = [], className = '' }) {\r\n    const currentBreakpoint = useBreakpoint();\r\n    if (!on.includes(currentBreakpoint)) {\r\n        return null;\r\n    }\r\n    return _jsx(\"div\", { className: className, children: children });\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\r\nimport { useBuilder } from '../../contexts/builder/BuilderContext';\r\nimport { useCanvasSettings } from '../../contexts/CanvasSettingsContext';\r\nimport { useIsMobile, useIsTablet } from '../../hooks/useResponsive';\r\nimport { ResponsiveContainer } from '../ui/Responsive';\r\nexport function Toolbar({ className }) {\r\n    const { state, dispatch, setMode, undo, redo, reset, toggleGrid, toggleGuides, setCanvas } = useBuilder();\r\n    const canvasSettings = useCanvasSettings();\r\n    const isMobile = useIsMobile();\r\n    const isTablet = useIsTablet();\r\n    // Vrifications de scurit\r\n    if (!state) {\r\n        return _jsx(\"div\", { style: { padding: '20px', backgroundColor: '#ffcccc', border: '1px solid #ff0000' }, children: \"Erreur: \\u00C9tat Builder non disponible\" });\r\n    }\r\n    if (!state.history) {\r\n        return _jsx(\"div\", { style: { padding: '20px', backgroundColor: '#ffcccc', border: '1px solid #ff0000' }, children: \"Erreur: Historique non disponible\" });\r\n    }\r\n    if (!state.canvas) {\r\n        return _jsx(\"div\", { style: { padding: '20px', backgroundColor: '#ffcccc', border: '1px solid #ff0000' }, children: \"Erreur: Canvas non disponible\" });\r\n    }\r\n    const tools = [\r\n        { mode: 'select', label: 'Slection', icon: '' },\r\n        { mode: 'rectangle', label: 'Rectangle', icon: '' },\r\n        { mode: 'circle', label: 'Cercle', icon: '' },\r\n        { mode: 'text', label: 'Texte', icon: 'T' },\r\n        { mode: 'line', label: 'Ligne', icon: '' },\r\n        { mode: 'image', label: 'Image', icon: '' },\r\n    ];\r\n    const handleModeChange = (mode) => {\r\n        if (setMode) {\r\n            setMode(mode);\r\n        }\r\n    };\r\n    const handleUndo = () => {\r\n        if (undo) {\r\n            undo();\r\n        }\r\n    };\r\n    const handleRedo = () => {\r\n        if (redo) {\r\n            redo();\r\n        }\r\n    };\r\n    const handleReset = () => {\r\n        if (reset) {\r\n            reset();\r\n        }\r\n    };\r\n    const handleToggleGrid = () => {\r\n        if (toggleGrid && canvasSettings.gridShow) {\r\n            toggleGrid();\r\n        }\r\n    };\r\n    const handleToggleGuides = () => {\r\n        if (toggleGuides && canvasSettings.guidesEnabled) {\r\n            toggleGuides();\r\n        }\r\n    };\r\n    const handleToggleSnapToGrid = () => {\r\n        // Vrifier que la grille globale est active avant d'autoriser l'accrochage\r\n        if (canvasSettings.gridShow && canvasSettings.gridSnapEnabled) {\r\n            const newSnapToGrid = !state.canvas.snapToGrid;\r\n            if (setCanvas) {\r\n                setCanvas({ snapToGrid: newSnapToGrid });\r\n            }\r\n        }\r\n    };\r\n    return (_jsx(ResponsiveContainer, { className: `pdf-builder-toolbar ${className || ''}`, mobileClass: \"toolbar-mobile\", tabletClass: \"toolbar-tablet\", desktopClass: \"toolbar-desktop\", children: _jsx(\"div\", { style: {\r\n                display: 'flex',\r\n                flexDirection: isMobile ? 'row' : 'column',\r\n                gap: isMobile ? '8px' : '12px',\r\n                padding: isMobile ? '8px' : '16px',\r\n                backgroundColor: '#ffffff',\r\n                border: '1px solid #e1e5e9',\r\n                borderRadius: '8px',\r\n                boxShadow: '0 2px 8px rgba(0, 0, 0, 0.1)',\r\n                maxHeight: isMobile ? 'auto' : '140px',\r\n                overflowX: isMobile ? 'auto' : 'visible',\r\n                overflowY: isMobile ? 'visible' : 'auto'\r\n            }, children: _jsxs(\"div\", { style: {\r\n                    display: 'flex',\r\n                    gap: isMobile ? '8px' : '16px',\r\n                    alignItems: isMobile ? 'center' : 'flex-start',\r\n                    flexDirection: isMobile ? 'column' : 'row',\r\n                    minWidth: isMobile ? 'auto' : '220px'\r\n                }, children: [_jsxs(\"section\", { style: {\r\n                            display: 'flex',\r\n                            flexDirection: 'column',\r\n                            gap: '8px',\r\n                            minWidth: isMobile ? 'auto' : '220px',\r\n                            flex: isMobile ? '1' : 'none'\r\n                        }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: isMobile ? '11px' : '13px',\r\n                                    fontWeight: '600',\r\n                                    color: '#374151',\r\n                                    textTransform: 'uppercase',\r\n                                    letterSpacing: '0.5px',\r\n                                    borderLeft: '3px solid #3b82f6',\r\n                                    paddingLeft: '8px',\r\n                                    display: isMobile ? 'none' : 'block'\r\n                                }, children: \"Outils\" }), _jsx(\"div\", { style: {\r\n                                    display: 'flex',\r\n                                    flexWrap: 'wrap',\r\n                                    gap: '6px',\r\n                                    maxHeight: '80px',\r\n                                    alignContent: 'flex-start'\r\n                                }, children: tools.map(tool => (_jsxs(\"button\", { onClick: () => handleModeChange(tool.mode), style: {\r\n                                        padding: '8px 12px',\r\n                                        border: '1px solid #d1d5db',\r\n                                        borderRadius: '6px',\r\n                                        backgroundColor: state.mode === tool.mode ? '#3b82f6' : '#ffffff',\r\n                                        color: state.mode === tool.mode ? '#ffffff' : '#374151',\r\n                                        cursor: 'pointer',\r\n                                        fontSize: '13px',\r\n                                        fontWeight: '500',\r\n                                        display: 'flex',\r\n                                        alignItems: 'center',\r\n                                        gap: '6px',\r\n                                        transition: 'all 0.2s ease',\r\n                                        boxShadow: state.mode === tool.mode ? '0 1px 3px rgba(59, 130, 246, 0.3)' : 'none',\r\n                                        minWidth: '90px',\r\n                                        justifyContent: 'center'\r\n                                    }, onMouseEnter: (e) => {\r\n                                        if (state.mode !== tool.mode) {\r\n                                            e.currentTarget.style.backgroundColor = '#f8fafc';\r\n                                            e.currentTarget.style.borderColor = '#9ca3af';\r\n                                        }\r\n                                    }, onMouseLeave: (e) => {\r\n                                        if (state.mode !== tool.mode) {\r\n                                            e.currentTarget.style.backgroundColor = '#ffffff';\r\n                                            e.currentTarget.style.borderColor = '#d1d5db';\r\n                                        }\r\n                                    }, children: [_jsx(\"span\", { style: { fontSize: '14px' }, children: tool.icon }), _jsx(\"span\", { children: tool.label })] }, tool.mode))) })] }), _jsxs(\"section\", { style: { display: 'flex', flexDirection: 'column', gap: '8px', flex: 1 }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '13px',\r\n                                    fontWeight: '600',\r\n                                    color: '#374151',\r\n                                    textTransform: 'uppercase',\r\n                                    letterSpacing: '0.5px',\r\n                                    borderLeft: '3px solid #10b981',\r\n                                    paddingLeft: '8px'\r\n                                }, children: \"Actions\" }), _jsxs(\"div\", { style: {\r\n                                    display: 'flex',\r\n                                    flexWrap: 'wrap',\r\n                                    gap: '6px',\r\n                                    maxHeight: '80px',\r\n                                    alignContent: 'flex-start'\r\n                                }, children: [_jsx(\"button\", { onClick: handleUndo, disabled: !state.history.canUndo, style: {\r\n                                            padding: '8px 12px',\r\n                                            border: '1px solid #d1d5db',\r\n                                            borderRadius: '6px',\r\n                                            backgroundColor: state.history.canUndo ? '#ffffff' : '#f9fafb',\r\n                                            color: state.history.canUndo ? '#374151' : '#9ca3af',\r\n                                            cursor: state.history.canUndo ? 'pointer' : 'not-allowed',\r\n                                            fontSize: '13px',\r\n                                            fontWeight: '500',\r\n                                            transition: 'all 0.2s ease',\r\n                                            minWidth: '90px'\r\n                                        }, onMouseEnter: (e) => {\r\n                                            if (state.history.canUndo) {\r\n                                                e.currentTarget.style.backgroundColor = '#f8fafc';\r\n                                                e.currentTarget.style.borderColor = '#9ca3af';\r\n                                            }\r\n                                        }, onMouseLeave: (e) => {\r\n                                            if (state.history.canUndo) {\r\n                                                e.currentTarget.style.backgroundColor = '#ffffff';\r\n                                                e.currentTarget.style.borderColor = '#d1d5db';\r\n                                            }\r\n                                        }, children: \"\\u21B6 Annuler\" }), _jsx(\"button\", { onClick: handleRedo, disabled: !state.history.canRedo, style: {\r\n                                            padding: '8px 12px',\r\n                                            border: '1px solid #d1d5db',\r\n                                            borderRadius: '6px',\r\n                                            backgroundColor: state.history.canRedo ? '#ffffff' : '#f9fafb',\r\n                                            color: state.history.canRedo ? '#374151' : '#9ca3af',\r\n                                            cursor: state.history.canRedo ? 'pointer' : 'not-allowed',\r\n                                            fontSize: '13px',\r\n                                            fontWeight: '500',\r\n                                            transition: 'all 0.2s ease',\r\n                                            minWidth: '90px'\r\n                                        }, onMouseEnter: (e) => {\r\n                                            if (state.history.canRedo) {\r\n                                                e.currentTarget.style.backgroundColor = '#f8fafc';\r\n                                                e.currentTarget.style.borderColor = '#9ca3af';\r\n                                            }\r\n                                        }, onMouseLeave: (e) => {\r\n                                            if (state.history.canRedo) {\r\n                                                e.currentTarget.style.backgroundColor = '#ffffff';\r\n                                                e.currentTarget.style.borderColor = '#d1d5db';\r\n                                            }\r\n                                        }, children: \"\\u21B7 R\\u00E9tablir\" }), _jsx(\"button\", { onClick: handleToggleGrid, disabled: !canvasSettings.gridShow, style: {\r\n                                            padding: '8px 12px',\r\n                                            border: '1px solid #d1d5db',\r\n                                            borderRadius: '6px',\r\n                                            backgroundColor: !canvasSettings.gridShow ? '#f9fafb' : (state.canvas.showGrid ? '#3b82f6' : '#ffffff'),\r\n                                            color: !canvasSettings.gridShow ? '#9ca3af' : (state.canvas.showGrid ? '#ffffff' : '#374151'),\r\n                                            cursor: !canvasSettings.gridShow ? 'not-allowed' : 'pointer',\r\n                                            fontSize: '13px',\r\n                                            fontWeight: '500',\r\n                                            transition: 'all 0.2s ease',\r\n                                            boxShadow: state.canvas.showGrid ? '0 1px 3px rgba(59, 130, 246, 0.3)' : 'none',\r\n                                            opacity: !canvasSettings.gridShow ? 0.6 : 1,\r\n                                            minWidth: '90px'\r\n                                        }, onMouseEnter: (e) => {\r\n                                            if (canvasSettings.gridShow && !state.canvas.showGrid) {\r\n                                                e.currentTarget.style.backgroundColor = '#f8fafc';\r\n                                                e.currentTarget.style.borderColor = '#9ca3af';\r\n                                            }\r\n                                        }, onMouseLeave: (e) => {\r\n                                            if (canvasSettings.gridShow && !state.canvas.showGrid) {\r\n                                                e.currentTarget.style.backgroundColor = '#ffffff';\r\n                                                e.currentTarget.style.borderColor = '#d1d5db';\r\n                                            }\r\n                                        }, children: state.canvas.showGrid ? ' Grille' : ' Grille' }), _jsx(\"button\", { onClick: handleToggleSnapToGrid, disabled: !canvasSettings.gridShow || !canvasSettings.gridSnapEnabled, style: {\r\n                                            padding: '8px 12px',\r\n                                            border: '1px solid #d1d5db',\r\n                                            borderRadius: '6px',\r\n                                            backgroundColor: (!canvasSettings.gridShow || !canvasSettings.gridSnapEnabled) ? '#f9fafb' : (state.canvas.snapToGrid ? '#3b82f6' : '#ffffff'),\r\n                                            color: (!canvasSettings.gridShow || !canvasSettings.gridSnapEnabled) ? '#9ca3af' : (state.canvas.snapToGrid ? '#ffffff' : '#374151'),\r\n                                            cursor: (!canvasSettings.gridShow || !canvasSettings.gridSnapEnabled) ? 'not-allowed' : 'pointer',\r\n                                            fontSize: '13px',\r\n                                            fontWeight: '500',\r\n                                            transition: 'all 0.2s ease',\r\n                                            boxShadow: state.canvas.snapToGrid ? '0 1px 3px rgba(59, 130, 246, 0.3)' : 'none',\r\n                                            opacity: (!canvasSettings.gridShow || !canvasSettings.gridSnapEnabled) ? 0.6 : 1,\r\n                                            minWidth: '90px'\r\n                                        }, onMouseEnter: (e) => {\r\n                                            if (canvasSettings.gridShow && canvasSettings.gridSnapEnabled && !state.canvas.snapToGrid) {\r\n                                                e.currentTarget.style.backgroundColor = '#f8fafc';\r\n                                                e.currentTarget.style.borderColor = '#9ca3af';\r\n                                            }\r\n                                        }, onMouseLeave: (e) => {\r\n                                            if (canvasSettings.gridShow && canvasSettings.gridSnapEnabled && !state.canvas.snapToGrid) {\r\n                                                e.currentTarget.style.backgroundColor = '#ffffff';\r\n                                                e.currentTarget.style.borderColor = '#d1d5db';\r\n                                            }\r\n                                        }, children: \"\\uD83E\\uDDF2 Snap\" }), _jsx(\"button\", { onClick: handleToggleGuides, disabled: !canvasSettings.guidesEnabled, style: {\r\n                                            padding: '8px 12px',\r\n                                            border: '1px solid #d1d5db',\r\n                                            borderRadius: '6px',\r\n                                            backgroundColor: !canvasSettings.guidesEnabled ? '#f9fafb' : (state.template.showGuides ? '#3b82f6' : '#ffffff'),\r\n                                            color: !canvasSettings.guidesEnabled ? '#9ca3af' : (state.template.showGuides ? '#ffffff' : '#374151'),\r\n                                            cursor: !canvasSettings.guidesEnabled ? 'not-allowed' : 'pointer',\r\n                                            fontSize: '13px',\r\n                                            fontWeight: '500',\r\n                                            transition: 'all 0.2s ease',\r\n                                            boxShadow: state.template.showGuides ? '0 1px 3px rgba(59, 130, 246, 0.3)' : 'none',\r\n                                            opacity: !canvasSettings.guidesEnabled ? 0.6 : 1,\r\n                                            minWidth: '90px'\r\n                                        }, onMouseEnter: (e) => {\r\n                                            if (canvasSettings.guidesEnabled && !state.template.showGuides) {\r\n                                                e.currentTarget.style.backgroundColor = '#f8fafc';\r\n                                                e.currentTarget.style.borderColor = '#9ca3af';\r\n                                            }\r\n                                        }, onMouseLeave: (e) => {\r\n                                            if (canvasSettings.guidesEnabled && !state.template.showGuides) {\r\n                                                e.currentTarget.style.backgroundColor = '#ffffff';\r\n                                                e.currentTarget.style.borderColor = '#d1d5db';\r\n                                            }\r\n                                        }, children: state.template.showGuides ? ' Guides' : ' Guides' }), _jsxs(\"div\", { style: {\r\n                                            display: 'flex',\r\n                                            alignItems: 'center',\r\n                                            gap: '4px',\r\n                                            padding: '6px 10px',\r\n                                            backgroundColor: '#f8fafc',\r\n                                            borderRadius: '6px',\r\n                                            border: '1px solid #e2e8f0'\r\n                                        }, children: [_jsx(\"span\", { style: { fontSize: '12px', color: '#64748b', fontWeight: '500' }, children: \"\\uD83D\\uDD0D\" }), _jsx(\"button\", { onClick: () => {\r\n                                                    // Zoom out\r\n                                                    const newZoom = Math.max(canvasSettings.zoomMin, state.canvas.zoom - canvasSettings.zoomStep);\r\n                                                    if (setCanvas) {\r\n                                                        setCanvas({ zoom: newZoom });\r\n                                                    }\r\n                                                }, style: {\r\n                                                    padding: '2px 6px',\r\n                                                    border: '1px solid #d1d5db',\r\n                                                    borderRadius: '4px',\r\n                                                    backgroundColor: '#ffffff',\r\n                                                    color: '#374151',\r\n                                                    cursor: 'pointer',\r\n                                                    fontSize: '12px',\r\n                                                    fontWeight: '600',\r\n                                                    minWidth: '24px'\r\n                                                }, title: \"Zoom arri\\u00E8re\", children: \"\\u2796\" }), _jsxs(\"span\", { style: {\r\n                                                    fontSize: '12px',\r\n                                                    fontWeight: '600',\r\n                                                    color: '#374151',\r\n                                                    minWidth: '40px',\r\n                                                    textAlign: 'center'\r\n                                                }, children: [state.canvas.zoom, \"%\"] }), _jsx(\"button\", { onClick: () => {\r\n                                                    // Zoom in\r\n                                                    const newZoom = Math.min(canvasSettings.zoomMax, state.canvas.zoom + canvasSettings.zoomStep);\r\n                                                    if (setCanvas) {\r\n                                                        setCanvas({ zoom: newZoom });\r\n                                                    }\r\n                                                }, style: {\r\n                                                    padding: '2px 6px',\r\n                                                    border: '1px solid #d1d5db',\r\n                                                    borderRadius: '4px',\r\n                                                    backgroundColor: '#ffffff',\r\n                                                    color: '#374151',\r\n                                                    cursor: 'pointer',\r\n                                                    fontSize: '12px',\r\n                                                    fontWeight: '600',\r\n                                                    minWidth: '24px'\r\n                                                }, title: \"Zoom avant\", children: \"\\u2795\" }), _jsx(\"span\", { style: { fontSize: '10px', color: '#94a3b8', margin: '0 2px' }, children: \"|\" }), _jsx(\"button\", { onClick: () => {\r\n                                                    // Fit to screen (zoom to fit canvas)\r\n                                                    if (setCanvas) {\r\n                                                        const fitZoom = Math.max(canvasSettings.zoomMin, Math.min(100, canvasSettings.zoomMax));\r\n                                                        setCanvas({ zoom: fitZoom });\r\n                                                    }\r\n                                                }, style: {\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #d1d5db',\r\n                                                    borderRadius: '4px',\r\n                                                    backgroundColor: '#ffffff',\r\n                                                    color: '#374151',\r\n                                                    cursor: 'pointer',\r\n                                                    fontSize: '11px',\r\n                                                    fontWeight: '500'\r\n                                                }, title: \"Adapter \\u00E0 l'\\u00E9cran\", children: \"\\uD83D\\uDD04\" })] })] })] }), _jsxs(\"section\", { style: { display: 'flex', flexDirection: 'column', gap: '6px', minWidth: '160px', marginLeft: 'auto' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '13px',\r\n                                    fontWeight: '600',\r\n                                    color: '#374151',\r\n                                    textTransform: 'uppercase',\r\n                                    letterSpacing: '0.5px',\r\n                                    borderLeft: '3px solid #f59e0b',\r\n                                    paddingLeft: '8px'\r\n                                }, children: \"Infos\" }), _jsxs(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    color: '#6b7280',\r\n                                    display: 'flex',\r\n                                    flexDirection: 'column',\r\n                                    gap: '2px',\r\n                                    backgroundColor: '#f9fafb',\r\n                                    padding: '6px',\r\n                                    borderRadius: '6px',\r\n                                    border: '1px solid #e5e7eb'\r\n                                }, children: [_jsxs(\"div\", { style: { display: 'flex', justifyContent: 'space-between' }, children: [_jsx(\"span\", { children: \"\\u00C9l\\u00E9ments:\" }), _jsx(\"span\", { style: { fontWeight: '600', color: '#374151' }, children: state.elements.length })] }), _jsxs(\"div\", { style: { display: 'flex', justifyContent: 'space-between' }, children: [_jsx(\"span\", { children: \"S\\u00E9lection:\" }), _jsx(\"span\", { style: { fontWeight: '600', color: '#374151' }, children: state.selection.selectedElements.length })] }), _jsxs(\"div\", { style: { display: 'flex', justifyContent: 'space-between' }, children: [_jsx(\"span\", { children: \"Mode:\" }), _jsx(\"span\", { style: { fontWeight: '600', color: '#374151' }, children: state.mode })] }), _jsxs(\"div\", { style: { display: 'flex', justifyContent: 'space-between' }, children: [_jsx(\"span\", { children: \"Zoom:\" }), _jsxs(\"span\", { style: { fontWeight: '600', color: '#374151' }, children: [state.canvas.zoom, \"%\"] })] })] })] })] }) }) }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport { useState } from 'react';\r\n// Composant Accordion personnalis\r\nconst Accordion = ({ title, children, defaultOpen = false }) => {\r\n    const [isOpen, setIsOpen] = useState(defaultOpen);\r\n    return (_jsxs(\"div\", { style: { marginBottom: '16px', border: '1px solid #e9ecef', borderRadius: '4px', overflow: 'hidden' }, children: [_jsxs(\"div\", { onClick: () => setIsOpen(!isOpen), style: {\r\n                    padding: '12px',\r\n                    backgroundColor: '#f8f9fa',\r\n                    cursor: 'pointer',\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'center',\r\n                    borderBottom: isOpen ? '1px solid #e9ecef' : 'none'\r\n                }, children: [_jsx(\"h4\", { style: { margin: '0', fontSize: '13px', fontWeight: 'bold', color: '#495057' }, children: title }), _jsx(\"span\", { style: {\r\n                            fontSize: '12px',\r\n                            color: '#6c757d',\r\n                            transform: isOpen ? 'rotate(180deg)' : 'rotate(0deg)'\r\n                        }, children: \"\\u25BC\" })] }), _jsx(\"div\", { style: {\r\n                    maxHeight: isOpen ? '1000px' : '0px',\r\n                    overflow: 'hidden',\r\n                    padding: isOpen ? '12px' : '0px 12px',\r\n                    backgroundColor: '#ffffff'\r\n                }, children: children })] }));\r\n};\r\n// Composant Toggle personnalis\r\nconst Toggle = ({ checked, onChange, label, description }) => (_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"div\", { style: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                marginBottom: '6px'\r\n            }, children: [_jsx(\"label\", { style: {\r\n                        fontSize: '12px',\r\n                        fontWeight: 'bold',\r\n                        color: '#333',\r\n                        flex: 1\r\n                    }, children: label }), _jsx(\"div\", { onClick: () => onChange(!checked), style: {\r\n                        position: 'relative',\r\n                        width: '44px',\r\n                        height: '24px',\r\n                        backgroundColor: checked ? '#007bff' : '#ccc',\r\n                        borderRadius: '12px',\r\n                        cursor: 'pointer',\r\n                        border: 'none'\r\n                    }, children: _jsx(\"div\", { style: {\r\n                            position: 'absolute',\r\n                            top: '2px',\r\n                            left: checked ? '22px' : '2px',\r\n                            width: '20px',\r\n                            height: '20px',\r\n                            backgroundColor: 'white',\r\n                            borderRadius: '50%',\r\n                            boxShadow: '0 1px 3px rgba(0,0,0,0.2)'\r\n                        } }) })] }), _jsx(\"div\", { style: {\r\n                fontSize: '11px',\r\n                color: '#666',\r\n                lineHeight: '1.4'\r\n            }, children: description })] }));\r\nexport function ProductTableProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const currentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px' }, children: [_jsx(\"button\", { onClick: () => setCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: currentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: currentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: currentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: currentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: currentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: currentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), currentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Structure du tableau\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showHeaders !== false, onChange: (checked) => onChange(element.id, 'showHeaders', checked), label: \"Afficher les en-t\\u00EAtes\", description: \"Affiche les noms des colonnes\" }), _jsx(Toggle, { checked: element.showBorders !== false, onChange: (checked) => onChange(element.id, 'showBorders', checked), label: \"Afficher les bordures\", description: \"Affiche les bordures du tableau\" }), _jsx(Toggle, { checked: element.showAlternatingRows !== false, onChange: (checked) => onChange(element.id, 'showAlternatingRows', checked), label: \"Lignes altern\\u00E9es\", description: \"Alterne les couleurs des lignes\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Colonnes produits\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showSku !== false, onChange: (checked) => onChange(element.id, 'showSku', checked), label: \"Afficher les SKU\", description: \"Colonne des r\\u00E9f\\u00E9rences produit\" }), _jsx(Toggle, { checked: element.showDescription !== false, onChange: (checked) => onChange(element.id, 'showDescription', checked), label: \"Afficher les descriptions\", description: \"Colonne des descriptions courtes\" }), _jsx(Toggle, { checked: element.showQuantity !== false, onChange: (checked) => onChange(element.id, 'showQuantity', checked), label: \"Afficher la quantit\\u00E9\", description: \"Colonne quantit\\u00E9 des produits\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"\\u00C9l\\u00E9ments de calcul\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showShipping !== false, onChange: (checked) => onChange(element.id, 'showShipping', checked), label: \"Afficher les frais de port\", description: \"Affiche les frais de livraison\" }), _jsx(Toggle, { checked: element.showTax !== false, onChange: (checked) => onChange(element.id, 'showTax', checked), label: \"Afficher la TVA\", description: \"Affiche les taxes sur le total\" }), _jsx(Toggle, { checked: element.showGlobalDiscount !== false, onChange: (checked) => onChange(element.id, 'showGlobalDiscount', checked), label: \"Afficher la remise globale\", description: \"Affiche la remise globale appliqu\\u00E9e\" })] })] })] })), currentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsxs(Accordion, { title: \"Police globale du tableau\", defaultOpen: true, children: [_jsxs(\"div\", { style: {\r\n                                    display: 'flex',\r\n                                    flexDirection: 'column',\r\n                                    gap: '12px'\r\n                                }, children: [_jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px', color: '#007bff' }, children: \"Taille\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"24\", value: element.globalFontSize || 11, onChange: (e) => onChange(element.id, 'globalFontSize', parseInt(e.target.value) || 11), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 6px',\r\n                                                    border: '1px solid #007bff',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '11px',\r\n                                                    backgroundColor: 'white'\r\n                                                } })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px', color: '#007bff' }, children: \"Police\" }), _jsxs(\"select\", { value: element.globalFontFamily || 'Arial', onChange: (e) => onChange(element.id, 'globalFontFamily', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 6px',\r\n                                                    border: '1px solid #007bff',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '11px',\r\n                                                    backgroundColor: 'white'\r\n                                                }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px', color: '#007bff' }, children: \"\\u00C9paisseur\" }), _jsxs(\"select\", { value: element.globalFontWeight || 'normal', onChange: (e) => onChange(element.id, 'globalFontWeight', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 6px',\r\n                                                    border: '1px solid #007bff',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '11px',\r\n                                                    backgroundColor: 'white'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras\" })] })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px', color: '#007bff' }, children: \"Style\" }), _jsxs(\"select\", { value: element.globalFontStyle || 'normal', onChange: (e) => onChange(element.id, 'globalFontStyle', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 6px',\r\n                                                    border: '1px solid #007bff',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '11px',\r\n                                                    backgroundColor: 'white'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] })] })] }), _jsx(\"div\", { style: {\r\n                                    fontSize: '10px',\r\n                                    color: '#666',\r\n                                    marginTop: '8px',\r\n                                    textAlign: 'center',\r\n                                    fontStyle: 'italic'\r\n                                }, children: \"Ces param\\u00E8tres s'appliquent \\u00E0 tout le tableau. Vous pouvez les personnaliser par zone ci-dessous.\" })] }), !element.globalFontEnabled && (_jsxs(_Fragment, { children: [_jsxs(Accordion, { title: \"Police de l'ent\\u00EAte\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police de l'ent\\u00EAte\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"24\", value: element.headerFontSize || element.globalFontSize || 12, onChange: (e) => onChange(element.id, 'headerFontSize', parseInt(e.target.value) || 12), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                } }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontSize || 11, \"px\"] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Famille de police de l'ent\\u00EAte\" }), _jsxs(\"select\", { value: element.headerFontFamily || element.globalFontFamily || 'Arial', onChange: (e) => onChange(element.id, 'headerFontFamily', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontFamily || 'Arial'] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de police de l'ent\\u00EAte\" }), _jsxs(\"select\", { value: element.headerFontWeight || element.globalFontWeight || 'bold', onChange: (e) => onChange(element.id, 'headerFontWeight', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal (400)\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras (700)\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin (300)\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras (900)\" })] }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontWeight || 'normal'] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Style de police de l'ent\\u00EAte\" }), _jsxs(\"select\", { value: element.headerFontStyle || element.globalFontStyle || 'normal', onChange: (e) => onChange(element.id, 'headerFontStyle', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontStyle || 'normal'] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte de l'ent\\u00EAte\" }), _jsx(\"input\", { type: \"color\", value: element.headerTextColor || '#374151', onChange: (e) => onChange(element.id, 'headerTextColor', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    height: '32px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px'\r\n                                                } }), _jsx(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: \"D\\u00E9faut: #374151\" })] })] }), _jsxs(Accordion, { title: \"Police des lignes\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police des lignes\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"24\", value: element.rowFontSize || element.globalFontSize || 11, onChange: (e) => onChange(element.id, 'rowFontSize', parseInt(e.target.value) || 11), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                } }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontSize || 11, \"px\"] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Famille de police des lignes\" }), _jsxs(\"select\", { value: element.rowFontFamily || element.globalFontFamily || 'Arial', onChange: (e) => onChange(element.id, 'rowFontFamily', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontFamily || 'Arial'] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de police des lignes\" }), _jsxs(\"select\", { value: element.rowFontWeight || element.globalFontWeight || 'normal', onChange: (e) => onChange(element.id, 'rowFontWeight', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal (400)\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras (700)\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin (300)\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras (900)\" })] }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontWeight || 'normal'] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Style de police des lignes\" }), _jsxs(\"select\", { value: element.rowFontStyle || element.globalFontStyle || 'normal', onChange: (e) => onChange(element.id, 'rowFontStyle', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontStyle || 'normal'] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte des lignes\" }), _jsx(\"input\", { type: \"color\", value: element.rowTextColor || '#111827', onChange: (e) => onChange(element.id, 'rowTextColor', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    height: '32px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px'\r\n                                                } }), _jsx(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: \"D\\u00E9faut: #111827\" })] })] }), _jsxs(Accordion, { title: \"Police des totaux\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police des totaux\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"24\", value: element.totalFontSize || element.globalFontSize || 12, onChange: (e) => onChange(element.id, 'totalFontSize', parseInt(e.target.value) || 12), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                } }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontSize || 12, \"px\"] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Famille de police des totaux\" }), _jsxs(\"select\", { value: element.totalFontFamily || element.globalFontFamily || 'Arial', onChange: (e) => onChange(element.id, 'totalFontFamily', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontFamily || 'Arial'] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de police des totaux\" }), _jsxs(\"select\", { value: element.totalFontWeight || element.globalFontWeight || 'bold', onChange: (e) => onChange(element.id, 'totalFontWeight', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal (400)\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras (700)\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin (300)\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras (900)\" })] }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontWeight || 'bold'] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Style de police des totaux\" }), _jsxs(\"select\", { value: element.totalFontStyle || element.globalFontStyle || 'normal', onChange: (e) => onChange(element.id, 'totalFontStyle', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] }), _jsxs(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: [\"D\\u00E9faut: \", element.globalFontStyle || 'normal'] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte des totaux\" }), _jsx(\"input\", { type: \"color\", value: element.totalTextColor || '#111827', onChange: (e) => onChange(element.id, 'totalTextColor', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    height: '32px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px'\r\n                                                } }), _jsx(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '2px' }, children: \"D\\u00E9faut: #111827\" })] })] })] })), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '8px' }, children: \"Th\\u00E8mes pr\\u00E9d\\u00E9finis\" }), _jsx(\"div\", { style: {\r\n                                    display: 'flex',\r\n                                    flexDirection: 'column',\r\n                                    gap: '6px',\r\n                                    maxHeight: '150px',\r\n                                    overflowY: 'auto',\r\n                                    padding: '4px',\r\n                                    border: '1px solid #e0e0e0',\r\n                                    borderRadius: '4px',\r\n                                    backgroundColor: '#fafafa'\r\n                                }, children: [\r\n                                    {\r\n                                        id: 'classic',\r\n                                        name: 'Classique',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #e5e7eb',\r\n                                                borderRadius: '2px',\r\n                                                backgroundColor: '#ffffff',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '1px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '90%',\r\n                                                        height: '2px',\r\n                                                        backgroundColor: '#f9fafb',\r\n                                                        borderRadius: '1px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '75%',\r\n                                                        height: '2px',\r\n                                                        backgroundColor: '#ffffff',\r\n                                                        borderRadius: '1px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#ffffff',\r\n                                            headerBackgroundColor: '#f9fafb',\r\n                                            alternateRowColor: '#f9fafb',\r\n                                            borderColor: '#e5e7eb',\r\n                                            textColor: '#111827',\r\n                                            headerTextColor: '#374151'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'modern',\r\n                                        name: 'Moderne',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #cbd5e1',\r\n                                                borderRadius: '4px',\r\n                                                backgroundColor: '#f8fafc',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#3b82f6',\r\n                                                        borderRadius: '1px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#ffffff',\r\n                                                        borderRadius: '1px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#f8fafc',\r\n                                            headerBackgroundColor: '#3b82f6',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#f1f5f9',\r\n                                            borderColor: '#cbd5e1',\r\n                                            textColor: '#334155'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'elegant',\r\n                                        name: 'lgant',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #c4b5fd',\r\n                                                borderRadius: '6px',\r\n                                                backgroundColor: '#fefefe',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#8b5cf6',\r\n                                                        borderRadius: '2px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#faf5ff',\r\n                                                        borderRadius: '2px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#fefefe',\r\n                                            headerBackgroundColor: '#8b5cf6',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#faf5ff',\r\n                                            borderColor: '#c4b5fd',\r\n                                            textColor: '#581c87'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'minimal',\r\n                                        name: 'Minimal',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #f3f4f6',\r\n                                                borderRadius: '0px',\r\n                                                backgroundColor: '#ffffff',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '1px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '2px',\r\n                                                        backgroundColor: '#f9fafb'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '2px',\r\n                                                        backgroundColor: '#ffffff'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#ffffff',\r\n                                            headerBackgroundColor: '#f9fafb',\r\n                                            alternateRowColor: '#f9fafb',\r\n                                            borderColor: '#f3f4f6',\r\n                                            textColor: '#374151',\r\n                                            headerTextColor: '#111827'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'corporate',\r\n                                        name: 'Corporate',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #374151',\r\n                                                borderRadius: '0px',\r\n                                                backgroundColor: '#ffffff',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#1f2937'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#f9fafb'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#ffffff',\r\n                                            headerBackgroundColor: '#1f2937',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#f9fafb',\r\n                                            borderColor: '#374151',\r\n                                            textColor: '#111827'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'warm',\r\n                                        name: 'Chaud',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #fed7aa',\r\n                                                borderRadius: '4px',\r\n                                                backgroundColor: '#fff7ed',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#ea580c',\r\n                                                        borderRadius: '1px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#ffedd5',\r\n                                                        borderRadius: '1px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#fff7ed',\r\n                                            headerBackgroundColor: '#ea580c',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#ffedd5',\r\n                                            borderColor: '#fed7aa',\r\n                                            textColor: '#9a3412'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'nature',\r\n                                        name: 'Nature',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #bbf7d0',\r\n                                                borderRadius: '6px',\r\n                                                backgroundColor: '#f0fdf4',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#16a34a',\r\n                                                        borderRadius: '2px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#dcfce7',\r\n                                                        borderRadius: '2px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#f0fdf4',\r\n                                            headerBackgroundColor: '#16a34a',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#dcfce7',\r\n                                            borderColor: '#bbf7d0',\r\n                                            textColor: '#14532d'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'dark',\r\n                                        name: 'Sombre',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #374151',\r\n                                                borderRadius: '4px',\r\n                                                backgroundColor: '#1f2937',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#111827',\r\n                                                        borderRadius: '1px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#374151',\r\n                                                        borderRadius: '1px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#1f2937',\r\n                                            headerBackgroundColor: '#111827',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#374151',\r\n                                            borderColor: '#4b5563',\r\n                                            textColor: '#f9fafb'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'ocean',\r\n                                        name: 'Ocan',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #0ea5e9',\r\n                                                borderRadius: '8px',\r\n                                                backgroundColor: '#f0f9ff',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#0284c7',\r\n                                                        borderRadius: '3px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#bae6fd',\r\n                                                        borderRadius: '3px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#f0f9ff',\r\n                                            headerBackgroundColor: '#0284c7',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#bae6fd',\r\n                                            borderColor: '#0ea5e9',\r\n                                            textColor: '#0c4a6e'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'sunset',\r\n                                        name: 'Coucher',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #f97316',\r\n                                                borderRadius: '12px',\r\n                                                backgroundColor: '#fff7ed',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#ea580c',\r\n                                                        borderRadius: '4px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#fed7aa',\r\n                                                        borderRadius: '4px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#fff7ed',\r\n                                            headerBackgroundColor: '#ea580c',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#fed7aa',\r\n                                            borderColor: '#f97316',\r\n                                            textColor: '#9a3412'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'forest',\r\n                                        name: 'Fort',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #22c55e',\r\n                                                borderRadius: '6px',\r\n                                                backgroundColor: '#f0fdf4',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#16a34a',\r\n                                                        borderRadius: '2px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#bbf7d0',\r\n                                                        borderRadius: '2px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#f0fdf4',\r\n                                            headerBackgroundColor: '#16a34a',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#bbf7d0',\r\n                                            borderColor: '#22c55e',\r\n                                            textColor: '#14532d'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'royal',\r\n                                        name: 'Royal',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #7c2d12',\r\n                                                borderRadius: '4px',\r\n                                                backgroundColor: '#fef2f2',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#991b1b',\r\n                                                        borderRadius: '1px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#fecaca',\r\n                                                        borderRadius: '1px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#fef2f2',\r\n                                            headerBackgroundColor: '#991b1b',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#fecaca',\r\n                                            borderColor: '#7c2d12',\r\n                                            textColor: '#450a0a'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'clean',\r\n                                        name: 'Propre',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #d1d5db',\r\n                                                borderRadius: '2px',\r\n                                                backgroundColor: '#ffffff',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '1px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '2px',\r\n                                                        backgroundColor: '#f3f4f6'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '2px',\r\n                                                        backgroundColor: '#ffffff'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#ffffff',\r\n                                            headerBackgroundColor: '#f3f4f6',\r\n                                            alternateRowColor: '#f9fafb',\r\n                                            borderColor: '#d1d5db',\r\n                                            textColor: '#374151',\r\n                                            headerTextColor: '#111827'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'tech',\r\n                                        name: 'Tech',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #6366f1',\r\n                                                borderRadius: '0px',\r\n                                                backgroundColor: '#f8fafc',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#4f46e5'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#e0e7ff'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#f8fafc',\r\n                                            headerBackgroundColor: '#4f46e5',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#e0e7ff',\r\n                                            borderColor: '#6366f1',\r\n                                            textColor: '#312e81'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'vintage',\r\n                                        name: 'Vintage',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '2px solid #92400e',\r\n                                                borderRadius: '0px',\r\n                                                backgroundColor: '#fef3c7',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#b45309',\r\n                                                        borderRadius: '0px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#fde68a',\r\n                                                        borderRadius: '0px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#fef3c7',\r\n                                            headerBackgroundColor: '#b45309',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#fde68a',\r\n                                            borderColor: '#92400e',\r\n                                            textColor: '#78350f'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'berry',\r\n                                        name: 'Baies',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #be185d',\r\n                                                borderRadius: '10px',\r\n                                                backgroundColor: '#fdf2f8',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#db2777',\r\n                                                        borderRadius: '5px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#fce7f3',\r\n                                                        borderRadius: '5px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#fdf2f8',\r\n                                            headerBackgroundColor: '#db2777',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#fce7f3',\r\n                                            borderColor: '#be185d',\r\n                                            textColor: '#831843'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'mint',\r\n                                        name: 'Menthe',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #059669',\r\n                                                borderRadius: '8px',\r\n                                                backgroundColor: '#ecfdf5',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#047857',\r\n                                                        borderRadius: '4px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#a7f3d0',\r\n                                                        borderRadius: '4px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#ecfdf5',\r\n                                            headerBackgroundColor: '#047857',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#a7f3d0',\r\n                                            borderColor: '#059669',\r\n                                            textColor: '#064e3b'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'lavender',\r\n                                        name: 'Lavande',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #7c3aed',\r\n                                                borderRadius: '12px',\r\n                                                backgroundColor: '#faf5ff',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#6d28d9',\r\n                                                        borderRadius: '6px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#e9d5ff',\r\n                                                        borderRadius: '6px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#faf5ff',\r\n                                            headerBackgroundColor: '#6d28d9',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#e9d5ff',\r\n                                            borderColor: '#7c3aed',\r\n                                            textColor: '#581c87'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'stone',\r\n                                        name: 'Pierre',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #6b7280',\r\n                                                borderRadius: '0px',\r\n                                                backgroundColor: '#f9fafb',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#4b5563'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#e5e7eb'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#f9fafb',\r\n                                            headerBackgroundColor: '#4b5563',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#e5e7eb',\r\n                                            borderColor: '#6b7280',\r\n                                            textColor: '#111827'\r\n                                        }\r\n                                    },\r\n                                    {\r\n                                        id: 'sunshine',\r\n                                        name: 'Soleil',\r\n                                        preview: (_jsxs(\"div\", { style: {\r\n                                                width: '100%',\r\n                                                height: '20px',\r\n                                                border: '1px solid #f59e0b',\r\n                                                borderRadius: '16px',\r\n                                                backgroundColor: '#fffbeb',\r\n                                                display: 'flex',\r\n                                                flexDirection: 'column',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                gap: '2px'\r\n                                            }, children: [_jsx(\"div\", { style: {\r\n                                                        width: '85%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#d97706',\r\n                                                        borderRadius: '8px'\r\n                                                    } }), _jsx(\"div\", { style: {\r\n                                                        width: '70%',\r\n                                                        height: '3px',\r\n                                                        backgroundColor: '#fef3c7',\r\n                                                        borderRadius: '8px'\r\n                                                    } })] })),\r\n                                        styles: {\r\n                                            backgroundColor: '#fffbeb',\r\n                                            headerBackgroundColor: '#d97706',\r\n                                            headerTextColor: '#ffffff',\r\n                                            alternateRowColor: '#fef3c7',\r\n                                            borderColor: '#f59e0b',\r\n                                            textColor: '#92400e'\r\n                                        }\r\n                                    }\r\n                                ].map(theme => (_jsxs(\"button\", { onClick: () => {\r\n                                        // Appliquer toutes les proprits du thme\r\n                                        Object.entries(theme.styles).forEach(([property, value]) => {\r\n                                            onChange(element.id, property, value);\r\n                                        });\r\n                                    }, style: {\r\n                                        padding: '6px',\r\n                                        border: '2px solid transparent',\r\n                                        borderRadius: '6px',\r\n                                        backgroundColor: '#ffffff',\r\n                                        cursor: 'pointer',\r\n                                        textAlign: 'center',\r\n                                        minHeight: '50px',\r\n                                        display: 'flex',\r\n                                        flexDirection: 'column',\r\n                                        alignItems: 'center',\r\n                                        gap: '4px'\r\n                                    }, onMouseEnter: (e) => {\r\n                                        e.currentTarget.style.borderColor = '#007bff';\r\n                                    }, onMouseLeave: (e) => {\r\n                                        e.currentTarget.style.borderColor = 'transparent';\r\n                                    }, title: `Appliquer le thme ${theme.name}`, children: [_jsx(\"div\", { style: {\r\n                                                fontSize: '10px',\r\n                                                fontWeight: 'bold',\r\n                                                color: '#333',\r\n                                                textAlign: 'center',\r\n                                                lineHeight: '1.2'\r\n                                            }, children: theme.name }), theme.preview] }, theme.id))) })] }), _jsx(\"hr\", { style: { margin: '16px 0', border: 'none', borderTop: '1px solid #ddd' } }), _jsxs(Accordion, { title: \"Couleurs\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.backgroundColor || '#ffffff', onChange: (e) => onChange(element.id, 'backgroundColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Fond des en-t\\u00EAtes\" }), _jsx(\"input\", { type: \"color\", value: element.headerBackgroundColor || '#f9fafb', onChange: (e) => onChange(element.id, 'headerBackgroundColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur lignes altern\\u00E9es\" }), _jsx(\"input\", { type: \"color\", value: element.alternateRowColor || '#f9fafb', onChange: (e) => onChange(element.id, 'alternateRowColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur des bordures\" }), _jsx(\"input\", { type: \"color\", value: element.borderColor || '#e5e7eb', onChange: (e) => onChange(element.id, 'borderColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte\" }), _jsx(\"input\", { type: \"color\", value: element.textColor || '#111827', onChange: (e) => onChange(element.id, 'textColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] })] })] })), currentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: [\"Position X \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", ((element.x) * 1).toFixed(1), \"px)\"] })] }), _jsx(\"input\", { type: \"number\", step: \"0.1\", value: element.x, onChange: (e) => onChange(element.id, 'x', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, placeholder: \"Entrer la valeur en pixels\" }), _jsx(\"small\", { style: { color: '#999', display: 'block', marginTop: '2px' }, children: \"Valeur en pixels\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: [\"Position Y \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", ((element.y) * 1).toFixed(1), \"px)\"] })] }), _jsx(\"input\", { type: \"number\", step: \"0.1\", value: element.y, onChange: (e) => onChange(element.id, 'y', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, placeholder: \"Entrer la valeur en pixels\" }), _jsx(\"small\", { style: { color: '#999', display: 'block', marginTop: '2px' }, children: \"Valeur en pixels\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: [\"Largeur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", ((element.width) * 1).toFixed(1), \"px)\"] })] }), _jsx(\"input\", { type: \"number\", step: \"0.1\", value: element.width, onChange: (e) => onChange(element.id, 'width', parseFloat(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, placeholder: \"Entrer la valeur en pixels\" }), _jsx(\"small\", { style: { color: '#999', display: 'block', marginTop: '2px' }, children: \"Valeur en pixels\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: [\"Hauteur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", ((element.height) * 1).toFixed(1), \"px)\"] })] }), _jsx(\"input\", { type: \"number\", step: \"0.1\", value: element.height, onChange: (e) => onChange(element.id, 'height', parseFloat(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, placeholder: \"Entrer la valeur en pixels\" }), _jsx(\"small\", { style: { color: '#999', display: 'block', marginTop: '2px' }, children: \"Valeur en pixels\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Alignement horizontal\" }), _jsxs(\"select\", { value: element.textAlign || 'left', onChange: (e) => onChange(element.id, 'textAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"left\", children: \"Gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centre\" }), _jsx(\"option\", { value: \"right\", children: \"Droite\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Alignement vertical\" }), _jsxs(\"select\", { value: element.verticalAlign || 'top', onChange: (e) => onChange(element.id, 'verticalAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"top\", children: \"Haut\" }), _jsx(\"option\", { value: \"middle\", children: \"Milieu\" }), _jsx(\"option\", { value: \"bottom\", children: \"Bas\" })] })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport { useState } from 'react';\r\n// Composant Accordion personnalis\r\nconst Accordion = ({ title, children, defaultOpen = false }) => {\r\n    const [isOpen, setIsOpen] = useState(defaultOpen);\r\n    return (_jsxs(\"div\", { style: { marginBottom: '16px', border: '1px solid #e9ecef', borderRadius: '4px', overflow: 'hidden' }, children: [_jsxs(\"div\", { onClick: () => setIsOpen(!isOpen), style: {\r\n                    padding: '12px',\r\n                    backgroundColor: '#f8f9fa',\r\n                    cursor: 'pointer',\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'center',\r\n                    borderBottom: isOpen ? '1px solid #e9ecef' : 'none'\r\n                }, children: [_jsx(\"h4\", { style: { margin: '0', fontSize: '13px', fontWeight: 'bold', color: '#495057' }, children: title }), _jsx(\"span\", { style: {\r\n                            fontSize: '12px',\r\n                            color: '#6c757d',\r\n                            transform: isOpen ? 'rotate(180deg)' : 'rotate(0deg)',\r\n                            transition: 'transform 0.2s ease'\r\n                        }, children: \"\\u25BC\" })] }), isOpen && (_jsx(\"div\", { style: { padding: '12px', backgroundColor: '#ffffff' }, children: children }))] }));\r\n};\r\n// Composant Toggle personnalis\r\nconst Toggle = ({ checked, onChange, label, description }) => (_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"div\", { style: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                marginBottom: '6px'\r\n            }, children: [_jsx(\"label\", { style: {\r\n                        fontSize: '12px',\r\n                        fontWeight: 'bold',\r\n                        color: '#333',\r\n                        flex: 1\r\n                    }, children: label }), _jsx(\"div\", { onClick: () => onChange(!checked), style: {\r\n                        position: 'relative',\r\n                        width: '44px',\r\n                        height: '24px',\r\n                        backgroundColor: checked ? '#007bff' : '#ccc',\r\n                        borderRadius: '12px',\r\n                        cursor: 'pointer',\r\n                        transition: 'background-color 0.2s ease',\r\n                        border: 'none'\r\n                    }, children: _jsx(\"div\", { style: {\r\n                            position: 'absolute',\r\n                            top: '2px',\r\n                            left: checked ? '22px' : '2px',\r\n                            width: '20px',\r\n                            height: '20px',\r\n                            backgroundColor: 'white',\r\n                            borderRadius: '50%',\r\n                            transition: 'left 0.2s ease',\r\n                            boxShadow: '0 1px 3px rgba(0,0,0,0.2)'\r\n                        } }) })] }), _jsx(\"div\", { style: {\r\n                fontSize: '11px',\r\n                color: '#666',\r\n                lineHeight: '1.4'\r\n            }, children: description })] }));\r\nexport function CustomerInfoProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const customerCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setCustomerCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setCustomerCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: customerCurrentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: customerCurrentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setCustomerCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: customerCurrentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: customerCurrentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setCustomerCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: customerCurrentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: customerCurrentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), customerCurrentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Structure des informations\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showHeaders !== false, onChange: (checked) => onChange(element.id, 'showHeaders', checked), label: \"Afficher les en-t\\u00EAtes\", description: \"Affiche les titres des sections\" }), _jsx(Toggle, { checked: element.showBackground !== false, onChange: (checked) => onChange(element.id, 'showBackground', checked), label: \"Afficher le fond\", description: \"Affiche un fond color\\u00E9 derri\\u00E8re les informations\" }), _jsx(Toggle, { checked: element.showBorders !== false, onChange: (checked) => onChange(element.id, 'showBorders', checked), label: \"Afficher les bordures\", description: \"Affiche les bordures autour des sections\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Informations personnelles\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showName !== false, onChange: (checked) => onChange(element.id, 'showName', checked), label: \"Afficher le nom\", description: \"Nom du client\" }), _jsx(Toggle, { checked: element.showFullName !== false, onChange: (checked) => onChange(element.id, 'showFullName', checked), label: \"Afficher le nom complet\", description: \"Pr\\u00E9nom et nom du client\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Coordonn\\u00E9es\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showAddress !== false, onChange: (checked) => onChange(element.id, 'showAddress', checked), label: \"Afficher l'adresse\", description: \"Adresse compl\\u00E8te du client\" }), _jsx(Toggle, { checked: element.showEmail !== false, onChange: (checked) => onChange(element.id, 'showEmail', checked), label: \"Afficher l'email\", description: \"Adresse email du client\" }), _jsx(Toggle, { checked: element.showPhone !== false, onChange: (checked) => onChange(element.id, 'showPhone', checked), label: \"Afficher le t\\u00E9l\\u00E9phone\", description: \"Num\\u00E9ro de t\\u00E9l\\u00E9phone du client\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Informations de paiement\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showPaymentMethod !== false, onChange: (checked) => onChange(element.id, 'showPaymentMethod', checked), label: \"Afficher le moyen de paiement\", description: \"M\\u00E9thode de paiement utilis\\u00E9e\" }), _jsx(Toggle, { checked: element.showTransactionId !== false, onChange: (checked) => onChange(element.id, 'showTransactionId', checked), label: \"Afficher l'ID de transaction\", description: \"Identifiant unique de la transaction\" })] })] })] })), customerCurrentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsx(Accordion, { title: \"Disposition\", defaultOpen: true, children: _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Type de disposition\" }), _jsxs(\"select\", { value: element.layout || 'vertical', onChange: (e) => onChange(element.id, 'layout', e.target.value), style: {\r\n                                        width: '100%',\r\n                                        padding: '4px 8px',\r\n                                        border: '1px solid #ccc',\r\n                                        borderRadius: '3px',\r\n                                        fontSize: '12px'\r\n                                    }, children: [_jsx(\"option\", { value: \"vertical\", children: \"Verticale\" }), _jsx(\"option\", { value: \"horizontal\", children: \"Horizontale\" }), _jsx(\"option\", { value: \"compact\", children: \"Compacte\" })] })] }) }), _jsx(Accordion, { title: \"Th\\u00E8mes pr\\u00E9d\\u00E9finis\", defaultOpen: false, children: _jsx(\"div\", { style: {\r\n                                display: 'grid',\r\n                                gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\r\n                                gap: '8px',\r\n                                maxHeight: '200px',\r\n                                overflowY: 'auto',\r\n                                padding: '4px',\r\n                                border: '1px solid #e0e0e0',\r\n                                borderRadius: '4px',\r\n                                backgroundColor: '#fafafa'\r\n                            }, children: [\r\n                                {\r\n                                    id: 'clean',\r\n                                    name: 'Propre',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: '1px solid #f3f4f6',\r\n                                            borderRadius: '4px',\r\n                                            backgroundColor: '#ffffff',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '1px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '2px',\r\n                                                    backgroundColor: '#f9fafb'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '2px',\r\n                                                    backgroundColor: '#ffffff'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '2px',\r\n                                                    backgroundColor: '#f9fafb'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: '#ffffff',\r\n                                        borderColor: '#f3f4f6',\r\n                                        textColor: '#374151',\r\n                                        headerTextColor: '#111827'\r\n                                    }\r\n                                },\r\n                                {\r\n                                    id: 'subtle',\r\n                                    name: 'Discret',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: '1px solid #f1f5f9',\r\n                                            borderRadius: '6px',\r\n                                            backgroundColor: '#fafbfc',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '2px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#e2e8f0',\r\n                                                    borderRadius: '1px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#fafbfc',\r\n                                                    borderRadius: '1px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#e2e8f0',\r\n                                                    borderRadius: '1px'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: '#fafbfc',\r\n                                        borderColor: '#f1f5f9',\r\n                                        textColor: '#475569',\r\n                                        headerTextColor: '#334155'\r\n                                    }\r\n                                },\r\n                                {\r\n                                    id: 'elegant',\r\n                                    name: 'lgant',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: '2px solid #f3e8ff',\r\n                                            borderRadius: '8px',\r\n                                            backgroundColor: '#fefefe',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '2px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#f3e8ff',\r\n                                                    borderRadius: '2px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#fefefe',\r\n                                                    borderRadius: '2px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#f3e8ff',\r\n                                                    borderRadius: '2px'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: '#fefefe',\r\n                                        borderColor: '#f3e8ff',\r\n                                        textColor: '#6b21a8',\r\n                                        headerTextColor: '#581c87'\r\n                                    }\r\n                                },\r\n                                {\r\n                                    id: 'corporate',\r\n                                    name: 'Corporate',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: '1px solid #e5e7eb',\r\n                                            borderRadius: '0px',\r\n                                            backgroundColor: '#ffffff',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '2px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#f3f4f6'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#ffffff'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#f3f4f6'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: '#ffffff',\r\n                                        borderColor: '#e5e7eb',\r\n                                        textColor: '#374151',\r\n                                        headerTextColor: '#111827'\r\n                                    }\r\n                                },\r\n                                {\r\n                                    id: 'warm',\r\n                                    name: 'Chaleureux',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: '1px solid #fed7aa',\r\n                                            borderRadius: '6px',\r\n                                            backgroundColor: '#fff8f0',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '2px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#fed7aa',\r\n                                                    borderRadius: '1px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#fff8f0',\r\n                                                    borderRadius: '1px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#fed7aa',\r\n                                                    borderRadius: '1px'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: '#fff8f0',\r\n                                        borderColor: '#fed7aa',\r\n                                        textColor: '#9a3412',\r\n                                        headerTextColor: '#78350f'\r\n                                    }\r\n                                },\r\n                                {\r\n                                    id: 'minimal',\r\n                                    name: 'Minimal',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: 'none',\r\n                                            borderRadius: '0px',\r\n                                            backgroundColor: 'transparent',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '1px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '1px',\r\n                                                    backgroundColor: '#e5e7eb'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '1px',\r\n                                                    backgroundColor: 'transparent'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '1px',\r\n                                                    backgroundColor: '#e5e7eb'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: 'transparent',\r\n                                        borderColor: 'transparent',\r\n                                        textColor: '#6b7280',\r\n                                        headerTextColor: '#374151'\r\n                                    }\r\n                                }\r\n                            ].map(theme => (_jsxs(\"button\", { onClick: () => {\r\n                                    // Appliquer toutes les proprits du thme\r\n                                    Object.entries(theme.styles).forEach(([property, value]) => {\r\n                                        onChange(element.id, property, value);\r\n                                    });\r\n                                }, style: {\r\n                                    padding: '6px',\r\n                                    border: '2px solid transparent',\r\n                                    borderRadius: '6px',\r\n                                    backgroundColor: '#ffffff',\r\n                                    cursor: 'pointer',\r\n                                    textAlign: 'center',\r\n                                    transition: 'all 0.2s ease',\r\n                                    minHeight: '70px',\r\n                                    display: 'flex',\r\n                                    flexDirection: 'column',\r\n                                    alignItems: 'center',\r\n                                    gap: '4px'\r\n                                }, onMouseEnter: (e) => {\r\n                                    e.currentTarget.style.borderColor = '#007bff';\r\n                                    e.currentTarget.style.backgroundColor = '#f8f9fa';\r\n                                    e.currentTarget.style.transform = 'translateY(-1px)';\r\n                                }, onMouseLeave: (e) => {\r\n                                    e.currentTarget.style.borderColor = 'transparent';\r\n                                    e.currentTarget.style.backgroundColor = '#ffffff';\r\n                                    e.currentTarget.style.transform = 'translateY(0)';\r\n                                }, title: `Appliquer le thme ${theme.name}`, children: [_jsx(\"div\", { style: {\r\n                                            fontSize: '10px',\r\n                                            fontWeight: 'bold',\r\n                                            color: '#333',\r\n                                            textAlign: 'center',\r\n                                            lineHeight: '1.2'\r\n                                        }, children: theme.name }), theme.preview] }, theme.id))) }) }), _jsx(\"hr\", { style: { margin: '16px 0', border: 'none', borderTop: '1px solid #ddd' } }), element.showHeaders !== false && (_jsxs(Accordion, { title: \"Police de l'en-t\\u00EAte\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"32\", value: element.headerFontSize || (element.fontSize || 12) + 2, onChange: (e) => onChange(element.id, 'headerFontSize', parseInt(e.target.value) || 14), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Famille de police\" }), _jsxs(\"select\", { value: element.headerFontFamily || element.fontFamily || 'Arial', onChange: (e) => onChange(element.id, 'headerFontFamily', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de police\" }), _jsxs(\"select\", { value: element.headerFontWeight || element.fontWeight || 'normal', onChange: (e) => onChange(element.id, 'headerFontWeight', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal (400)\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras (700)\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin (300)\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras (900)\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Style de police\" }), _jsxs(\"select\", { value: element.headerFontStyle || element.fontStyle || 'normal', onChange: (e) => onChange(element.id, 'headerFontStyle', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de police\" }), _jsx(\"input\", { type: \"color\", value: element.headerTextColor || element.textColor || '#111827', onChange: (e) => onChange(element.id, 'headerTextColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] })] })), _jsxs(Accordion, { title: \"Police du corps du texte\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"24\", value: element.bodyFontSize || element.fontSize || 12, onChange: (e) => onChange(element.id, 'bodyFontSize', parseInt(e.target.value) || 12), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Famille de police\" }), _jsxs(\"select\", { value: element.bodyFontFamily || element.fontFamily || 'Arial', onChange: (e) => onChange(element.id, 'bodyFontFamily', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de police\" }), _jsxs(\"select\", { value: element.bodyFontWeight || element.fontWeight || 'normal', onChange: (e) => onChange(element.id, 'bodyFontWeight', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal (400)\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras (700)\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin (300)\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras (900)\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Style de police\" }), _jsxs(\"select\", { value: element.bodyFontStyle || element.fontStyle || 'normal', onChange: (e) => onChange(element.id, 'bodyFontStyle', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de police\" }), _jsx(\"input\", { type: \"color\", value: element.textColor || '#374151', onChange: (e) => onChange(element.id, 'textColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] })] }), _jsxs(Accordion, { title: \"Couleurs\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte d'en-t\\u00EAte\" }), _jsx(\"input\", { type: \"color\", value: element.headerTextColor || element.textColor || '#111827', onChange: (e) => onChange(element.id, 'headerTextColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte du corps\" }), _jsx(\"input\", { type: \"color\", value: element.textColor || '#374151', onChange: (e) => onChange(element.id, 'textColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] }), element.showBackground !== false && (_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.backgroundColor === 'transparent' ? '#ffffff' : (element.backgroundColor || '#ffffff'), onChange: (e) => onChange(element.id, 'backgroundColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] })), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur des bordures\" }), _jsx(\"input\", { type: \"color\", value: element.borderColor || '#e5e7eb', onChange: (e) => onChange(element.id, 'borderColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] })] })] })), customerCurrentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Position X\" }), _jsx(\"input\", { type: \"number\", value: element.x, onChange: (e) => onChange(element.id, 'x', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Position Y\" }), _jsx(\"input\", { type: \"number\", value: element.y, onChange: (e) => onChange(element.id, 'y', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Largeur\" }), _jsx(\"input\", { type: \"number\", value: element.width, onChange: (e) => onChange(element.id, 'width', parseInt(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Hauteur\" }), _jsx(\"input\", { type: \"number\", value: element.height, onChange: (e) => onChange(element.id, 'height', parseInt(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Alignement horizontal\" }), _jsxs(\"select\", { value: element.textAlign || 'left', onChange: (e) => onChange(element.id, 'textAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"left\", children: \"Gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centre\" }), _jsx(\"option\", { value: \"right\", children: \"Droite\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Alignement vertical\" }), _jsxs(\"select\", { value: element.verticalAlign || 'top', onChange: (e) => onChange(element.id, 'verticalAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"top\", children: \"Haut\" }), _jsx(\"option\", { value: \"middle\", children: \"Milieu\" }), _jsx(\"option\", { value: \"bottom\", children: \"Bas\" })] })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport React, { useState } from 'react';\r\n// Composant Toggle personnalis\r\nconst Toggle = ({ checked, onChange, label, description }) => (_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"div\", { style: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                marginBottom: '6px'\r\n            }, children: [_jsx(\"label\", { style: {\r\n                        fontSize: '12px',\r\n                        fontWeight: 'bold',\r\n                        color: '#333',\r\n                        flex: 1\r\n                    }, children: label }), _jsx(\"div\", { onClick: () => onChange(!checked), style: {\r\n                        position: 'relative',\r\n                        width: '44px',\r\n                        height: '24px',\r\n                        backgroundColor: checked ? '#007bff' : '#ccc',\r\n                        borderRadius: '12px',\r\n                        cursor: 'pointer',\r\n                        transition: 'background-color 0.2s ease',\r\n                        border: 'none'\r\n                    }, children: _jsx(\"div\", { style: {\r\n                            position: 'absolute',\r\n                            top: '2px',\r\n                            left: checked ? '22px' : '2px',\r\n                            width: '20px',\r\n                            height: '20px',\r\n                            backgroundColor: 'white',\r\n                            borderRadius: '50%',\r\n                            transition: 'left 0.2s ease',\r\n                            boxShadow: '0 1px 3px rgba(0,0,0,0.2)'\r\n                        } }) })] }), _jsx(\"div\", { style: {\r\n                fontSize: '11px',\r\n                color: '#666',\r\n                lineHeight: '1.4'\r\n            }, children: description })] }));\r\nexport function CompanyInfoProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const companyCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setCompanyCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    // tat pour les accordons de police\r\n    const [fontAccordions, setFontAccordions] = useState({\r\n        headerFont: false,\r\n        bodyFont: false,\r\n        layout: true,\r\n        themes: false,\r\n        colors: false // Accordon couleurs ferm par dfaut\r\n    });\r\n    const toggleAccordion = (accordion) => {\r\n        setFontAccordions(prev => ({\r\n            ...prev,\r\n            [accordion]: !prev[accordion]\r\n        }));\r\n    };\r\n    const companyThemes = [\r\n        {\r\n            id: 'corporate',\r\n            name: 'Corporate',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #1f2937',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#ffffff',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '3px',\r\n                            backgroundColor: '#1f2937'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '2px',\r\n                            backgroundColor: '#6b7280'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '2px',\r\n                            backgroundColor: '#9ca3af'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#1f2937',\r\n                textColor: '#374151',\r\n                headerTextColor: '#111827'\r\n            }\r\n        },\r\n        {\r\n            id: 'modern',\r\n            name: 'Moderne',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #3b82f6',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#ffffff',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '3px',\r\n                            backgroundColor: '#3b82f6'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '2px',\r\n                            backgroundColor: '#60a5fa'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '2px',\r\n                            backgroundColor: '#93c5fd'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#3b82f6',\r\n                textColor: '#1e40af',\r\n                headerTextColor: '#1e3a8a'\r\n            }\r\n        },\r\n        {\r\n            id: 'elegant',\r\n            name: 'lgant',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #8b5cf6',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#ffffff',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '3px',\r\n                            backgroundColor: '#8b5cf6'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '2px',\r\n                            backgroundColor: '#a78bfa'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '2px',\r\n                            backgroundColor: '#c4b5fd'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#8b5cf6',\r\n                textColor: '#6d28d9',\r\n                headerTextColor: '#581c87'\r\n            }\r\n        },\r\n        {\r\n            id: 'minimal',\r\n            name: 'Minimal',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #e5e7eb',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#ffffff',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '2px',\r\n                            backgroundColor: '#374151'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '2px',\r\n                            backgroundColor: '#6b7280'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '2px',\r\n                            backgroundColor: '#9ca3af'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#e5e7eb',\r\n                textColor: '#374151',\r\n                headerTextColor: '#111827'\r\n            }\r\n        },\r\n        {\r\n            id: 'professional',\r\n            name: 'Professionnel',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #059669',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#ffffff',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '3px',\r\n                            backgroundColor: '#059669'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '2px',\r\n                            backgroundColor: '#10b981'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '2px',\r\n                            backgroundColor: '#34d399'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#059669',\r\n                textColor: '#065f46',\r\n                headerTextColor: '#064e3b'\r\n            }\r\n        },\r\n        {\r\n            id: 'classic',\r\n            name: 'Classique',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #92400e',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#ffffff',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '3px',\r\n                            backgroundColor: '#92400e'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '2px',\r\n                            backgroundColor: '#d97706'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '2px',\r\n                            backgroundColor: '#f59e0b'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#92400e',\r\n                textColor: '#78350f',\r\n                headerTextColor: '#451a03'\r\n            }\r\n        }\r\n    ];\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setCompanyCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: companyCurrentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: companyCurrentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setCompanyCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: companyCurrentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: companyCurrentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setCompanyCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: companyCurrentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: companyCurrentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), companyCurrentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Structure des informations\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showBackground !== false, onChange: (checked) => onChange(element.id, 'showBackground', checked), label: \"Afficher le fond\", description: \"Affiche un fond color\\u00E9 derri\\u00E8re les informations\" }), _jsx(Toggle, { checked: element.showBorders !== false, onChange: (checked) => onChange(element.id, 'showBorders', checked), label: \"Afficher les bordures\", description: \"Affiche les bordures autour des sections\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Informations g\\u00E9n\\u00E9rales\" }), _jsx(\"div\", { style: { paddingLeft: '8px' }, children: _jsx(Toggle, { checked: element.showCompanyName !== false, onChange: (checked) => onChange(element.id, 'showCompanyName', checked), label: \"Afficher le nom de l'entreprise\", description: \"Nom de l'entreprise\" }) })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Coordonn\\u00E9es\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showAddress !== false, onChange: (checked) => onChange(element.id, 'showAddress', checked), label: \"Afficher l'adresse\", description: \"Adresse compl\\u00E8te de l'entreprise\" }), _jsx(Toggle, { checked: element.showPhone !== false, onChange: (checked) => onChange(element.id, 'showPhone', checked), label: \"Afficher le t\\u00E9l\\u00E9phone\", description: \"Num\\u00E9ro de t\\u00E9l\\u00E9phone\" }), _jsx(Toggle, { checked: element.showEmail !== false, onChange: (checked) => onChange(element.id, 'showEmail', checked), label: \"Afficher l'email\", description: \"Adresse email de l'entreprise\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Informations l\\u00E9gales\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showSiret !== false, onChange: (checked) => onChange(element.id, 'showSiret', checked), label: \"Afficher le num\\u00E9ro SIRET\", description: \"Num\\u00E9ro SIRET de l'entreprise\" }), _jsx(Toggle, { checked: element.showVat !== false, onChange: (checked) => onChange(element.id, 'showVat', checked), label: \"Afficher le num\\u00E9ro TVA\", description: \"Num\\u00E9ro TVA de l'entreprise\" }), _jsx(Toggle, { checked: element.showRcs !== false, onChange: (checked) => onChange(element.id, 'showRcs', checked), label: \"Afficher le RCS\", description: \"Registre du Commerce et des Soci\\u00E9t\\u00E9s\" }), _jsx(Toggle, { checked: element.showCapital !== false, onChange: (checked) => onChange(element.id, 'showCapital', checked), label: \"Afficher le capital social\", description: \"Montant du capital social de l'entreprise\" })] })] })] })), companyCurrentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '16px', border: '1px solid #e9ecef', borderRadius: '4px', overflow: 'hidden' }, children: [_jsxs(\"div\", { onClick: () => setFontAccordions(prev => ({ ...prev, layout: !prev.layout })), style: {\r\n                                    padding: '12px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    cursor: 'pointer',\r\n                                    display: 'flex',\r\n                                    justifyContent: 'space-between',\r\n                                    alignItems: 'center',\r\n                                    borderBottom: fontAccordions.layout ? '1px solid #e9ecef' : 'none'\r\n                                }, children: [_jsx(\"h4\", { style: { margin: '0', fontSize: '13px', fontWeight: 'bold', color: '#495057' }, children: \"Disposition\" }), _jsx(\"span\", { style: {\r\n                                            fontSize: '12px',\r\n                                            color: '#6c757d',\r\n                                            transform: fontAccordions.layout ? 'rotate(180deg)' : 'rotate(0deg)',\r\n                                            transition: 'transform 0.2s ease'\r\n                                        }, children: \"\\u25BC\" })] }), fontAccordions.layout && (_jsxs(\"div\", { style: { padding: '12px', backgroundColor: '#ffffff' }, children: [_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Type de disposition\" }), _jsxs(\"select\", { value: element.layout || 'vertical', onChange: (e) => onChange(element.id, 'layout', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"vertical\", children: \"Verticale\" }), _jsx(\"option\", { value: \"horizontal\", children: \"Horizontale\" }), _jsx(\"option\", { value: \"compact\", children: \"Compacte\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Alignement du texte\" }), _jsxs(\"select\", { value: element.textAlign || 'left', onChange: (e) => onChange(element.id, 'textAlign', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"left\", children: \"Gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centre\" }), _jsx(\"option\", { value: \"right\", children: \"Droite\" })] })] })] }))] }), _jsxs(\"div\", { style: { marginBottom: '16px', border: '1px solid #e9ecef', borderRadius: '4px', overflow: 'hidden' }, children: [_jsxs(\"div\", { onClick: () => setFontAccordions(prev => ({ ...prev, themes: !prev.themes })), style: {\r\n                                    padding: '12px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    cursor: 'pointer',\r\n                                    display: 'flex',\r\n                                    justifyContent: 'space-between',\r\n                                    alignItems: 'center',\r\n                                    borderBottom: fontAccordions.themes ? '1px solid #e9ecef' : 'none'\r\n                                }, children: [_jsx(\"h4\", { style: { margin: '0', fontSize: '13px', fontWeight: 'bold', color: '#495057' }, children: \"Th\\u00E8mes pr\\u00E9d\\u00E9finis\" }), _jsx(\"span\", { style: {\r\n                                            fontSize: '12px',\r\n                                            color: '#6c757d',\r\n                                            transform: fontAccordions.themes ? 'rotate(180deg)' : 'rotate(0deg)',\r\n                                            transition: 'transform 0.2s ease'\r\n                                        }, children: \"\\u25BC\" })] }), fontAccordions.themes && (_jsx(\"div\", { style: { padding: '12px', backgroundColor: '#ffffff' }, children: _jsx(\"div\", { style: {\r\n                                        display: 'grid',\r\n                                        gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\r\n                                        gap: '8px',\r\n                                        maxHeight: '200px',\r\n                                        overflowY: 'auto',\r\n                                        padding: '4px',\r\n                                        border: '1px solid #e0e0e0',\r\n                                        borderRadius: '4px',\r\n                                        backgroundColor: '#fafafa'\r\n                                    }, children: companyThemes.map((theme) => (_jsxs(\"div\", { onClick: () => onChange(element.id, 'theme', theme.id), style: {\r\n                                            cursor: 'pointer',\r\n                                            border: element.theme === theme.id ? '2px solid #007bff' : '2px solid transparent',\r\n                                            borderRadius: '6px',\r\n                                            padding: '6px',\r\n                                            backgroundColor: '#ffffff',\r\n                                            transition: 'all 0.2s ease'\r\n                                        }, title: theme.name, children: [_jsx(\"div\", { style: { fontSize: '10px', fontWeight: 'bold', marginBottom: '4px', textAlign: 'center' }, children: theme.name }), theme.preview] }, theme.id))) }) }))] }), _jsx(\"hr\", { style: { margin: '16px 0', border: 'none', borderTop: '1px solid #ddd' } }), element.showCompanyName !== false && (_jsxs(\"div\", { style: { marginBottom: '16px', border: '1px solid #e9ecef', borderRadius: '4px', overflow: 'hidden' }, children: [_jsxs(\"div\", { onClick: () => toggleAccordion('headerFont'), style: {\r\n                                    padding: '12px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    cursor: 'pointer',\r\n                                    display: 'flex',\r\n                                    justifyContent: 'space-between',\r\n                                    alignItems: 'center',\r\n                                    borderBottom: fontAccordions.headerFont ? '1px solid #e9ecef' : 'none'\r\n                                }, children: [_jsx(\"h4\", { style: { margin: '0', fontSize: '13px', fontWeight: 'bold', color: '#495057' }, children: \"Police du nom de l'entreprise\" }), _jsx(\"span\", { style: {\r\n                                            fontSize: '12px',\r\n                                            color: '#6c757d',\r\n                                            transform: fontAccordions.headerFont ? 'rotate(180deg)' : 'rotate(0deg)',\r\n                                            transition: 'transform 0.2s ease'\r\n                                        }, children: \"\\u25BC\" })] }), fontAccordions.headerFont && (_jsxs(\"div\", { style: { padding: '12px', backgroundColor: '#ffffff' }, children: [_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police\" }), _jsx(\"input\", { type: \"number\", min: \"10\", max: \"32\", value: element.headerFontSize || Math.round((element.fontSize || 12) * 1.2), onChange: (e) => onChange(element.id, 'headerFontSize', parseInt(e.target.value) || 14), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Famille de police\" }), _jsxs(\"select\", { value: element.headerFontFamily || element.fontFamily || 'Arial', onChange: (e) => onChange(element.id, 'headerFontFamily', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de police\" }), _jsxs(\"select\", { value: element.headerFontWeight || 'bold', onChange: (e) => onChange(element.id, 'headerFontWeight', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal (400)\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras (700)\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin (300)\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras (900)\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Style de police\" }), _jsxs(\"select\", { value: element.headerFontStyle || element.fontStyle || 'normal', onChange: (e) => onChange(element.id, 'headerFontStyle', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] })] })] }))] })), _jsxs(\"div\", { style: { marginBottom: '16px', border: '1px solid #e9ecef', borderRadius: '4px', overflow: 'hidden' }, children: [_jsxs(\"div\", { onClick: () => toggleAccordion('bodyFont'), style: {\r\n                                    padding: '12px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    cursor: 'pointer',\r\n                                    display: 'flex',\r\n                                    justifyContent: 'space-between',\r\n                                    alignItems: 'center',\r\n                                    borderBottom: fontAccordions.bodyFont ? '1px solid #e9ecef' : 'none'\r\n                                }, children: [_jsx(\"h4\", { style: { margin: '0', fontSize: '13px', fontWeight: 'bold', color: '#495057' }, children: \"Police des informations\" }), _jsx(\"span\", { style: {\r\n                                            fontSize: '12px',\r\n                                            color: '#6c757d',\r\n                                            transform: fontAccordions.bodyFont ? 'rotate(180deg)' : 'rotate(0deg)',\r\n                                            transition: 'transform 0.2s ease'\r\n                                        }, children: \"\\u25BC\" })] }), fontAccordions.bodyFont && (_jsxs(\"div\", { style: { padding: '12px', backgroundColor: '#ffffff' }, children: [_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"24\", value: element.bodyFontSize || element.fontSize || 12, onChange: (e) => onChange(element.id, 'bodyFontSize', parseInt(e.target.value) || 12), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Famille de police\" }), _jsxs(\"select\", { value: element.bodyFontFamily || element.fontFamily || 'Arial', onChange: (e) => onChange(element.id, 'bodyFontFamily', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de police\" }), _jsxs(\"select\", { value: element.bodyFontWeight || element.fontWeight || 'normal', onChange: (e) => onChange(element.id, 'bodyFontWeight', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal (400)\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras (700)\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin (300)\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras (900)\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Style de police\" }), _jsxs(\"select\", { value: element.bodyFontStyle || element.fontStyle || 'normal', onChange: (e) => onChange(element.id, 'bodyFontStyle', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] })] })] }))] }), _jsxs(\"div\", { style: { marginBottom: '16px', border: '1px solid #e9ecef', borderRadius: '4px', overflow: 'hidden' }, children: [_jsxs(\"div\", { onClick: () => setFontAccordions(prev => ({ ...prev, colors: !prev.colors })), style: {\r\n                                    padding: '12px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    cursor: 'pointer',\r\n                                    display: 'flex',\r\n                                    justifyContent: 'space-between',\r\n                                    alignItems: 'center',\r\n                                    borderBottom: fontAccordions.colors ? '1px solid #e9ecef' : 'none'\r\n                                }, children: [_jsx(\"h4\", { style: { margin: '0', fontSize: '13px', fontWeight: 'bold', color: '#495057' }, children: \"Couleurs\" }), _jsx(\"span\", { style: {\r\n                                            fontSize: '12px',\r\n                                            color: '#6c757d',\r\n                                            transform: fontAccordions.colors ? 'rotate(180deg)' : 'rotate(0deg)',\r\n                                            transition: 'transform 0.2s ease'\r\n                                        }, children: \"\\u25BC\" })] }), fontAccordions.colors && (_jsxs(\"div\", { style: { padding: '12px', backgroundColor: '#ffffff' }, children: [element.showBackground !== false && (_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.backgroundColor === 'transparent' ? '#ffffff' : (element.backgroundColor || '#ffffff'), onChange: (e) => onChange(element.id, 'backgroundColor', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    height: '32px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    cursor: 'pointer'\r\n                                                } })] })), element.showBorders !== false && (_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur des bordures\" }), _jsx(\"input\", { type: \"color\", value: element.borderColor === 'transparent' ? '#e5e7eb' : (element.borderColor || '#e5e7eb'), onChange: (e) => onChange(element.id, 'borderColor', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    height: '32px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    cursor: 'pointer'\r\n                                                } })] })), element.showBorders !== false && (_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de la bordure\" }), _jsxs(\"select\", { value: String(element.borderWidth || '1'), onChange: (e) => onChange(element.id, 'borderWidth', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '4px 8px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"0.5\", children: \"Fin (0.5px)\" }), _jsx(\"option\", { value: \"1\", children: \"Normal (1px)\" }), _jsx(\"option\", { value: \"1.5\", children: \"Moyen (1.5px)\" }), _jsx(\"option\", { value: \"2\", children: \"\\u00C9pais (2px)\" }), _jsx(\"option\", { value: \"3\", children: \"Tr\\u00E8s \\u00E9pais (3px)\" })] })] })), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte d'en-t\\u00EAte\" }), _jsx(\"input\", { type: \"color\", value: element.headerTextColor || element.textColor || '#111827', onChange: (e) => onChange(element.id, 'headerTextColor', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    height: '32px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    cursor: 'pointer'\r\n                                                } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte du corps\" }), _jsx(\"input\", { type: \"color\", value: element.textColor || '#374151', onChange: (e) => onChange(element.id, 'textColor', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    height: '32px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    cursor: 'pointer'\r\n                                                } })] }), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte\" }), _jsx(\"input\", { type: \"color\", value: element.textColor || '#000000', onChange: (e) => onChange(element.id, 'textColor', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    height: '32px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '3px',\r\n                                                    cursor: 'pointer'\r\n                                                } })] })] }))] })] })), companyCurrentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Position X\" }), _jsx(\"input\", { type: \"number\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Position Y\" }), _jsx(\"input\", { type: \"number\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Largeur\" }), _jsx(\"input\", { type: \"number\", value: element.width || 200, onChange: (e) => onChange(element.id, 'width', parseInt(e.target.value) || 200), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Hauteur\" }), _jsx(\"input\", { type: \"number\", value: element.height || 100, onChange: (e) => onChange(element.id, 'height', parseInt(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nexport function CompanyLogoProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const logoCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setLogoCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setLogoCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: logoCurrentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: logoCurrentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setLogoCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: logoCurrentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: logoCurrentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setLogoCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: logoCurrentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: logoCurrentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), logoCurrentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"URL du logo\" }), _jsxs(\"div\", { style: { display: 'flex', gap: '6px', alignItems: 'center' }, children: [_jsx(\"input\", { type: \"text\", value: element.src || '', onChange: (e) => onChange(element.id, 'src', e.target.value), placeholder: \"https://exemple.com/logo.png\", style: {\r\n                                            flex: 1,\r\n                                            padding: '6px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '4px',\r\n                                            fontSize: '12px'\r\n                                        } }), _jsx(\"button\", { onClick: () => {\r\n                                            var _a;\r\n                                            // Ouvrir la bibliothque de mdias WordPress\r\n                                            if (!((_a = window.wp) === null || _a === void 0 ? void 0 : _a.media)) {\r\n                                                const errorMsg = 'Bibliothque de mdias WordPress non disponible (wp_enqueue_media non appel ?)';\r\n                                                alert(errorMsg + '\\n\\nSaisissez l\\'URL manuellement.');\r\n                                                return;\r\n                                            }\r\n                                            try {\r\n                                                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                                                const mediaUploader = window.wp.media({\r\n                                                    title: 'Slectionner un logo',\r\n                                                    button: {\r\n                                                        text: 'Utiliser ce logo'\r\n                                                    },\r\n                                                    multiple: false,\r\n                                                    library: {\r\n                                                        type: 'image'\r\n                                                    }\r\n                                                });\r\n                                                // couter l'vnement select avec closure pour avoir accs  mediaUploader\r\n                                                mediaUploader.on('select', () => {\r\n                                                    try {\r\n                                                        const state = mediaUploader.state();\r\n                                                        const selection = state.get('selection');\r\n                                                        if (!selection || selection.length === 0) {\r\n                                                            return;\r\n                                                        }\r\n                                                        const attachment = selection.first().toJSON();\r\n                                                        if (!attachment || !attachment.url) {\r\n                                                            alert('Erreur: L\\'image slectionne n\\'a pas d\\'URL valide');\r\n                                                            return;\r\n                                                        }\r\n                                                        // Mettre  jour l'URL\r\n                                                        onChange(element.id, 'src', attachment.url);\r\n                                                        // Optionnellement, mettre  jour les dimensions\r\n                                                        if (!element.width || element.width === 150) {\r\n                                                            onChange(element.id, 'width', attachment.width || 150);\r\n                                                        }\r\n                                                        if (!element.height || element.height === 80) {\r\n                                                            onChange(element.id, 'height', attachment.height || 80);\r\n                                                        }\r\n                                                    }\r\n                                                    catch (error) {\r\n                                                        alert('Erreur: ' + (error instanceof Error ? error.message : 'Erreur inconnue'));\r\n                                                    }\r\n                                                });\r\n                                                mediaUploader.open();\r\n                                            }\r\n                                            catch (error) {\r\n                                                alert('Erreur: ' + (error instanceof Error ? error.message : 'Impossible d\\'ouvrir la bibliothque'));\r\n                                            }\r\n                                        }, style: {\r\n                                            padding: '6px 12px',\r\n                                            backgroundColor: '#007bff',\r\n                                            color: '#fff',\r\n                                            border: 'none',\r\n                                            borderRadius: '4px',\r\n                                            cursor: 'pointer',\r\n                                            fontSize: '11px',\r\n                                            fontWeight: 'bold',\r\n                                            whiteSpace: 'nowrap'\r\n                                        }, title: \"S\\u00E9lectionner depuis la biblioth\\u00E8que WordPress\", children: \"\\uD83D\\uDCC1 Choisir\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Texte alternatif\" }), _jsx(\"input\", { type: \"text\", value: element.altText || '', onChange: (e) => onChange(element.id, 'altText', e.target.value), placeholder: \"Logo de l'entreprise\", style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Maintenir les proportions\" }), _jsx(\"input\", { type: \"checkbox\", checked: element.maintainAspectRatio !== false, onChange: (e) => onChange(element.id, 'maintainAspectRatio', e.target.checked), style: { marginRight: '8px' } }), _jsx(\"span\", { style: { fontSize: '11px', color: '#666' }, children: \"Pr\\u00E9serve le ratio largeur/hauteur\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Afficher une bordure\" }), _jsx(\"input\", { type: \"checkbox\", checked: element.showBorder !== false, onChange: (e) => onChange(element.id, 'showBorder', e.target.checked), style: { marginRight: '8px' } }), _jsx(\"span\", { style: { fontSize: '11px', color: '#666' }, children: \"Affiche une bordure autour du logo\" })] })] })), logoCurrentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Mode d'ajustement\" }), _jsxs(\"select\", { value: element.objectFit || 'contain', onChange: (e) => onChange(element.id, 'objectFit', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"contain\", children: \"Contenir (respecte les proportions)\" }), _jsx(\"option\", { value: \"cover\", children: \"Couvrir (remplit compl\\u00E8tement)\" }), _jsx(\"option\", { value: \"fill\", children: \"Remplir (\\u00E9tire si n\\u00E9cessaire)\" }), _jsx(\"option\", { value: \"none\", children: \"Aucun (taille originale)\" }), _jsx(\"option\", { value: \"scale-down\", children: \"R\\u00E9duire (taille originale ou contenir)\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Opacit\\u00E9\" }), _jsx(\"input\", { type: \"range\", min: \"0\", max: \"1\", step: \"0.1\", value: element.opacity || 1, onChange: (e) => onChange(element.id, 'opacity', parseFloat(e.target.value)), style: {\r\n                                    width: '100%',\r\n                                    marginTop: '4px'\r\n                                } }), _jsx(\"div\", { style: { fontSize: '11px', color: '#666', textAlign: 'center', marginTop: '2px' }, children: element.opacity || 1 })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Rayon des coins\" }), _jsx(\"input\", { type: \"number\", min: \"0\", max: \"50\", value: element.borderRadius || 0, onChange: (e) => onChange(element.id, 'borderRadius', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Rotation\" }), _jsx(\"input\", { type: \"number\", min: \"-180\", max: \"180\", value: element.rotation || 0, onChange: (e) => onChange(element.id, 'rotation', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } }), _jsx(\"div\", { style: { fontSize: '11px', color: '#666', marginTop: '2px' }, children: \"Degr\\u00E9s\" })] })] })), logoCurrentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Position X\" }), _jsx(\"input\", { type: \"number\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Position Y\" }), _jsx(\"input\", { type: \"number\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Largeur\" }), _jsx(\"input\", { type: \"number\", value: element.width || 100, onChange: (e) => onChange(element.id, 'width', parseInt(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Hauteur\" }), _jsx(\"input\", { type: \"number\", value: element.height || 100, onChange: (e) => onChange(element.id, 'height', parseInt(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport { useState } from 'react';\r\n// Composant Accordion personnalis\r\nconst Accordion = ({ title, children, defaultOpen = false }) => {\r\n    const [isOpen, setIsOpen] = useState(defaultOpen);\r\n    return (_jsxs(\"div\", { style: { marginBottom: '16px', border: '1px solid #e9ecef', borderRadius: '4px', overflow: 'hidden' }, children: [_jsxs(\"div\", { onClick: () => setIsOpen(!isOpen), style: {\r\n                    padding: '12px',\r\n                    backgroundColor: '#f8f9fa',\r\n                    cursor: 'pointer',\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'center',\r\n                    borderBottom: isOpen ? '1px solid #e9ecef' : 'none'\r\n                }, children: [_jsx(\"h4\", { style: { margin: '0', fontSize: '13px', fontWeight: 'bold', color: '#495057' }, children: title }), _jsx(\"span\", { style: {\r\n                            fontSize: '12px',\r\n                            color: '#6c757d',\r\n                            transform: isOpen ? 'rotate(180deg)' : 'rotate(0deg)',\r\n                            transition: 'transform 0.2s ease'\r\n                        }, children: \"\\u25BC\" })] }), isOpen && (_jsx(\"div\", { style: { padding: '12px', backgroundColor: '#ffffff' }, children: children }))] }));\r\n};\r\n// Composant Toggle personnalis\r\nconst Toggle = ({ checked, onChange, label, description }) => (_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"div\", { style: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                marginBottom: '6px'\r\n            }, children: [_jsx(\"label\", { style: {\r\n                        fontSize: '12px',\r\n                        fontWeight: 'bold',\r\n                        color: '#333',\r\n                        flex: 1\r\n                    }, children: label }), _jsx(\"div\", { onClick: () => onChange(!checked), style: {\r\n                        position: 'relative',\r\n                        width: '44px',\r\n                        height: '24px',\r\n                        backgroundColor: checked ? '#007bff' : '#ccc',\r\n                        borderRadius: '12px',\r\n                        cursor: 'pointer',\r\n                        transition: 'background-color 0.2s ease',\r\n                        border: 'none'\r\n                    }, children: _jsx(\"div\", { style: {\r\n                            position: 'absolute',\r\n                            top: '2px',\r\n                            left: checked ? '22px' : '2px',\r\n                            width: '20px',\r\n                            height: '20px',\r\n                            backgroundColor: 'white',\r\n                            borderRadius: '50%',\r\n                            transition: 'left 0.2s ease',\r\n                            boxShadow: '0 1px 3px rgba(0,0,0,0.2)'\r\n                        } }) })] }), _jsx(\"div\", { style: {\r\n                fontSize: '11px',\r\n                color: '#666',\r\n                lineHeight: '1.4'\r\n            }, children: description })] }));\r\nexport function OrderNumberProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const currentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: currentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: currentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: currentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: currentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: currentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: currentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), currentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Structure des informations\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showHeaders !== false, onChange: (checked) => onChange(element.id, 'showHeaders', checked), label: \"Afficher les en-t\\u00EAtes\", description: \"Affiche les titres des sections\" }), _jsx(Toggle, { checked: element.showBackground !== false, onChange: (checked) => onChange(element.id, 'showBackground', checked), label: \"Afficher le fond\", description: \"Affiche un fond color\\u00E9 derri\\u00E8re le num\\u00E9ro de commande\" }), _jsx(Toggle, { checked: element.showBorders !== false, onChange: (checked) => onChange(element.id, 'showBorders', checked), label: \"Afficher les bordures\", description: \"Affiche les bordures autour des sections\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"\\u00C9l\\u00E9ments principaux\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsx(Toggle, { checked: element.showLabel !== false, onChange: (checked) => onChange(element.id, 'showLabel', checked), label: \"Afficher le libell\\u00E9\", description: \"Affiche un texte devant le num\\u00E9ro de commande\" }), _jsx(Toggle, { checked: element.showDate !== false, onChange: (checked) => onChange(element.id, 'showDate', checked), label: \"Afficher la date\", description: \"Affiche la date de commande\" })] })] }), element.showLabel !== false && (_jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Configuration du libell\\u00E9\" }), _jsxs(\"div\", { style: { paddingLeft: '8px' }, children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Texte du libell\\u00E9\" }), _jsx(\"input\", { type: \"text\", value: element.labelText || 'N de commande:', onChange: (e) => onChange(element.id, 'labelText', e.target.value), placeholder: \"N\\u00B0 de commande:\", style: {\r\n                                                    width: '100%',\r\n                                                    padding: '6px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '4px',\r\n                                                    fontSize: '12px'\r\n                                                } }), _jsx(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '4px' }, children: \"Texte affich\\u00E9 avant le num\\u00E9ro de commande\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Position du libell\\u00E9\" }), _jsxs(\"select\", { value: element.labelPosition || 'above', onChange: (e) => onChange(element.id, 'labelPosition', e.target.value), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '6px',\r\n                                                    border: '1px solid #ccc',\r\n                                                    borderRadius: '4px',\r\n                                                    fontSize: '12px'\r\n                                                }, children: [_jsx(\"option\", { value: \"above\", children: \"Au-dessus du num\\u00E9ro\" }), _jsx(\"option\", { value: \"left\", children: \"\\u00C0 gauche du num\\u00E9ro\" }), _jsx(\"option\", { value: \"right\", children: \"\\u00C0 droite du num\\u00E9ro\" }), _jsx(\"option\", { value: \"below\", children: \"En-dessous du num\\u00E9ro\" })] })] })] })] })), element.showDate !== false && (_jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Format de date\" }), _jsx(\"div\", { style: { paddingLeft: '8px' }, children: _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Format d'affichage\" }), _jsxs(\"select\", { value: String(element.dateFormat || 'DD/MM/YYYY'), onChange: (e) => onChange(element.id, 'dateFormat', e.target.value), style: {\r\n                                                width: '100%',\r\n                                                padding: '6px',\r\n                                                border: '1px solid #ccc',\r\n                                                borderRadius: '4px',\r\n                                                fontSize: '12px'\r\n                                            }, children: [_jsx(\"option\", { value: \"DD/MM/YYYY\", children: \"JJ/MM/AAAA (31/12/2024)\" }), _jsx(\"option\", { value: \"MM/DD/YYYY\", children: \"MM/JJ/AAAA (12/31/2024)\" }), _jsx(\"option\", { value: \"DD-MM-YYYY\", children: \"JJ-MM-AAAA (31-12-2024)\" }), _jsx(\"option\", { value: \"YYYY-MM-DD\", children: \"AAAA-MM-JJ (2024-12-31)\" }), _jsx(\"option\", { value: \"DD MMM YYYY\", children: \"JJ MMM AAAA (31 d\\u00E9c. 2024)\" })] }), _jsx(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '4px' }, children: \"Format d'affichage de la date de commande\" })] }) })] })), _jsxs(\"div\", { style: { marginBottom: '12px', padding: '12px', backgroundColor: '#f8f9fa', borderRadius: '4px', border: '1px solid #e9ecef' }, children: [_jsx(\"div\", { style: { fontSize: '12px', fontWeight: 'bold', marginBottom: '8px', color: '#495057' }, children: \"\\u2139\\uFE0F Information\" }), _jsx(\"div\", { style: { fontSize: '11px', color: '#6c757d', lineHeight: '1.4' }, children: \"Le num\\u00E9ro de commande est automatiquement r\\u00E9cup\\u00E9r\\u00E9 depuis WooCommerce. Le format et la num\\u00E9rotation sont g\\u00E9r\\u00E9s par votre configuration WooCommerce.\" })] })] })), currentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsx(Accordion, { title: \"Th\\u00E8mes pr\\u00E9d\\u00E9finis\", defaultOpen: true, children: _jsx(\"div\", { style: {\r\n                                display: 'grid',\r\n                                gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\r\n                                gap: '8px',\r\n                                maxHeight: '200px',\r\n                                overflowY: 'auto',\r\n                                padding: '4px',\r\n                                border: '1px solid #e0e0e0',\r\n                                borderRadius: '4px',\r\n                                backgroundColor: '#fafafa'\r\n                            }, children: [\r\n                                {\r\n                                    id: 'clean',\r\n                                    name: 'Propre',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: '1px solid #f3f4f6',\r\n                                            borderRadius: '4px',\r\n                                            backgroundColor: '#ffffff',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '1px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '2px',\r\n                                                    backgroundColor: '#f9fafb'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '2px',\r\n                                                    backgroundColor: '#ffffff'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '2px',\r\n                                                    backgroundColor: '#f9fafb'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: '#ffffff',\r\n                                        borderColor: '#f3f4f6',\r\n                                        textColor: '#374151',\r\n                                        headerTextColor: '#111827',\r\n                                        showHeaders: true,\r\n                                        showBackground: true,\r\n                                        showBorders: true\r\n                                    }\r\n                                },\r\n                                {\r\n                                    id: 'subtle',\r\n                                    name: 'Discret',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: '1px solid #f1f5f9',\r\n                                            borderRadius: '6px',\r\n                                            backgroundColor: '#fafbfc',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '2px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#e2e8f0',\r\n                                                    borderRadius: '1px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#fafbfc',\r\n                                                    borderRadius: '1px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#e2e8f0',\r\n                                                    borderRadius: '1px'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: '#fafbfc',\r\n                                        borderColor: '#f1f5f9',\r\n                                        textColor: '#475569',\r\n                                        headerTextColor: '#334155',\r\n                                        showHeaders: true,\r\n                                        showBackground: true,\r\n                                        showBorders: true\r\n                                    }\r\n                                },\r\n                                {\r\n                                    id: 'elegant',\r\n                                    name: 'lgant',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: '2px solid #f3e8ff',\r\n                                            borderRadius: '8px',\r\n                                            backgroundColor: '#fefefe',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '2px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#f3e8ff',\r\n                                                    borderRadius: '2px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#fefefe',\r\n                                                    borderRadius: '2px'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#f3e8ff',\r\n                                                    borderRadius: '2px'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: '#fefefe',\r\n                                        borderColor: '#f3e8ff',\r\n                                        textColor: '#6b21a8',\r\n                                        headerTextColor: '#581c87',\r\n                                        showHeaders: true,\r\n                                        showBackground: true,\r\n                                        showBorders: true\r\n                                    }\r\n                                },\r\n                                {\r\n                                    id: 'corporate',\r\n                                    name: 'Corporate',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: '1px solid #e5e7eb',\r\n                                            borderRadius: '0px',\r\n                                            backgroundColor: '#ffffff',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '2px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#f3f4f6'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#ffffff'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '3px',\r\n                                                    backgroundColor: '#f3f4f6'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: '#ffffff',\r\n                                        borderColor: '#e5e7eb',\r\n                                        textColor: '#374151',\r\n                                        headerTextColor: '#111827',\r\n                                        showHeaders: true,\r\n                                        showBackground: false,\r\n                                        showBorders: true\r\n                                    }\r\n                                },\r\n                                {\r\n                                    id: 'minimal',\r\n                                    name: 'Minimal',\r\n                                    preview: (_jsxs(\"div\", { style: {\r\n                                            width: '100%',\r\n                                            height: '35px',\r\n                                            border: 'none',\r\n                                            borderRadius: '0px',\r\n                                            backgroundColor: 'transparent',\r\n                                            display: 'flex',\r\n                                            flexDirection: 'column',\r\n                                            justifyContent: 'center',\r\n                                            alignItems: 'center',\r\n                                            gap: '1px'\r\n                                        }, children: [_jsx(\"div\", { style: {\r\n                                                    width: '90%',\r\n                                                    height: '1px',\r\n                                                    backgroundColor: '#e5e7eb'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '75%',\r\n                                                    height: '1px',\r\n                                                    backgroundColor: 'transparent'\r\n                                                } }), _jsx(\"div\", { style: {\r\n                                                    width: '60%',\r\n                                                    height: '1px',\r\n                                                    backgroundColor: '#e5e7eb'\r\n                                                } })] })),\r\n                                    styles: {\r\n                                        backgroundColor: 'transparent',\r\n                                        borderColor: 'transparent',\r\n                                        textColor: '#6b7280',\r\n                                        headerTextColor: '#374151',\r\n                                        showHeaders: false,\r\n                                        showBackground: false,\r\n                                        showBorders: false\r\n                                    }\r\n                                }\r\n                            ].map(theme => (_jsxs(\"button\", { onClick: () => {\r\n                                    // Appliquer toutes les proprits du thme\r\n                                    Object.entries(theme.styles).forEach(([property, value]) => {\r\n                                        onChange(element.id, property, value);\r\n                                    });\r\n                                }, style: {\r\n                                    padding: '6px',\r\n                                    border: '2px solid transparent',\r\n                                    borderRadius: '6px',\r\n                                    backgroundColor: '#ffffff',\r\n                                    cursor: 'pointer',\r\n                                    textAlign: 'center',\r\n                                    transition: 'all 0.2s ease',\r\n                                    minHeight: '70px',\r\n                                    display: 'flex',\r\n                                    flexDirection: 'column',\r\n                                    alignItems: 'center',\r\n                                    gap: '4px'\r\n                                }, onMouseEnter: (e) => {\r\n                                    e.currentTarget.style.borderColor = '#007bff';\r\n                                    e.currentTarget.style.backgroundColor = '#f8f9fa';\r\n                                    e.currentTarget.style.transform = 'translateY(-1px)';\r\n                                }, onMouseLeave: (e) => {\r\n                                    e.currentTarget.style.borderColor = 'transparent';\r\n                                    e.currentTarget.style.backgroundColor = '#ffffff';\r\n                                    e.currentTarget.style.transform = 'translateY(0)';\r\n                                }, title: `Appliquer le thme ${theme.name}`, children: [_jsx(\"div\", { style: {\r\n                                            fontSize: '10px',\r\n                                            fontWeight: 'bold',\r\n                                            color: '#333',\r\n                                            textAlign: 'center',\r\n                                            lineHeight: '1.2'\r\n                                        }, children: theme.name }), theme.preview] }, theme.id))) }) }), _jsx(\"hr\", { style: { margin: '16px 0', border: 'none', borderTop: '1px solid #ddd' } }), element.showLabel !== false && element.showHeaders !== false && (_jsxs(Accordion, { title: \"Police du libell\\u00E9\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"32\", value: element.headerFontSize || (Number(element.fontSize) || 14) + 2, onChange: (e) => onChange(element.id, 'headerFontSize', parseInt(e.target.value) || 16), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Famille de police\" }), _jsxs(\"select\", { value: String(element.headerFontFamily || element.fontFamily || 'Arial'), onChange: (e) => onChange(element.id, 'headerFontFamily', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de police\" }), _jsxs(\"select\", { value: element.headerFontWeight || element.fontWeight || 'bold', onChange: (e) => onChange(element.id, 'headerFontWeight', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal (400)\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras (700)\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin (300)\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras (900)\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Style de police\" }), _jsxs(\"select\", { value: element.headerFontStyle || element.fontStyle || 'normal', onChange: (e) => onChange(element.id, 'headerFontStyle', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de police\" }), _jsx(\"input\", { type: \"color\", value: element.headerTextColor || element.textColor || '#111827', onChange: (e) => onChange(element.id, 'headerTextColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] })] })), _jsxs(Accordion, { title: \"Police du num\\u00E9ro et de la date\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police du num\\u00E9ro\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"24\", value: element.numberFontSize || element.bodyFontSize || element.fontSize || 14, onChange: (e) => onChange(element.id, 'numberFontSize', parseInt(e.target.value) || 14), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police de la date\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"24\", value: element.dateFontSize || (Number(element.bodyFontSize || element.fontSize) || 14) - 2, onChange: (e) => onChange(element.id, 'dateFontSize', parseInt(e.target.value) || 12), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Famille de police\" }), _jsxs(\"select\", { value: element.bodyFontFamily || element.fontFamily || 'Arial', onChange: (e) => onChange(element.id, 'bodyFontFamily', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" }), _jsx(\"option\", { value: \"Trebuchet MS\", children: \"Trebuchet MS\" }), _jsx(\"option\", { value: \"Calibri\", children: \"Calibri\" }), _jsx(\"option\", { value: \"Cambria\", children: \"Cambria\" }), _jsx(\"option\", { value: \"Segoe UI\", children: \"Segoe UI\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de police\" }), _jsxs(\"select\", { value: element.bodyFontWeight || element.fontWeight || 'normal', onChange: (e) => onChange(element.id, 'bodyFontWeight', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal (400)\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras (700)\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin (300)\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras (900)\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Style de police\" }), _jsxs(\"select\", { value: element.bodyFontStyle || element.fontStyle || 'normal', onChange: (e) => onChange(element.id, 'bodyFontStyle', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"italic\", children: \"Italique\" }), _jsx(\"option\", { value: \"oblique\", children: \"Oblique\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de police\" }), _jsx(\"input\", { type: \"color\", value: element.textColor || '#374151', onChange: (e) => onChange(element.id, 'textColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] })] }), _jsxs(Accordion, { title: \"Couleurs\", defaultOpen: false, children: [_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte du libell\\u00E9\" }), _jsx(\"input\", { type: \"color\", value: element.headerTextColor || element.textColor || '#111827', onChange: (e) => onChange(element.id, 'headerTextColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] }), _jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte du num\\u00E9ro\" }), _jsx(\"input\", { type: \"color\", value: element.textColor || '#374151', onChange: (e) => onChange(element.id, 'textColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] }), element.showBackground !== false && (_jsxs(\"div\", { style: { marginBottom: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.backgroundColor === 'transparent' ? '#ffffff' : (element.backgroundColor || '#ffffff'), onChange: (e) => onChange(element.id, 'backgroundColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] })), _jsxs(\"div\", { style: { marginBottom: '0' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur des bordures\" }), _jsx(\"input\", { type: \"color\", value: element.borderColor || '#e5e7eb', onChange: (e) => onChange(element.id, 'borderColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '32px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px'\r\n                                        } })] })] })] })), currentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Position X\" }), _jsx(\"input\", { type: \"number\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Position Y\" }), _jsx(\"input\", { type: \"number\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Largeur\" }), _jsx(\"input\", { type: \"number\", value: element.width || 200, onChange: (e) => onChange(element.id, 'width', parseInt(e.target.value) || 200), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Hauteur\" }), _jsx(\"input\", { type: \"number\", value: element.height || 40, onChange: (e) => onChange(element.id, 'height', parseInt(e.target.value) || 40), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Alignement du contenu\" }), _jsxs(\"select\", { value: element.contentAlign || 'left', onChange: (e) => onChange(element.id, 'contentAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"left\", children: \"Aligner \\u00E0 gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centrer\" }), _jsx(\"option\", { value: \"right\", children: \"Aligner \\u00E0 droite\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Alignement horizontal\" }), _jsxs(\"select\", { value: element.textAlign || 'left', onChange: (e) => onChange(element.id, 'textAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"left\", children: \"Gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centre\" }), _jsx(\"option\", { value: \"right\", children: \"Droite\" })] })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\n// Composant Toggle personnalis\r\nconst Toggle = ({ checked, onChange, label, description }) => (_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"div\", { style: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                marginBottom: '6px'\r\n            }, children: [_jsx(\"label\", { style: {\r\n                        fontSize: '12px',\r\n                        fontWeight: 'bold',\r\n                        color: '#333',\r\n                        flex: 1\r\n                    }, children: label }), _jsx(\"div\", { onClick: () => onChange(!checked), style: {\r\n                        position: 'relative',\r\n                        width: '44px',\r\n                        height: '24px',\r\n                        backgroundColor: checked ? '#007bff' : '#ccc',\r\n                        borderRadius: '12px',\r\n                        cursor: 'pointer',\r\n                        transition: 'background-color 0.2s ease',\r\n                        border: 'none'\r\n                    }, children: _jsx(\"div\", { style: {\r\n                            position: 'absolute',\r\n                            top: '2px',\r\n                            left: checked ? '22px' : '2px',\r\n                            width: '20px',\r\n                            height: '20px',\r\n                            backgroundColor: 'white',\r\n                            borderRadius: '50%',\r\n                            transition: 'left 0.2s ease',\r\n                            boxShadow: '0 1px 3px rgba(0,0,0,0.2)'\r\n                        } }) })] }), _jsx(\"div\", { style: {\r\n                fontSize: '11px',\r\n                color: '#666',\r\n                lineHeight: '1.4'\r\n            }, children: description })] }));\r\nexport function DynamicTextProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    var _a;\r\n    const dynamicCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setDynamicCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    // Liste des exemples prdfinis\r\n    const textExamples = [\r\n        // === PROFESSIONNEL ===\r\n        {\r\n            id: 'signature_zone',\r\n            label: 'Zone de signature',\r\n            template: 'Signature du client :\\n\\n______________________________\\n\\nDate :\\n\\n____/____/________'\r\n        },\r\n        {\r\n            id: 'signature_client',\r\n            label: 'Signature client',\r\n            template: 'Signature du client\\n\\n______________________________\\n\\nNom et prnom :\\n\\nDate : ____/____/________'\r\n        },\r\n        {\r\n            id: 'signature_entreprise',\r\n            label: 'Signature entreprise',\r\n            template: 'Pour l\\'entreprise :\\n\\n______________________________\\n\\n[prenom] [nom]\\n[entreprise]'\r\n        },\r\n        {\r\n            id: 'signature_double',\r\n            label: 'Double signature',\r\n            template: 'Signature du client :\\n______________________________\\n\\nSignature de l\\'entreprise :\\n______________________________\\n\\nDate : ____/____/________'\r\n        },\r\n        {\r\n            id: 'signature_with_stamp',\r\n            label: 'Signature avec cachet',\r\n            template: 'Signature et cachet :\\n\\n______________________________\\n\\n[entreprise]\\nCachet de l\\'entreprise\\n\\nDate : ____/____/________'\r\n        },\r\n        {\r\n            id: 'signature_contract',\r\n            label: 'Signature contrat',\r\n            template: 'Fait  [Ville], le [date]\\n\\nSignatures :\\n\\nLe Client :\\n______________________________\\n\\nL\\'Entreprise :\\n______________________________\\n\\n[prenom] [nom]'\r\n        },\r\n        {\r\n            id: 'signature_approval',\r\n            label: 'Approbation',\r\n            template: 'Lu et approuv :\\n\\n______________________________\\n\\n[prenom] [nom]\\n[date]'\r\n        },\r\n        {\r\n            id: 'signature_witness',\r\n            label: 'Tmoin',\r\n            template: 'Tmoin :\\n\\n______________________________\\n\\nNom et prnom :\\n\\nAdresse :\\n\\nDate : ____/____/________'\r\n        },\r\n        {\r\n            id: 'document_title',\r\n            label: 'Titre de document',\r\n            template: 'CONTRAT DE PRESTATION DE SERVICES'\r\n        },\r\n        {\r\n            id: 'document_subtitle',\r\n            label: 'Sous-titre de document',\r\n            template: 'Entre les parties ci-dessous dsignes'\r\n        },\r\n        // === FORMULAIRES ===\r\n        {\r\n            id: 'checkbox_terms',\r\n            label: 'Case - Conditions gnrales',\r\n            template: ' J\\'ai lu et j\\'accepte les conditions gnrales de vente'\r\n        },\r\n        {\r\n            id: 'checkbox_privacy',\r\n            label: 'Case - Politique de confidentialit',\r\n            template: ' J\\'accepte la politique de confidentialit'\r\n        },\r\n        {\r\n            id: 'checkbox_newsletter',\r\n            label: 'Case - Newsletter',\r\n            template: ' Je souhaite m\\'inscrire  la newsletter'\r\n        },\r\n        {\r\n            id: 'checkbox_certification',\r\n            label: 'Case - Certification',\r\n            template: ' Je certifie l\\'exactitude des informations fournies'\r\n        },\r\n        {\r\n            id: 'checkbox_quote_acceptance',\r\n            label: 'Case - Acceptation devis',\r\n            template: ' J\\'accepte ce devis et souhaite passer commande'\r\n        },\r\n        {\r\n            id: 'checkbox_order_confirmation',\r\n            label: 'Case - Confirmation commande',\r\n            template: ' Je confirme ma commande selon les termes du devis'\r\n        },\r\n        {\r\n            id: 'checkbox_payment_terms',\r\n            label: 'Case - Conditions de paiement',\r\n            template: ' J\\'accepte les conditions de paiement proposes'\r\n        },\r\n        {\r\n            id: 'checkbox_delivery_terms',\r\n            label: 'Case - Conditions de livraison',\r\n            template: ' J\\'accepte les conditions de livraison et dlais'\r\n        },\r\n        {\r\n            id: 'checkbox_price_acceptance',\r\n            label: 'Case - Acceptation tarif',\r\n            template: ' J\\'accepte le tarif propos pour cette prestation'\r\n        },\r\n        {\r\n            id: 'checkbox_liability_waiver',\r\n            label: 'Case - Dcharge responsabilit',\r\n            template: ' Je dgage l\\'entreprise de toute responsabilit en cas de...'\r\n        },\r\n        {\r\n            id: 'checkbox_data_processing',\r\n            label: 'Case - Traitement donnes',\r\n            template: ' J\\'autorise le traitement de mes donnes personnelles'\r\n        },\r\n        {\r\n            id: 'checkbox_contract_acceptance',\r\n            label: 'Case - Acceptation contrat',\r\n            template: ' J\\'accepte les termes du contrat ci-dessus'\r\n        },\r\n        // === INFORMATIONS ===\r\n        {\r\n            id: 'contact_complete',\r\n            label: 'Contact complet',\r\n            template: '[entreprise]\\n[Adresse ligne 1]\\n[Code postal] [Ville]\\n[telephone] | [email]\\n[site]'\r\n        },\r\n        {\r\n            id: 'contact_minimal',\r\n            label: 'Contact minimal',\r\n            template: '[email] | [telephone]'\r\n        },\r\n        {\r\n            id: 'legal_mentions',\r\n            label: 'Mentions lgales',\r\n            template: 'SIRET: [SIRET] | TVA: [TVA]\\nCapital social: [capital]'\r\n        },\r\n        // === DATES ===\r\n        {\r\n            id: 'date_today',\r\n            label: 'Date du jour',\r\n            template: 'Fait  [Ville], le [date]'\r\n        },\r\n        {\r\n            id: 'date_contract',\r\n            label: 'Date de contrat',\r\n            template: 'Contrat tabli le [date]'\r\n        },\r\n        // === TEXTES ===\r\n        {\r\n            id: 'paragraph_intro',\r\n            label: 'Introduction',\r\n            template: 'Par la prsente, il est convenu ce qui suit entre les parties :'\r\n        },\r\n        {\r\n            id: 'paragraph_conclusion',\r\n            label: 'Conclusion',\r\n            template: 'Les parties dclarent avoir lu et approuv l\\'intgralit du prsent document.'\r\n        },\r\n        {\r\n            id: 'paragraph_payment',\r\n            label: 'Paiement',\r\n            template: 'Le paiement s\\'effectuera selon les modalits suivantes :'\r\n        },\r\n        // === LISTES ===\r\n        {\r\n            id: 'bullet_services',\r\n            label: 'Services (liste)',\r\n            template: ' Conseil et accompagnement\\n Formation personnalise\\n Support technique'\r\n        },\r\n        {\r\n            id: 'numbered_steps',\r\n            label: 'tapes (liste)',\r\n            template: '1. Validation du cahier des charges\\n2. Ralisation du projet\\n3. Livraison et recette'\r\n        },\r\n        {\r\n            id: 'bullet_features',\r\n            label: 'Fonctionnalits',\r\n            template: ' Interface intuitive\\n Performance optimise\\n Scurit renforce'\r\n        },\r\n        // === PROFESSIONNEL AVANC ===\r\n        {\r\n            id: 'confidentiality_clause',\r\n            label: 'Clause de confidentialit',\r\n            template: 'Les parties s\\'engagent  garder confidentielles les informations changes.'\r\n        },\r\n        {\r\n            id: 'jurisdiction_clause',\r\n            label: 'Clause de juridiction',\r\n            template: 'Tout litige sera soumis aux tribunaux de [Ville].'\r\n        },\r\n        {\r\n            id: 'termination_clause',\r\n            label: 'Clause de rsiliation',\r\n            template: 'Le prsent contrat peut tre rsili par l\\'une ou l\\'autre des parties avec un pravis de 30 jours.'\r\n        },\r\n        {\r\n            id: 'custom',\r\n            label: 'Personnalis',\r\n            template: ''\r\n        }\r\n    ];\r\n    // Dtecter le template actuel\r\n    const currentText = element.text || '';\r\n    const currentTemplate = element.textTemplate ||\r\n        ((_a = textExamples.find((ex) => ex.template === currentText)) === null || _a === void 0 ? void 0 : _a.id) || 'custom';\r\n    // Fonction pour changer de template\r\n    const handleTemplateChange = (templateId) => {\r\n        const selectedExample = textExamples.find((ex) => ex.id === templateId);\r\n        if (selectedExample) {\r\n            onChange(element.id, 'text', selectedExample.template);\r\n            onChange(element.id, 'textTemplate', selectedExample.id);\r\n        }\r\n    };\r\n    const dynamicTextThemes = [\r\n        {\r\n            id: 'clean',\r\n            name: 'Propre',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #f3f4f6',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#ffffff',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '2px',\r\n                            backgroundColor: '#f9fafb'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '2px',\r\n                            backgroundColor: '#ffffff'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '2px',\r\n                            backgroundColor: '#f9fafb'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#f3f4f6',\r\n                textColor: '#374151',\r\n                headerTextColor: '#111827'\r\n            }\r\n        },\r\n        {\r\n            id: 'subtle',\r\n            name: 'Discret',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #e5e7eb',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#f9fafb',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '2px',\r\n                            backgroundColor: '#e5e7eb'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '2px',\r\n                            backgroundColor: '#f3f4f6'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '2px',\r\n                            backgroundColor: '#e5e7eb'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#f9fafb',\r\n                borderColor: '#e5e7eb',\r\n                textColor: '#6b7280',\r\n                headerTextColor: '#374151'\r\n            }\r\n        },\r\n        {\r\n            id: 'highlighted',\r\n            name: 'Surlign',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #dbeafe',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#eff6ff',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '2px',\r\n                            backgroundColor: '#dbeafe'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '2px',\r\n                            backgroundColor: '#eff6ff'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '2px',\r\n                            backgroundColor: '#dbeafe'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#eff6ff',\r\n                borderColor: '#dbeafe',\r\n                textColor: '#1e40af',\r\n                headerTextColor: '#1e3a8a'\r\n            }\r\n        }\r\n    ];\r\n    const availableVariables = [\r\n        { key: '[date]', label: 'Date actuelle' },\r\n        { key: '[nom]', label: 'Nom' },\r\n        { key: '[prenom]', label: 'Prnom' },\r\n        { key: '[entreprise]', label: 'Nom de l\\'entreprise' },\r\n        { key: '[telephone]', label: 'Tlphone' },\r\n        { key: '[email]', label: 'Email' },\r\n        { key: '[site]', label: 'Site web' },\r\n        { key: '[ville]', label: 'Ville' },\r\n        { key: '[siret]', label: 'Numro SIRET' },\r\n        { key: '[tva]', label: 'Numro TVA' },\r\n        { key: '[capital]', label: 'Capital social' },\r\n        { key: '[rcs]', label: 'RCS' }\r\n    ];\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setDynamicCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: dynamicCurrentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: dynamicCurrentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setDynamicCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: dynamicCurrentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: dynamicCurrentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setDynamicCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: dynamicCurrentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: dynamicCurrentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), dynamicCurrentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Mod\\u00E8le de texte\" }), _jsx(\"select\", { value: currentTemplate, onChange: (e) => handleTemplateChange(e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                }, children: textExamples.map((example) => (_jsx(\"option\", { value: example.id, children: example.label }, example.id))) })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Texte personnalis\\u00E9\" }), _jsx(\"textarea\", { value: element.text || '', onChange: (e) => onChange(element.id, 'text', e.target.value), placeholder: \"Modifiez le texte ou utilisez les variables disponibles\", rows: 3, style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px',\r\n                                    resize: 'vertical'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '8px' }, children: \"Variables disponibles\" }), _jsx(\"div\", { style: {\r\n                                    maxHeight: '150px',\r\n                                    overflowY: 'auto',\r\n                                    border: '1px solid #e0e0e0',\r\n                                    borderRadius: '4px',\r\n                                    padding: '8px',\r\n                                    backgroundColor: '#fafafa'\r\n                                }, children: availableVariables.map((variable) => (_jsxs(\"div\", { onClick: () => {\r\n                                        const currentText = element.text || '';\r\n                                        const newText = currentText + variable.key;\r\n                                        onChange(element.id, 'text', newText);\r\n                                    }, style: {\r\n                                        cursor: 'pointer',\r\n                                        padding: '4px 8px',\r\n                                        marginBottom: '4px',\r\n                                        backgroundColor: '#ffffff',\r\n                                        border: '1px solid #e0e0e0',\r\n                                        borderRadius: '3px',\r\n                                        fontSize: '11px',\r\n                                        fontFamily: 'monospace'\r\n                                    }, title: `Cliquez pour insrer ${variable.key}`, children: [_jsx(\"strong\", { children: variable.key }), \" - \", variable.label] }, variable.key))) })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Retour \\u00E0 la ligne automatique\" }), _jsx(\"input\", { type: \"checkbox\", checked: element.autoWrap !== false, onChange: (e) => onChange(element.id, 'autoWrap', e.target.checked), style: { marginRight: '8px' } }), _jsx(\"span\", { style: { fontSize: '11px', color: '#666' }, children: \"Adapte le texte \\u00E0 la largeur\" })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Affichage du fond\" }), _jsx(\"div\", { style: { paddingLeft: '8px' }, children: _jsx(Toggle, { checked: element.showBackground !== false, onChange: (checked) => onChange(element.id, 'showBackground', checked), label: \"Afficher le fond\", description: \"Affiche un fond color\\u00E9 derri\\u00E8re le texte dynamique\" }) })] })] })), dynamicCurrentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '8px' }, children: \"Th\\u00E8me visuel\" }), _jsx(\"div\", { style: {\r\n                                    display: 'grid',\r\n                                    gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\r\n                                    gap: '8px',\r\n                                    maxHeight: '200px',\r\n                                    overflowY: 'auto',\r\n                                    padding: '4px',\r\n                                    border: '1px solid #e0e0e0',\r\n                                    borderRadius: '4px',\r\n                                    backgroundColor: '#fafafa'\r\n                                }, children: dynamicTextThemes.map((theme) => (_jsxs(\"div\", { onClick: () => onChange(element.id, 'theme', theme.id), style: {\r\n                                        cursor: 'pointer',\r\n                                        border: element.theme === theme.id ? '2px solid #007bff' : '2px solid transparent',\r\n                                        borderRadius: '6px',\r\n                                        padding: '6px',\r\n                                        backgroundColor: '#ffffff',\r\n                                        transition: 'all 0.2s ease'\r\n                                    }, title: theme.name, children: [_jsx(\"div\", { style: { fontSize: '10px', fontWeight: 'bold', marginBottom: '4px', textAlign: 'center' }, children: theme.name }), theme.preview] }, theme.id))) })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Taille du texte\" }), _jsxs(\"select\", { value: element.fontSize || '12', onChange: (e) => onChange(element.id, 'fontSize', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"10\", children: \"Petit (10px)\" }), _jsx(\"option\", { value: \"12\", children: \"Normal (12px)\" }), _jsx(\"option\", { value: \"14\", children: \"Moyen (14px)\" }), _jsx(\"option\", { value: \"16\", children: \"Grand (16px)\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Alignement du texte\" }), _jsxs(\"select\", { value: element.textAlign || 'left', onChange: (e) => onChange(element.id, 'textAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"left\", children: \"Gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centre\" }), _jsx(\"option\", { value: \"right\", children: \"Droite\" }), _jsx(\"option\", { value: \"justify\", children: \"Justifi\\u00E9\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Style du texte\" }), _jsxs(\"div\", { style: { display: 'flex', gap: '8px', flexWrap: 'wrap' }, children: [_jsxs(\"label\", { style: { fontSize: '11px', display: 'flex', alignItems: 'center' }, children: [_jsx(\"input\", { type: \"checkbox\", checked: element.fontWeight === 'bold', onChange: (e) => onChange(element.id, 'fontWeight', e.target.checked ? 'bold' : 'normal'), style: { marginRight: '4px' } }), \"Gras\"] }), _jsxs(\"label\", { style: { fontSize: '11px', display: 'flex', alignItems: 'center' }, children: [_jsx(\"input\", { type: \"checkbox\", checked: element.fontStyle === 'italic', onChange: (e) => onChange(element.id, 'fontStyle', e.target.checked ? 'italic' : 'normal'), style: { marginRight: '4px' } }), \"Italique\"] }), _jsxs(\"label\", { style: { fontSize: '11px', display: 'flex', alignItems: 'center' }, children: [_jsx(\"input\", { type: \"checkbox\", checked: element.textDecoration === 'underline', onChange: (e) => onChange(element.id, 'textDecoration', e.target.checked ? 'underline' : 'none'), style: { marginRight: '4px' } }), \"Soulign\\u00E9\"] })] })] }), element.showBackground !== false && (_jsx(\"div\", { style: { marginTop: '16px', paddingTop: '16px', borderTop: '1px solid #e5e7eb' }, children: _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.backgroundColor || '#e5e7eb', onChange: (e) => onChange(element.id, 'backgroundColor', e.target.value), style: {\r\n                                        width: '100%',\r\n                                        height: '40px',\r\n                                        border: '1px solid #d1d5db',\r\n                                        borderRadius: '6px',\r\n                                        cursor: 'pointer'\r\n                                    } })] }) }))] })), dynamicCurrentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Position X\" }), _jsx(\"input\", { type: \"number\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Position Y\" }), _jsx(\"input\", { type: \"number\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Largeur\" }), _jsx(\"input\", { type: \"number\", value: element.width || 200, onChange: (e) => onChange(element.id, 'width', parseInt(e.target.value) || 200), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Hauteur\" }), _jsx(\"input\", { type: \"number\", value: element.height || 50, onChange: (e) => onChange(element.id, 'height', parseInt(e.target.value) || 50), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\n// Composant Toggle personnalis\r\nconst Toggle = ({ checked, onChange, label, description }) => (_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"div\", { style: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                marginBottom: '6px'\r\n            }, children: [_jsx(\"label\", { style: {\r\n                        fontSize: '12px',\r\n                        fontWeight: 'bold',\r\n                        color: '#333',\r\n                        flex: 1\r\n                    }, children: label }), _jsx(\"div\", { onClick: () => onChange(!checked), style: {\r\n                        position: 'relative',\r\n                        width: '44px',\r\n                        height: '24px',\r\n                        backgroundColor: checked ? '#007bff' : '#ccc',\r\n                        borderRadius: '12px',\r\n                        cursor: 'pointer',\r\n                        transition: 'background-color 0.2s ease',\r\n                        border: 'none'\r\n                    }, children: _jsx(\"div\", { style: {\r\n                            position: 'absolute',\r\n                            top: '2px',\r\n                            left: checked ? '22px' : '2px',\r\n                            width: '20px',\r\n                            height: '20px',\r\n                            backgroundColor: 'white',\r\n                            borderRadius: '50%',\r\n                            transition: 'left 0.2s ease',\r\n                            boxShadow: '0 1px 3px rgba(0,0,0,0.2)'\r\n                        } }) })] }), _jsx(\"div\", { style: {\r\n                fontSize: '11px',\r\n                color: '#666',\r\n                lineHeight: '1.4'\r\n            }, children: description })] }));\r\nexport function MentionsProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    var _a, _b, _c, _d, _e, _f;\r\n    const mentionsCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setMentionsCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    const mentionsThemes = [\r\n        {\r\n            id: 'legal',\r\n            name: 'Lgal',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #6b7280',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#ffffff',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '2px',\r\n                            backgroundColor: '#6b7280'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '1px',\r\n                            backgroundColor: '#9ca3af'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '1px',\r\n                            backgroundColor: '#d1d5db'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#ffffff',\r\n                borderColor: '#6b7280',\r\n                textColor: '#374151',\r\n                headerTextColor: '#111827'\r\n            }\r\n        },\r\n        {\r\n            id: 'subtle',\r\n            name: 'Discret',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: '1px solid #e5e7eb',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: '#f9fafb',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '1px',\r\n                            backgroundColor: '#9ca3af'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '1px',\r\n                            backgroundColor: '#d1d5db'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '1px',\r\n                            backgroundColor: '#e5e7eb'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: '#f9fafb',\r\n                borderColor: '#e5e7eb',\r\n                textColor: '#6b7280',\r\n                headerTextColor: '#374151'\r\n            }\r\n        },\r\n        {\r\n            id: 'minimal',\r\n            name: 'Minimal',\r\n            preview: (_jsxs(\"div\", { style: {\r\n                    width: '100%',\r\n                    height: '35px',\r\n                    border: 'none',\r\n                    borderRadius: '4px',\r\n                    backgroundColor: 'transparent',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    justifyContent: 'center',\r\n                    alignItems: 'center',\r\n                    gap: '1px'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            width: '90%',\r\n                            height: '1px',\r\n                            backgroundColor: '#d1d5db'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '75%',\r\n                            height: '1px',\r\n                            backgroundColor: '#e5e7eb'\r\n                        } }), _jsx(\"div\", { style: {\r\n                            width: '60%',\r\n                            height: '1px',\r\n                            backgroundColor: '#f3f4f6'\r\n                        } })] })),\r\n            styles: {\r\n                backgroundColor: 'transparent',\r\n                borderColor: 'transparent',\r\n                textColor: '#6b7280',\r\n                headerTextColor: '#374151'\r\n            }\r\n        }\r\n    ];\r\n    const predefinedMentions = [\r\n        {\r\n            key: 'cgv',\r\n            label: 'Conditions Gnrales de Vente',\r\n            text: 'Conditions Gnrales de Vente applicables. Consultez notre site web pour plus de dtails.'\r\n        },\r\n        {\r\n            key: 'legal',\r\n            label: 'Mentions lgales',\r\n            text: 'Document tabli sous la responsabilit de l\\'entreprise. Toutes les informations sont confidentielles.'\r\n        },\r\n        {\r\n            key: 'payment',\r\n            label: 'Conditions de paiement',\r\n            text: 'Paiement d dans les dlais convenus. Tout retard peut entraner des pnalits.'\r\n        },\r\n        {\r\n            key: 'warranty',\r\n            label: 'Garantie',\r\n            text: 'Garantie lgale de conformit et garantie contre les vices cachs selon les articles L217-4 et suivants du Code de la consommation.'\r\n        },\r\n        {\r\n            key: 'returns',\r\n            label: 'Droit de rtractation',\r\n            text: 'Droit de rtractation de 14 jours selon l\\'article L221-18 du Code de la consommation.'\r\n        },\r\n        {\r\n            key: 'tva',\r\n            label: 'TVA et mentions fiscales',\r\n            text: 'TVA non applicable, art. 293 B du CGI. Mention : auto-entrepreneur soumise  l\\'impt sur le revenu.'\r\n        },\r\n        {\r\n            key: 'penalties',\r\n            label: 'Pnalits de retard',\r\n            text: 'Tout retard de paiement donnera lieu au paiement d\\'une pnalit gale  3 fois le taux d\\'intrt lgal en vigueur.'\r\n        },\r\n        {\r\n            key: 'property',\r\n            label: 'Rserve de proprit',\r\n            text: 'Les biens vendus restent la proprit du vendeur jusqu\\'au paiement intgral du prix.'\r\n        },\r\n        {\r\n            key: 'jurisdiction',\r\n            label: 'Juridiction comptente',\r\n            text: 'Tout litige sera soumis  la comptence exclusive des tribunaux de commerce franais.'\r\n        },\r\n        {\r\n            key: 'rgpd',\r\n            label: 'RGPD - Protection des donnes',\r\n            text: 'Vos donnes personnelles sont traites conformment au RGPD. Consultez notre politique de confidentialit.'\r\n        },\r\n        {\r\n            key: 'discount',\r\n            label: 'Escompte',\r\n            text: 'Escompte pour paiement anticip : 2% du montant HT si paiement sous 8 jours.'\r\n        },\r\n        {\r\n            key: 'clause',\r\n            label: 'Clause de rserve',\r\n            text: 'Sous rserve d\\'acceptation de votre commande et de disponibilit des produits.'\r\n        },\r\n        {\r\n            key: 'intellectual',\r\n            label: 'Proprit intellectuelle',\r\n            text: 'Tous droits de proprit intellectuelle rservs. Reproduction interdite sans autorisation.'\r\n        },\r\n        {\r\n            key: 'force',\r\n            label: 'Force majeure',\r\n            text: 'Aucun des parties ne pourra tre tenu responsable en cas de force majeure.'\r\n        },\r\n        {\r\n            key: 'liability',\r\n            label: 'Limitation de responsabilit',\r\n            text: 'Notre responsabilit est limite  la valeur de la commande en cas de faute prouve.'\r\n        },\r\n        {\r\n            key: 'tva_info',\r\n            label: 'Informations TVA',\r\n            text: 'TVA non applicable - article 293 B du CGI. Rgime micro-entreprise.'\r\n        },\r\n        {\r\n            key: 'rcs_info',\r\n            label: 'Informations RCS',\r\n            text: 'RCS Paris 123 456 789 - SIRET 123 456 789 00012 - APE 1234Z'\r\n        },\r\n        {\r\n            key: 'siret_info',\r\n            label: 'Informations SIRET',\r\n            text: 'SIRET 123 456 789 00012 - NAF 1234Z - TVA FR 12 345 678 901'\r\n        },\r\n        {\r\n            key: 'legal_status',\r\n            label: 'Statut juridique',\r\n            text: 'Socit  responsabilit limite au capital de 10 000 - RCS Paris 123 456 789'\r\n        },\r\n        {\r\n            key: 'insurance',\r\n            label: 'Assurance responsabilit',\r\n            text: 'Couvert par assurance responsabilit civile professionnelle - Police N 123456789'\r\n        },\r\n        {\r\n            key: 'mediation',\r\n            label: 'Mdiation consommateur',\r\n            text: 'En cas de litige, le consommateur peut saisir gratuitement le mdiateur comptent.'\r\n        },\r\n        {\r\n            key: 'iban',\r\n            label: 'Coordonnes bancaires',\r\n            text: 'IBAN FR76 1234 5678 9012 3456 7890 123 - BIC BNPAFRPP'\r\n        },\r\n        {\r\n            key: 'delivery',\r\n            label: 'Conditions de livraison',\r\n            text: 'Livraison sous 3-5 jours ouvrs. Frais de port offerts  partir de 50 HT.'\r\n        },\r\n        {\r\n            key: 'packaging',\r\n            label: 'Emballage et environnement',\r\n            text: 'Emballages recyclables. Respectueux de l\\'environnement.'\r\n        },\r\n        {\r\n            key: 'medley',\r\n            label: 'Mdley (Combinaison)',\r\n            text: ''\r\n        },\r\n        {\r\n            key: 'custom',\r\n            label: 'Personnalis',\r\n            text: ''\r\n        }\r\n    ];\r\n    // Dtecter automatiquement le type de mention bas sur le texte actuel\r\n    const detectMentionType = () => {\r\n        const currentText = element.text || '';\r\n        const currentMentionType = element.mentionType || 'custom';\r\n        // Si un type est dj dfini et que ce n'est pas custom, le garder\r\n        if (currentMentionType && currentMentionType !== 'custom') {\r\n            return currentMentionType;\r\n        }\r\n        // Pour le medley, vrifier s'il y a des mentions slectionnes\r\n        if (element.selectedMentions && element.selectedMentions.length > 0) {\r\n            return 'medley';\r\n        }\r\n        // Sinon, essayer de dtecter automatiquement\r\n        const matchingMention = predefinedMentions.find(mention => mention.key !== 'custom' && mention.key !== 'medley' && mention.text === currentText);\r\n        return matchingMention ? matchingMention.key : 'custom';\r\n    };\r\n    const currentMentionType = detectMentionType();\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setMentionsCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: mentionsCurrentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: mentionsCurrentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setMentionsCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: mentionsCurrentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: mentionsCurrentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setMentionsCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: mentionsCurrentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: mentionsCurrentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), mentionsCurrentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Type de mentions\" }), _jsx(\"select\", { value: currentMentionType, onChange: (e) => {\r\n                                    const selectedMention = predefinedMentions.find(m => m.key === e.target.value);\r\n                                    onChange(element.id, 'mentionType', e.target.value);\r\n                                    // Ne mettre  jour le texte que si ce n'est pas \"custom\" et qu'il y a du texte prdfini\r\n                                    if (selectedMention && selectedMention.key !== 'custom' && selectedMention.key !== 'medley' && selectedMention.text) {\r\n                                        onChange(element.id, 'text', selectedMention.text);\r\n                                    }\r\n                                    // Pour \"custom\" et \"medley\", on garde le texte actuel\r\n                                }, style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                }, children: predefinedMentions.map((mention) => (_jsx(\"option\", { value: mention.key, children: mention.label }, mention.key))) })] }), currentMentionType === 'medley' && (_jsxs(\"div\", { style: { marginBottom: '12px', padding: '12px', border: '1px solid #e0e0e0', borderRadius: '4px', backgroundColor: '#f9f9f9' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '8px' }, children: \"S\\u00E9lectionnez les mentions \\u00E0 combiner :\" }), _jsx(\"div\", { style: {\r\n                                    display: 'grid',\r\n                                    gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\r\n                                    gap: '6px',\r\n                                    maxHeight: '200px',\r\n                                    overflowY: 'auto'\r\n                                }, children: predefinedMentions.filter(m => m.key !== 'medley' && m.key !== 'custom').map((mention) => {\r\n                                    const selectedMentions = element.selectedMentions || [];\r\n                                    const isSelected = selectedMentions.includes(mention.key);\r\n                                    return (_jsxs(\"label\", { style: {\r\n                                            display: 'flex',\r\n                                            alignItems: 'flex-start',\r\n                                            fontSize: '11px',\r\n                                            cursor: 'pointer',\r\n                                            padding: '4px',\r\n                                            borderRadius: '3px',\r\n                                            backgroundColor: isSelected ? '#e3f2fd' : 'transparent'\r\n                                        }, children: [_jsx(\"input\", { type: \"checkbox\", checked: isSelected, onChange: (e) => {\r\n                                                    const currentSelected = element.selectedMentions || [];\r\n                                                    let newSelected;\r\n                                                    if (e.target.checked) {\r\n                                                        newSelected = [...currentSelected, mention.key];\r\n                                                    }\r\n                                                    else {\r\n                                                        newSelected = currentSelected.filter((key) => key !== mention.key);\r\n                                                    }\r\n                                                    onChange(element.id, 'selectedMentions', newSelected);\r\n                                                    // Gnrer le texte combin avec le sparateur configur\r\n                                                    const separatorMap = {\r\n                                                        'double_newline': '\\n\\n',\r\n                                                        'single_newline': '\\n',\r\n                                                        'dash': ' - ',\r\n                                                        'bullet': '  ',\r\n                                                        'pipe': ' | '\r\n                                                    };\r\n                                                    const separator = separatorMap[(element.medleySeparator || 'double_newline')] || '\\n\\n';\r\n                                                    const combinedText = newSelected\r\n                                                        .map((key) => { var _a; return (_a = predefinedMentions.find(m => m.key === key)) === null || _a === void 0 ? void 0 : _a.text; })\r\n                                                        .filter(Boolean)\r\n                                                        .join(separator);\r\n                                                    onChange(element.id, 'text', combinedText);\r\n                                                    // Ajuster automatiquement la hauteur et la largeur selon le contenu\r\n                                                    const lines = combinedText.split('\\n');\r\n                                                    const fontSize = typeof element.fontSize === 'string' ? parseFloat(element.fontSize) : (element.fontSize || 10);\r\n                                                    const lineHeight = fontSize * 1.3; // Harmoniser avec pdf-canvas-core.js\r\n                                                    const padding = 10; // Rduire pour cohrence\r\n                                                    const iconSpace = 20; // Espace pour l'icne\r\n                                                    const minHeight = 60; // Hauteur minimale base sur la valeur par dfaut\r\n                                                    const calculatedHeight = Math.max(minHeight, lines.length * lineHeight + iconSpace + padding);\r\n                                                    const maxHeight = 500;\r\n                                                    const newHeight = Math.min(calculatedHeight, maxHeight);\r\n                                                    // Calculer la largeur base sur la ligne la plus longue\r\n                                                    const canvas = document.createElement('canvas');\r\n                                                    const ctx = canvas.getContext('2d');\r\n                                                    if (ctx) {\r\n                                                        ctx.font = `${element.fontWeight || 'normal'} ${fontSize}px ${element.fontFamily || 'Arial'}`;\r\n                                                        const maxLineWidth = Math.max(...lines.map((line) => ctx.measureText(line).width));\r\n                                                        const margin = 20; // Mme marge qu dans pdf-canvas-core.js (width - 20)\r\n                                                        const minWidth = 500; // Largeur minimale base sur la valeur par dfaut\r\n                                                        const calculatedWidth = Math.max(minWidth, maxLineWidth + margin);\r\n                                                        const maxWidth = 800; // Largeur maximale\r\n                                                        const newWidth = Math.min(calculatedWidth, maxWidth);\r\n                                                        if (element.width !== newWidth) {\r\n                                                            onChange(element.id, 'width', newWidth);\r\n                                                        }\r\n                                                    }\r\n                                                    if (element.height !== newHeight) {\r\n                                                        onChange(element.id, 'height', newHeight);\r\n                                                    }\r\n                                                }, style: { marginRight: '6px', marginTop: '1px' } }), _jsxs(\"div\", { children: [_jsx(\"div\", { style: { fontWeight: 'bold', marginBottom: '2px' }, children: mention.label }), _jsx(\"div\", { style: { fontSize: '10px', color: '#666', lineHeight: '1.3' }, children: mention.text.length > 60 ? mention.text.substring(0, 60) + '...' : mention.text })] })] }, mention.key));\r\n                                }) }), _jsxs(\"div\", { style: { marginTop: '8px', fontSize: '10px', color: '#666' }, children: [((_b = (_a = element.selectedMentions) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0), \" mention(s) s\\u00E9lectionn\\u00E9e(s)\", ((_d = (_c = element.selectedMentions) === null || _c === void 0 ? void 0 : _c.length) !== null && _d !== void 0 ? _d : 0) > 0 && (_jsx(\"span\", { style: { color: '#007bff', marginLeft: '8px' }, children: \"\\u2022 Dimensions ajustables manuellement (avec clipping)\" }))] }), ((_f = (_e = element.selectedMentions) === null || _e === void 0 ? void 0 : _e.length) !== null && _f !== void 0 ? _f : 0) > 0 && (_jsxs(\"div\", { style: { marginTop: '8px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '11px', fontWeight: 'bold', marginBottom: '4px' }, children: \"S\\u00E9parateur entre mentions :\" }), _jsxs(\"select\", { value: element.medleySeparator || 'double_newline', onChange: (e) => {\r\n                                            onChange(element.id, 'medleySeparator', e.target.value);\r\n                                            // Rgnrer le texte avec le nouveau sparateur\r\n                                            const selectedMentions = element.selectedMentions || [];\r\n                                            const separatorMap = {\r\n                                                'double_newline': '\\n\\n',\r\n                                                'single_newline': '\\n',\r\n                                                'dash': ' - ',\r\n                                                'bullet': '  ',\r\n                                                'pipe': ' | '\r\n                                            };\r\n                                            const separator = separatorMap[e.target.value] || '\\n\\n';\r\n                                            const combinedText = selectedMentions\r\n                                                .map((key) => { var _a; return (_a = predefinedMentions.find(m => m.key === key)) === null || _a === void 0 ? void 0 : _a.text; })\r\n                                                .filter(Boolean)\r\n                                                .join(separator);\r\n                                            onChange(element.id, 'text', combinedText);\r\n                                            // Ajuster la hauteur et la largeur selon le nouveau nombre de lignes\r\n                                            const lines = combinedText.split('\\n');\r\n                                            const fontSize = typeof element.fontSize === 'string' ? parseFloat(element.fontSize) : (element.fontSize || 10);\r\n                                            const lineHeight = fontSize * 1.3; // Harmoniser avec pdf-canvas-core.js\r\n                                            const padding = 10; // Rduire pour cohrence\r\n                                            const iconSpace = 20; // Espace pour l'icne\r\n                                            const minHeight = 60; // Hauteur minimale base sur la valeur par dfaut\r\n                                            const calculatedHeight = Math.max(minHeight, lines.length * lineHeight + iconSpace + padding);\r\n                                            const maxHeight = 500;\r\n                                            const newHeight = Math.min(calculatedHeight, maxHeight);\r\n                                            // Calculer la largeur base sur la ligne la plus longue\r\n                                            const canvas = document.createElement('canvas');\r\n                                            const ctx = canvas.getContext('2d');\r\n                                            if (ctx) {\r\n                                                ctx.font = `${element.fontWeight || 'normal'} ${fontSize}px ${element.fontFamily || 'Arial'}`;\r\n                                                const maxLineWidth = Math.max(...lines.map((line) => ctx.measureText(line).width));\r\n                                                const margin = 20; // Mme marge qu dans pdf-canvas-core.js (width - 20)\r\n                                                const minWidth = 200;\r\n                                                const calculatedWidth = Math.max(minWidth, maxLineWidth + margin);\r\n                                                const maxWidth = 800;\r\n                                                const newWidth = Math.min(calculatedWidth, maxWidth);\r\n                                                if (element.width !== newWidth) {\r\n                                                    onChange(element.id, 'width', newWidth);\r\n                                                }\r\n                                            }\r\n                                            if (element.height !== newHeight) {\r\n                                                onChange(element.id, 'height', newHeight);\r\n                                            }\r\n                                        }, style: {\r\n                                            width: '100%',\r\n                                            padding: '4px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '11px'\r\n                                        }, children: [_jsx(\"option\", { value: \"double_newline\", children: \"Double saut de ligne\" }), _jsx(\"option\", { value: \"single_newline\", children: \"Saut de ligne simple\" }), _jsx(\"option\", { value: \"dash\", children: \"Tiret (-)\" }), _jsx(\"option\", { value: \"bullet\", children: \"Point (\\u2022)\" }), _jsx(\"option\", { value: \"pipe\", children: \"Barre verticale (|)\" })] })] }))] })), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Texte des mentions\" }), _jsx(\"textarea\", { value: element.text || '', onChange: (e) => onChange(element.id, 'text', e.target.value), placeholder: \"Entrez le texte des mentions l\\u00E9gales...\", rows: 6, style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px',\r\n                                    resize: 'vertical'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Afficher un s\\u00E9parateur\" }), _jsx(\"input\", { type: \"checkbox\", checked: element.showSeparator !== false, onChange: (e) => onChange(element.id, 'showSeparator', e.target.checked), style: { marginRight: '8px' } }), _jsx(\"span\", { style: { fontSize: '11px', color: '#666' }, children: \"Ligne de s\\u00E9paration avant les mentions\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Style du s\\u00E9parateur\" }), _jsxs(\"select\", { value: element.separatorStyle || 'solid', onChange: (e) => onChange(element.id, 'separatorStyle', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"solid\", children: \"Ligne continue\" }), _jsx(\"option\", { value: \"dashed\", children: \"Tirets\" }), _jsx(\"option\", { value: \"dotted\", children: \"Pointill\\u00E9s\" }), _jsx(\"option\", { value: \"double\", children: \"Double ligne\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"div\", { style: {\r\n                                    fontSize: '12px',\r\n                                    fontWeight: 'bold',\r\n                                    color: '#333',\r\n                                    marginBottom: '8px',\r\n                                    padding: '4px 8px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    borderRadius: '3px',\r\n                                    border: '1px solid #e9ecef'\r\n                                }, children: \"Affichage du fond\" }), _jsx(\"div\", { style: { paddingLeft: '8px' }, children: _jsx(Toggle, { checked: element.showBackground !== false, onChange: (checked) => onChange(element.id, 'showBackground', checked), label: \"Afficher le fond\", description: \"Affiche un fond color\\u00E9 derri\\u00E8re les mentions\" }) })] })] })), mentionsCurrentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '8px' }, children: \"Th\\u00E8me visuel\" }), _jsx(\"div\", { style: {\r\n                                    display: 'grid',\r\n                                    gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\r\n                                    gap: '8px',\r\n                                    maxHeight: '200px',\r\n                                    overflowY: 'auto',\r\n                                    padding: '4px',\r\n                                    border: '1px solid #e0e0e0',\r\n                                    borderRadius: '4px',\r\n                                    backgroundColor: '#fafafa'\r\n                                }, children: mentionsThemes.map((theme) => (_jsxs(\"div\", { onClick: () => onChange(element.id, 'theme', theme.id), style: {\r\n                                        cursor: 'pointer',\r\n                                        border: element.theme === theme.id ? '2px solid #007bff' : '2px solid transparent',\r\n                                        borderRadius: '6px',\r\n                                        padding: '6px',\r\n                                        backgroundColor: '#ffffff',\r\n                                        transition: 'all 0.2s ease'\r\n                                    }, title: theme.name, children: [_jsx(\"div\", { style: { fontSize: '10px', fontWeight: 'bold', marginBottom: '4px', textAlign: 'center' }, children: theme.name }), theme.preview] }, theme.id))) })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Taille du texte\" }), _jsxs(\"select\", { value: element.fontSize || '10', onChange: (e) => {\r\n                                    var _a, _b;\r\n                                    onChange(element.id, 'fontSize', e.target.value);\r\n                                    // Si c'est un medley, ajuster la hauteur selon la nouvelle taille de police\r\n                                    if (currentMentionType === 'medley' && ((_b = (_a = element.selectedMentions) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0) > 0) {\r\n                                        const selectedMentions = element.selectedMentions || [];\r\n                                        const separatorMap = {\r\n                                            'double_newline': '\\n\\n',\r\n                                            'single_newline': '\\n',\r\n                                            'dash': ' - ',\r\n                                            'bullet': '  ',\r\n                                            'pipe': ' | '\r\n                                        };\r\n                                        const separator = separatorMap[(element.medleySeparator || 'double_newline')] || '\\n\\n';\r\n                                        const combinedText = selectedMentions\r\n                                            .map((key) => { var _a; return (_a = predefinedMentions.find(m => m.key === key)) === null || _a === void 0 ? void 0 : _a.text; })\r\n                                            .filter(Boolean)\r\n                                            .join(separator);\r\n                                        const lines = combinedText.split('\\n');\r\n                                        const fontSize = parseInt(e.target.value) || 10;\r\n                                        const lineHeight = fontSize * 1.3; // Harmoniser avec pdf-canvas-core.js\r\n                                        const padding = 10; // Rduire le padding pour tre cohrent\r\n                                        const iconSpace = 20; // Espace pour l'icne comme dans Canvas\r\n                                        const minHeight = 60; // Hauteur minimale base sur la valeur par dfaut\r\n                                        const calculatedHeight = Math.max(minHeight, lines.length * lineHeight + iconSpace + padding); // + iconSpace pour l'icne\r\n                                        const maxHeight = 500;\r\n                                        const newHeight = Math.min(calculatedHeight, maxHeight);\r\n                                        // Calculer la largeur base sur la ligne la plus longue\r\n                                        const canvas = document.createElement('canvas');\r\n                                        const ctx = canvas.getContext('2d');\r\n                                        if (ctx) {\r\n                                            ctx.font = `${element.fontWeight || 'normal'} ${fontSize}px ${element.fontFamily || 'Arial'}`;\r\n                                            const maxLineWidth = Math.max(...lines.map((line) => ctx.measureText(line).width));\r\n                                            const margin = 20; // Mme marge qu dans pdf-canvas-core.js (width - 20)\r\n                                            const minWidth = 200;\r\n                                            const calculatedWidth = Math.max(minWidth, maxLineWidth + margin);\r\n                                            const maxWidth = 800;\r\n                                            const newWidth = Math.min(calculatedWidth, maxWidth);\r\n                                            if (element.width !== newWidth) {\r\n                                                onChange(element.id, 'width', newWidth);\r\n                                            }\r\n                                        }\r\n                                        if (element.height !== newHeight) {\r\n                                            onChange(element.id, 'height', newHeight);\r\n                                        }\r\n                                    }\r\n                                }, style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"8\", children: \"Tr\\u00E8s petit (8px)\" }), _jsx(\"option\", { value: \"10\", children: \"Petit (10px)\" }), _jsx(\"option\", { value: \"11\", children: \"Normal (11px)\" }), _jsx(\"option\", { value: \"12\", children: \"Moyen (12px)\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Alignement du texte\" }), _jsxs(\"select\", { value: element.textAlign || 'left', onChange: (e) => onChange(element.id, 'textAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"left\", children: \"Gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centre\" }), _jsx(\"option\", { value: \"right\", children: \"Droite\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Style du texte\" }), _jsxs(\"div\", { style: { display: 'flex', gap: '8px', flexWrap: 'wrap' }, children: [_jsxs(\"label\", { style: { fontSize: '11px', display: 'flex', alignItems: 'center' }, children: [_jsx(\"input\", { type: \"checkbox\", checked: element.fontWeight === 'bold', onChange: (e) => onChange(element.id, 'fontWeight', e.target.checked ? 'bold' : 'normal'), style: { marginRight: '4px' } }), \"Gras\"] }), _jsxs(\"label\", { style: { fontSize: '11px', color: '#666', display: 'flex', alignItems: 'center' }, children: [_jsx(\"input\", { type: \"checkbox\", checked: element.fontStyle === 'italic', onChange: (e) => onChange(element.id, 'fontStyle', e.target.checked ? 'italic' : 'normal'), style: { marginRight: '4px' } }), \"Italique\"] })] })] }), element.showBackground !== false && (_jsx(\"div\", { style: { marginTop: '16px', paddingTop: '16px', borderTop: '1px solid #e5e7eb' }, children: _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.backgroundColor || '#e5e7eb', onChange: (e) => onChange(element.id, 'backgroundColor', e.target.value), style: {\r\n                                        width: '100%',\r\n                                        height: '40px',\r\n                                        border: '1px solid #d1d5db',\r\n                                        borderRadius: '6px',\r\n                                        cursor: 'pointer'\r\n                                    } })] }) }))] })), mentionsCurrentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Position X\" }), _jsx(\"input\", { type: \"number\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Position Y\" }), _jsx(\"input\", { type: \"number\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Largeur \", currentMentionType === 'medley' ? '(manuel = clipping activ)' : ''] }), _jsx(\"input\", { type: \"number\", value: element.width || 500, onChange: (e) => onChange(element.id, 'width', parseInt(e.target.value) || 500), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } }), currentMentionType === 'medley' && (_jsx(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '4px' }, children: \"Redimensionner manuellement active le clipping du texte\" }))] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Hauteur \", currentMentionType === 'medley' ? '(manuel = clipping activ)' : ''] }), _jsx(\"input\", { type: \"number\", value: element.height || 60, onChange: (e) => onChange(element.id, 'height', parseInt(e.target.value) || 60), style: {\r\n                                    width: '100%',\r\n                                    padding: '6px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    fontSize: '12px'\r\n                                } }), currentMentionType === 'medley' && (_jsx(\"div\", { style: { fontSize: '10px', color: '#666', marginTop: '4px' }, children: \"Redimensionner manuellement active le clipping du texte\" }))] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\r\n// Composant Toggle personnalis\r\nconst Toggle = ({ checked, onChange, label, description }) => (_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"div\", { style: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                marginBottom: '6px'\r\n            }, children: [_jsx(\"label\", { style: {\r\n                        fontSize: '12px',\r\n                        fontWeight: 'bold',\r\n                        color: '#333',\r\n                        flex: 1\r\n                    }, children: label }), _jsx(\"div\", { onClick: () => onChange(!checked), style: {\r\n                        position: 'relative',\r\n                        width: '44px',\r\n                        height: '24px',\r\n                        backgroundColor: checked ? '#007bff' : '#ccc',\r\n                        borderRadius: '12px',\r\n                        cursor: 'pointer',\r\n                        transition: 'background-color 0.2s ease',\r\n                        border: 'none'\r\n                    }, children: _jsx(\"div\", { style: {\r\n                            position: 'absolute',\r\n                            top: '2px',\r\n                            left: checked ? '22px' : '2px',\r\n                            width: '20px',\r\n                            height: '20px',\r\n                            backgroundColor: 'white',\r\n                            borderRadius: '50%',\r\n                            transition: 'left 0.2s ease',\r\n                            boxShadow: '0 1px 3px rgba(0,0,0,0.2)'\r\n                        } }) })] }), _jsx(\"div\", { style: {\r\n                fontSize: '11px',\r\n                color: '#666',\r\n                lineHeight: '1.4'\r\n            }, children: description })] }));\r\nexport function DocumentTypeProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const documentCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setDocumentCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    const documentTypes = [\r\n        { value: 'FACTURE', label: 'Facture' },\r\n        { value: 'DEVIS', label: 'Devis' },\r\n        { value: 'BON_COMMANDE', label: 'Bon de Commande' },\r\n        { value: 'AVOIR', label: 'Avoir' },\r\n        { value: 'RELEVE', label: 'Relev' },\r\n        { value: 'CONTRAT', label: 'Contrat' }\r\n    ];\r\n    return (_jsxs(\"div\", { style: { padding: '16px', backgroundColor: '#ffffff', borderRadius: '8px', marginBottom: '16px' }, children: [_jsx(\"div\", { style: { display: 'flex', marginBottom: '16px', borderBottom: '1px solid #e5e7eb' }, children: [\r\n                    { key: 'fonctionnalites', label: 'Fonctionnalits' },\r\n                    { key: 'personnalisation', label: 'Personnalisation' },\r\n                    { key: 'positionnement', label: 'Positionnement' }\r\n                ].map(tab => (_jsx(\"button\", { onClick: () => setDocumentCurrentTab(tab.key), style: {\r\n                        padding: '8px 16px',\r\n                        border: 'none',\r\n                        backgroundColor: documentCurrentTab === tab.key ? '#007acc' : 'transparent',\r\n                        color: documentCurrentTab === tab.key ? '#ffffff' : '#6b7280',\r\n                        borderRadius: '4px 4px 0 0',\r\n                        cursor: 'pointer',\r\n                        fontSize: '12px',\r\n                        fontWeight: '500'\r\n                    }, children: tab.label }, tab.key))) }), documentCurrentTab === 'fonctionnalites' && (_jsxs(\"div\", { children: [_jsx(\"h4\", { style: { margin: '0 0 12px 0', fontSize: '14px', fontWeight: '600', color: '#374151' }, children: \"Type de Document\" }), _jsxs(\"div\", { style: { marginBottom: '16px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#6b7280' }, children: \"Type\" }), _jsx(\"select\", { value: element.documentType || 'FACTURE', onChange: (e) => onChange(element.id, 'documentType', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '8px 12px',\r\n                                    border: '1px solid #d1d5db',\r\n                                    borderRadius: '6px',\r\n                                    fontSize: '14px',\r\n                                    backgroundColor: '#ffffff'\r\n                                }, children: documentTypes.map(type => (_jsx(\"option\", { value: type.value, children: type.label }, type.value))) })] }), _jsxs(\"div\", { style: { marginTop: '16px', paddingTop: '16px', borderTop: '1px solid #e5e7eb' }, children: [_jsx(\"h4\", { style: { margin: '0 0 12px 0', fontSize: '14px', fontWeight: '600', color: '#374151' }, children: \"Affichage du fond\" }), _jsx(Toggle, { checked: element.showBackground !== false, onChange: (checked) => onChange(element.id, 'showBackground', checked), label: \"Afficher le fond\", description: \"Affiche un fond color\\u00E9 derri\\u00E8re le texte\" })] })] })), documentCurrentTab === 'personnalisation' && (_jsxs(\"div\", { children: [_jsx(\"h4\", { style: { margin: '0 0 12px 0', fontSize: '14px', fontWeight: '600', color: '#374151' }, children: \"Apparence du Texte\" }), _jsxs(\"div\", { style: { display: 'grid', gap: '12px' }, children: [_jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#6b7280' }, children: \"Taille de police\" }), _jsx(\"input\", { type: \"number\", value: element.fontSize || 18, onChange: (e) => onChange(element.id, 'fontSize', parseInt(e.target.value) || 18), min: \"8\", max: \"72\", style: {\r\n                                            width: '100%',\r\n                                            padding: '8px 12px',\r\n                                            border: '1px solid #d1d5db',\r\n                                            borderRadius: '6px',\r\n                                            fontSize: '14px'\r\n                                        } })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#6b7280' }, children: \"Style de police\" }), _jsxs(\"select\", { value: element.fontWeight || 'bold', onChange: (e) => onChange(element.id, 'fontWeight', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '8px 12px',\r\n                                            border: '1px solid #d1d5db',\r\n                                            borderRadius: '6px',\r\n                                            fontSize: '14px',\r\n                                            backgroundColor: '#ffffff'\r\n                                        }, children: [_jsx(\"option\", { value: \"normal\", children: \"Normal\" }), _jsx(\"option\", { value: \"bold\", children: \"Gras\" }), _jsx(\"option\", { value: \"bolder\", children: \"Tr\\u00E8s gras\" }), _jsx(\"option\", { value: \"lighter\", children: \"Fin\" })] })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#6b7280' }, children: \"Alignement\" }), _jsxs(\"select\", { value: element.textAlign || 'left', onChange: (e) => onChange(element.id, 'textAlign', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            padding: '8px 12px',\r\n                                            border: '1px solid #d1d5db',\r\n                                            borderRadius: '6px',\r\n                                            fontSize: '14px',\r\n                                            backgroundColor: '#ffffff'\r\n                                        }, children: [_jsx(\"option\", { value: \"left\", children: \"Gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centre\" }), _jsx(\"option\", { value: \"right\", children: \"Droite\" })] })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#6b7280' }, children: \"Couleur du texte\" }), _jsx(\"input\", { type: \"color\", value: element.textColor || '#000000', onChange: (e) => onChange(element.id, 'textColor', e.target.value), style: {\r\n                                            width: '100%',\r\n                                            height: '40px',\r\n                                            border: '1px solid #d1d5db',\r\n                                            borderRadius: '6px',\r\n                                            cursor: 'pointer'\r\n                                        } })] })] }), element.showBackground !== false && (_jsxs(\"div\", { style: { marginTop: '16px', paddingTop: '16px', borderTop: '1px solid #e5e7eb' }, children: [_jsx(\"h4\", { style: { margin: '0 0 12px 0', fontSize: '14px', fontWeight: '600', color: '#374151' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.backgroundColor || '#e5e7eb', onChange: (e) => onChange(element.id, 'backgroundColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '40px',\r\n                                    border: '1px solid #d1d5db',\r\n                                    borderRadius: '6px',\r\n                                    cursor: 'pointer'\r\n                                } })] }))] })), documentCurrentTab === 'positionnement' && (_jsxs(\"div\", { children: [_jsx(\"h4\", { style: { margin: '0 0 12px 0', fontSize: '14px', fontWeight: '600', color: '#374151' }, children: \"Position et Dimensions\" }), _jsxs(\"div\", { style: { display: 'grid', gap: '12px' }, children: [_jsxs(\"div\", { style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '8px' }, children: [_jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#6b7280' }, children: \"Position X\" }), _jsx(\"input\", { type: \"number\", value: element.x, onChange: (e) => onChange(element.id, 'x', parseFloat(e.target.value) || 0), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '8px 12px',\r\n                                                    border: '1px solid #d1d5db',\r\n                                                    borderRadius: '6px',\r\n                                                    fontSize: '14px'\r\n                                                } })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#6b7280' }, children: \"Position Y\" }), _jsx(\"input\", { type: \"number\", value: element.y, onChange: (e) => onChange(element.id, 'y', parseFloat(e.target.value) || 0), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '8px 12px',\r\n                                                    border: '1px solid #d1d5db',\r\n                                                    borderRadius: '6px',\r\n                                                    fontSize: '14px'\r\n                                                } })] })] }), _jsxs(\"div\", { style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '8px' }, children: [_jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#6b7280' }, children: \"Largeur\" }), _jsx(\"input\", { type: \"number\", value: element.width, onChange: (e) => onChange(element.id, 'width', parseFloat(e.target.value) || 0), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '8px 12px',\r\n                                                    border: '1px solid #d1d5db',\r\n                                                    borderRadius: '6px',\r\n                                                    fontSize: '14px'\r\n                                                } })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#6b7280' }, children: \"Hauteur\" }), _jsx(\"input\", { type: \"number\", value: element.height, onChange: (e) => onChange(element.id, 'height', parseFloat(e.target.value) || 0), style: {\r\n                                                    width: '100%',\r\n                                                    padding: '8px 12px',\r\n                                                    border: '1px solid #d1d5db',\r\n                                                    borderRadius: '6px',\r\n                                                    fontSize: '14px'\r\n                                                } })] })] })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nexport function TextProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const textCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setTextCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setTextCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: textCurrentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: textCurrentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setTextCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: textCurrentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: textCurrentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setTextCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: textCurrentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: textCurrentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), textCurrentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Contenu du texte\" }), _jsx(\"textarea\", { value: element.text || '', onChange: (e) => onChange(element.id, 'text', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    minHeight: '60px',\r\n                                    padding: '8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px',\r\n                                    fontFamily: 'monospace',\r\n                                    resize: 'vertical'\r\n                                }, placeholder: \"Entrez votre texte ici...\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Alignement horizontal\" }), _jsxs(\"select\", { value: element.textAlign || element.align || 'left', onChange: (e) => onChange(element.id, 'textAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"left\", children: \"Gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centre\" }), _jsx(\"option\", { value: \"right\", children: \"Droite\" }), _jsx(\"option\", { value: \"justify\", children: \"Justifi\\u00E9\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Alignement vertical\" }), _jsxs(\"select\", { value: element.verticalAlign || 'top', onChange: (e) => onChange(element.id, 'verticalAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"top\", children: \"Haut\" }), _jsx(\"option\", { value: \"middle\", children: \"Milieu\" }), _jsx(\"option\", { value: \"bottom\", children: \"Bas\" })] })] })] })), textCurrentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Police\" }), _jsxs(\"select\", { value: element.fontFamily || 'Arial', onChange: (e) => onChange(element.id, 'fontFamily', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Courier New\", children: \"Courier New\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" }), _jsx(\"option\", { value: \"Tahoma\", children: \"Tahoma\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Taille de police \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.fontSize || 16, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"6\", max: \"72\", value: element.fontSize || 16, onChange: (e) => onChange(element.id, 'fontSize', parseInt(e.target.value) || 16), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Style de police\" }), _jsxs(\"div\", { style: { display: 'flex', gap: '4px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => onChange(element.id, 'fontWeight', element.fontWeight === 'bold' ? 'normal' : 'bold'), style: {\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            backgroundColor: element.fontWeight === 'bold' ? '#007bff' : '#f8f9fa',\r\n                                            color: element.fontWeight === 'bold' ? '#fff' : '#333',\r\n                                            cursor: 'pointer',\r\n                                            fontSize: '11px',\r\n                                            fontWeight: 'bold'\r\n                                        }, children: \"B\" }), _jsx(\"button\", { onClick: () => onChange(element.id, 'fontStyle', element.fontStyle === 'italic' ? 'normal' : 'italic'), style: {\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            backgroundColor: element.fontStyle === 'italic' ? '#007bff' : '#f8f9fa',\r\n                                            color: element.fontStyle === 'italic' ? '#fff' : '#333',\r\n                                            cursor: 'pointer',\r\n                                            fontSize: '11px',\r\n                                            fontStyle: 'italic'\r\n                                        }, children: \"I\" }), _jsx(\"button\", { onClick: () => onChange(element.id, 'textDecoration', element.textDecoration === 'underline' ? 'none' : 'underline'), style: {\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            backgroundColor: element.textDecoration === 'underline' ? '#007bff' : '#f8f9fa',\r\n                                            color: element.textDecoration === 'underline' ? '#fff' : '#333',\r\n                                            cursor: 'pointer',\r\n                                            fontSize: '11px',\r\n                                            textDecoration: 'underline'\r\n                                        }, children: \"U\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Couleur du texte\" }), _jsx(\"input\", { type: \"color\", value: element.textColor || element.color || '#000000', onChange: (e) => onChange(element.id, 'textColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    cursor: 'pointer'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.backgroundColor === 'transparent' ? '#ffffff' : (element.backgroundColor || '#ffffff'), onChange: (e) => onChange(element.id, 'backgroundColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    cursor: 'pointer'\r\n                                } })] })] })), textCurrentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Position X \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.x || 0, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Position Y \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.y || 0, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Largeur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.width || 100, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", value: element.width || 100, onChange: (e) => onChange(element.id, 'width', parseFloat(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Hauteur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.height || 50, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", value: element.height || 50, onChange: (e) => onChange(element.id, 'height', parseFloat(e.target.value) || 50), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Rotation \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.rotation || 0, \"\\u00B0)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"-180\", max: \"180\", value: element.rotation || 0, onChange: (e) => onChange(element.id, 'rotation', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Opacit\\u00E9 \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", Math.round((element.opacity || 1) * 100), \"%)\"] })] }), _jsx(\"input\", { type: \"range\", min: \"0\", max: \"1\", step: \"0.1\", value: element.opacity || 1, onChange: (e) => onChange(element.id, 'opacity', parseFloat(e.target.value)), style: { width: '100%' } })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nexport function ShapeProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const shapeCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setShapeCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setShapeCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: shapeCurrentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: shapeCurrentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setShapeCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: shapeCurrentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: shapeCurrentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setShapeCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: shapeCurrentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: shapeCurrentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), shapeCurrentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [element.type === 'circle' && (_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Forme\" }), _jsx(\"div\", { style: { padding: '8px', backgroundColor: '#f8f9fa', borderRadius: '4px', textAlign: 'center' }, children: \"Cercle\" })] })), element.type === 'rectangle' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Forme\" }), _jsx(\"div\", { style: { padding: '8px', backgroundColor: '#f8f9fa', borderRadius: '4px', textAlign: 'center' }, children: \"Rectangle\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Rayon des coins \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.borderRadius || 0, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"0\", max: \"50\", value: element.borderRadius || 0, onChange: (e) => onChange(element.id, 'borderRadius', parseInt(e.target.value) || 0), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] })] }))] })), shapeCurrentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Couleur de remplissage\" }), _jsx(\"input\", { type: \"color\", value: element.fillColor === 'transparent' ? '#ffffff' : (element.fillColor || '#007bff'), onChange: (e) => onChange(element.id, 'fillColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    cursor: 'pointer'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Couleur de bordure\" }), _jsx(\"input\", { type: \"color\", value: element.strokeColor === 'transparent' ? '#000000' : (element.strokeColor || '#000000'), onChange: (e) => onChange(element.id, 'strokeColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    cursor: 'pointer'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"\\u00C9paisseur de bordure \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.strokeWidth || 1, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"0\", max: \"20\", value: element.strokeWidth || 1, onChange: (e) => onChange(element.id, 'strokeWidth', parseInt(e.target.value) || 1), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] })] })), shapeCurrentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Position X \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.x || 0, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Position Y \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.y || 0, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Largeur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.width || 100, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", value: element.width || 100, onChange: (e) => onChange(element.id, 'width', parseFloat(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Hauteur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.height || 100, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", value: element.height || 100, onChange: (e) => onChange(element.id, 'height', parseFloat(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Rotation \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.rotation || 0, \"\\u00B0)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"-180\", max: \"180\", value: element.rotation || 0, onChange: (e) => onChange(element.id, 'rotation', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Opacit\\u00E9 \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", Math.round((element.opacity || 1) * 100), \"%)\"] })] }), _jsx(\"input\", { type: \"range\", min: \"0\", max: \"1\", step: \"0.1\", value: element.opacity || 1, onChange: (e) => onChange(element.id, 'opacity', parseFloat(e.target.value)), style: { width: '100%' } })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nexport function ImageProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const imageCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setImageCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    const openMediaLibrary = () => {\r\n        var _a;\r\n        if ((_a = window.wp) === null || _a === void 0 ? void 0 : _a.media) {\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            const media = window.wp.media({\r\n                title: 'Slectionner une image',\r\n                button: {\r\n                    text: 'Utiliser cette image'\r\n                },\r\n                multiple: false\r\n            });\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            media.on('select', () => {\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                const attachment = media.state().get('selection').first().toJSON();\r\n                onChange(element.id, 'src', attachment.url);\r\n            });\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            media.open();\r\n        }\r\n    };\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setImageCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: imageCurrentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: imageCurrentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setImageCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: imageCurrentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: imageCurrentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setImageCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: imageCurrentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: imageCurrentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), imageCurrentTab === 'fonctionnalites' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Source de l'image\" }), _jsxs(\"div\", { style: { display: 'flex', gap: '4px' }, children: [_jsx(\"input\", { type: \"text\", value: element.src || '', onChange: (e) => onChange(element.id, 'src', e.target.value), placeholder: \"URL de l'image\", style: {\r\n                                            flex: 1,\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } }), _jsx(\"button\", { onClick: openMediaLibrary, style: {\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #007bff',\r\n                                            borderRadius: '3px',\r\n                                            backgroundColor: '#007bff',\r\n                                            color: '#fff',\r\n                                            cursor: 'pointer',\r\n                                            fontSize: '11px'\r\n                                        }, title: \"Ouvrir la m\\u00E9diath\\u00E8que WordPress\", children: \"\\uD83D\\uDCC1\" })] })] }), element.src && (_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Aper\\u00E7u\" }), _jsx(\"div\", { style: {\r\n                                    padding: '8px',\r\n                                    border: '1px solid #e0e0e0',\r\n                                    borderRadius: '4px',\r\n                                    backgroundColor: '#f8f9fa',\r\n                                    textAlign: 'center'\r\n                                }, children: _jsx(\"img\", { src: element.src, alt: \"Aper\\u00E7u\", style: {\r\n                                        maxWidth: '100%',\r\n                                        maxHeight: '100px',\r\n                                        borderRadius: '4px',\r\n                                        boxShadow: '0 1px 3px rgba(0,0,0,0.1)'\r\n                                    } }) })] }))] })), imageCurrentTab === 'personnalisation' && (_jsx(_Fragment, { children: _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Ajustement de l'image\" }), _jsxs(\"select\", { value: element.objectFit || 'contain', onChange: (e) => onChange(element.id, 'objectFit', e.target.value), style: {\r\n                                width: '100%',\r\n                                padding: '4px 8px',\r\n                                border: '1px solid #ccc',\r\n                                borderRadius: '3px',\r\n                                fontSize: '12px'\r\n                            }, children: [_jsx(\"option\", { value: \"contain\", children: \"Contenir (respecter les proportions)\" }), _jsx(\"option\", { value: \"cover\", children: \"Couvrir (remplir compl\\u00E8tement)\" }), _jsx(\"option\", { value: \"fill\", children: \"Remplir (\\u00E9tirer si n\\u00E9cessaire)\" }), _jsx(\"option\", { value: \"none\", children: \"Aucun (taille originale)\" }), _jsx(\"option\", { value: \"scale-down\", children: \"R\\u00E9duire (taille originale ou contenir)\" })] })] }) })), imageCurrentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Position X \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.x || 0, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Position Y \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.y || 0, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Largeur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.width || 100, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", value: element.width || 100, onChange: (e) => onChange(element.id, 'width', parseFloat(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Hauteur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.height || 100, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", value: element.height || 100, onChange: (e) => onChange(element.id, 'height', parseFloat(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Rotation \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.rotation || 0, \"\\u00B0)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"-180\", max: \"180\", value: element.rotation || 0, onChange: (e) => onChange(element.id, 'rotation', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Opacit\\u00E9 \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", Math.round((element.opacity || 1) * 100), \"%)\"] })] }), _jsx(\"input\", { type: \"range\", min: \"0\", max: \"1\", step: \"0.1\", value: element.opacity || 1, onChange: (e) => onChange(element.id, 'opacity', parseFloat(e.target.value)), style: { width: '100%' } })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nexport function LineProperties({ element, onChange, activeTab, setActiveTab }) {\r\n    const lineCurrentTab = activeTab[element.id] || 'fonctionnalites';\r\n    const setLineCurrentTab = (tab) => {\r\n        setActiveTab({ ...activeTab, [element.id]: tab });\r\n    };\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { display: 'flex', marginBottom: '12px', borderBottom: '2px solid #ddd', gap: '2px', flexWrap: 'wrap' }, children: [_jsx(\"button\", { onClick: () => setLineCurrentTab('fonctionnalites'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: lineCurrentTab === 'fonctionnalites' ? '#007bff' : '#f0f0f0',\r\n                            color: lineCurrentTab === 'fonctionnalites' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Fonctionnalit\\u00E9s\", children: \"Fonctionnalit\\u00E9s\" }), _jsx(\"button\", { onClick: () => setLineCurrentTab('personnalisation'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: lineCurrentTab === 'personnalisation' ? '#007bff' : '#f0f0f0',\r\n                            color: lineCurrentTab === 'personnalisation' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Personnalisation\", children: \"Personnalisation\" }), _jsx(\"button\", { onClick: () => setLineCurrentTab('positionnement'), style: {\r\n                            flex: '1 1 30%',\r\n                            padding: '8px 6px',\r\n                            backgroundColor: lineCurrentTab === 'positionnement' ? '#007bff' : '#f0f0f0',\r\n                            color: lineCurrentTab === 'positionnement' ? '#fff' : '#333',\r\n                            border: 'none',\r\n                            cursor: 'pointer',\r\n                            fontSize: '11px',\r\n                            fontWeight: 'bold',\r\n                            borderRadius: '3px 3px 0 0',\r\n                            minWidth: '0',\r\n                            whiteSpace: 'nowrap',\r\n                            overflow: 'hidden',\r\n                            textOverflow: 'ellipsis'\r\n                        }, title: \"Positionnement\", children: \"Positionnement\" })] }), lineCurrentTab === 'fonctionnalites' && (_jsx(_Fragment, { children: _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Type d'\\u00E9l\\u00E9ment\" }), _jsx(\"div\", { style: { padding: '8px', backgroundColor: '#f8f9fa', borderRadius: '4px', textAlign: 'center' }, children: \"Ligne\" })] }) })), lineCurrentTab === 'personnalisation' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Couleur de la ligne\" }), _jsx(\"input\", { type: \"color\", value: element.strokeColor || '#000000', onChange: (e) => onChange(element.id, 'strokeColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    cursor: 'pointer'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"\\u00C9paisseur de la ligne \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.strokeWidth || 2, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", max: \"20\", value: element.strokeWidth || 2, onChange: (e) => onChange(element.id, 'strokeWidth', parseInt(e.target.value) || 2), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Opacit\\u00E9 \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", Math.round((element.opacity || 1) * 100), \"%)\"] })] }), _jsx(\"input\", { type: \"range\", min: \"0\", max: \"1\", step: \"0.1\", value: element.opacity || 1, onChange: (e) => onChange(element.id, 'opacity', parseFloat(e.target.value)), style: { width: '100%' } })] })] })), lineCurrentTab === 'positionnement' && (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Position X \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.x || 0, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Position Y \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.y || 0, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Longueur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.width || 100, \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", value: element.width || 100, onChange: (e) => onChange(element.id, 'width', parseFloat(e.target.value) || 100), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: [\"Rotation \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", element.rotation || 0, \"\\u00B0)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"-180\", max: \"180\", value: element.rotation || 0, onChange: (e) => onChange(element.id, 'rotation', parseFloat(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] })] }))] }));\r\n}\r\n","import { jsxs as _jsxs, jsx as _jsx, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nexport function ElementProperties({ element, onChange }) {\r\n    return (_jsxs(_Fragment, { children: [_jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: [\"Largeur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", ((element.width || 100) * 1).toFixed(1), \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", step: \"0.1\", value: element.width || 100, onChange: (e) => onChange(element.id, 'width', parseFloat(e.target.value) || 100), style: {\r\n                            width: '100%',\r\n                            padding: '4px 8px',\r\n                            border: '1px solid #ccc',\r\n                            borderRadius: '3px',\r\n                            fontSize: '12px'\r\n                        }, placeholder: \"Valeur en pixels\" }), _jsx(\"small\", { style: { color: '#999', display: 'block', marginTop: '2px' }, children: \"Entrer la largeur en pixels\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: [\"Hauteur \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", ((element.height || 50) * 1).toFixed(1), \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"1\", step: \"0.1\", value: element.height || 50, onChange: (e) => onChange(element.id, 'height', parseFloat(e.target.value) || 50), style: {\r\n                            width: '100%',\r\n                            padding: '4px 8px',\r\n                            border: '1px solid #ccc',\r\n                            borderRadius: '3px',\r\n                            fontSize: '12px'\r\n                        }, placeholder: \"Valeur en pixels\" }), _jsx(\"small\", { style: { color: '#999', display: 'block', marginTop: '2px' }, children: \"Entrer la hauteur en pixels\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: [\"Position X \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", ((element.x || 0) * 1).toFixed(1), \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"0\", step: \"0.1\", value: element.x || 0, onChange: (e) => onChange(element.id, 'x', parseFloat(e.target.value) || 0), style: {\r\n                            width: '100%',\r\n                            padding: '4px 8px',\r\n                            border: '1px solid #ccc',\r\n                            borderRadius: '3px',\r\n                            fontSize: '12px'\r\n                        }, placeholder: \"Valeur en pixels\" }), _jsx(\"small\", { style: { color: '#999', display: 'block', marginTop: '2px' }, children: \"Entrer la position en pixels\" })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsxs(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: [\"Position Y \", _jsxs(\"span\", { style: { color: '#666', fontSize: '10px' }, children: [\"(\", ((element.y || 0) * 1).toFixed(1), \"px)\"] })] }), _jsx(\"input\", { type: \"number\", min: \"0\", step: \"0.1\", value: element.y || 0, onChange: (e) => onChange(element.id, 'y', parseFloat(e.target.value) || 0), style: {\r\n                            width: '100%',\r\n                            padding: '4px 8px',\r\n                            border: '1px solid #ccc',\r\n                            borderRadius: '3px',\r\n                            fontSize: '12px'\r\n                        }, placeholder: \"Valeur en pixels\" }), _jsx(\"small\", { style: { color: '#999', display: 'block', marginTop: '2px' }, children: \"Entrer la position en pixels\" })] }), element.type === 'rectangle' && (_jsxs(_Fragment, { children: [_jsx(\"hr\", { style: { margin: '16px 0', border: 'none', borderTop: '1px solid #ddd' } }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.fillColor || '#ffffff', onChange: (e) => onChange(element.id, 'fillColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de bordure\" }), _jsx(\"input\", { type: \"color\", value: element.strokeColor || '#000000', onChange: (e) => onChange(element.id, 'strokeColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de bordure\" }), _jsx(\"input\", { type: \"number\", min: \"0\", max: \"20\", value: element.strokeWidth || 1, onChange: (e) => onChange(element.id, 'strokeWidth', parseInt(e.target.value) || 1), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Rayon des coins\" }), _jsx(\"input\", { type: \"number\", min: \"0\", max: \"50\", value: element.borderRadius || 0, onChange: (e) => onChange(element.id, 'borderRadius', parseInt(e.target.value) || 0), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] })] })), element.type === 'circle' && (_jsxs(_Fragment, { children: [_jsx(\"hr\", { style: { margin: '16px 0', border: 'none', borderTop: '1px solid #ddd' } }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de fond\" }), _jsx(\"input\", { type: \"color\", value: element.fillColor || '#ffffff', onChange: (e) => onChange(element.id, 'fillColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur de bordure\" }), _jsx(\"input\", { type: \"color\", value: element.strokeColor || '#000000', onChange: (e) => onChange(element.id, 'strokeColor', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"\\u00C9paisseur de bordure\" }), _jsx(\"input\", { type: \"number\", min: \"0\", max: \"20\", value: element.strokeWidth || 1, onChange: (e) => onChange(element.id, 'strokeWidth', parseInt(e.target.value) || 1), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] })] })), element.type === 'text' && (_jsxs(_Fragment, { children: [_jsx(\"hr\", { style: { margin: '16px 0', border: 'none', borderTop: '1px solid #ddd' } }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Texte\" }), _jsx(\"textarea\", { value: element.text || '', onChange: (e) => onChange(element.id, 'text', e.target.value), rows: 3, style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px',\r\n                                    resize: 'vertical'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Taille de police\" }), _jsx(\"input\", { type: \"number\", min: \"8\", max: \"72\", value: element.fontSize || 12, onChange: (e) => onChange(element.id, 'fontSize', parseInt(e.target.value) || 12), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Couleur du texte\" }), _jsx(\"input\", { type: \"color\", value: element.color || '#000000', onChange: (e) => onChange(element.id, 'color', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    height: '32px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Alignement\" }), _jsxs(\"select\", { value: element.textAlign || 'left', onChange: (e) => onChange(element.id, 'textAlign', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"left\", children: \"Gauche\" }), _jsx(\"option\", { value: \"center\", children: \"Centre\" }), _jsx(\"option\", { value: \"right\", children: \"Droite\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Police\" }), _jsxs(\"select\", { value: element.fontFamily || 'Arial', onChange: (e) => onChange(element.id, 'fontFamily', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"Arial\", children: \"Arial\" }), _jsx(\"option\", { value: \"Helvetica\", children: \"Helvetica\" }), _jsx(\"option\", { value: \"Times New Roman\", children: \"Times New Roman\" }), _jsx(\"option\", { value: \"Courier New\", children: \"Courier New\" }), _jsx(\"option\", { value: \"Georgia\", children: \"Georgia\" }), _jsx(\"option\", { value: \"Verdana\", children: \"Verdana\" })] })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '6px' }, children: \"Style du texte\" }), _jsxs(\"div\", { style: { display: 'flex', gap: '8px', flexWrap: 'wrap' }, children: [_jsxs(\"label\", { style: { display: 'flex', alignItems: 'center', fontSize: '11px' }, children: [_jsx(\"input\", { type: \"checkbox\", checked: element.bold || false, onChange: (e) => onChange(element.id, 'bold', e.target.checked), style: { marginRight: '4px' } }), \"Gras\"] }), _jsxs(\"label\", { style: { display: 'flex', alignItems: 'center', fontSize: '11px' }, children: [_jsx(\"input\", { type: \"checkbox\", checked: element.italic || false, onChange: (e) => onChange(element.id, 'italic', e.target.checked), style: { marginRight: '4px' } }), \"Italique\"] }), _jsxs(\"label\", { style: { display: 'flex', alignItems: 'center', fontSize: '11px' }, children: [_jsx(\"input\", { type: \"checkbox\", checked: element.underline || false, onChange: (e) => onChange(element.id, 'underline', e.target.checked), style: { marginRight: '4px' } }), \"Soulign\\u00E9\"] })] })] })] })), element.type === 'image' && (_jsxs(_Fragment, { children: [_jsx(\"hr\", { style: { margin: '16px 0', border: 'none', borderTop: '1px solid #ddd' } }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"URL de l'image\" }), _jsx(\"input\", { type: \"text\", value: element.src || '', onChange: (e) => onChange(element.id, 'src', e.target.value), placeholder: \"https://example.com/image.jpg\", style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                } })] }), _jsxs(\"div\", { style: { marginBottom: '12px' }, children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Ajustement\" }), _jsxs(\"select\", { value: element.objectFit || 'contain', onChange: (e) => onChange(element.id, 'objectFit', e.target.value), style: {\r\n                                    width: '100%',\r\n                                    padding: '4px 8px',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '3px',\r\n                                    fontSize: '12px'\r\n                                }, children: [_jsx(\"option\", { value: \"contain\", children: \"Contenir\" }), _jsx(\"option\", { value: \"cover\", children: \"Couvrir\" }), _jsx(\"option\", { value: \"fill\", children: \"Remplir\" }), _jsx(\"option\", { value: \"none\", children: \"Aucun\" }), _jsx(\"option\", { value: \"scale-down\", children: \"R\\u00E9duire\" })] })] })] }))] }));\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\r\nimport React, { useState, useMemo, useCallback, memo } from 'react';\r\nimport { useBuilder } from '../../contexts/builder/BuilderContext';\r\nimport { useIsMobile, useIsTablet } from '../../hooks/useResponsive';\r\nimport { ResponsiveContainer } from '../ui/Responsive';\r\nimport { ProductTableProperties } from './ProductTableProperties';\r\nimport { CustomerInfoProperties } from './CustomerInfoProperties';\r\nimport { CompanyInfoProperties } from './CompanyInfoProperties';\r\nimport { CompanyLogoProperties } from './CompanyLogoProperties';\r\nimport { OrderNumberProperties } from './OrderNumberProperties';\r\nimport { DynamicTextProperties } from './DynamicTextProperties';\r\nimport { MentionsProperties } from './MentionsProperties';\r\nimport { DocumentTypeProperties } from './DocumentTypeProperties';\r\nimport { TextProperties } from './TextProperties';\r\nimport { ShapeProperties } from './ShapeProperties';\r\nimport { ImageProperties } from './ImageProperties';\r\nimport { LineProperties } from './LineProperties';\r\nimport { ElementProperties } from './ElementProperties';\r\nexport const PropertiesPanel = memo(function PropertiesPanel({ className }) {\r\n    const { state, updateElement, removeElement } = useBuilder();\r\n    const [activeTab, setActiveTab] = useState({});\r\n    const isMobile = useIsMobile();\r\n    const isTablet = useIsTablet();\r\n    // Optimisation: mmoriser les lments slectionns\r\n    const selectedElements = useMemo(() => state.elements.filter(el => state.selection.selectedElements.includes(el.id)), [state.elements, state.selection.selectedElements]);\r\n    // Optimisation: mmoriser les handlers\r\n    const handlePropertyChange = useCallback((elementId, property, value) => {\r\n        updateElement(elementId, { [property]: value });\r\n    }, [updateElement]);\r\n    const handleDeleteSelected = useCallback(() => {\r\n        state.selection.selectedElements.forEach(id => {\r\n            removeElement(id);\r\n        });\r\n    }, [state.selection.selectedElements, removeElement]);\r\n    if (selectedElements.length === 0) {\r\n        return (_jsx(ResponsiveContainer, { className: `pdf-builder-properties ${className || ''}`, mobileClass: \"properties-panel-mobile\", tabletClass: \"properties-panel-tablet\", desktopClass: \"properties-panel-desktop\", children: _jsxs(\"div\", { style: {\r\n                    padding: isMobile ? '8px' : '12px',\r\n                    backgroundColor: '#f9f9f9',\r\n                    border: '1px solid #ddd',\r\n                    borderRadius: '4px',\r\n                    minHeight: isMobile ? '150px' : '200px',\r\n                    maxHeight: isMobile ? 'calc(50vh - 16px)' : 'calc(100vh - 32px)',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    textAlign: 'center'\r\n                }, children: [_jsx(\"div\", { style: {\r\n                            fontSize: isMobile ? '24px' : '32px',\r\n                            marginBottom: '8px',\r\n                            opacity: 0.5\r\n                        }, children: \"\\uD83C\\uDFAF\" }), _jsx(\"div\", { style: {\r\n                            fontSize: isMobile ? '12px' : '14px',\r\n                            color: '#666',\r\n                            fontWeight: '500'\r\n                        }, children: isMobile ? 'Slectionnez un lment' : 'Slectionnez un lment pour modifier ses proprits' }), _jsx(\"div\", { style: {\r\n                            fontSize: isMobile ? '10px' : '12px',\r\n                            color: '#999',\r\n                            marginTop: '4px',\r\n                            display: isMobile ? 'none' : 'block'\r\n                        }, children: \"Cliquez sur un \\u00E9l\\u00E9ment du canvas pour commencer\" })] }) }));\r\n    }\r\n    return (_jsxs(\"div\", { className: `pdf-builder-properties ${className || ''}`, style: {\r\n            padding: '12px',\r\n            backgroundColor: '#f9f9f9',\r\n            border: '1px solid #ddd',\r\n            borderRadius: '4px',\r\n            maxHeight: 'calc(100vh - 32px)',\r\n            overflowY: 'auto'\r\n        }, children: [_jsxs(\"div\", { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px' }, children: [_jsxs(\"h4\", { style: { margin: '0', fontSize: '14px', fontWeight: 'bold' }, children: [\"Propri\\u00E9t\\u00E9s (\", selectedElements.length, \")\"] }), _jsx(\"div\", { style: { display: 'flex', gap: '4px' }, children: _jsx(\"button\", { onClick: handleDeleteSelected, style: {\r\n                                padding: '4px 8px',\r\n                                border: '1px solid #dc3545',\r\n                                borderRadius: '4px',\r\n                                backgroundColor: '#dc3545',\r\n                                color: '#ffffff',\r\n                                cursor: 'pointer',\r\n                                fontSize: '12px'\r\n                            }, children: \"\\uD83D\\uDDD1\\uFE0F Supprimer\" }) })] }), selectedElements.map(element => (_jsxs(\"div\", { style: {\r\n                    marginBottom: '16px',\r\n                    padding: '12px',\r\n                    backgroundColor: '#ffffff',\r\n                    border: '1px solid #e0e0e0',\r\n                    borderRadius: '4px',\r\n                    maxHeight: 'calc(100vh - 120px)',\r\n                    overflowY: 'auto'\r\n                }, children: [_jsxs(\"h5\", { style: { margin: '0 0 8px 0', fontSize: '13px', fontWeight: 'bold' }, children: [element.type.charAt(0).toUpperCase() + element.type.slice(1), \" - \", element.id.slice(0, 8)] }), element.type !== 'product_table' && element.type !== 'customer_info' && element.type !== 'company_info' && element.type !== 'company_logo' && element.type !== 'order_number' && element.type !== 'document_type' && element.type !== 'dynamic-text' && element.type !== 'mentions' && element.type !== 'text' && element.type !== 'rectangle' && element.type !== 'circle' && element.type !== 'image' && element.type !== 'line' && (_jsxs(\"div\", { style: { display: 'grid', gap: '8px' }, children: [_jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Position X\" }), _jsx(\"input\", { type: \"number\", value: element.x, onChange: (e) => handlePropertyChange(element.id, 'x', parseFloat(e.target.value) || 0), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Position Y\" }), _jsx(\"input\", { type: \"number\", value: element.y, onChange: (e) => handlePropertyChange(element.id, 'y', parseFloat(e.target.value) || 0), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Largeur\" }), _jsx(\"input\", { type: \"number\", value: element.width, onChange: (e) => handlePropertyChange(element.id, 'width', parseFloat(e.target.value) || 0), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Hauteur\" }), _jsx(\"input\", { type: \"number\", value: element.height, onChange: (e) => handlePropertyChange(element.id, 'height', parseFloat(e.target.value) || 0), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Rotation (\\u00B0)\" }), _jsx(\"input\", { type: \"number\", value: element.rotation || 0, onChange: (e) => handlePropertyChange(element.id, 'rotation', parseFloat(e.target.value) || 0), style: {\r\n                                            width: '100%',\r\n                                            padding: '4px 8px',\r\n                                            border: '1px solid #ccc',\r\n                                            borderRadius: '3px',\r\n                                            fontSize: '12px'\r\n                                        } })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: 'bold', marginBottom: '4px' }, children: \"Opacit\\u00E9\" }), _jsx(\"input\", { type: \"range\", min: \"0\", max: \"1\", step: \"0.1\", value: element.opacity || 1, onChange: (e) => handlePropertyChange(element.id, 'opacity', parseFloat(e.target.value)), style: { width: '100%' } }), _jsxs(\"span\", { style: { fontSize: '11px', color: '#666' }, children: [Math.round((element.opacity || 1) * 100), \"%\"] })] })] })), element.type === 'product_table' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(ProductTableProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'customer_info' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(CustomerInfoProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'company_info' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(CompanyInfoProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'company_logo' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(CompanyLogoProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'order_number' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(OrderNumberProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'document_type' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(DocumentTypeProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'dynamic-text' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(DynamicTextProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'mentions' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(MentionsProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'text' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(TextProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), (element.type === 'rectangle' || element.type === 'circle') && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(ShapeProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'image' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(ImageProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), element.type === 'line' && (\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    _jsx(LineProperties, { element: element, onChange: handlePropertyChange, activeTab: activeTab, setActiveTab: setActiveTab })), (element.type !== 'product_table' && element.type !== 'customer_info' && element.type !== 'company_info' && element.type !== 'company_logo' && element.type !== 'order_number' && element.type !== 'document_type' && element.type !== 'dynamic-text' && element.type !== 'mentions' && element.type !== 'text' && element.type !== 'rectangle' && element.type !== 'circle' && element.type !== 'image' && element.type !== 'line') && (_jsx(ElementProperties, { element: element, onChange: handlePropertyChange }))] }, element.id)))] }));\r\n});\r\n","import { useState, useCallback } from 'react';\r\n/**\r\n * Hook React usePreview pour grer l'aperu PDF\r\n * Implmente les exigences de l'tape 1.5 du roadmap\r\n */\r\nexport function usePreview() {\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const [isGenerating, setIsGenerating] = useState(false);\r\n    const [previewUrl, setPreviewUrl] = useState(null);\r\n    const [error, setError] = useState(null);\r\n    const [format, setFormat] = useState('png');\r\n    const openModal = useCallback(() => {\r\n        setIsModalOpen(true);\r\n        setError(null);\r\n        setPreviewUrl(null);\r\n    }, []);\r\n    const closeModal = useCallback(() => {\r\n        setIsModalOpen(false);\r\n        setIsGenerating(false);\r\n        setPreviewUrl(null);\r\n        setError(null);\r\n    }, []);\r\n    const clearPreview = useCallback(() => {\r\n        setPreviewUrl(null);\r\n        setError(null);\r\n    }, []);\r\n    const generatePreview = useCallback(async (templateData, options = {}) => {\r\n        const finalFormat = options.format || format;\r\n        const quality = options.quality || 150;\r\n        setIsGenerating(true);\r\n        setError(null);\r\n        setPreviewUrl(null);\r\n        try {\r\n            // Vrifier s'il y a du contenu dans le template\r\n            const hasContent = templateData.elements && templateData.elements.length > 0;\r\n            if (!hasContent) {\r\n                throw new Error('Aucun contenu dans le template. Ajoutez des lments avant de gnrer un aperu.');\r\n            }\r\n            // Vrifier la disponibilit de l'API Preview\r\n            if (typeof window.pdfPreviewAPI === 'undefined') {\r\n                throw new Error('API Preview non disponible. Vrifiez que les scripts sont chargs.');\r\n            }\r\n            // Gnrer l'aperu\r\n            const result = await window.pdfPreviewAPI.generateEditorPreview(templateData, { format: finalFormat, quality });\r\n            if (result && typeof result === 'object' && 'success' in result && result.success && 'image_url' in result && typeof result.image_url === 'string') {\r\n                if (finalFormat === 'pdf') {\r\n                    // Pour PDF, ouvrir dans un nouvel onglet\r\n                    window.open(result.image_url, '_blank');\r\n                    setPreviewUrl(null); // Ne pas afficher dans la modale\r\n                }\r\n                else {\r\n                    // Pour PNG/JPG, afficher dans la modale\r\n                    setPreviewUrl(result.image_url);\r\n                }\r\n            }\r\n            else {\r\n                const errorMsg = (result && typeof result === 'object' && 'error' in result && typeof result.error === 'string') ? result.error : 'Erreur lors de la gnration de l\\'aperu';\r\n                throw new Error(errorMsg);\r\n            }\r\n        }\r\n        catch (err) {\r\n            const errorMessage = err instanceof Error ? err.message : 'Erreur inconnue lors de la gnration';\r\n            setError(errorMessage);\r\n        }\r\n        finally {\r\n            setIsGenerating(false);\r\n        }\r\n    }, [format]);\r\n    return {\r\n        // tat de la modale\r\n        isModalOpen,\r\n        openModal,\r\n        closeModal,\r\n        // tat de gnration\r\n        isGenerating,\r\n        previewUrl,\r\n        error,\r\n        // Options\r\n        format,\r\n        setFormat,\r\n        // Actions\r\n        generatePreview,\r\n        clearPreview\r\n    };\r\n}\r\nexport default usePreview;\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport React, { useState, useEffect, useCallback, memo, useDeferredValue } from 'react';\r\nimport { useBuilder } from '../../contexts/builder/BuilderContext';\r\nimport { usePreview } from '../../hooks/usePreview';\r\nimport { useCanvasSettings } from '../../contexts/CanvasSettingsContext';\r\nimport { debugLog, debugError } from '../../utils/debug';\r\nexport const Header = memo(function Header({ templateName, templateDescription, canvasWidth, canvasHeight, showGuides, snapToGrid, isNewTemplate, isModified, isSaving, isLoading, isEditingExistingTemplate, onSave, onPreview: _onPreview, onNewTemplate, onUpdateTemplateSettings }) {\r\n    // Use deferred values for frequently changing props to prevent cascading re-renders\r\n    const deferredIsModified = useDeferredValue(isModified);\r\n    const deferredIsSaving = useDeferredValue(isSaving);\r\n    const deferredIsLoading = useDeferredValue(isLoading);\r\n    const deferredIsEditingExistingTemplate = useDeferredValue(isEditingExistingTemplate);\r\n    // Debug logging\r\n    useEffect(() => {\r\n    }, []);\r\n    const { state } = useBuilder();\r\n    const canvasSettings = useCanvasSettings();\r\n    const [hoveredButton, setHoveredButton] = useState(null);\r\n    const [showSettingsModal, setShowSettingsModal] = useState(false);\r\n    const [showJsonModal, setShowJsonModal] = useState(false);\r\n    const [copySuccess, setCopySuccess] = useState(false);\r\n    const [isHeaderFixed, setIsHeaderFixed] = useState(false);\r\n    const [editedTemplateName, setEditedTemplateName] = useState(templateName);\r\n    const [editedTemplateDescription, setEditedTemplateDescription] = useState(templateDescription);\r\n    const [editedCanvasWidth, setEditedCanvasWidth] = useState(canvasWidth);\r\n    const [editedCanvasHeight, setEditedCanvasHeight] = useState(canvasHeight);\r\n    const [editedShowGuides, setEditedShowGuides] = useState(showGuides);\r\n    const [editedSnapToGrid, setEditedSnapToGrid] = useState(snapToGrid);\r\n    const [showPredefinedTemplates, setShowPredefinedTemplates] = useState(false);\r\n    // Utiliser le hook usePreview pour la gestion de l'aperu\r\n    const { isModalOpen: showPreviewModal, openModal: openPreviewModal, closeModal: closePreviewModal, isGenerating: isGeneratingPreview, previewUrl: previewImageUrl, error: previewError, format: previewFormat, setFormat: setPreviewFormat, generatePreview, clearPreview } = usePreview();\r\n    // Debug logging\r\n    useEffect(() => {\r\n        debugLog(' [PDF Builder] tat bouton Enregistrer mis  jour', {\r\n            templateName,\r\n            buttonState: {\r\n                disabled: deferredIsSaving || !deferredIsModified || deferredIsLoading,\r\n                isSaving: deferredIsSaving,\r\n                isModified: deferredIsModified,\r\n                isLoading: deferredIsLoading,\r\n                canSave: !deferredIsSaving && deferredIsModified && !deferredIsLoading\r\n            },\r\n            timestamp: new Date().toISOString()\r\n        });\r\n    }, [deferredIsSaving, deferredIsModified, deferredIsLoading, templateName]);\r\n    useEffect(() => {\r\n    }, [showPreviewModal]);\r\n    // Synchroniser les tats locaux avec les props quand elles changent\r\n    useEffect(() => {\r\n        setEditedTemplateName(templateName);\r\n    }, [templateName]);\r\n    useEffect(() => {\r\n        setEditedTemplateDescription(templateDescription);\r\n    }, [templateDescription]);\r\n    useEffect(() => {\r\n        setEditedCanvasWidth(canvasWidth);\r\n    }, [canvasWidth]);\r\n    useEffect(() => {\r\n        setEditedCanvasHeight(canvasHeight);\r\n    }, [canvasHeight]);\r\n    useEffect(() => {\r\n        setEditedShowGuides(showGuides);\r\n    }, [showGuides]);\r\n    useEffect(() => {\r\n        // Si les guides sont dsactivs globalement, forcer l'tat local  false\r\n        if (!canvasSettings.guidesEnabled) {\r\n            setEditedShowGuides(false);\r\n        }\r\n    }, [canvasSettings.guidesEnabled]);\r\n    useEffect(() => {\r\n        setEditedSnapToGrid(snapToGrid);\r\n    }, [snapToGrid]);\r\n    // State pour le throttling du scroll\r\n    const [scrollTimeout, setScrollTimeout] = useState(null);\r\n    // Optimisation: mmoriser le handler de scroll avec throttling\r\n    const handleScroll = useCallback(() => {\r\n        if (scrollTimeout)\r\n            return; // Si un timeout est dj en cours, ignorer\r\n        setScrollTimeout(setTimeout(() => {\r\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n            // Le header devient fixe aprs 120px de scroll\r\n            setIsHeaderFixed(scrollTop > 120);\r\n            setScrollTimeout(null);\r\n        }, 50)); // Dlai de 50ms pour viter les changements trop frquents\r\n    }, [scrollTimeout]);\r\n    // Effet pour grer le scroll et rendre le header fixe\r\n    useEffect(() => {\r\n        window.addEventListener('scroll', handleScroll, { passive: true });\r\n        return () => window.removeEventListener('scroll', handleScroll);\r\n    }, [handleScroll]);\r\n    // Effet pour fermer le dropdown des modles prdfinis quand on clique ailleurs\r\n    useEffect(() => {\r\n        const handleClickOutside = (event) => {\r\n            const target = event.target;\r\n            if (showPredefinedTemplates && !target.closest('[data-predefined-dropdown]')) {\r\n                setShowPredefinedTemplates(false);\r\n            }\r\n        };\r\n        if (showPredefinedTemplates) {\r\n            document.addEventListener('mousedown', handleClickOutside, { passive: true });\r\n            return () => document.removeEventListener('mousedown', handleClickOutside);\r\n        }\r\n    }, [showPredefinedTemplates]);\r\n    const buttonBaseStyles = {\r\n        padding: '10px 16px',\r\n        border: 'none',\r\n        borderRadius: '6px',\r\n        cursor: 'pointer',\r\n        fontSize: '14px',\r\n        fontWeight: '500',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        gap: '6px',\r\n        whiteSpace: 'nowrap'\r\n    };\r\n    const primaryButtonStyles = {\r\n        ...buttonBaseStyles,\r\n        backgroundColor: '#4CAF50',\r\n        color: '#fff',\r\n        boxShadow: hoveredButton === 'save' ? '0 4px 12px rgba(76, 175, 80, 0.3)' : 'none'\r\n    };\r\n    const secondaryButtonStyles = {\r\n        ...buttonBaseStyles,\r\n        backgroundColor: '#fff',\r\n        border: '1px solid #ddd',\r\n        color: '#333',\r\n        boxShadow: hoveredButton === 'preview-image' || hoveredButton === 'preview-pdf' || hoveredButton === 'new' ? '0 2px 8px rgba(0, 0, 0, 0.1)' : 'none'\r\n    };\r\n    return (_jsxs(\"div\", { style: {\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between',\r\n            padding: isHeaderFixed ? '16px' : '12px',\r\n            paddingLeft: isHeaderFixed ? '16px' : '12px',\r\n            paddingRight: isHeaderFixed ? '16px' : '12px',\r\n            backgroundColor: '#ffffff',\r\n            borderBottom: '2px solid #e0e0e0',\r\n            borderRadius: '0px',\r\n            boxShadow: isHeaderFixed\r\n                ? '0 4px 12px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1)'\r\n                : 'none',\r\n            gap: '16px',\r\n            position: isHeaderFixed ? 'fixed' : 'relative',\r\n            top: isHeaderFixed ? '32px' : 'auto',\r\n            left: isHeaderFixed ? '160px' : 'auto',\r\n            right: isHeaderFixed ? '0' : 'auto',\r\n            width: isHeaderFixed ? 'calc(100% - 160px)' : 'auto',\r\n            zIndex: 1000,\r\n            boxSizing: 'border-box',\r\n            transition: 'all 0.25s ease-in-out'\r\n        }, children: [_jsx(\"div\", { style: {\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '12px',\r\n                    minWidth: 0,\r\n                    flex: 1\r\n                }, children: _jsxs(\"div\", { style: {\r\n                        display: 'flex',\r\n                        alignItems: 'baseline',\r\n                        gap: '12px',\r\n                        minWidth: 0\r\n                    }, children: [_jsx(\"h2\", { style: {\r\n                                margin: 0,\r\n                                fontSize: '20px',\r\n                                fontWeight: '600',\r\n                                color: '#1a1a1a',\r\n                                overflow: 'hidden',\r\n                                textOverflow: 'ellipsis',\r\n                                whiteSpace: 'nowrap'\r\n                            }, children: templateName || 'Sans titre' }), _jsxs(\"div\", { style: {\r\n                                display: 'flex',\r\n                                alignItems: 'center',\r\n                                gap: '8px',\r\n                                flexShrink: 0\r\n                            }, children: [deferredIsModified && (_jsxs(\"span\", { style: {\r\n                                        fontSize: '12px',\r\n                                        padding: '4px 10px',\r\n                                        backgroundColor: '#fff3cd',\r\n                                        color: '#856404',\r\n                                        borderRadius: '4px',\r\n                                        fontWeight: '500',\r\n                                        border: '1px solid #ffeaa7',\r\n                                        display: 'flex',\r\n                                        alignItems: 'center',\r\n                                        gap: '4px'\r\n                                    }, children: [_jsx(\"span\", { style: { fontSize: '16px' }, children: \"\\u25CF\" }), \"Modifi\\u00E9\"] })), isNewTemplate && (_jsx(\"span\", { style: {\r\n                                        fontSize: '12px',\r\n                                        padding: '4px 10px',\r\n                                        backgroundColor: '#d1ecf1',\r\n                                        color: '#0c5460',\r\n                                        borderRadius: '4px',\r\n                                        fontWeight: '500',\r\n                                        border: '1px solid #bee5eb'\r\n                                    }, children: \"Nouveau\" }))] })] }) }), _jsxs(\"div\", { style: {\r\n                    display: 'flex',\r\n                    gap: '10px',\r\n                    flexShrink: 0,\r\n                    alignItems: 'center'\r\n                }, children: [_jsxs(\"button\", { onClick: onNewTemplate, onMouseEnter: () => setHoveredButton('new'), onMouseLeave: () => setHoveredButton(null), style: {\r\n                            ...secondaryButtonStyles,\r\n                            opacity: isSaving ? 0.6 : 1,\r\n                            pointerEvents: isSaving ? 'none' : 'auto'\r\n                        }, title: \"Cr\\u00E9er un nouveau template\", children: [_jsx(\"span\", { children: \"\\u2795\" }), _jsx(\"span\", { children: \"Nouveau\" })] }), _jsxs(\"div\", { style: { position: 'relative' }, \"data-predefined-dropdown\": true, children: [_jsxs(\"button\", { onClick: () => setShowPredefinedTemplates(!showPredefinedTemplates), onMouseEnter: () => setHoveredButton('predefined'), onMouseLeave: () => setHoveredButton(null), style: {\r\n                                    ...secondaryButtonStyles,\r\n                                    opacity: isSaving ? 0.6 : 1,\r\n                                    pointerEvents: isSaving ? 'none' : 'auto'\r\n                                }, title: \"Mod\\u00E8les pr\\u00E9d\\u00E9finis\", children: [_jsx(\"span\", { children: \"\\uD83C\\uDFA8\" }), _jsx(\"span\", { children: \"Mod\\u00E8les Pr\\u00E9d\\u00E9finis\" }), _jsx(\"span\", { style: { marginLeft: '4px', fontSize: '12px' }, children: \"\\u25BC\" })] }), showPredefinedTemplates && (_jsxs(\"div\", { style: {\r\n                                    position: 'absolute',\r\n                                    top: '100%',\r\n                                    right: 0,\r\n                                    background: 'white',\r\n                                    border: '1px solid #e0e0e0',\r\n                                    borderRadius: '8px',\r\n                                    boxShadow: '0 4px 12px rgba(0,0,0,0.15)',\r\n                                    zIndex: 1001,\r\n                                    minWidth: '280px',\r\n                                    maxHeight: '400px',\r\n                                    overflowY: 'auto'\r\n                                }, children: [_jsx(\"div\", { style: {\r\n                                            padding: '12px 16px',\r\n                                            borderBottom: '1px solid #e0e0e0',\r\n                                            background: '#f8f9fa',\r\n                                            fontWeight: '600',\r\n                                            fontSize: '14px',\r\n                                            color: '#23282d'\r\n                                        }, children: \"\\uD83C\\uDFA8 Mod\\u00E8les Pr\\u00E9d\\u00E9finis\" }), _jsxs(\"div\", { style: { padding: '8px 0' }, children: [_jsxs(\"div\", { style: {\r\n                                                    padding: '12px 16px',\r\n                                                    cursor: 'pointer',\r\n                                                    borderBottom: '1px solid #f0f0f0',\r\n                                                    display: 'flex',\r\n                                                    alignItems: 'center',\r\n                                                    gap: '12px'\r\n                                                }, onClick: () => {\r\n                                                    // Ouvrir la page des templates prdfinis\r\n                                                    window.open('/wp-admin/admin.php?page=pdf-builder-templates', '_blank');\r\n                                                    setShowPredefinedTemplates(false);\r\n                                                }, onMouseEnter: (e) => e.currentTarget.style.backgroundColor = '#f8f9fa', onMouseLeave: (e) => e.currentTarget.style.backgroundColor = 'transparent', children: [_jsx(\"span\", { style: { fontSize: '20px' }, children: \"\\uD83E\\uDDFE\" }), _jsxs(\"div\", { children: [_jsx(\"div\", { style: { fontWeight: '500', color: '#23282d' }, children: \"Facture Professionnelle\" }), _jsx(\"div\", { style: { fontSize: '12px', color: '#666' }, children: \"Template professionnel pour factures\" })] })] }), _jsxs(\"div\", { style: {\r\n                                                    padding: '12px 16px',\r\n                                                    cursor: 'pointer',\r\n                                                    borderBottom: '1px solid #f0f0f0',\r\n                                                    display: 'flex',\r\n                                                    alignItems: 'center',\r\n                                                    gap: '12px'\r\n                                                }, onClick: () => {\r\n                                                    // Ouvrir la page des templates prdfinis\r\n                                                    window.open('/wp-admin/admin.php?page=pdf-builder-templates', '_blank');\r\n                                                    setShowPredefinedTemplates(false);\r\n                                                }, onMouseEnter: (e) => e.currentTarget.style.backgroundColor = '#f8f9fa', onMouseLeave: (e) => e.currentTarget.style.backgroundColor = 'transparent', children: [_jsx(\"span\", { style: { fontSize: '20px' }, children: \"\\uD83D\\uDCCB\" }), _jsxs(\"div\", { children: [_jsx(\"div\", { style: { fontWeight: '500', color: '#23282d' }, children: \"Devis Commercial\" }), _jsx(\"div\", { style: { fontSize: '12px', color: '#666' }, children: \"Template professionnel pour devis\" })] })] }), _jsxs(\"div\", { style: {\r\n                                                    padding: '12px 16px',\r\n                                                    cursor: 'pointer',\r\n                                                    borderBottom: '1px solid #f0f0f0',\r\n                                                    display: 'flex',\r\n                                                    alignItems: 'center',\r\n                                                    gap: '12px'\r\n                                                }, onClick: () => {\r\n                                                    // Ouvrir la page des templates prdfinis\r\n                                                    window.open('/wp-admin/admin.php?page=pdf-builder-templates', '_blank');\r\n                                                    setShowPredefinedTemplates(false);\r\n                                                }, onMouseEnter: (e) => e.currentTarget.style.backgroundColor = '#f8f9fa', onMouseLeave: (e) => e.currentTarget.style.backgroundColor = 'transparent', children: [_jsx(\"span\", { style: { fontSize: '20px' }, children: \"\\uD83D\\uDCE6\" }), _jsxs(\"div\", { children: [_jsx(\"div\", { style: { fontWeight: '500', color: '#23282d' }, children: \"Bon de Commande\" }), _jsx(\"div\", { style: { fontSize: '12px', color: '#666' }, children: \"Template professionnel pour commandes\" })] })] }), _jsxs(\"div\", { style: {\r\n                                                    padding: '12px 16px',\r\n                                                    cursor: 'pointer',\r\n                                                    display: 'flex',\r\n                                                    alignItems: 'center',\r\n                                                    gap: '12px',\r\n                                                    color: '#007cba',\r\n                                                    fontWeight: '500'\r\n                                                }, onClick: () => {\r\n                                                    // Ouvrir la page des templates prdfinis\r\n                                                    window.open('/wp-admin/admin.php?page=pdf-builder-templates', '_blank');\r\n                                                    setShowPredefinedTemplates(false);\r\n                                                }, onMouseEnter: (e) => e.currentTarget.style.backgroundColor = '#f8f9fa', onMouseLeave: (e) => e.currentTarget.style.backgroundColor = 'transparent', children: [_jsx(\"span\", { style: { fontSize: '16px' }, children: \"\\uD83D\\uDCDA\" }), _jsx(\"span\", { children: \"Voir tous les mod\\u00E8les...\" })] })] })] }))] }), _jsxs(\"button\", { onClick: () => {\r\n                            openPreviewModal();\r\n                        }, onMouseEnter: () => setHoveredButton('preview'), onMouseLeave: () => setHoveredButton(null), style: {\r\n                            ...secondaryButtonStyles,\r\n                            opacity: isSaving ? 0.6 : 1,\r\n                            pointerEvents: isSaving ? 'none' : 'auto'\r\n                        }, title: \"G\\u00E9n\\u00E9rer un aper\\u00E7u du PDF (Image ou PDF)\", children: [_jsx(\"span\", { children: \"\\uD83D\\uDC41\\uFE0F\" }), _jsx(\"span\", { children: \"Aper\\u00E7u\" })] }), _jsx(\"div\", { style: { width: '1px', height: '24px', backgroundColor: '#e0e0e0' } }), _jsxs(\"button\", { onClick: () => setShowJsonModal(true), onMouseEnter: () => setHoveredButton('json'), onMouseLeave: () => setHoveredButton(null), style: {\r\n                            ...secondaryButtonStyles,\r\n                            opacity: isSaving ? 0.6 : 1,\r\n                            pointerEvents: isSaving ? 'none' : 'auto'\r\n                        }, title: \"Voir et copier le JSON du canvas\", children: [_jsx(\"span\", { children: \"\\uD83D\\uDCC4\" }), _jsx(\"span\", { children: \"JSON\" })] }), _jsxs(\"button\", { onClick: () => setShowSettingsModal(true), onMouseEnter: () => setHoveredButton('settings'), onMouseLeave: () => setHoveredButton(null), style: {\r\n                            ...secondaryButtonStyles,\r\n                            opacity: isSaving ? 0.6 : 1,\r\n                            pointerEvents: isSaving ? 'none' : 'auto'\r\n                        }, title: \"Param\\u00E8tres du template\", children: [_jsx(\"span\", { children: \"\\u2699\\uFE0F\" }), _jsx(\"span\", { children: \"Param\\u00E8tres\" })] }), _jsxs(\"button\", { onClick: async () => {\r\n                            var _a, _b, _c, _d, _e;\r\n                            const startTime = performance.now();\r\n                            debugLog(' [PDF Builder] Bouton Enregistrer cliqu', {\r\n                                templateName,\r\n                                isModified: deferredIsModified,\r\n                                isSaving: deferredIsSaving,\r\n                                isLoading: deferredIsLoading,\r\n                                timestamp: new Date().toISOString(),\r\n                                // Informations dtailles sur le canvas\r\n                                canvasInfo: {\r\n                                    width: canvasWidth,\r\n                                    height: canvasHeight,\r\n                                    showGuides,\r\n                                    snapToGrid\r\n                                },\r\n                                // Informations sur les lments\r\n                                elementsInfo: {\r\n                                    totalElements: ((_a = state.elements) === null || _a === void 0 ? void 0 : _a.length) || 0,\r\n                                    elementTypes: ((_b = state.elements) === null || _b === void 0 ? void 0 : _b.reduce((acc, el) => {\r\n                                        acc[el.type] = (acc[el.type] || 0) + 1;\r\n                                        return acc;\r\n                                    }, {})) || {}\r\n                                },\r\n                                // tat du builder\r\n                                builderState: {\r\n                                    template: state.template ? {\r\n                                        name: state.template.name,\r\n                                        description: state.template.description,\r\n                                        hasBackground: !!state.canvas.backgroundColor\r\n                                    } : null,\r\n                                    selectedElement: state.selection.selectedElements[0] || null,\r\n                                    zoom: state.canvas.zoom || 1\r\n                                },\r\n                                // Paramtres canvas\r\n                                canvasSettings: {\r\n                                    guidesEnabled: canvasSettings.guidesEnabled,\r\n                                    memoryLimit: canvasSettings.memoryLimitJs\r\n                                }\r\n                            });\r\n                            try {\r\n                                debugLog(' [PDF Builder] Dbut de la sauvegarde...');\r\n                                await onSave();\r\n                                const endTime = performance.now();\r\n                                const saveDuration = endTime - startTime;\r\n                                debugLog(' [PDF Builder] Sauvegarde russie', {\r\n                                    templateName,\r\n                                    timestamp: new Date().toISOString(),\r\n                                    duration: `${saveDuration.toFixed(2)}ms`,\r\n                                    performance: {\r\n                                        saveTime: saveDuration,\r\n                                        elementsCount: ((_c = state.elements) === null || _c === void 0 ? void 0 : _c.length) || 0,\r\n                                        templateSize: JSON.stringify(state.template).length,\r\n                                        elementsSize: JSON.stringify(state.elements).length\r\n                                    },\r\n                                    // Vrification post-sauvegarde\r\n                                    postSaveState: {\r\n                                        isModified: false,\r\n                                        isSaving: false\r\n                                    }\r\n                                });\r\n                                // Log des mtriques de performance\r\n                                debugLog(' [PDF Builder] Mtriques de sauvegarde', {\r\n                                    duration: saveDuration,\r\n                                    avgTimePerElement: ((_d = state.elements) === null || _d === void 0 ? void 0 : _d.length) ? saveDuration / state.elements.length : 0,\r\n                                    memoryUsage: performance.memory ? {\r\n                                        used: performance.memory.usedJSHeapSize,\r\n                                        total: performance.memory.totalJSHeapSize,\r\n                                        limit: performance.memory.jsHeapSizeLimit\r\n                                    } : 'N/A'\r\n                                });\r\n                            }\r\n                            catch (error) {\r\n                                const endTime = performance.now();\r\n                                const failedDuration = endTime - startTime;\r\n                                debugError(' [PDF Builder] Erreur lors de la sauvegarde:', {\r\n                                    error: error instanceof Error ? {\r\n                                        message: error.message,\r\n                                        stack: error.stack,\r\n                                        name: error.name\r\n                                    } : error,\r\n                                    templateName,\r\n                                    timestamp: new Date().toISOString(),\r\n                                    duration: `${failedDuration.toFixed(2)}ms`,\r\n                                    context: {\r\n                                        isModified: deferredIsModified,\r\n                                        isSaving: deferredIsSaving,\r\n                                        elementsCount: ((_e = state.elements) === null || _e === void 0 ? void 0 : _e.length) || 0\r\n                                    }\r\n                                });\r\n                                alert('Erreur lors de la sauvegarde: ' + (error instanceof Error ? error.message : 'Erreur inconnue'));\r\n                            }\r\n                        }, disabled: deferredIsSaving || !deferredIsModified || deferredIsLoading, onMouseEnter: () => {\r\n                            debugLog(' [PDF Builder] Souris sur bouton Enregistrer', {\r\n                                templateName,\r\n                                buttonState: {\r\n                                    disabled: deferredIsSaving || !deferredIsModified || deferredIsLoading,\r\n                                    isSaving: deferredIsSaving,\r\n                                    isModified: deferredIsModified,\r\n                                    isLoading: deferredIsLoading\r\n                                },\r\n                                timestamp: new Date().toISOString()\r\n                            });\r\n                            setHoveredButton('save');\r\n                        }, onMouseLeave: () => {\r\n                            debugLog(' [PDF Builder] Souris quitte bouton Enregistrer', {\r\n                                templateName,\r\n                                timestamp: new Date().toISOString()\r\n                            });\r\n                            setHoveredButton(null);\r\n                        }, style: {\r\n                            ...primaryButtonStyles,\r\n                            opacity: (deferredIsSaving || !deferredIsModified || deferredIsLoading) ? 0.6 : 1,\r\n                            pointerEvents: (deferredIsSaving || !deferredIsModified || deferredIsLoading) ? 'none' : 'auto'\r\n                        }, title: deferredIsLoading ? 'Chargement du template...' :\r\n                            deferredIsModified ? (deferredIsEditingExistingTemplate ? 'Modifier le template' : 'Enregistrer les modifications') :\r\n                                'Aucune modification', children: [_jsx(\"span\", { children: deferredIsSaving ? '' : '' }), _jsx(\"span\", { children: deferredIsSaving ? 'Enregistrement...' : (deferredIsEditingExistingTemplate ? 'Modifier' : 'Enregistrer') })] })] }), showSettingsModal && (_jsx(\"div\", { style: {\r\n                    position: 'fixed',\r\n                    top: 0,\r\n                    left: 0,\r\n                    right: 0,\r\n                    bottom: 0,\r\n                    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    zIndex: 1000\r\n                }, children: _jsxs(\"div\", { style: {\r\n                        backgroundColor: '#ffffff',\r\n                        borderRadius: '8px',\r\n                        padding: '24px',\r\n                        maxWidth: '500px',\r\n                        width: '90%',\r\n                        maxHeight: '80vh',\r\n                        overflowY: 'auto',\r\n                        boxShadow: '0 10px 30px rgba(0, 0, 0, 0.3)'\r\n                    }, children: [_jsxs(\"div\", { style: {\r\n                                display: 'flex',\r\n                                justifyContent: 'space-between',\r\n                                alignItems: 'center',\r\n                                marginBottom: '20px',\r\n                                borderBottom: '1px solid #e0e0e0',\r\n                                paddingBottom: '16px'\r\n                            }, children: [_jsx(\"h3\", { style: { margin: 0, fontSize: '18px', fontWeight: '600', color: '#1a1a1a' }, children: \"Param\\u00E8tres du template\" }), _jsx(\"button\", { onClick: () => setShowSettingsModal(false), style: {\r\n                                        background: 'none',\r\n                                        border: 'none',\r\n                                        fontSize: '24px',\r\n                                        cursor: 'pointer',\r\n                                        color: '#666',\r\n                                        padding: '4px'\r\n                                    }, title: \"Fermer\", children: \"\\u00D7\" })] }), _jsxs(\"div\", { style: { display: 'flex', flexDirection: 'column', gap: '16px' }, children: [_jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '14px', fontWeight: '600', marginBottom: '8px', color: '#333' }, children: \"Nom du mod\\u00E8le\" }), _jsx(\"input\", { type: \"text\", value: editedTemplateName, onChange: (e) => setEditedTemplateName(e.target.value), style: {\r\n                                                width: '100%',\r\n                                                padding: '8px 12px',\r\n                                                border: '1px solid #ddd',\r\n                                                borderRadius: '4px',\r\n                                                fontSize: '14px',\r\n                                                backgroundColor: '#ffffff'\r\n                                            }, placeholder: \"Entrez le nom du template\" })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '14px', fontWeight: '600', marginBottom: '8px', color: '#333' }, children: \"Description\" }), _jsx(\"textarea\", { value: editedTemplateDescription, onChange: (e) => setEditedTemplateDescription(e.target.value), style: {\r\n                                                width: '100%',\r\n                                                padding: '8px 12px',\r\n                                                border: '1px solid #ddd',\r\n                                                borderRadius: '4px',\r\n                                                fontSize: '14px',\r\n                                                minHeight: '60px',\r\n                                                resize: 'vertical'\r\n                                            }, placeholder: \"Description du template...\" })] }), _jsxs(\"div\", { style: { borderTop: '1px solid #e0e0e0', paddingTop: '16px', marginTop: '16px' }, children: [_jsx(\"h4\", { style: { margin: '0 0 12px 0', fontSize: '14px', fontWeight: '600', color: '#333' }, children: \"Param\\u00E8tres avanc\\u00E9s\" }), _jsxs(\"div\", { style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px' }, children: [_jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#555' }, children: \"Largeur du canvas (px)\" }), _jsx(\"input\", { type: \"number\", value: editedCanvasWidth, disabled: true, style: {\r\n                                                                width: '100%',\r\n                                                                padding: '6px 8px',\r\n                                                                border: '1px solid #ccc',\r\n                                                                borderRadius: '3px',\r\n                                                                fontSize: '12px',\r\n                                                                backgroundColor: '#f5f5f5',\r\n                                                                color: '#999',\r\n                                                                cursor: 'not-allowed'\r\n                                                            } }), _jsx(\"div\", { style: { fontSize: '10px', color: '#999', marginTop: '2px' }, children: \"Non modifiable\" })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '12px', fontWeight: '500', marginBottom: '4px', color: '#555' }, children: \"Hauteur du canvas (px)\" }), _jsx(\"input\", { type: \"number\", value: editedCanvasHeight, disabled: true, style: {\r\n                                                                width: '100%',\r\n                                                                padding: '6px 8px',\r\n                                                                border: '1px solid #ccc',\r\n                                                                borderRadius: '3px',\r\n                                                                fontSize: '12px',\r\n                                                                backgroundColor: '#f5f5f5',\r\n                                                                color: '#999',\r\n                                                                cursor: 'not-allowed'\r\n                                                            } }), _jsx(\"div\", { style: { fontSize: '10px', color: '#999', marginTop: '2px' }, children: \"Non modifiable\" })] })] }), _jsx(\"div\", { style: { marginTop: '12px' }, children: _jsxs(\"label\", { style: {\r\n                                                    display: 'flex',\r\n                                                    alignItems: 'center',\r\n                                                    gap: '8px',\r\n                                                    fontSize: '12px',\r\n                                                    fontWeight: '500',\r\n                                                    color: canvasSettings.guidesEnabled ? '#555' : '#999',\r\n                                                    opacity: canvasSettings.guidesEnabled ? 1 : 0.6\r\n                                                }, children: [_jsx(\"input\", { type: \"checkbox\", checked: editedShowGuides, onChange: (e) => setEditedShowGuides(e.target.checked), disabled: !canvasSettings.guidesEnabled, style: { margin: 0 } }), \"Afficher les guides d'alignement\", !canvasSettings.guidesEnabled && (_jsx(\"span\", { style: { fontSize: '10px', color: '#999', fontStyle: 'italic' }, children: \"(d\\u00E9sactiv\\u00E9 dans les param\\u00E8tres)\" }))] }) }), _jsx(\"div\", { style: { marginTop: '8px' }, children: _jsxs(\"label\", { style: { display: 'flex', alignItems: 'center', gap: '8px', fontSize: '12px', fontWeight: '500', color: '#555' }, children: [_jsx(\"input\", { type: \"checkbox\", checked: editedSnapToGrid, onChange: (e) => setEditedSnapToGrid(e.target.checked), style: { margin: 0 } }), \"Mode grille magn\\u00E9tique\"] }) })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '14px', fontWeight: '600', marginBottom: '8px', color: '#333' }, children: \"Statut\" }), _jsxs(\"div\", { style: { display: 'flex', gap: '8px', flexWrap: 'wrap' }, children: [isNewTemplate && (_jsx(\"span\", { style: {\r\n                                                        padding: '4px 8px',\r\n                                                        backgroundColor: '#e3f2fd',\r\n                                                        color: '#1565c0',\r\n                                                        borderRadius: '12px',\r\n                                                        fontSize: '12px',\r\n                                                        fontWeight: '500'\r\n                                                    }, children: \"Nouveau template\" })), deferredIsModified && (_jsx(\"span\", { style: {\r\n                                                        padding: '4px 8px',\r\n                                                        backgroundColor: '#fff3e0',\r\n                                                        color: '#f57c00',\r\n                                                        borderRadius: '12px',\r\n                                                        fontSize: '12px',\r\n                                                        fontWeight: '500'\r\n                                                    }, children: \"Modifi\\u00E9\" })), isEditingExistingTemplate && (_jsx(\"span\", { style: {\r\n                                                        padding: '4px 8px',\r\n                                                        backgroundColor: '#f3e5f5',\r\n                                                        color: '#7b1fa2',\r\n                                                        borderRadius: '12px',\r\n                                                        fontSize: '12px',\r\n                                                        fontWeight: '500'\r\n                                                    }, children: \"\\u00C9dition existante\" }))] })] }), _jsxs(\"div\", { children: [_jsx(\"label\", { style: { display: 'block', fontSize: '14px', fontWeight: '600', marginBottom: '8px', color: '#333' }, children: \"Informations syst\\u00E8me\" }), _jsxs(\"div\", { style: { fontSize: '13px', color: '#666', lineHeight: '1.5' }, children: [_jsxs(\"div\", { children: [\"Template ID: \", templateName || 'N/A'] }), _jsxs(\"div\", { children: [\"Derni\\u00E8re modification: \", new Date().toLocaleString('fr-FR')] }), _jsxs(\"div\", { children: [\"\\u00C9tat: \", deferredIsSaving ? 'Enregistrement...' : deferredIsModified ? 'Modifi' : 'Sauvegard'] })] })] }), _jsxs(\"div\", { style: { display: 'flex', justifyContent: 'flex-end', gap: '12px', marginTop: '20px' }, children: [_jsx(\"button\", { onClick: () => setShowSettingsModal(false), style: {\r\n                                                padding: '8px 16px',\r\n                                                border: '1px solid #ddd',\r\n                                                borderRadius: '4px',\r\n                                                backgroundColor: '#f8f8f8',\r\n                                                color: '#333',\r\n                                                cursor: 'pointer',\r\n                                                fontSize: '14px'\r\n                                            }, children: \"Annuler\" }), _jsx(\"button\", { onClick: () => {\r\n                                                // Sauvegarder les paramtres du template\r\n                                                onUpdateTemplateSettings({\r\n                                                    name: editedTemplateName,\r\n                                                    description: editedTemplateDescription,\r\n                                                    showGuides: editedShowGuides,\r\n                                                    snapToGrid: editedSnapToGrid\r\n                                                });\r\n                                                setShowSettingsModal(false);\r\n                                            }, style: {\r\n                                                padding: '8px 16px',\r\n                                                border: 'none',\r\n                                                borderRadius: '4px',\r\n                                                backgroundColor: '#4CAF50',\r\n                                                color: '#ffffff',\r\n                                                cursor: 'pointer',\r\n                                                fontSize: '14px',\r\n                                                fontWeight: '500'\r\n                                            }, children: \"Sauvegarder\" })] })] })] }) })), showJsonModal && (_jsx(\"div\", { style: {\r\n                    position: 'fixed',\r\n                    top: 0,\r\n                    left: 0,\r\n                    right: 0,\r\n                    bottom: 0,\r\n                    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    zIndex: 1001\r\n                }, children: _jsxs(\"div\", { style: {\r\n                        backgroundColor: '#ffffff',\r\n                        borderRadius: '8px',\r\n                        padding: '24px',\r\n                        maxWidth: '90vw',\r\n                        width: '100%',\r\n                        maxHeight: '85vh',\r\n                        display: 'flex',\r\n                        flexDirection: 'column',\r\n                        boxShadow: '0 10px 40px rgba(0, 0, 0, 0.3)'\r\n                    }, children: [_jsxs(\"div\", { style: {\r\n                                display: 'flex',\r\n                                justifyContent: 'space-between',\r\n                                alignItems: 'center',\r\n                                marginBottom: '16px',\r\n                                borderBottom: '1px solid #e0e0e0',\r\n                                paddingBottom: '12px'\r\n                            }, children: [_jsxs(\"h3\", { style: { margin: 0, fontSize: '18px', fontWeight: '600', color: '#1a1a1a' }, children: [\"\\uD83D\\uDCCB JSON Brut du Template (ID: \", templateName || 'N/A', \")\"] }), _jsx(\"button\", { onClick: () => setShowJsonModal(false), style: {\r\n                                        background: 'none',\r\n                                        border: 'none',\r\n                                        fontSize: '24px',\r\n                                        cursor: 'pointer',\r\n                                        color: '#666',\r\n                                        padding: '4px'\r\n                                    }, title: \"Fermer\", children: \"\\u00D7\" })] }), _jsx(\"div\", { style: {\r\n                                flex: 1,\r\n                                overflow: 'auto',\r\n                                backgroundColor: '#f5f5f5',\r\n                                borderRadius: '6px',\r\n                                padding: '16px',\r\n                                fontFamily: \"'Courier New', monospace\",\r\n                                fontSize: '12px',\r\n                                lineHeight: '1.5',\r\n                                color: '#333',\r\n                                whiteSpace: 'pre-wrap',\r\n                                wordBreak: 'break-word',\r\n                                border: '1px solid #ddd',\r\n                                marginBottom: '16px'\r\n                            }, children: JSON.stringify({\r\n                                ...state.template,\r\n                                elements: state.elements\r\n                            }, null, 2) }), _jsxs(\"div\", { style: {\r\n                                display: 'flex',\r\n                                gap: '12px',\r\n                                justifyContent: 'flex-end',\r\n                                alignItems: 'center'\r\n                            }, children: [_jsx(\"button\", { onClick: () => {\r\n                                        navigator.clipboard.writeText(JSON.stringify({\r\n                                            ...state.template,\r\n                                            elements: state.elements\r\n                                        }, null, 2));\r\n                                        setCopySuccess(true);\r\n                                        setTimeout(() => setCopySuccess(false), 2000);\r\n                                    }, style: {\r\n                                        padding: '8px 16px',\r\n                                        backgroundColor: '#0073aa',\r\n                                        color: '#ffffff',\r\n                                        border: 'none',\r\n                                        borderRadius: '4px',\r\n                                        cursor: 'pointer',\r\n                                        fontSize: '14px',\r\n                                        fontWeight: '500',\r\n                                        opacity: copySuccess ? 0.7 : 1\r\n                                    }, title: \"Copier le JSON\", children: copySuccess ? ' Copi!' : ' Copier JSON' }), _jsx(\"button\", { onClick: () => {\r\n                                        const jsonString = JSON.stringify({\r\n                                            ...state.template,\r\n                                            elements: state.elements\r\n                                        }, null, 2);\r\n                                        const blob = new Blob([jsonString], { type: 'application/json' });\r\n                                        const url = URL.createObjectURL(blob);\r\n                                        const link = document.createElement('a');\r\n                                        link.href = url;\r\n                                        link.download = `template-${templateName || 'export'}-${new Date().getTime()}.json`;\r\n                                        link.click();\r\n                                        URL.revokeObjectURL(url);\r\n                                    }, style: {\r\n                                        padding: '8px 16px',\r\n                                        backgroundColor: '#10a37f',\r\n                                        color: '#ffffff',\r\n                                        border: 'none',\r\n                                        borderRadius: '4px',\r\n                                        cursor: 'pointer',\r\n                                        fontSize: '14px',\r\n                                        fontWeight: '500'\r\n                                    }, title: \"T\\u00E9l\\u00E9charger le JSON\", children: \"\\uD83D\\uDCBE T\\u00E9l\\u00E9charger\" }), _jsx(\"button\", { onClick: () => setShowJsonModal(false), style: {\r\n                                        padding: '8px 16px',\r\n                                        border: '1px solid #ddd',\r\n                                        borderRadius: '4px',\r\n                                        backgroundColor: '#f8f8f8',\r\n                                        color: '#333',\r\n                                        cursor: 'pointer',\r\n                                        fontSize: '14px',\r\n                                        fontWeight: '500'\r\n                                    }, children: \"Fermer\" })] })] }) })), showPreviewModal && (_jsx(\"div\", { style: {\r\n                    position: 'fixed',\r\n                    top: 0,\r\n                    left: 0,\r\n                    right: 0,\r\n                    bottom: 0,\r\n                    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    zIndex: 1001\r\n                }, children: _jsxs(\"div\", { style: {\r\n                        backgroundColor: '#ffffff',\r\n                        borderRadius: '8px',\r\n                        padding: '24px',\r\n                        maxWidth: '90vw',\r\n                        width: '600px',\r\n                        maxHeight: '90vh',\r\n                        overflow: 'auto',\r\n                        boxShadow: '0 4px 20px rgba(0, 0, 0, 0.15)'\r\n                    }, children: [_jsxs(\"div\", { style: {\r\n                                display: 'flex',\r\n                                justifyContent: 'space-between',\r\n                                alignItems: 'center',\r\n                                marginBottom: '20px'\r\n                            }, children: [_jsx(\"h3\", { style: {\r\n                                        margin: 0,\r\n                                        fontSize: '18px',\r\n                                        fontWeight: '600',\r\n                                        color: '#1a1a1a'\r\n                                    }, children: \"Aper\\u00E7u du PDF\" }), _jsx(\"button\", { onClick: () => {\r\n                                        closePreviewModal();\r\n                                        clearPreview();\r\n                                    }, style: {\r\n                                        background: 'none',\r\n                                        border: 'none',\r\n                                        fontSize: '24px',\r\n                                        cursor: 'pointer',\r\n                                        color: '#666',\r\n                                        padding: '0',\r\n                                        width: '30px',\r\n                                        height: '30px',\r\n                                        display: 'flex',\r\n                                        alignItems: 'center',\r\n                                        justifyContent: 'center'\r\n                                    }, title: \"Fermer\", children: \"\\u00D7\" })] }), _jsxs(\"div\", { style: { marginBottom: '20px' }, children: [_jsx(\"label\", { style: {\r\n                                        display: 'block',\r\n                                        fontSize: '14px',\r\n                                        fontWeight: '500',\r\n                                        color: '#333',\r\n                                        marginBottom: '8px'\r\n                                    }, children: \"Format d'export :\" }), _jsx(\"div\", { style: { display: 'flex', gap: '10px' }, children: [\r\n                                        { value: 'png', label: 'PNG', icon: '' },\r\n                                        { value: 'jpg', label: 'JPG', icon: '' },\r\n                                        { value: 'pdf', label: 'PDF', icon: '' }\r\n                                    ].map(format => (_jsxs(\"button\", { onClick: () => setPreviewFormat(format.value), style: {\r\n                                            padding: '8px 16px',\r\n                                            border: `2px solid ${previewFormat === format.value ? '#007cba' : '#ddd'}`,\r\n                                            borderRadius: '6px',\r\n                                            backgroundColor: previewFormat === format.value ? '#f0f8ff' : '#fff',\r\n                                            color: previewFormat === format.value ? '#007cba' : '#333',\r\n                                            cursor: 'pointer',\r\n                                            fontSize: '14px',\r\n                                            fontWeight: '500',\r\n                                            display: 'flex',\r\n                                            alignItems: 'center',\r\n                                            gap: '6px'\r\n                                        }, children: [_jsx(\"span\", { children: format.icon }), _jsx(\"span\", { children: format.label })] }, format.value))) })] }), _jsx(\"div\", { style: { marginBottom: '20px' }, children: _jsx(\"button\", { onClick: async () => {\r\n                                    await generatePreview({\r\n                                        ...state.template,\r\n                                        elements: state.elements\r\n                                    }, {\r\n                                        format: previewFormat,\r\n                                        quality: 150\r\n                                    });\r\n                                }, disabled: isGeneratingPreview, style: {\r\n                                    padding: '12px 24px',\r\n                                    backgroundColor: isGeneratingPreview ? '#ccc' : '#007cba',\r\n                                    color: '#fff',\r\n                                    border: 'none',\r\n                                    borderRadius: '6px',\r\n                                    cursor: isGeneratingPreview ? 'not-allowed' : 'pointer',\r\n                                    fontSize: '16px',\r\n                                    fontWeight: '500',\r\n                                    display: 'flex',\r\n                                    alignItems: 'center',\r\n                                    gap: '8px'\r\n                                }, children: isGeneratingPreview ? (_jsxs(_Fragment, { children: [_jsx(\"span\", { children: \"\\u27F3\" }), _jsx(\"span\", { children: \"G\\u00E9n\\u00E9ration en cours...\" })] })) : (_jsxs(_Fragment, { children: [_jsx(\"span\", { children: \"\\uD83C\\uDFA8\" }), _jsx(\"span\", { children: \"G\\u00E9n\\u00E9rer l'aper\\u00E7u\" })] })) }) }), previewError && (_jsxs(\"div\", { style: {\r\n                                padding: '12px',\r\n                                backgroundColor: '#f8d7da',\r\n                                border: '1px solid #f5c6cb',\r\n                                borderRadius: '4px',\r\n                                color: '#721c24',\r\n                                marginBottom: '20px'\r\n                            }, children: [_jsx(\"strong\", { children: \"Erreur:\" }), \" \", previewError] })), previewImageUrl && (_jsxs(\"div\", { style: { textAlign: 'center' }, children: [_jsx(\"img\", { src: previewImageUrl, alt: \"Aper\\u00E7u du PDF\", style: {\r\n                                        maxWidth: '100%',\r\n                                        maxHeight: '400px',\r\n                                        border: '1px solid #ddd',\r\n                                        borderRadius: '4px',\r\n                                        boxShadow: '0 2px 8px rgba(0, 0, 0, 0.1)'\r\n                                    } }), _jsx(\"div\", { style: { marginTop: '10px' }, children: _jsx(\"a\", { href: previewImageUrl, download: `apercu-${templateName || 'template'}.${previewFormat}`, style: {\r\n                                            padding: '8px 16px',\r\n                                            backgroundColor: '#28a745',\r\n                                            color: '#fff',\r\n                                            textDecoration: 'none',\r\n                                            borderRadius: '4px',\r\n                                            fontSize: '14px',\r\n                                            fontWeight: '500'\r\n                                        }, children: \"\\uD83D\\uDCBE T\\u00E9l\\u00E9charger\" }) })] }))] }) }))] }));\r\n});\r\n","import { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\r\nimport { useIsMobile, useIsTablet } from '../../hooks/useResponsive';\r\nimport { ResponsiveContainer } from '../ui/Responsive';\r\n// Dfinition des lments WooCommerce (migration depuis l'ancien diteur)\r\nconst WOOCOMMERCE_ELEMENTS = [\r\n    {\r\n        type: 'product_table',\r\n        label: 'Tableau Produits',\r\n        icon: '',\r\n        description: 'Tableau des produits commands avec quantits et prix',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 50,\r\n            y: 50,\r\n            width: 500,\r\n            height: 200,\r\n            showHeaders: true,\r\n            showBorders: true,\r\n            showAlternatingRows: true,\r\n            showSku: false,\r\n            showDescription: false,\r\n            showQuantity: true,\r\n            fontSize: 11,\r\n            fontFamily: 'Arial',\r\n            fontWeight: 'normal',\r\n            fontStyle: 'normal',\r\n            textDecoration: 'none',\r\n            textTransform: 'none',\r\n            letterSpacing: 'normal',\r\n            wordSpacing: 'normal',\r\n            lineHeight: '1.2',\r\n            currency: '',\r\n            tableStyle: 'default',\r\n            textAlign: 'left',\r\n            verticalAlign: 'top',\r\n            backgroundColor: '#ffffff',\r\n            headerBackgroundColor: '#f9fafb',\r\n            headerTextColor: '#111827',\r\n            alternateRowColor: '#f9fafb',\r\n            borderColor: '#e5e7eb',\r\n            borderWidth: 1,\r\n            textColor: '#374151',\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            visible: true\r\n        }\r\n    },\r\n    {\r\n        type: 'customer_info',\r\n        label: 'Fiche Client',\r\n        icon: '',\r\n        description: 'Informations dtailles du client (nom, adresse, email)',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 50,\r\n            y: 220,\r\n            width: 250,\r\n            height: 120,\r\n            showHeaders: true,\r\n            showBackground: true,\r\n            showBorders: false,\r\n            showFullName: true,\r\n            showAddress: true,\r\n            showEmail: true,\r\n            showPhone: true,\r\n            showPaymentMethod: false,\r\n            showTransactionId: false,\r\n            layout: 'vertical',\r\n            fontSize: 12,\r\n            fontFamily: 'Arial',\r\n            fontWeight: 'normal',\r\n            fontStyle: 'normal',\r\n            headerFontStyle: 'normal',\r\n            bodyFontStyle: 'normal',\r\n            textDecoration: 'none',\r\n            textTransform: 'none',\r\n            letterSpacing: 'normal',\r\n            wordSpacing: 'normal',\r\n            lineHeight: '1.2',\r\n            backgroundColor: '#e5e7eb',\r\n            borderColor: '#e5e7eb',\r\n            borderWidth: 0,\r\n            textColor: '#374151',\r\n            headerTextColor: '#111827',\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            visible: true\r\n        }\r\n    },\r\n    {\r\n        type: 'company_info',\r\n        label: 'Informations Entreprise',\r\n        icon: '[D]',\r\n        description: 'Nom, adresse, contact et TVA de l\\'entreprise',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 50,\r\n            y: 340,\r\n            width: 250,\r\n            height: 120,\r\n            showBorders: false,\r\n            showFullName: true,\r\n            showAddress: true,\r\n            showEmail: true,\r\n            showPhone: true,\r\n            showSiret: true,\r\n            showVat: true,\r\n            showRcs: true,\r\n            showCapital: true,\r\n            showCompanyName: true,\r\n            layout: 'vertical',\r\n            fontSize: 12,\r\n            fontFamily: 'Arial',\r\n            fontWeight: 'normal',\r\n            fontStyle: 'normal',\r\n            headerFontStyle: 'normal',\r\n            bodyFontStyle: 'normal',\r\n            textDecoration: 'none',\r\n            textTransform: 'none',\r\n            letterSpacing: 'normal',\r\n            wordSpacing: 'normal',\r\n            lineHeight: '1.2',\r\n            backgroundColor: '#e5e7eb',\r\n            borderColor: '#e5e7eb',\r\n            borderWidth: 0,\r\n            textColor: '#374151',\r\n            headerTextColor: '#111827',\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            showBackground: true,\r\n            visible: true\r\n        }\r\n    },\r\n    {\r\n        type: 'company_logo',\r\n        label: 'Logo Entreprise',\r\n        icon: '',\r\n        description: 'Logo et identit visuelle de l\\'entreprise',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 350,\r\n            y: 50,\r\n            width: 150,\r\n            height: 80,\r\n            fit: 'contain',\r\n            objectFit: 'contain',\r\n            alignment: 'left',\r\n            src: '',\r\n            backgroundColor: 'transparent',\r\n            borderColor: '#e5e7eb',\r\n            borderWidth: 1,\r\n            borderRadius: 0,\r\n            opacity: 1,\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            visible: true\r\n        }\r\n    },\r\n    {\r\n        type: 'order-number',\r\n        label: 'Numro de Commande',\r\n        icon: '',\r\n        description: 'Rfrence de commande avec date',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 350,\r\n            y: 130,\r\n            width: 100,\r\n            height: 30,\r\n            fontSize: 14,\r\n            fontFamily: 'Arial',\r\n            fontWeight: 'normal',\r\n            fontStyle: 'normal',\r\n            textDecoration: 'none',\r\n            textTransform: 'none',\r\n            letterSpacing: 'normal',\r\n            wordSpacing: 'normal',\r\n            lineHeight: '1.2',\r\n            textAlign: 'right',\r\n            backgroundColor: 'transparent',\r\n            borderColor: '#e5e7eb',\r\n            borderWidth: 0,\r\n            textColor: '#374151',\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            visible: true\r\n        }\r\n    },\r\n    {\r\n        type: 'woocommerce-order-date',\r\n        label: 'Date de Commande',\r\n        icon: '',\r\n        description: 'Date de cration de la commande',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 350,\r\n            y: 160,\r\n            width: 100,\r\n            height: 30,\r\n            fontSize: 12,\r\n            fontFamily: 'Arial',\r\n            fontWeight: 'normal',\r\n            fontStyle: 'normal',\r\n            textDecoration: 'none',\r\n            textTransform: 'none',\r\n            letterSpacing: 'normal',\r\n            wordSpacing: 'normal',\r\n            lineHeight: '1.2',\r\n            textAlign: 'right',\r\n            backgroundColor: 'transparent',\r\n            borderColor: '#e5e7eb',\r\n            borderWidth: 0,\r\n            textColor: '#374151',\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            visible: true\r\n        }\r\n    },\r\n    {\r\n        type: 'woocommerce-invoice-number',\r\n        label: 'Numro de Facture',\r\n        icon: '',\r\n        description: 'Numro de facture gnr',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 350,\r\n            y: 190,\r\n            width: 100,\r\n            height: 30,\r\n            fontSize: 12,\r\n            fontFamily: 'Arial',\r\n            fontWeight: 'normal',\r\n            fontStyle: 'normal',\r\n            textDecoration: 'none',\r\n            textTransform: 'none',\r\n            letterSpacing: 'normal',\r\n            wordSpacing: 'normal',\r\n            lineHeight: '1.2',\r\n            textAlign: 'right',\r\n            backgroundColor: 'transparent',\r\n            borderColor: '#e5e7eb',\r\n            borderWidth: 0,\r\n            textColor: '#374151',\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            visible: true\r\n        }\r\n    },\r\n    {\r\n        type: 'document_type',\r\n        label: 'Type de Document',\r\n        icon: '',\r\n        description: 'Type du document (Facture, Devis, Bon de commande, etc.)',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 50,\r\n            y: 430,\r\n            width: 150,\r\n            height: 40,\r\n            title: 'FACTURE',\r\n            fontSize: 18,\r\n            fontFamily: 'Arial',\r\n            fontWeight: 'bold',\r\n            fontStyle: 'normal',\r\n            textDecoration: 'none',\r\n            textTransform: 'none',\r\n            letterSpacing: 'normal',\r\n            wordSpacing: 'normal',\r\n            lineHeight: '1.2',\r\n            textAlign: 'left',\r\n            backgroundColor: 'transparent',\r\n            borderColor: '#e5e7eb',\r\n            borderWidth: 0,\r\n            textColor: '#111827',\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            visible: true\r\n        }\r\n    },\r\n    {\r\n        type: 'dynamic-text',\r\n        label: 'Texte Dynamique',\r\n        icon: '',\r\n        description: 'Texte avec variables dynamiques',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 50,\r\n            y: 550,\r\n            width: 200,\r\n            height: 40,\r\n            text: 'Texte personnalisable',\r\n            textTemplate: 'custom',\r\n            autoWrap: true,\r\n            theme: 'clean',\r\n            fontSize: 14,\r\n            fontFamily: 'Arial',\r\n            fontWeight: 'normal',\r\n            fontStyle: 'normal',\r\n            textDecoration: 'none',\r\n            textTransform: 'none',\r\n            letterSpacing: 'normal',\r\n            wordSpacing: 'normal',\r\n            lineHeight: '1.3',\r\n            backgroundColor: 'transparent',\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            visible: true\r\n        }\r\n    },\r\n    {\r\n        type: 'mentions',\r\n        label: 'Mentions lgales',\r\n        icon: '',\r\n        description: 'Informations lgales (email, SIRET, tlphone, etc.)',\r\n        category: 'woocommerce',\r\n        defaultProps: {\r\n            x: 50,\r\n            y: 480,\r\n            width: 500,\r\n            height: 60,\r\n            showEmail: true,\r\n            showPhone: true,\r\n            showSiret: true,\r\n            showVat: true,\r\n            separator: '  ',\r\n            fontSize: 10,\r\n            fontFamily: 'Arial',\r\n            fontWeight: 'normal',\r\n            fontStyle: 'normal',\r\n            textDecoration: 'none',\r\n            textTransform: 'none',\r\n            letterSpacing: 'normal',\r\n            wordSpacing: 'normal',\r\n            lineHeight: '1.2',\r\n            textAlign: 'left',\r\n            backgroundColor: 'transparent',\r\n            borderColor: '#e5e7eb',\r\n            borderWidth: 0,\r\n            textColor: '#6b7280',\r\n            rotation: 0,\r\n            shadowColor: '#000000',\r\n            shadowOffsetX: 0,\r\n            shadowOffsetY: 0,\r\n            shadowBlur: 0,\r\n            visible: true\r\n        }\r\n    }\r\n];\r\nexport function ElementLibrary({ onElementSelect, className }) {\r\n    const isMobile = useIsMobile();\r\n    const isTablet = useIsTablet();\r\n    const handleElementClick = (elementType) => {\r\n        if (onElementSelect) {\r\n            onElementSelect(elementType);\r\n        }\r\n    };\r\n    const handleDragStart = (e, element) => {\r\n        // Stocker les donnes de l'lment dans le transfert\r\n        e.dataTransfer.setData('application/json', JSON.stringify({\r\n            type: element.type,\r\n            label: element.label,\r\n            defaultProps: element.defaultProps\r\n        }));\r\n        e.dataTransfer.effectAllowed = 'copy';\r\n    };\r\n    const handleDragEnd = (_e) => {\r\n        // Drag termin\r\n    };\r\n    return (_jsx(ResponsiveContainer, { className: `pdf-element-library ${className || ''}`, mobileClass: \"element-library-mobile\", tabletClass: \"element-library-tablet\", desktopClass: \"element-library-desktop\", children: _jsxs(\"div\", { style: {\r\n                width: isMobile ? '100%' : isTablet ? '240px' : '280px',\r\n                height: '100%',\r\n                backgroundColor: '#f8f9fa',\r\n                borderRight: isMobile ? 'none' : '1px solid #e9ecef',\r\n                borderBottom: isMobile ? '1px solid #e9ecef' : 'none',\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                overflow: 'hidden'\r\n            }, children: [_jsxs(\"div\", { style: {\r\n                        padding: isMobile ? '12px' : '16px',\r\n                        borderBottom: '1px solid #e9ecef',\r\n                        backgroundColor: '#ffffff'\r\n                    }, children: [_jsx(\"h3\", { style: {\r\n                                margin: 0,\r\n                                fontSize: isMobile ? '14px' : '16px',\r\n                                fontWeight: '600',\r\n                                color: '#495057'\r\n                            }, children: \"\\uD83D\\uDCE6 \\u00C9l\\u00E9ments WooCommerce\" }), _jsx(\"p\", { style: {\r\n                                margin: '4px 0 0 0',\r\n                                fontSize: isMobile ? '11px' : '12px',\r\n                                color: '#6c757d',\r\n                                display: isMobile ? 'none' : 'block'\r\n                            }, children: \"Glissez les \\u00E9l\\u00E9ments sur le canvas\" })] }), _jsx(\"div\", { style: {\r\n                        flex: 1,\r\n                        overflowY: 'auto',\r\n                        padding: isMobile ? '12px' : '8px'\r\n                    }, children: _jsx(\"div\", { style: {\r\n                            display: 'grid',\r\n                            gap: '8px'\r\n                        }, children: WOOCOMMERCE_ELEMENTS.map((element) => (_jsxs(\"div\", { draggable: true, onClick: () => handleElementClick(element.type), onDragStart: (e) => handleDragStart(e, element), onDragEnd: handleDragEnd, style: {\r\n                                padding: '12px',\r\n                                backgroundColor: '#ffffff',\r\n                                border: '1px solid #dee2e6',\r\n                                borderRadius: '6px',\r\n                                cursor: 'grab',\r\n                                transition: 'all 0.2s ease',\r\n                                display: 'flex',\r\n                                alignItems: 'center',\r\n                                gap: '12px',\r\n                                userSelect: 'none'\r\n                            }, onMouseEnter: (e) => {\r\n                                e.currentTarget.style.borderColor = '#007acc';\r\n                                e.currentTarget.style.boxShadow = '0 2px 4px rgba(0, 122, 204, 0.1)';\r\n                                e.currentTarget.style.cursor = 'grabbing';\r\n                            }, onMouseLeave: (e) => {\r\n                                e.currentTarget.style.borderColor = '#dee2e6';\r\n                                e.currentTarget.style.boxShadow = 'none';\r\n                                e.currentTarget.style.cursor = 'grab';\r\n                            }, children: [_jsx(\"div\", { style: {\r\n                                        fontSize: '20px',\r\n                                        width: '32px',\r\n                                        height: '32px',\r\n                                        display: 'flex',\r\n                                        alignItems: 'center',\r\n                                        justifyContent: 'center',\r\n                                        backgroundColor: '#f8f9fa',\r\n                                        borderRadius: '4px'\r\n                                    }, children: element.icon }), _jsxs(\"div\", { style: { flex: 1 }, children: [_jsx(\"div\", { style: {\r\n                                                fontSize: '14px',\r\n                                                fontWeight: '500',\r\n                                                color: '#495057',\r\n                                                marginBottom: '2px'\r\n                                            }, children: element.label }), _jsx(\"div\", { style: {\r\n                                                fontSize: '12px',\r\n                                                color: '#6c757d',\r\n                                                lineHeight: '1.3'\r\n                                            }, children: element.description })] })] }, element.type))) }) }), _jsx(\"div\", { style: {\r\n                        padding: '12px 16px',\r\n                        borderTop: '1px solid #e9ecef',\r\n                        backgroundColor: '#ffffff',\r\n                        fontSize: '11px',\r\n                        color: '#6c757d',\r\n                        textAlign: 'center'\r\n                    }, children: \"Cliquez sur un \\u00E9l\\u00E9ment pour l'ajouter\" })] }) }));\r\n}\r\n","/**\r\n * Normalisation robuste des lments pour assurer la prservation complte des proprits\r\n * C'est LE systme central qui garantit que contentAlign, labelPosition, etc. ne sont jamais perdus\r\n */\r\nimport { debugWarn, debugError } from './debug';\r\n/**\r\n * FONCTION CRITIQUE: Normalise les lments sans perdre AUCUNE proprit personnalise\r\n * Utilise au chargement APRS le parsing JSON\r\n *\r\n * Proprits  prserver ABSOLUMENT:\r\n * - contentAlign, labelPosition (order_number)\r\n * - Toute proprit custom ajoute via l'diteur\r\n */\r\nexport function normalizeElementsAfterLoad(elements) {\r\n    if (!Array.isArray(elements)) {\r\n        debugWarn(' [NORMALIZE] Elements n\\'est pas un array:', typeof elements);\r\n        return [];\r\n    }\r\n    return elements.map((el, idx) => {\r\n        if (!el || typeof el !== 'object') {\r\n            debugWarn(` [NORMALIZE] Element ${idx} invalide:`, el);\r\n            return {};\r\n        }\r\n        const element = el;\r\n        // Crer une copie COMPLTE (spread shallow)\r\n        const normalized = {\r\n            ...element,\r\n            id: element.id || `element-${idx}`,\r\n            type: element.type || 'unknown',\r\n            x: Number(element.x) || 0,\r\n            y: Number(element.y) || 0,\r\n            width: Number(element.width) || 100,\r\n            height: Number(element.height) || 100\r\n        };\r\n        return normalized;\r\n    });\r\n}\r\n/**\r\n * FONCTION CRITIQUE: Prpare les lments pour la sauvegarde\r\n * Assure que TOUT est srialisable et complet\r\n */\r\nexport function normalizeElementsBeforeSave(elements) {\r\n    if (!Array.isArray(elements)) {\r\n        debugWarn(' [SAVE NORMALIZE] Elements n\\'est pas un array');\r\n        return [];\r\n    }\r\n    return elements.map((el, idx) => {\r\n        if (!el || typeof el !== 'object') {\r\n            debugWarn(` [SAVE NORMALIZE] Element ${idx} invalide`);\r\n            return {};\r\n        }\r\n        // Crer une copie COMPLTE\r\n        const normalized = {\r\n            ...el\r\n        };\r\n        // Valider les champs critiques\r\n        if (!normalized.id)\r\n            normalized.id = `element-${idx}`;\r\n        if (!normalized.type)\r\n            normalized.type = 'unknown';\r\n        if (typeof normalized.x !== 'number')\r\n            normalized.x = 0;\r\n        if (typeof normalized.y !== 'number')\r\n            normalized.y = 0;\r\n        if (typeof normalized.width !== 'number')\r\n            normalized.width = 100;\r\n        if (typeof normalized.height !== 'number')\r\n            normalized.height = 100;\r\n        // CRITICAL: Log les proprits order_number avant sauvegarde\r\n        if (normalized.type === 'order_number') {\r\n        }\r\n        // Filtrer les proprits non srialisables (Date, Function, etc)\r\n        const serializable = {};\r\n        Object.keys(normalized).forEach(key => {\r\n            const value = normalized[key];\r\n            const type = typeof value;\r\n            // DEBUG: Log des proprits spciales\r\n            if (key.includes('') || key.includes('interactions') || key.includes('comportement') || key.includes('behavior')) {\r\n                // console.log(`[NORMALIZE] Proprit spciale dtecte: ${key} (type: ${type}) =`, value);\r\n            }\r\n            // Garder: string, number, boolean, null, undefined\r\n            // Garder: objects simples et arrays\r\n            // REJETER: functions, symbols, dates (sauf si srialises)\r\n            if (value === null ||\r\n                value === undefined ||\r\n                type === 'string' ||\r\n                type === 'number' ||\r\n                type === 'boolean') {\r\n                serializable[key] = value;\r\n            }\r\n            else if (type === 'object') {\r\n                try {\r\n                    // Vrifier si c'est srialisable\r\n                    JSON.stringify(value);\r\n                    serializable[key] = value;\r\n                }\r\n                catch (_a) {\r\n                    debugWarn(`  [SAVE NORMALIZE] Proprit non srialisable ${key} skippe`, value);\r\n                }\r\n            }\r\n            else {\r\n                // Proprits rejetes (functions, etc.)\r\n                debugWarn(`  [SAVE NORMALIZE] Proprit rejete: ${key} (type: ${type})`);\r\n            }\r\n        });\r\n        return serializable;\r\n    });\r\n}\r\n/**\r\n * Valide que les proprits critiques sont prsentes\r\n */\r\nexport function validateElementIntegrity(elements, elementType) {\r\n    const elementsOfType = elements.filter(el => el.type === elementType);\r\n    if (elementsOfType.length === 0) {\r\n        return true; // Pas d'lments de ce type\r\n    }\r\n    let allValid = true;\r\n    elementsOfType.forEach((el, idx) => {\r\n        const required = ['id', 'type', 'x', 'y', 'width', 'height'];\r\n        const missing = required.filter(key => !(key in el));\r\n        if (missing.length > 0) {\r\n            debugError(` [VALIDATE] Element ${idx} missing: ${missing.join(', ')}`);\r\n            allValid = false;\r\n        }\r\n        if (elementType === 'order_number') {\r\n            const hasContentAlign = 'contentAlign' in el;\r\n            const hasLabelPosition = 'labelPosition' in el;\r\n            if (!hasContentAlign || !hasLabelPosition) {\r\n                allValid = false;\r\n            }\r\n        }\r\n    });\r\n    return allValid;\r\n}\r\n/**\r\n * Debug helper: affiche un rapport complet\r\n */\r\nexport function debugElementState(elements, label) {\r\n    // Debug function - logs removed for production\r\n}\r\n","import { useEffect, useCallback } from 'react';\r\nimport { useBuilder } from '../contexts/builder/BuilderContext';\r\nimport { useCanvasSettings } from '../contexts/CanvasSettingsContext';\r\nimport { debugError, debugWarn } from '../utils/debug';\r\nimport { normalizeElementsBeforeSave, normalizeElementsAfterLoad, debugElementState } from '../utils/elementNormalization';\r\nexport function useTemplate() {\r\n    const { state, dispatch } = useBuilder();\r\n    const { canvasWidth, canvasHeight } = useCanvasSettings();\r\n    // Dtecter si on est sur un template existant via l'URL ou les donnes localises\r\n    const getTemplateIdFromUrl = useCallback(() => {\r\n        var _a;\r\n        // Priorit 1: Utiliser le templateId des donnes PHP localises\r\n        if ((_a = window.pdfBuilderData) === null || _a === void 0 ? void 0 : _a.templateId) {\r\n            return window.pdfBuilderData.templateId.toString();\r\n        }\r\n        // Priorit 2: Utiliser le paramtre URL (pour compatibilit)\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n        const urlTemplateId = urlParams.get('template_id');\r\n        if (urlTemplateId) {\r\n            return urlTemplateId;\r\n        }\r\n        return null;\r\n    }, []);\r\n    const isEditingExistingTemplate = () => {\r\n        return getTemplateIdFromUrl() !== null;\r\n    };\r\n    // Charger un template existant\r\n    const loadExistingTemplate = useCallback(async (templateId) => {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o;\r\n        console.log(' [useTemplate] loadExistingTemplate called with templateId:', templateId);\r\n        console.log(' [useTemplate] window.pdfBuilderData at start:', window.pdfBuilderData);\r\n        console.log(' [useTemplate] window.pdfBuilderData?.ajaxUrl:', (_a = window.pdfBuilderData) === null || _a === void 0 ? void 0 : _a.ajaxUrl);\r\n        console.log(' [useTemplate] window.pdfBuilderData?.nonce:', (_b = window.pdfBuilderData) === null || _b === void 0 ? void 0 : _b.nonce);\r\n        console.log(' [useTemplate] window keys containing pdfBuilder:', Object.keys(window).filter(key => key.includes('pdfBuilder')));\r\n        console.log(' [useTemplate] window.pdfBuilderData?.existingTemplate:', (_c = window.pdfBuilderData) === null || _c === void 0 ? void 0 : _c.existingTemplate);\r\n        console.log(' [useTemplate] window.pdfBuilderData?.hasExistingData:', (_d = window.pdfBuilderData) === null || _d === void 0 ? void 0 : _d.hasExistingData);\r\n        try {\r\n            //  PRIORIT: Utiliser les donnes localises si disponibles (plus rapide et fiable)\r\n            if (((_e = window.pdfBuilderData) === null || _e === void 0 ? void 0 : _e.existingTemplate) && ((_f = window.pdfBuilderData) === null || _f === void 0 ? void 0 : _f.hasExistingData)) {\r\n                console.log(' [useTemplate] USING LOCALIZED DATA PATH for template:', templateId);\r\n                const templateData = window.pdfBuilderData.existingTemplate;\r\n                console.log(' [useTemplate] templateData:', templateData);\r\n                console.log(' [useTemplate] templateData.name:', templateData === null || templateData === void 0 ? void 0 : templateData.name);\r\n                console.log(' [useTemplate] templateData._db_name:', templateData === null || templateData === void 0 ? void 0 : templateData._db_name);\r\n                console.log(' [useTemplate] templateData keys:', Object.keys(templateData || {}));\r\n                // Utiliser le nom du JSON en priorit (s'il existe et n'est pas vide), sinon le nom de la DB, sinon fallback explicite\r\n                const templateName = ((templateData === null || templateData === void 0 ? void 0 : templateData.name) && templateData.name.trim() !== '') ?\r\n                    templateData.name :\r\n                    ((templateData === null || templateData === void 0 ? void 0 : templateData._db_name) && templateData._db_name.trim() !== '') ?\r\n                        templateData._db_name :\r\n                        `[NOM NON RCUPR - ID: ${templateId}]`;\r\n                console.log(' [useTemplate] Final template name:', templateName);\r\n                // console.log(' [LOAD TEMPLATE] Utilisation des donnes localises pour template:', templateId, 'Nom:', templateData.name);\r\n                // Parse JSON strings if needed\r\n                let elements = [];\r\n                let canvasData = null;\r\n                try {\r\n                    if (typeof templateData.elements === 'string') {\r\n                        elements = JSON.parse(templateData.elements);\r\n                    }\r\n                    else if (Array.isArray(templateData.elements)) {\r\n                        elements = templateData.elements;\r\n                    }\r\n                    else {\r\n                        elements = [];\r\n                    }\r\n                    if (templateData.canvasWidth && templateData.canvasHeight) {\r\n                        canvasData = {\r\n                            width: templateData.canvasWidth,\r\n                            height: templateData.canvasHeight\r\n                        };\r\n                    }\r\n                    else if (typeof templateData.canvas === 'string') {\r\n                        canvasData = JSON.parse(templateData.canvas);\r\n                    }\r\n                    else if (templateData.canvas && typeof templateData.canvas === 'object') {\r\n                        canvasData = templateData.canvas;\r\n                    }\r\n                    else {\r\n                        canvasData = { width: 210, height: 297 };\r\n                    }\r\n                }\r\n                catch (parseError) {\r\n                    debugError(' [LOAD TEMPLATE] Erreur de parsing des donnes localises:', parseError);\r\n                    elements = [];\r\n                    canvasData = { width: 210, height: 297 };\r\n                }\r\n                const normalizedElements = normalizeElementsAfterLoad(elements);\r\n                const enrichedElements = normalizedElements.map((el) => {\r\n                    let enrichedElement = { ...el };\r\n                    if (el.type === 'company_logo' && !el.src && !el.logoUrl) {\r\n                        const logoUrl = el.defaultSrc || '';\r\n                        if (logoUrl) {\r\n                            enrichedElement.src = logoUrl;\r\n                        }\r\n                    }\r\n                    if (enrichedElement.createdAt) {\r\n                        try {\r\n                            const createdAt = new Date(enrichedElement.createdAt);\r\n                            enrichedElement.createdAt = isNaN(createdAt.getTime()) ? new Date() : createdAt;\r\n                        }\r\n                        catch (_a) {\r\n                            enrichedElement.createdAt = new Date();\r\n                        }\r\n                    }\r\n                    else {\r\n                        enrichedElement.createdAt = new Date();\r\n                    }\r\n                    if (enrichedElement.updatedAt) {\r\n                        try {\r\n                            const updatedAt = new Date(enrichedElement.updatedAt);\r\n                            enrichedElement.updatedAt = isNaN(updatedAt.getTime()) ? new Date() : updatedAt;\r\n                        }\r\n                        catch (_b) {\r\n                            enrichedElement.updatedAt = new Date();\r\n                        }\r\n                    }\r\n                    else {\r\n                        enrichedElement.updatedAt = new Date();\r\n                    }\r\n                    return enrichedElement;\r\n                });\r\n                let lastSavedDate;\r\n                try {\r\n                    if (templateData.updated_at) {\r\n                        lastSavedDate = new Date(templateData.updated_at);\r\n                        if (isNaN(lastSavedDate.getTime())) {\r\n                            lastSavedDate = new Date();\r\n                        }\r\n                    }\r\n                    else {\r\n                        lastSavedDate = new Date();\r\n                    }\r\n                }\r\n                catch (_p) {\r\n                    lastSavedDate = new Date();\r\n                }\r\n                dispatch({\r\n                    type: 'LOAD_TEMPLATE',\r\n                    payload: {\r\n                        id: templateId,\r\n                        name: templateName,\r\n                        elements: enrichedElements,\r\n                        canvas: canvasData,\r\n                        lastSaved: lastSavedDate\r\n                    }\r\n                });\r\n                return true;\r\n            }\r\n            //  FALLBACK: Utiliser AJAX si les donnes localises ne sont pas disponibles\r\n            console.log(' [useTemplate] USING AJAX FALLBACK PATH for template:', templateId);\r\n            console.log(' [useTemplate] Checking window.pdfBuilderData again:', window.pdfBuilderData);\r\n            console.log(' [useTemplate] ajaxUrl for AJAX call:', (_g = window.pdfBuilderData) === null || _g === void 0 ? void 0 : _g.ajaxUrl);\r\n            console.log(' [useTemplate] nonce for AJAX call:', (_h = window.pdfBuilderData) === null || _h === void 0 ? void 0 : _h.nonce);\r\n            // Dtecter le navigateur pour des en-ttes spcifiques\r\n            const isChrome = typeof navigator !== 'undefined' &&\r\n                /Chrome/.test(navigator.userAgent) &&\r\n                /Google Inc/.test(navigator.vendor);\r\n            const isFirefox = typeof navigator !== 'undefined' &&\r\n                /Firefox/.test(navigator.userAgent);\r\n            const isSafari = typeof navigator !== 'undefined' &&\r\n                /Safari/.test(navigator.userAgent) &&\r\n                !/Chrome/.test(navigator.userAgent) &&\r\n                !/Chromium/.test(navigator.userAgent);\r\n            console.log(' [useTemplate] Browser detection:', { isChrome, isFirefox, isSafari });\r\n            // Prparer les options fetch avec des en-ttes spcifiques par navigateur\r\n            const fetchOptions = {\r\n                method: 'GET',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'X-Requested-With': 'XMLHttpRequest',\r\n                    // En-ttes anti-cache spcifiques\r\n                    'Cache-Control': 'no-cache, no-store, must-revalidate',\r\n                    'Pragma': 'no-cache',\r\n                    'Expires': '0'\r\n                },\r\n                // Mode spcifique selon le navigateur\r\n                mode: 'cors',\r\n                credentials: 'same-origin'\r\n            };\r\n            // Ajustements spcifiques par navigateur\r\n            if (isChrome) {\r\n                // Chrome peut avoir besoin d'un mode plus permissif\r\n                fetchOptions.mode = 'cors';\r\n                fetchOptions.cache = 'no-cache';\r\n                console.log(' [useTemplate] Using Chrome-specific options');\r\n            }\r\n            else if (isFirefox) {\r\n                // Firefox gre bien le cache par dfaut\r\n                fetchOptions.cache = 'no-cache';\r\n                console.log(' [useTemplate] Using Firefox-specific options');\r\n            }\r\n            else if (isSafari) {\r\n                // Safari peut avoir des problmes avec certains modes\r\n                fetchOptions.mode = 'cors';\r\n                console.log(' [useTemplate] Using Safari-specific options');\r\n            }\r\n            const cacheBreaker = Date.now();\r\n            const url = `${(_j = window.pdfBuilderData) === null || _j === void 0 ? void 0 : _j.ajaxUrl}?action=pdf_builder_get_template&template_id=${templateId}&nonce=${(_k = window.pdfBuilderData) === null || _k === void 0 ? void 0 : _k.nonce}&t=${cacheBreaker}`;\r\n            console.log(' [useTemplate] About to fetch URL:', url);\r\n            console.log(' [useTemplate] Fetch options:', fetchOptions);\r\n            const response = await fetch(url, fetchOptions);\r\n            if (!response.ok) {\r\n                const errorText = await response.text();\r\n                debugError('[useTemplate] Response error text:', errorText);\r\n                throw new Error(`Erreur HTTP ${response.status}: ${response.statusText}`);\r\n            }\r\n            const result = await response.json();\r\n            if (!result.success) {\r\n                throw new Error(result.data || 'Erreur lors du chargement du template');\r\n            }\r\n            console.log(' [useTemplate] AJAX result:', result);\r\n            console.log(' [useTemplate] result.data:', result.data);\r\n            console.log(' [useTemplate] result.template:', result.template);\r\n            console.log(' [useTemplate] result.template_name:', result.template_name);\r\n            const templateData = result.data ? result.data.template : result.template;\r\n            const ajaxTemplateName = result.data ? (result.data.template_name || result.data.name) : (result.name || result.template_name);\r\n            console.log(' [useTemplate] templateData:', templateData);\r\n            console.log(' [useTemplate] ajaxTemplateName:', ajaxTemplateName);\r\n            // Appliquer la mme logique de fallback que pour les donnes localises\r\n            const templateName = (ajaxTemplateName && ajaxTemplateName.trim() !== '') ?\r\n                ajaxTemplateName :\r\n                ((templateData === null || templateData === void 0 ? void 0 : templateData.name) && templateData.name.trim() !== '') ?\r\n                    templateData.name :\r\n                    `[NOM NON RCUPR - ID: ${templateId}]`;\r\n            //  Tracer les lments reus du serveur\r\n            if (templateData.elements) {\r\n                //  Vrifier spcifiquement les lments order_number\r\n                const orderNumberElements = templateData.elements.filter((el) => el.type === 'order_number');\r\n            }\r\n            // Parse JSON strings\r\n            let elements = [];\r\n            let canvasData = null;\r\n            try {\r\n                // Check if elements is already an object or needs parsing\r\n                if (typeof templateData.elements === 'string') {\r\n                    elements = JSON.parse(templateData.elements);\r\n                }\r\n                else if (Array.isArray(templateData.elements)) {\r\n                    elements = templateData.elements;\r\n                }\r\n                else {\r\n                    elements = [];\r\n                }\r\n                //  CORRECTION: Support both old format (canvas: {width, height}) and new format (canvasWidth, canvasHeight)\r\n                if (templateData.canvasWidth && templateData.canvasHeight) {\r\n                    canvasData = {\r\n                        width: templateData.canvasWidth,\r\n                        height: templateData.canvasHeight\r\n                    };\r\n                }\r\n                else if (typeof templateData.canvas === 'string') {\r\n                    canvasData = JSON.parse(templateData.canvas);\r\n                }\r\n                else if (templateData.canvas && typeof templateData.canvas === 'object') {\r\n                    canvasData = templateData.canvas;\r\n                }\r\n                else {\r\n                    canvasData = { width: 210, height: 297 };\r\n                }\r\n            }\r\n            catch (parseError) {\r\n                debugError(' [LOAD TEMPLATE] Erreur de parsing:', parseError);\r\n                elements = [];\r\n                canvasData = { width: 210, height: 297 };\r\n            }\r\n            //  NORMALISER LES LMENTS APRS CHARGE (CRITIQUE!)\r\n            // Cela garantit que contentAlign, labelPosition, etc. sont prservs\r\n            const normalizedElements = normalizeElementsAfterLoad(elements);\r\n            debugElementState(normalizedElements, 'APRS CHARGEMENT');\r\n            //  Enrichir les lments company_logo avec src si manquant et convertir les dates\r\n            const enrichedElements = normalizedElements.map((el) => {\r\n                let enrichedElement = { ...el };\r\n                //  CORRECTION: Enrichir les lments company_logo SEULEMENT si src ET logoUrl sont vides\r\n                if (el.type === 'company_logo' && !el.src && !el.logoUrl) {\r\n                    // Essayer d'obtenir le logo depuis les proprits de l'lment\r\n                    const logoUrl = el.defaultSrc || '';\r\n                    if (logoUrl) {\r\n                        enrichedElement.src = logoUrl;\r\n                    }\r\n                }\r\n                // Convertir les proprits de date en objets Date valides\r\n                if (enrichedElement.createdAt) {\r\n                    try {\r\n                        const createdAt = new Date(enrichedElement.createdAt);\r\n                        enrichedElement.createdAt = isNaN(createdAt.getTime()) ? new Date() : createdAt;\r\n                    }\r\n                    catch (_a) {\r\n                        enrichedElement.createdAt = new Date();\r\n                    }\r\n                }\r\n                else {\r\n                    enrichedElement.createdAt = new Date();\r\n                }\r\n                if (enrichedElement.updatedAt) {\r\n                    try {\r\n                        const updatedAt = new Date(enrichedElement.updatedAt);\r\n                        enrichedElement.updatedAt = isNaN(updatedAt.getTime()) ? new Date() : updatedAt;\r\n                    }\r\n                    catch (_b) {\r\n                        enrichedElement.updatedAt = new Date();\r\n                    }\r\n                }\r\n                else {\r\n                    enrichedElement.updatedAt = new Date();\r\n                }\r\n                return enrichedElement;\r\n            });\r\n            enrichedElements.slice(0, 3).forEach((_el, _idx) => {\r\n            });\r\n            // Crer une date valide pour lastSaved\r\n            let lastSavedDate;\r\n            try {\r\n                if (templateData.updated_at) {\r\n                    lastSavedDate = new Date(templateData.updated_at);\r\n                    // Vrifier si la date est valide\r\n                    if (isNaN(lastSavedDate.getTime())) {\r\n                        lastSavedDate = new Date();\r\n                    }\r\n                }\r\n                else {\r\n                    lastSavedDate = new Date();\r\n                }\r\n            }\r\n            catch (_q) {\r\n                lastSavedDate = new Date();\r\n            }\r\n            //  Log final des lments order_number avant envoi au contexte\r\n            const finalOrderNumberElements = enrichedElements.filter((el) => el.type === 'order_number');\r\n            dispatch({\r\n                type: 'LOAD_TEMPLATE',\r\n                payload: {\r\n                    id: templateId,\r\n                    name: templateName,\r\n                    elements: enrichedElements,\r\n                    canvas: canvasData,\r\n                    lastSaved: lastSavedDate\r\n                }\r\n            });\r\n            return true;\r\n        }\r\n        catch (error) {\r\n            debugError(' [LOAD TEMPLATE] Erreur lors du chargement:', error);\r\n            // Diagnostics spcifiques selon le navigateur\r\n            const isChrome = typeof navigator !== 'undefined' &&\r\n                /Chrome/.test(navigator.userAgent) &&\r\n                /Google Inc/.test(navigator.vendor);\r\n            const isFirefox = typeof navigator !== 'undefined' &&\r\n                /Firefox/.test(navigator.userAgent);\r\n            const isSafari = typeof navigator !== 'undefined' &&\r\n                /Safari/.test(navigator.userAgent) &&\r\n                !/Chrome/.test(navigator.userAgent) &&\r\n                !/Chromium/.test(navigator.userAgent);\r\n            debugError(` [LOAD TEMPLATE] chec du chargement sur ${isChrome ? 'Chrome' : isFirefox ? 'Firefox' : isSafari ? 'Safari' : 'navigateur inconnu'}`);\r\n            debugError(' [LOAD TEMPLATE] Dtails de l\\'erreur:', {\r\n                message: error instanceof Error ? error.message : 'Unknown error',\r\n                stack: error instanceof Error ? error.stack : undefined,\r\n                name: error instanceof Error ? error.name : 'Unknown',\r\n                templateId: templateId,\r\n                ajaxUrl: (_l = window.pdfBuilderData) === null || _l === void 0 ? void 0 : _l.ajaxUrl,\r\n                userAgent: navigator.userAgent\r\n            });\r\n            // Tentative de fallback pour Chrome\r\n            if (isChrome && (error instanceof Error && error.message.includes('fetch'))) {\r\n                debugWarn(' [LOAD TEMPLATE] Tentative de fallback pour Chrome - Nouvelle tentative avec options diffrentes');\r\n                try {\r\n                    // Attendre un peu avant retry\r\n                    await new Promise(resolve => setTimeout(resolve, 1000));\r\n                    // Retry avec des options diffrentes\r\n                    const fallbackOptions = {\r\n                        method: 'GET',\r\n                        headers: {\r\n                            'Accept': 'application/json, text/plain, */*',\r\n                            'X-Requested-With': 'XMLHttpRequest'\r\n                        },\r\n                        mode: 'no-cors',\r\n                        cache: 'reload'\r\n                    };\r\n                    const fallbackUrl = `${(_m = window.pdfBuilderData) === null || _m === void 0 ? void 0 : _m.ajaxUrl}?action=pdf_builder_get_template&template_id=${templateId}&nonce=${(_o = window.pdfBuilderData) === null || _o === void 0 ? void 0 : _o.nonce}&fallback=1&t=${Date.now()}`;\r\n                    const fallbackResponse = await fetch(fallbackUrl, fallbackOptions);\r\n                    if (fallbackResponse.ok || fallbackResponse.status === 0) { // no-cors peut retourner status 0\r\n                        // Traiter la rponse mme si elle est opaque\r\n                        return true;\r\n                    }\r\n                }\r\n                catch (fallbackError) {\r\n                    debugError(' [LOAD TEMPLATE] chec du fallback:', fallbackError);\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n    }, [dispatch]);\r\n    //  DISABLED: Event-based template loading causes race conditions with useEffect\r\n    // Both methods try to load the same template, causing flashing/alternating canvas\r\n    // The useEffect approach (reading URL) is more reliable and runs once per page load\r\n    useEffect(() => {\r\n        //  Event listener disabled to prevent race conditions\r\n        // Only useEffect with URL reading will load templates now\r\n        return () => {\r\n            // cleanup\r\n        };\r\n    }, []);\r\n    // Effet pour charger automatiquement un template existant au montage\r\n    //  Dpendance vide: charger une seule fois au montage du composant\r\n    useEffect(() => {\r\n        const templateId = getTemplateIdFromUrl();\r\n        if (templateId) {\r\n            // Timeout de scurit : forcer isLoading  false aprs 10 secondes si le chargement choue\r\n            const loadingTimeout = setTimeout(() => {\r\n                debugError('[useTemplate] Loading timeout reached, forcing isLoading to false');\r\n                dispatch({ type: 'SET_TEMPLATE_LOADING', payload: false });\r\n            }, 10000);\r\n            // Charger le template avec gestion d'erreur amliore\r\n            loadExistingTemplate(templateId)\r\n                .then(() => {\r\n                clearTimeout(loadingTimeout);\r\n            })\r\n                .catch((error) => {\r\n                clearTimeout(loadingTimeout);\r\n                debugError('[useTemplate] Template loading failed:', error);\r\n                // Force isLoading to false on error\r\n                dispatch({ type: 'SET_TEMPLATE_LOADING', payload: false });\r\n            });\r\n        }\r\n        else {\r\n            // Si pas de template ID, forcer isLoading  false pour nouveau template\r\n            dispatch({ type: 'NEW_TEMPLATE' });\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n    // Sauvegarder un template manuellement\r\n    const saveTemplate = useCallback(async () => {\r\n        var _a, _b, _c, _d;\r\n        // console.log('[PDF_BUILDER_FRONTEND] Starting template save...');\r\n        dispatch({ type: 'SET_TEMPLATE_SAVING', payload: true });\r\n        try {\r\n            const templateId = getTemplateIdFromUrl();\r\n            // console.log('[PDF_BUILDER_FRONTEND] Template ID:', templateId);\r\n            if (!templateId) {\r\n                throw new Error('Aucun template charg pour la sauvegarde');\r\n            }\r\n            // Vrifier que le template est compltement charg\r\n            if (!state.template.name || state.template.name.trim() === '') {\r\n                // console.log('[PDF_BUILDER_FRONTEND] Template name not loaded yet, skipping save');\r\n                return; // Ne pas lancer d'erreur, juste ignorer\r\n            }\r\n            // console.log('[PDF_BUILDER_FRONTEND] Template name:', state.template.name);\r\n            if (!((_a = window.pdfBuilderData) === null || _a === void 0 ? void 0 : _a.ajaxUrl)) {\r\n                throw new Error('URL AJAX non disponible');\r\n            }\r\n            if (!((_b = window.pdfBuilderData) === null || _b === void 0 ? void 0 : _b.nonce)) {\r\n                throw new Error('Nonce non disponible');\r\n            }\r\n            // console.log('[PDF_BUILDER_FRONTEND] AJAX URL available:', !!window.pdfBuilderData?.ajaxUrl);\r\n            // console.log('[PDF_BUILDER_FRONTEND] Nonce available:', !!window.pdfBuilderData?.nonce);\r\n            //  NORMALISER LES LMENTS AVANT SAUVEGARDE\r\n            // Cela garantit que contentAlign, labelPosition, etc. ne sont jamais perdus\r\n            const normalizedElements = normalizeElementsBeforeSave(state.elements);\r\n            debugElementState(normalizedElements, 'AVANT SAUVEGARDE');\r\n            //  DEBUG: Log complet des proprits des lments avant sauvegarde\r\n            // console.log('[PDF_BUILDER_FRONTEND] lments avant normalisation:', state.elements);\r\n            // console.log('[PDF_BUILDER_FRONTEND] lments aprs normalisation:', normalizedElements);\r\n            // Vrifier les proprits spciales\r\n            normalizedElements.forEach((el, idx) => {\r\n                // console.log(`[PDF_BUILDER_FRONTEND] lment ${idx} (${el.type}) proprits:`, Object.keys(el));\r\n                // Chercher des proprits avec emoji ou \"interactions\"\r\n                Object.keys(el).forEach(key => {\r\n                    if (key.includes('') || key.includes('interactions') || key.includes('comportement') || key.includes('behavior')) {\r\n                        // console.log(`[PDF_BUILDER_FRONTEND] Proprit spciale trouve: ${key} =`, el[key]);\r\n                    }\r\n                });\r\n            });\r\n            // Structure simple et propre pour la sauvegarde\r\n            const templateData = {\r\n                elements: normalizedElements,\r\n                canvasWidth: canvasWidth,\r\n                canvasHeight: canvasHeight,\r\n                version: '1.0',\r\n                // Inclure les paramtres du template\r\n                name: state.template.name,\r\n                description: state.template.description,\r\n                showGuides: state.template.showGuides,\r\n                snapToGrid: state.template.snapToGrid,\r\n                marginTop: state.template.marginTop,\r\n                marginBottom: state.template.marginBottom\r\n            };\r\n            const formData = new FormData();\r\n            formData.append('action', 'pdf_builder_save_template');\r\n            formData.append('template_id', templateId);\r\n            formData.append('template_name', state.template.name || 'Nouveau template');\r\n            formData.append('template_description', state.template.description || '');\r\n            formData.append('template_data', JSON.stringify(templateData));\r\n            formData.append('nonce', ((_c = window.pdfBuilderData) === null || _c === void 0 ? void 0 : _c.nonce) || '');\r\n            // Ajouter les paramtres du template\r\n            formData.append('show_guides', state.template.showGuides ? '1' : '0');\r\n            formData.append('snap_to_grid', state.template.snapToGrid ? '1' : '0');\r\n            formData.append('margin_top', (state.template.marginTop || 0).toString());\r\n            formData.append('margin_bottom', (state.template.marginBottom || 0).toString());\r\n            formData.append('canvas_width', (state.template.canvasWidth || canvasWidth).toString());\r\n            formData.append('canvas_height', (state.template.canvasHeight || canvasHeight).toString());\r\n            // console.log('[PDF_BUILDER_FRONTEND] Data to send:');\r\n            // console.log('- Template ID:', templateId);\r\n            // console.log('- Template Name:', state.template.name || 'Nouveau template');\r\n            // console.log('- Elements count:', normalizedElements.length);\r\n            // console.log('- Canvas size:', canvasWidth, 'x', canvasHeight);\r\n            // console.log('- Template data size:', JSON.stringify(templateData).length, 'characters');\r\n            // console.log('- Nonce:', window.pdfBuilderData?.nonce ? 'Present' : 'Missing');\r\n            const response = await fetch(((_d = window.pdfBuilderData) === null || _d === void 0 ? void 0 : _d.ajaxUrl) || '', {\r\n                method: 'POST',\r\n                body: formData\r\n            });\r\n            // console.log('[PDF_BUILDER_FRONTEND] HTTP Response status:', response.status);\r\n            if (!response.ok) {\r\n                throw new Error(`Erreur HTTP: ${response.status}`);\r\n            }\r\n            const result = await response.json();\r\n            // console.log('[PDF_BUILDER_FRONTEND] Server response:', result);\r\n            if (!result.success) {\r\n                debugError('[PDF_BUILDER_FRONTEND] Server returned error:', result.data);\r\n                const errorMessage = result.data || 'Unknown error during save';\r\n                throw new Error(errorMessage);\r\n            }\r\n            // console.log('[PDF_BUILDER_FRONTEND] Save successful! Template ID:', result.data?.template_id);\r\n            dispatch({\r\n                type: 'SAVE_TEMPLATE',\r\n                payload: {\r\n                    id: result.data.template_id || result.data.id,\r\n                    name: result.data.name\r\n                }\r\n            });\r\n        }\r\n        catch (error) {\r\n            debugError('[PDF_BUILDER_FRONTEND] Save failed:', error);\r\n            debugError('[useTemplate] SAVE - Error:', error);\r\n            throw error;\r\n        }\r\n        finally {\r\n            dispatch({ type: 'SET_TEMPLATE_SAVING', payload: false });\r\n        }\r\n    }, [state.elements, state.template.name, dispatch, canvasWidth, canvasHeight, getTemplateIdFromUrl]);\r\n    const previewTemplate = useCallback(() => {\r\n        dispatch({ type: 'SET_SHOW_PREVIEW_MODAL', payload: true });\r\n    }, [dispatch]);\r\n    const newTemplate = useCallback(() => {\r\n        dispatch({ type: 'NEW_TEMPLATE' });\r\n    }, [dispatch]);\r\n    const setTemplateModified = useCallback((modified) => {\r\n        dispatch({ type: 'SET_TEMPLATE_MODIFIED', payload: modified });\r\n    }, [dispatch]);\r\n    const updateTemplateSettings = useCallback((settings) => {\r\n        dispatch({ type: 'UPDATE_TEMPLATE_SETTINGS', payload: settings });\r\n    }, [dispatch]);\r\n    return {\r\n        templateName: state.template.name,\r\n        templateDescription: state.template.description,\r\n        templateTags: state.template.tags,\r\n        canvasWidth: state.template.canvasWidth,\r\n        canvasHeight: state.template.canvasHeight,\r\n        marginTop: state.template.marginTop,\r\n        marginBottom: state.template.marginBottom,\r\n        showGuides: state.template.showGuides,\r\n        snapToGrid: state.template.snapToGrid,\r\n        isNewTemplate: state.template.isNew,\r\n        isModified: state.template.isModified,\r\n        isSaving: state.template.isSaving,\r\n        isLoading: state.template.isLoading,\r\n        lastSaved: state.template.lastSaved,\r\n        isEditingExistingTemplate: isEditingExistingTemplate(),\r\n        saveTemplate,\r\n        previewTemplate,\r\n        newTemplate,\r\n        setTemplateModified,\r\n        updateTemplateSettings\r\n    };\r\n}\r\n","/**\r\n * Constantes pour les dimensions du PDF Builder\r\n *\r\n * IMPORTANT: Le systme utilise UNIQUEMENT les PIXELS (PX)\r\n * Les dimensions sont maintenant dynamiques selon les paramtres sauvegards\r\n */\r\n// Fonction pour rcuprer les dimensions depuis les paramtres WordPress\r\nexport const getCanvasDimensions = () => {\r\n    var _a, _b;\r\n    // Rcuprer les dimensions depuis les paramtres sauvegards\r\n    const width = ((_a = window.pdfBuilderCanvasSettings) === null || _a === void 0 ? void 0 : _a.default_canvas_width) ||\r\n        parseInt(localStorage.getItem('pdf_builder_canvas_width') || '794');\r\n    const height = ((_b = window.pdfBuilderCanvasSettings) === null || _b === void 0 ? void 0 : _b.default_canvas_height) ||\r\n        parseInt(localStorage.getItem('pdf_builder_canvas_height') || '1123');\r\n    return {\r\n        width: Math.max(100, Math.min(3000, width)),\r\n        height: Math.max(100, Math.min(3000, height))\r\n    };\r\n};\r\n// Dimensions par dfaut pour le rendu canvas (rcupres dynamiquement)\r\nexport const DEFAULT_CANVAS_WIDTH = getCanvasDimensions().width;\r\nexport const DEFAULT_CANVAS_HEIGHT = getCanvasDimensions().height;\r\n// Dimensions A4 en PIXELS (pour rfrence uniquement)\r\nexport const CANVAS_DIMENSIONS = {\r\n    A4_PORTRAIT: {\r\n        width: 794,\r\n        height: 1123,\r\n        name: 'A4 Portrait'\r\n    },\r\n    A4_LANDSCAPE: {\r\n        width: 1123,\r\n        height: 794,\r\n        name: 'A4 Landscape'\r\n    }\r\n};\r\n","/**\r\n * Utilitaires CSS pour le responsive design\r\n * Classes utilitaires pour une gestion simplifie du responsive\r\n */\r\nimport { BREAKPOINTS } from '../constants/responsive';\r\n/**\r\n * Gnre des classes CSS responsive\r\n */\r\nexport const responsiveUtils = `\r\n/* Utilitaires responsive automatiques */\r\n\r\n/* Visibilit */\r\n.hidden-xs { display: none !important; }\r\n.hidden-sm { display: none !important; }\r\n.hidden-md { display: none !important; }\r\n.hidden-lg { display: none !important; }\r\n.hidden-xl { display: none !important; }\r\n\r\n.visible-xs { display: block !important; }\r\n.visible-sm { display: block !important; }\r\n.visible-md { display: block !important; }\r\n.visible-lg { display: block !important; }\r\n.visible-xl { display: block !important; }\r\n\r\n/* Media queries pour la visibilit */\r\n@media (min-width: ${BREAKPOINTS.xs}px) {\r\n  .hidden-xs { display: inherit !important; }\r\n  .visible-xs { display: none !important; }\r\n}\r\n\r\n@media (min-width: ${BREAKPOINTS.sm}px) {\r\n  .hidden-sm { display: inherit !important; }\r\n  .visible-sm { display: none !important; }\r\n}\r\n\r\n@media (min-width: ${BREAKPOINTS.md}px) {\r\n  .hidden-md { display: inherit !important; }\r\n  .visible-md { display: none !important; }\r\n}\r\n\r\n@media (min-width: ${BREAKPOINTS.lg}px) {\r\n  .hidden-lg { display: inherit !important; }\r\n  .visible-lg { display: none !important; }\r\n}\r\n\r\n@media (min-width: ${BREAKPOINTS.xl}px) {\r\n  .hidden-xl { display: inherit !important; }\r\n  .visible-xl { display: none !important; }\r\n}\r\n\r\n/* Flex utilities responsive */\r\n.flex-column-xs { flex-direction: column !important; }\r\n.flex-column-sm { flex-direction: column !important; }\r\n.flex-column-md { flex-direction: column !important; }\r\n.flex-row-xs { flex-direction: row !important; }\r\n.flex-row-sm { flex-direction: row !important; }\r\n.flex-row-md { flex-direction: row !important; }\r\n\r\n/* Text alignment responsive */\r\n.text-center-xs { text-align: center !important; }\r\n.text-center-sm { text-align: center !important; }\r\n.text-center-md { text-align: center !important; }\r\n.text-left-xs { text-align: left !important; }\r\n.text-left-sm { text-align: left !important; }\r\n.text-left-md { text-align: left !important; }\r\n.text-right-xs { text-align: right !important; }\r\n.text-right-sm { text-align: right !important; }\r\n.text-right-md { text-align: right !important; }\r\n\r\n/* Spacing responsive */\r\n.m-0-xs { margin: 0 !important; }\r\n.m-0-sm { margin: 0 !important; }\r\n.m-0-md { margin: 0 !important; }\r\n.p-0-xs { padding: 0 !important; }\r\n.p-0-sm { padding: 0 !important; }\r\n.p-0-md { padding: 0 !important; }\r\n\r\n/* Width responsive */\r\n.w-100-xs { width: 100% !important; }\r\n.w-100-sm { width: 100% !important; }\r\n.w-100-md { width: 100% !important; }\r\n.w-auto-xs { width: auto !important; }\r\n.w-auto-sm { width: auto !important; }\r\n.w-auto-md { width: auto !important; }\r\n\r\n/* Container responsive */\r\n.container-fluid-xs { width: 100% !important; padding-left: 15px !important; padding-right: 15px !important; }\r\n.container-fluid-sm { width: 100% !important; padding-left: 15px !important; padding-right: 15px !important; }\r\n.container-xs { max-width: 100% !important; margin: 0 auto !important; }\r\n.container-sm { max-width: 100% !important; margin: 0 auto !important; }\r\n\r\n/* Media queries pour les utilitaires */\r\n@media (min-width: ${BREAKPOINTS.xs}px) {\r\n  .flex-column-xs { flex-direction: row !important; }\r\n  .flex-row-xs { flex-direction: column !important; }\r\n  .text-center-xs { text-align: inherit !important; }\r\n  .text-left-xs { text-align: inherit !important; }\r\n  .text-right-xs { text-align: inherit !important; }\r\n  .m-0-xs { margin: inherit !important; }\r\n  .p-0-xs { padding: inherit !important; }\r\n  .w-100-xs { width: inherit !important; }\r\n  .w-auto-xs { width: inherit !important; }\r\n  .container-fluid-xs { width: inherit !important; padding-left: inherit !important; padding-right: inherit !important; }\r\n  .container-xs { max-width: inherit !important; }\r\n}\r\n\r\n@media (min-width: ${BREAKPOINTS.sm}px) {\r\n  .flex-column-sm { flex-direction: row !important; }\r\n  .flex-row-sm { flex-direction: column !important; }\r\n  .text-center-sm { text-align: inherit !important; }\r\n  .text-left-sm { text-align: inherit !important; }\r\n  .text-right-sm { text-align: inherit !important; }\r\n  .m-0-sm { margin: inherit !important; }\r\n  .p-0-sm { padding: inherit !important; }\r\n  .w-100-sm { width: inherit !important; }\r\n  .w-auto-sm { width: inherit !important; }\r\n  .container-fluid-sm { width: inherit !important; padding-left: inherit !important; padding-right: inherit !important; }\r\n  .container-sm { max-width: inherit !important; }\r\n}\r\n\r\n@media (min-width: ${BREAKPOINTS.md}px) {\r\n  .flex-column-md { flex-direction: row !important; }\r\n  .flex-row-md { flex-direction: column !important; }\r\n  .text-center-md { text-align: inherit !important; }\r\n  .text-left-md { text-align: inherit !important; }\r\n  .text-right-md { text-align: inherit !important; }\r\n  .m-0-md { margin: inherit !important; }\r\n  .p-0-md { padding: inherit !important; }\r\n  .w-100-md { width: inherit !important; }\r\n  .w-auto-md { width: inherit !important; }\r\n}\r\n`;\r\n/**\r\n * Injecte les utilitaires CSS responsive dans le DOM\r\n */\r\nexport function injectResponsiveUtils() {\r\n    if (typeof document === 'undefined')\r\n        return;\r\n    const existingStyle = document.getElementById('pdf-builder-responsive-utils');\r\n    if (existingStyle)\r\n        return;\r\n    const style = document.createElement('style');\r\n    style.id = 'pdf-builder-responsive-utils';\r\n    style.textContent = responsiveUtils;\r\n    document.head.appendChild(style);\r\n}\r\n","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\r\nimport React, { useState, useEffect, memo, useCallback } from 'react';\r\nimport { Canvas } from './canvas/Canvas';\r\nimport { Toolbar } from './toolbar/Toolbar';\r\nimport { PropertiesPanel } from './properties/PropertiesPanel';\r\nimport { Header } from './header/Header';\r\nimport { ElementLibrary } from './element-library/ElementLibrary';\r\nimport { useTemplate } from '../hooks/useTemplate';\r\nimport { useCanvasSettings } from '../contexts/CanvasSettingsContext';\r\nimport { DEFAULT_CANVAS_WIDTH, DEFAULT_CANVAS_HEIGHT } from '../constants/canvas';\r\nimport { injectResponsiveUtils } from '../utils/responsive';\r\nimport { useIsMobile, useIsTablet } from '../hooks/useResponsive';\r\nimport { debugLog, debugError } from '../utils/debug';\r\n//  Add spin animation\r\nconst spinStyles = `\r\n  @keyframes spin {\r\n    0% { transform: rotate(0deg); }\r\n    100% { transform: rotate(360deg); }\r\n  }\r\n`;\r\n// Inject CSS\r\nif (typeof document !== 'undefined') {\r\n    const style = document.createElement('style');\r\n    style.textContent = spinStyles;\r\n    document.head.appendChild(style);\r\n}\r\nexport const PDFBuilderContent = memo(function PDFBuilderContent({ width = DEFAULT_CANVAS_WIDTH, height = DEFAULT_CANVAS_HEIGHT, className }) {\r\n    debugLog(' PDFBuilderContent: Component initialized with props:', { width, height, className });\r\n    const [isHeaderFixed, setIsHeaderFixed] = useState(false);\r\n    const [isPropertiesPanelOpen, setIsPropertiesPanelOpen] = useState(false);\r\n    const [manualSaveSuccess, setManualSaveSuccess] = useState(false);\r\n    debugLog(' PDFBuilderContent: Initial state set:', { isHeaderFixed, isPropertiesPanelOpen, manualSaveSuccess });\r\n    // Hooks responsives\r\n    const isMobile = useIsMobile();\r\n    const isTablet = useIsTablet();\r\n    debugLog(' PDFBuilderContent: Responsive hooks:', { isMobile, isTablet });\r\n    const { templateName, templateDescription, canvasWidth, canvasHeight, marginTop, marginBottom, showGuides, snapToGrid, isNewTemplate, isModified, isSaving, isLoading, //  NEW: Template is loading\r\n    isEditingExistingTemplate, saveTemplate, previewTemplate, newTemplate, updateTemplateSettings } = useTemplate();\r\n    debugLog(' PDFBuilderContent: useTemplate hook values:', {\r\n        templateName,\r\n        templateDescription,\r\n        canvasWidth,\r\n        canvasHeight,\r\n        marginTop,\r\n        marginBottom,\r\n        showGuides,\r\n        snapToGrid,\r\n        isNewTemplate,\r\n        isModified,\r\n        isSaving,\r\n        isLoading,\r\n        isEditingExistingTemplate\r\n    });\r\n    // Hook pour les paramtres du canvas\r\n    const canvasSettings = useCanvasSettings();\r\n    debugLog(' PDFBuilderContent: Canvas settings:', canvasSettings);\r\n    // Injection des utilitaires responsives\r\n    useEffect(() => {\r\n        debugLog(' PDFBuilderContent: Injecting responsive utils');\r\n        injectResponsiveUtils();\r\n        debugLog(' PDFBuilderContent: Responsive utils injected');\r\n    }, []);\r\n    // Effet pour grer le scroll et ajuster le padding\r\n    useEffect(() => {\r\n        debugLog(' PDFBuilderContent: Setting up scroll handler');\r\n        const handleScroll = () => {\r\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n            const newIsHeaderFixed = scrollTop > 100;\r\n            debugLog(' PDFBuilderContent: Scroll detected, scrollTop:', scrollTop, 'isHeaderFixed:', newIsHeaderFixed);\r\n            setIsHeaderFixed(newIsHeaderFixed);\r\n        };\r\n        window.addEventListener('scroll', handleScroll, { passive: true });\r\n        debugLog(' PDFBuilderContent: Scroll handler added');\r\n        return () => {\r\n            debugLog(' PDFBuilderContent: Cleaning up scroll handler');\r\n            window.removeEventListener('scroll', handleScroll);\r\n        };\r\n    }, []);\r\n    // Wrapper pour sauvegarder\r\n    const saveTemplateWithAutoSave = useCallback(async () => {\r\n        debugLog(' PDFBuilderContent: Manual save initiated');\r\n        try {\r\n            // Effectuer la sauvegarde manuelle\r\n            debugLog(' PDFBuilderContent: Calling saveTemplate...');\r\n            await saveTemplate();\r\n            debugLog(' PDFBuilderContent: Manual save successful');\r\n            debugLog('[PDF_BUILDER] Manual save successful');\r\n            // Afficher une notification de succs\r\n            if (typeof window !== 'undefined' && window.showSuccessNotification) {\r\n                debugLog(' PDFBuilderContent: Showing success notification');\r\n                window.showSuccessNotification('Template sauvegard avec succs !');\r\n            }\r\n        }\r\n        catch (manualSaveError) {\r\n            debugError(' PDFBuilderContent: Manual save failed:', manualSaveError);\r\n            debugError('[PDF_BUILDER] Manual save failed:', manualSaveError);\r\n            // Afficher une notification d'erreur\r\n            if (typeof window !== 'undefined' && window.showErrorNotification) {\r\n                debugLog(' PDFBuilderContent: Showing error notification');\r\n                window.showErrorNotification('Erreur lors de la sauvegarde du template');\r\n            }\r\n            throw manualSaveError; // Re-throw pour que l'UI montre l'erreur\r\n        }\r\n    }, [saveTemplate]);\r\n    return (_jsx(_Fragment, { children: _jsxs(\"div\", { className: `pdf-builder ${className || ''}`, style: {\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                width: '100%',\r\n                height: '100%',\r\n                gap: '0px',\r\n                padding: '0px',\r\n                backgroundColor: '#ffffff',\r\n                border: 'none',\r\n                borderRadius: '0px',\r\n                paddingTop: isHeaderFixed ? '132px' : '0px',\r\n                transition: 'padding 0.3s ease'\r\n            }, children: [_jsx(Header, { templateName: templateName || '', templateDescription: templateDescription || '', canvasWidth: canvasWidth || 794, canvasHeight: canvasHeight || 1123, showGuides: showGuides || true, snapToGrid: snapToGrid || false, isNewTemplate: isNewTemplate, isModified: isModified, isSaving: isSaving, isLoading: isLoading, isEditingExistingTemplate: isEditingExistingTemplate, onSave: saveTemplateWithAutoSave, onPreview: previewTemplate, onNewTemplate: newTemplate, onUpdateTemplateSettings: updateTemplateSettings }), _jsx(\"div\", { style: { flexShrink: 0, padding: '12px 12px 0 12px' }, children: _jsx(Toolbar, {}) }), _jsxs(\"div\", { style: { display: 'flex', flex: 1, gap: '0', padding: '12px' }, children: [_jsx(ElementLibrary, {}), _jsxs(\"div\", { style: { flex: 1, display: 'flex', flexDirection: 'column', position: 'relative' }, children: [_jsxs(\"div\", { style: {\r\n                                        flex: 1,\r\n                                        display: 'flex',\r\n                                        justifyContent: 'center',\r\n                                        alignItems: 'center',\r\n                                        backgroundColor: canvasSettings.containerBackgroundColor || '#f8f8f8',\r\n                                        border: '1px solid #e0e0e0',\r\n                                        borderRadius: '4px',\r\n                                        overflow: 'visible',\r\n                                        position: 'relative',\r\n                                        paddingTop: '20px',\r\n                                        paddingBottom: '20px'\r\n                                    }, children: [_jsx(\"div\", { style: {\r\n                                                position: 'absolute',\r\n                                                top: '8px',\r\n                                                right: '8px',\r\n                                                backgroundColor: 'rgba(0, 122, 204, 0.9)',\r\n                                                color: 'white',\r\n                                                padding: '4px 8px',\r\n                                                borderRadius: '4px',\r\n                                                fontSize: '12px',\r\n                                                fontWeight: 'bold',\r\n                                                zIndex: 10\r\n                                            }, children: (() => {\r\n                                                var _a, _b, _c;\r\n                                                const format = ((_a = window.pdfBuilderCanvasSettings) === null || _a === void 0 ? void 0 : _a.default_canvas_format) || 'A4';\r\n                                                const dpi = ((_b = window.pdfBuilderCanvasSettings) === null || _b === void 0 ? void 0 : _b.default_canvas_dpi) || 96;\r\n                                                const orientation = ((_c = window.pdfBuilderCanvasSettings) === null || _c === void 0 ? void 0 : _c.default_canvas_orientation) || 'portrait';\r\n                                                const paperFormats = window.pdfBuilderPaperFormats || {\r\n                                                    'A4': { width: 210, height: 297 },\r\n                                                    'A3': { width: 297, height: 420 },\r\n                                                    'A5': { width: 148, height: 210 },\r\n                                                    'Letter': { width: 215.9, height: 279.4 },\r\n                                                    'Legal': { width: 215.9, height: 355.6 },\r\n                                                    'Tabloid': { width: 279.4, height: 431.8 }\r\n                                                };\r\n                                                // Rcuprer les dimensions en mm\r\n                                                const dimsMM = paperFormats[format] || paperFormats['A4'];\r\n                                                // Calculer les dimensions en pixels avec le DPI actuel\r\n                                                const pixelsPerMM = dpi / 25.4;\r\n                                                let widthPx = Math.round(dimsMM.width * pixelsPerMM);\r\n                                                let heightPx = Math.round(dimsMM.height * pixelsPerMM);\r\n                                                // Inverser si orientation paysage\r\n                                                if (orientation === 'landscape') {\r\n                                                    [widthPx, heightPx] = [heightPx, widthPx];\r\n                                                }\r\n                                                return `${format}: ${widthPx}${heightPx}px (${dpi} DPI)`;\r\n                                            })() }), isLoading && (_jsx(\"div\", { style: {\r\n                                                position: 'absolute',\r\n                                                top: 0,\r\n                                                left: 0,\r\n                                                right: 0,\r\n                                                bottom: 0,\r\n                                                backgroundColor: 'rgba(255, 255, 255, 0.7)',\r\n                                                display: 'flex',\r\n                                                justifyContent: 'center',\r\n                                                alignItems: 'center',\r\n                                                zIndex: 100,\r\n                                                borderRadius: '4px'\r\n                                            }, children: _jsxs(\"div\", { style: { textAlign: 'center' }, children: [_jsx(\"div\", { style: {\r\n                                                            width: '40px',\r\n                                                            height: '40px',\r\n                                                            border: '4px solid #e0e0e0',\r\n                                                            borderTop: '4px solid #007acc',\r\n                                                            borderRadius: '50%',\r\n                                                            animation: 'spin 1s linear infinite',\r\n                                                            margin: '0 auto 12px'\r\n                                                        } }), _jsx(\"p\", { style: { margin: 0, color: '#666', fontSize: '14px' }, children: \"Chargement du template...\" })] }) })), !isLoading && (_jsxs(_Fragment, { children: [debugLog(' PDFBuilderContent: Rendering Canvas component'), _jsx(Canvas, { width: width, height: height })] }))] }), _jsx(\"button\", { onClick: () => {\r\n                                        debugLog(' PDFBuilderContent: Properties panel toggle clicked, current state:', isPropertiesPanelOpen);\r\n                                        setIsPropertiesPanelOpen(!isPropertiesPanelOpen);\r\n                                        debugLog(' PDFBuilderContent: Properties panel state changed to:', !isPropertiesPanelOpen);\r\n                                    }, style: {\r\n                                        position: 'absolute',\r\n                                        top: '50%',\r\n                                        right: isPropertiesPanelOpen ? '-12px' : '0px',\r\n                                        transform: 'translateY(-50%)',\r\n                                        zIndex: 20,\r\n                                        padding: '8px 6px',\r\n                                        backgroundColor: '#007acc',\r\n                                        color: 'white',\r\n                                        border: 'none',\r\n                                        borderRadius: '4px 0 0 4px',\r\n                                        cursor: 'pointer',\r\n                                        fontSize: '14px',\r\n                                        fontWeight: 'bold',\r\n                                        boxShadow: '0 2px 4px rgba(0,0,0,0.2)',\r\n                                        display: 'flex',\r\n                                        alignItems: 'center',\r\n                                        justifyContent: 'center',\r\n                                        width: '24px',\r\n                                        height: '60px',\r\n                                        writingMode: 'vertical-rl',\r\n                                        textOrientation: 'mixed'\r\n                                    }, title: isPropertiesPanelOpen ? 'Fermer le panneau de proprits' : 'Ouvrir le panneau de proprits', children: isPropertiesPanelOpen ? '' : '' })] }), isPropertiesPanelOpen && (_jsx(\"div\", { style: {\r\n                                flexShrink: 0,\r\n                                width: '430px',\r\n                                position: 'sticky',\r\n                                top: '110px',\r\n                                height: 'fit-content',\r\n                                maxHeight: 'calc(100vh - 32px)'\r\n                            }, children: _jsx(PropertiesPanel, {}) }))] })] }) }));\r\n});\r\n","import { jsx as _jsx } from \"react/jsx-runtime\";\r\nimport React, { useState, useEffect } from 'react';\r\nimport { BuilderProvider } from './contexts/builder/BuilderContext';\r\nimport { CanvasSettingsProvider } from './contexts/CanvasSettingsContext';\r\nimport { PDFBuilderContent } from './components/PDFBuilderContent';\r\nimport { DEFAULT_CANVAS_WIDTH, DEFAULT_CANVAS_HEIGHT } from './constants/canvas';\r\nimport { debugLog } from './utils/debug';\r\ndebugLog(' [PDFBuilder.tsx] Import successful. React:', typeof React, 'useState:', typeof useState, 'useEffect:', typeof useEffect);\r\ndebugLog(' [PDFBuilder.tsx] window.pdfBuilderData at import time:', window.pdfBuilderData);\r\ndebugLog(' [PDFBuilder.tsx] window keys at import time:', Object.keys(window).filter(key => key.includes('pdfBuilder')));\r\nexport function PDFBuilder({ width: initialWidth = DEFAULT_CANVAS_WIDTH, height: initialHeight = DEFAULT_CANVAS_HEIGHT, className }) {\r\n    var _a, _b;\r\n    debugLog(' PDFBuilder: Component initialized with props:', { initialWidth, initialHeight, className });\r\n    debugLog(' PDFBuilder: window.pdfBuilderData at component init:', window.pdfBuilderData);\r\n    debugLog(' PDFBuilder: window.pdfBuilderData?.ajaxUrl:', (_a = window.pdfBuilderData) === null || _a === void 0 ? void 0 : _a.ajaxUrl);\r\n    debugLog(' PDFBuilder: window.pdfBuilderData?.nonce:', (_b = window.pdfBuilderData) === null || _b === void 0 ? void 0 : _b.nonce);\r\n    const [dimensions, setDimensions] = useState({\r\n        width: initialWidth,\r\n        height: initialHeight\r\n    });\r\n    debugLog(' PDFBuilder: Initial dimensions set:', dimensions);\r\n    // couter les changements de dimensions depuis l'API globale\r\n    useEffect(() => {\r\n        debugLog(' PDFBuilder: Setting up dimension change listener');\r\n        const handleUpdateDimensions = (event) => {\r\n            debugLog(' PDFBuilder: Received dimension update event:', event.detail);\r\n            const { width, height } = event.detail;\r\n            debugLog(' PDFBuilder: Updating dimensions to:', { width, height });\r\n            setDimensions({ width, height });\r\n        };\r\n        document.addEventListener('pdfBuilderUpdateCanvasDimensions', handleUpdateDimensions, { passive: true });\r\n        debugLog(' PDFBuilder: Dimension change listener added');\r\n        return () => {\r\n            debugLog(' PDFBuilder: Cleaning up dimension change listener');\r\n            document.removeEventListener('pdfBuilderUpdateCanvasDimensions', handleUpdateDimensions);\r\n        };\r\n    }, []);\r\n    debugLog(' PDFBuilder: Rendering with dimensions:', dimensions);\r\n    return (_jsx(CanvasSettingsProvider, { children: _jsx(BuilderProvider, { children: _jsx(PDFBuilderContent, { width: dimensions.width, height: dimensions.height, className: className }) }) }));\r\n}\r\n// Export des composants individuels pour une utilisation modulaire\r\nexport { PDFBuilderContent };\r\n"],"names":[],"sourceRoot":""}