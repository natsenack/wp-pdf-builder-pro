"use strict";(self.webpackChunkwp_pdf_builder_pro=self.webpackChunkwp_pdf_builder_pro||[]).push([[690,702],{690:(e,t,o)=>{o.r(t),o.d(t,{default:()=>i});var r=o(540),n=o(705),a=o(702);const i=function(e){var t=e.isOpen,o=e.onClose,i=e.elements,c=void 0===i?[]:i,s=e.canvasWidth,d=void 0===s?595:s,l=e.canvasHeight,m=void 0===l?842:l,u=e.zoom,h=void 0===u?1:u,p=e.ajaxurl,w=e.pdfBuilderNonce;return t&&t?r.createElement("div",{className:"preview-modal-overlay",onClick:o},r.createElement("div",{className:"preview-modal-content",onClick:function(e){return e.stopPropagation()}},r.createElement("div",{className:"preview-modal-header"},r.createElement("h3",null,"[PDF] AperÃ§u PDF - PDF Builder Pro"),r.createElement("button",{className:"preview-modal-close",onClick:o},"Ã—")),r.createElement("div",{className:"preview-modal-body"},r.createElement("div",{className:"preview-content",style:{padding:"20px",background:"#f8f9fa",borderRadius:"4px"}},r.createElement("div",{className:"preview-canvas",style:{width:d,height:m,margin:"0 auto",border:"1px solid #e2e8f0",background:"white",position:"relative",overflow:"hidden",transform:"scale(".concat(h,")"),transformOrigin:"top center"}},c.filter(function(e){return!e.type.startsWith("woocommerce-")}).map(function(e){return r.createElement(n.H,{key:e.id,element:e,isSelected:!1,zoom:1,snapToGrid:!1,gridSize:10,canvasWidth:d,canvasHeight:m,onSelect:function(){},onUpdate:function(){},onRemove:function(){},onContextMenu:function(){},dragAndDrop:!1})}),c.filter(function(e){return e.type.startsWith("woocommerce-")}).map(function(e){return r.createElement(a.default,{key:e.id,element:e,isSelected:!1,onSelect:function(){},onUpdate:function(){},dragAndDrop:!1,zoom:1,canvasWidth:d,canvasHeight:m})})))),r.createElement("div",{className:"preview-modal-footer"},r.createElement("button",{className:"btn btn-secondary",onClick:o},"âŒ Fermer"),r.createElement("button",{className:"btn btn-primary",onClick:function(){if(console.log("handlePrint called with elements:",c),console.log("canvasWidth:",d,"canvasHeight:",m),c.forEach(function(e,t){console.log("Element ".concat(t,":"),{type:e.type,text:e.text,src:e.src,content:e.content,x:e.x,y:e.y,width:e.width,height:e.height})}),!p||!w)return console.error("Variables AJAX manquantes:",{ajaxurl:p,pdfBuilderNonce:w}),void alert("Erreur: Variables AJAX non disponibles. Rechargez la page.");var e=new FormData;e.append("action","pdf_builder_generate_pdf"),e.append("nonce",w),e.append("elements",JSON.stringify(c)),e.append("canvasWidth",d),e.append("canvasHeight",m),console.log("Envoi requÃªte AJAX vers:",p);var t=document.querySelector(".btn-primary"),o=t.textContent;t.textContent="â³ GÃ©nÃ©ration PDF...",t.disabled=!0,fetch(p,{method:"POST",body:e}).then(function(e){if(console.log("RÃ©ponse reÃ§ue:",e.status,e.statusText),!e.ok)throw new Error("Erreur rÃ©seau: "+e.status+" "+e.statusText);return e.json()}).then(function(e){if(console.log("DonnÃ©es reÃ§ues:",e),!e.success)throw new Error(e.data||"Erreur inconnue lors de la gÃ©nÃ©ration du PDF");var t=e.data.pdf,o=new Blob([Uint8Array.from(atob(t),function(e){return e.charCodeAt(0)})],{type:"application/pdf"});console.log("Blob PDF crÃ©Ã©, taille:",o.size,"bytes");var r=URL.createObjectURL(o),n=document.createElement("a");n.href=r,n.download=e.data.filename||"pdf-builder-pro-document.pdf",n.target="_blank",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r),console.log("PDF gÃ©nÃ©rÃ© et ouvert avec succÃ¨s")}).catch(function(e){console.error("Erreur lors de la gÃ©nÃ©ration du PDF:",e),alert("Erreur lors de la gÃ©nÃ©ration du PDF: "+e.message)}).finally(function(){t.textContent=o,t.disabled=!1})}},"ðŸ–¨ï¸ Imprimer")))):null}},702:(e,t,o)=>{o.r(t),o.d(t,{default:()=>c,useWooCommerceElements:()=>i});var r=o(540),n=o(630),a=function(e){return{"woocommerce-invoice-number":"NumÃ©ro Facture","woocommerce-invoice-date":"Date Facture","woocommerce-order-number":"NÂ° Commande","woocommerce-order-date":"Date Commande","woocommerce-billing-address":"Adresse Facturation","woocommerce-shipping-address":"Adresse Livraison","woocommerce-customer-name":"Nom Client","woocommerce-customer-email":"Email Client","woocommerce-payment-method":"Paiement","woocommerce-order-status":"Statut","woocommerce-products-table":"Tableau Produits","woocommerce-products-simple":"Liste Produits","woocommerce-subtotal":"Sous-total","woocommerce-discount":"Remise","woocommerce-shipping":"Livraison","woocommerce-taxes":"Taxes","woocommerce-total":"Total","woocommerce-refund":"Remboursement","woocommerce-fees":"Frais","woocommerce-quote-number":"NÂ° Devis","woocommerce-quote-date":"Date Devis","woocommerce-quote-validity":"ValiditÃ©","woocommerce-quote-notes":"Notes Devis"}[e]||"Ã‰lÃ©ment WC"},i=function(){return{getElementDefaults:function(e){var t={width:200,height:60,fontSize:14,fontFamily:"Arial, sans-serif",color:"#333333",backgroundColor:"#ffffff",borderColor:"#dddddd",borderWidth:1,borderStyle:"solid",borderRadius:4,padding:8};switch(e){case"woocommerce-billing-address":case"woocommerce-shipping-address":t.height=100;break;case"woocommerce-products-table":t.width=400,t.height=150,t.columns={image:!0,name:!0,sku:!0,quantity:!0,price:!0,total:!0};break;case"woocommerce-products-simple":t.width=350,t.height=120;break;case"woocommerce-invoice-number":case"woocommerce-order-number":case"woocommerce-quote-number":t.width=150,t.height=40}return t},validateElement:function(e){return e&&e.type&&e.id},getElementLabel:a}};const c=function(e){var t=e.element,o=e.isSelected,i=e.onSelect,c=e.onUpdate,s=e.dragAndDrop,d=e.zoom,l=void 0===d?1:d,m=e.canvasWidth,u=e.canvasHeight,h=e.orderData,p=void 0===h?{}:h,w=(0,r.useRef)(null),g=(0,n.s)({onElementResize:function(e){c({x:e.x,y:e.y,width:e.width,height:e.height})},snapToGrid:!0,gridSize:10,canvasWidth:m,canvasHeight:u}),b={position:"absolute",left:t.x*l,top:t.y*l,width:t.width*l,height:t.height*l,cursor:o?"move":"pointer",userSelect:"none",border:o?"2px solid #007cba":t.borderWidth>0?"".concat(t.borderWidth||1,"px ").concat(t.borderStyle||"solid"," ").concat(t.borderColor||"transparent"):"none",backgroundColor:t.backgroundColor||"transparent",color:t.color||"#333333",fontSize:(t.fontSize||14)*l,fontFamily:t.fontFamily||"Arial, sans-serif",padding:(t.padding||8)*l,borderRadius:(t.borderRadius||4)*l,boxSizing:"border-box",overflow:"hidden","--element-border-width":o?"2px":t.borderWidth>0?"".concat(t.borderWidth||1,"px"):"0px"};return r.createElement(r.Fragment,null,r.createElement("div",{ref:w,style:b,onClick:function(e){e.stopPropagation(),o||i(t.id)},onMouseDown:function(e){e.stopPropagation();var o=w.current.closest(".canvas-zoom-wrapper");if(o){for(var r=o.getBoundingClientRect(),n=(w.current.getBoundingClientRect(),(e.clientX-r.left)/l),a=(e.clientY-r.top)/l,i=8/l,c=0,d=[{name:"nw",x:t.x,y:t.y},{name:"ne",x:t.x+t.width,y:t.y},{name:"sw",x:t.x,y:t.y+t.height},{name:"se",x:t.x+t.width,y:t.y+t.height},{name:"n",x:t.x+t.width/2,y:t.y},{name:"s",x:t.x+t.width/2,y:t.y+t.height},{name:"w",x:t.x,y:t.y+t.height/2},{name:"e",x:t.x+t.width,y:t.y+t.height/2}];c<d.length;c++){var m=d[c];if(n>=m.x-i/2&&n<=m.x+i/2&&a>=m.y-i/2&&a<=m.y+i/2)return void g.handleResizeStart(e,m.name,{x:t.x,y:t.y,width:t.width,height:t.height},r,l)}if(s&&s.handleMouseDown){var u=w.current.closest(".canvas-zoom-wrapper").getBoundingClientRect();s.handleMouseDown(e,t.id,{left:t.x,top:t.y,width:t.width,height:t.height},u,l)}}}},r.createElement("div",{style:{fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.5px"}},a(t.type)),r.createElement("div",{style:{whiteSpace:"pre-line",lineHeight:"1.4",color:"#666"}},function(e){switch(e){case"woocommerce-invoice-number":return p.invoice_number||"INV-001";case"woocommerce-invoice-date":return p.invoice_date||"15/10/2025";case"woocommerce-order-number":return p.order_number||"#12345";case"woocommerce-order-date":return p.order_date||"15/10/2025";case"woocommerce-customer-name":return p.customer_name||"John Doe";case"woocommerce-customer-email":return p.customer_email||"john.doe@example.com";case"woocommerce-billing-address":return p.billing_address||"123 Rue de Test\n75001 Paris\nFrance";case"woocommerce-shipping-address":return p.shipping_address||"456 Rue de Livraison\n75002 Paris\nFrance";case"woocommerce-payment-method":return p.payment_method||"Carte bancaire";case"woocommerce-order-status":return p.order_status||"TraitÃ©e";case"woocommerce-subtotal":return p.subtotal||"45,00 â‚¬";case"woocommerce-discount":return p.discount||"-5,00 â‚¬";case"woocommerce-shipping":return p.shipping||"5,00 â‚¬";case"woocommerce-taxes":return p.tax||"9,00 â‚¬";case"woocommerce-total":return p.total||"54,00 â‚¬";case"woocommerce-refund":return p.refund||"0,00 â‚¬";case"woocommerce-fees":return p.fees||"1,50 â‚¬";case"woocommerce-quote-number":return p.quote_number||"QUO-001";case"woocommerce-quote-date":return p.quote_date||"15/10/2025";case"woocommerce-quote-validity":return p.quote_validity||"30 jours";case"woocommerce-quote-notes":return p.quote_notes||"Conditions spÃ©ciales : paiement Ã  30 jours.";case"woocommerce-products-table":return p.products&&p.products.length>0?p.products.map(function(e){return"".concat(e.name," x").concat(e.quantity," - ").concat(e.total)}).join("\n"):"Produit Test 1 x1 - 25,00 â‚¬\nProduit Test 2 x2 - 20,00 â‚¬";case"woocommerce-products-simple":return p.products&&p.products.length>0?p.products.map(function(e){return"".concat(e.quantity,"x ").concat(e.name)}).join("\n"):"1x Produit Test 1\n2x Produit Test 2";default:return"[Contenu dynamique WooCommerce]"}}(t.type))),o&&r.createElement(r.Fragment,null,r.createElement("div",{className:"resize-handle nw",style:{position:"absolute",width:8,height:8,backgroundColor:"#007cba",border:"1px solid white",pointerEvents:"auto"},onMouseDown:function(e){return g.handleResizeStart(e,"nw",{x:t.x,y:t.y,width:t.width,height:t.height})}}),r.createElement("div",{className:"resize-handle ne",style:{position:"absolute",width:8,height:8,backgroundColor:"#007cba",border:"1px solid white",pointerEvents:"auto"},onMouseDown:function(e){return g.handleResizeStart(e,"ne",{x:t.x,y:t.y,width:t.width,height:t.height})}}),r.createElement("div",{className:"resize-handle sw",style:{position:"absolute",width:8,height:8,backgroundColor:"#007cba",border:"1px solid white",pointerEvents:"auto"},onMouseDown:function(e){return g.handleResizeStart(e,"sw",{x:t.x,y:t.y,width:t.width,height:t.height})}}),r.createElement("div",{className:"resize-handle se",style:{position:"absolute",width:8,height:8,backgroundColor:"#007cba",border:"1px solid white",pointerEvents:"auto"},onMouseDown:function(e){return g.handleResizeStart(e,"se",{x:t.x,y:t.y,width:t.width,height:t.height})}}),r.createElement("div",{className:"resize-handle n",style:{position:"absolute",width:8,height:8,backgroundColor:"#007cba",border:"1px solid white",pointerEvents:"auto"},onMouseDown:function(e){return g.handleResizeStart(e,"n",{x:t.x,y:t.y,width:t.width,height:t.height})}}),r.createElement("div",{className:"resize-handle s",style:{position:"absolute",width:8,height:8,backgroundColor:"#007cba",border:"1px solid white",pointerEvents:"auto"},onMouseDown:function(e){return g.handleResizeStart(e,"s",{x:t.x,y:t.y,width:t.width,height:t.height})}}),r.createElement("div",{className:"resize-handle w",style:{position:"absolute",width:8,height:8,backgroundColor:"#007cba",border:"1px solid white",pointerEvents:"auto"},onMouseDown:function(e){return g.handleResizeStart(e,"w",{x:t.x,y:t.y,width:t.width,height:t.height})}}),r.createElement("div",{className:"resize-handle e",style:{position:"absolute",width:8,height:8,backgroundColor:"#007cba",border:"1px solid white",pointerEvents:"auto"},onMouseDown:function(e){return g.handleResizeStart(e,"e",{x:t.x,y:t.y,width:t.width,height:t.height})}})))}}}]);