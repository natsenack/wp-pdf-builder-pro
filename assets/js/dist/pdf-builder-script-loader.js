(self.webpackChunkwp_pdf_builder_pro=self.webpackChunkwp_pdf_builder_pro||[]).push([[865],{269:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function o(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,n||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var a=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r(r({},this.defaultConfig),t);"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){return e.optimizeLoading(n)},n.deferThreshold)}):setTimeout(function(){return e.optimizeLoading(n)},n.deferThreshold),n.preloadCritical&&this.preloadCriticalResources(),console.log("ScriptLoader initialisé avec configuration:",n)}},{key:"optimizeLoading",value:function(e){var t=this,n=document.querySelectorAll("script[src]"),r=[];n.forEach(function(n){var i=n.getAttribute("src");i&&!t.isCriticalScript(i,e.criticalScripts)&&r.push(n)}),console.log("Optimisation: ".concat(r.length," scripts non critiques identifiés")),r.forEach(function(e){t.deferScript(e)})}},{key:"isCriticalScript",value:function(e,t){return t.some(function(t){return e.includes(t)})}},{key:"deferScript",value:function(e){var t=e.getAttribute("src"),n=e.parentNode,r=document.createComment("Deferred script: ".concat(t));n.replaceChild(r,e),this.loadScriptAsync(t,e).then(function(){n.replaceChild(e,r),console.log("Script différé chargé: ".concat(t))}).catch(function(i){console.warn("Échec du chargement différé pour: ".concat(t),i),n.replaceChild(e,r)})}},{key:"loadScriptAsync",value:function(e,t){var n=this;return new Promise(function(r,i){if(n.loadingScripts.has(e))n.loadingScripts.get(e).push({resolve:r,reject:i});else if(n.loadedScripts.has(e))r();else{n.loadingScripts.set(e,[{resolve:r,reject:i}]);var o=document.createElement("script");o.src=e,o.async=!0,t.hasAttribute("integrity")&&(o.integrity=t.getAttribute("integrity")),t.hasAttribute("crossorigin")&&(o.crossOrigin=t.getAttribute("crossorigin")),o.onload=function(){n.loadedScripts.add(e),(n.loadingScripts.get(e)||[]).forEach(function(e){return(0,e.resolve)()}),n.loadingScripts.delete(e)},o.onerror=function(t){(n.loadingScripts.get(e)||[]).forEach(function(e){return(0,e.reject)(t)}),n.loadingScripts.delete(e)},document.head.appendChild(o)}})}},{key:"preloadCriticalResources",value:function(){[].forEach(function(e){var t=document.createElement("link");t.rel="preload",t.href=e,t.as="font",t.crossOrigin="anonymous",document.head.appendChild(t)}),document.querySelectorAll('link[rel="stylesheet"]').forEach(function(e){e.href&&e.href.includes("pdf-builder-admin")&&(e.rel="preload",e.as="style",e.onload=function(){this.rel="stylesheet"},document.head.appendChild(e.cloneNode()))}),console.log("Ressources critiques préchargées")}},{key:"loadScriptWithDeps",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise(function(r,i){var o=n.filter(function(e){return!t.loadedScripts.has(e)});if(o.length>0)return t.dependencyQueues.has(e)||t.dependencyQueues.set(e,[]),t.dependencyQueues.get(e).push({resolve:r,reject:i,dependencies:o}),void o.forEach(function(n){t.loadScriptAsync(n,document.createElement("script")).then(function(){return t.checkDependencyQueue(e)}).catch(i)});t.loadScriptAsync(e,document.createElement("script")).then(r).catch(i)})}},{key:"checkDependencyQueue",value:function(e){var t=this,n=this.dependencyQueues.get(e);if(n){var r=n.filter(function(e){return e.dependencies.every(function(e){return t.loadedScripts.has(e)})});r.forEach(function(n){t.loadScriptAsync(e,document.createElement("script")).then(n.resolve).catch(n.reject)}),n.splice(0,r.length),0===n.length&&this.dependencyQueues.delete(e)}}},{key:"getPerformanceMetrics",value:function(){var e={scriptsLoaded:this.loadedScripts.size,scriptsLoading:this.loadingScripts.size,dependencyQueues:this.dependencyQueues.size,totalScripts:document.querySelectorAll("script[src]").length};if(window.performance&&window.performance.getEntriesByType){var t=window.performance.getEntriesByType("navigation")[0];t&&(e.domContentLoaded=t.domContentLoadedEventEnd-t.domContentLoadedEventStart,e.loadComplete=t.loadEventEnd-t.loadEventStart)}return e}},{key:"cleanup",value:function(){this.loadingScripts.clear(),this.loadedScripts.clear(),this.dependencyQueues.clear(),console.log("ScriptLoader nettoyé")}}],(t=null)&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();o(a,"loadingScripts",new Map),o(a,"loadedScripts",new Set),o(a,"dependencyQueues",new Map),o(a,"defaultConfig",{criticalScripts:["jquery","jquery-core"],deferThreshold:2e3,preloadCritical:!0,enableIntersectionObserver:!0}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){return a.init()}):a.init(),e.exports&&(e.exports=a),window.ScriptLoader=a}},e=>{var t;t=269,e(e.s=t)}]);