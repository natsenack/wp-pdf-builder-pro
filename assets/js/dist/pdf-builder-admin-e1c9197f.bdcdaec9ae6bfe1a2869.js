/*! For license information please see pdf-builder-admin-e1c9197f.bdcdaec9ae6bfe1a2869.js.LICENSE.txt */
"use strict";(self.webpackChunkPDFBuilderPro=self.webpackChunkPDFBuilderPro||[]).push([[823],{41:(e,t,n)=>{n.d(t,{s:()=>d});var r=n(540);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return s(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var d=function(e){var t=e.onElementResize,n=e.snapToGrid,o=void 0===n||n,a=e.gridSize,l=void 0===a?10:a,s=e.minWidth,d=void 0===s?20:s,f=e.minHeight,p=void 0===f?20:f,m=e.zoom,h=void 0===m?1:m,v=e.canvasRect,y=void 0===v?null:v,b=e.canvasWidth,g=void 0===b?595:b,w=e.canvasHeight,_=void 0===w?842:w,S=e.guides,x=void 0===S?{horizontal:[],vertical:[]}:S,C=e.snapToGuides,O=void 0===C||C,z=e.elementType,k=void 0===z?null:z,j=u((0,r.useState)(!1),2),E=j[0],M=j[1],T=u((0,r.useState)(null),2),I=T[0],A=T[1],P=(0,r.useRef)({x:0,y:0}),D=(0,r.useRef)({x:0,y:0,width:0,height:0}),B=(0,r.useCallback)(function(e){return o?Math.round(e/l)*l:e},[o,l]),R=(0,r.useCallback)(function(e){if(!O)return e;var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?x.horizontal:x.vertical);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(Math.abs(e-r)<=5)return r}}catch(o){n.e(o)}finally{n.f()}return e},[O,x]),H=(0,r.useCallback)(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e;return n=B(n),n=R(n,t)},[B,R]),F=(0,r.useCallback)(function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(e.preventDefault(),e.stopPropagation(),e.target&&e.target.isConnected&&e.target.parentNode&&e.target.parentNode.isConnected){M(!0),A(n);var l=o||y||{left:0,top:0},u=a||h||1;P.current={x:(e.clientX-l.left)/u,y:(e.clientY-l.top)/u},D.current=i({},r);var c=function(e){var r=(e.clientX-l.left)/u,a=(e.clientY-l.top)/u,c=r-P.current.x,s=a-P.current.y,f=i({},D.current),m="divider"===k||"line"===k;switch(n){case"nw":m?(f.x=H(D.current.x+c,!1),f.width=H(D.current.width-c,!1)):(f.x=H(D.current.x+c,!1),f.y=H(D.current.y+s,!0),f.width=H(D.current.width-c,!1),f.height=H(D.current.height-s,!0));break;case"ne":m?f.width=H(D.current.width+c,!1):(f.y=H(D.current.y+s,!0),f.width=H(D.current.width+c,!1),f.height=H(D.current.height-s,!0));break;case"sw":m?(f.x=H(D.current.x+c,!1),f.width=H(D.current.width-c,!1)):(f.x=H(D.current.x+c,!1),f.width=H(D.current.width-c,!1),f.height=H(D.current.height+s,!0));break;case"se":m?f.width=H(D.current.width+c,!1):(f.width=H(D.current.width+c,!1),f.height=H(D.current.height+s,!0));break;case"n":m||(f.y=H(D.current.y+s,!0),f.height=H(D.current.height-s,!0));break;case"s":m||(f.height=H(D.current.height+s,!0));break;case"w":f.x=H(D.current.x+c,!1),f.width=H(D.current.width-c,!1);break;case"e":f.width=H(D.current.width+c,!1)}f.width<d&&(n.includes("w")&&(f.x=D.current.x+D.current.width-d),f.width=d),f.height<p&&(n.includes("n")&&(f.y=D.current.y+D.current.height-p),f.height=p);var h=o?o.width/u:g,v=o?o.height/u:_;f.x=Math.max(0,Math.min(h-f.width,f.x)),f.y=Math.max(0,Math.min(v-f.height,f.y)),t&&t(f)},s=function(){M(!1),A(null),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",c),document.addEventListener("mouseup",s)}},[B,d,p,t,h,y,g,_]);return{isResizing:E,resizeHandle:I,handleResizeStart:F}}},58:(e,t,n)=>{n.d(t,{f:()=>i});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e){var t=e.initialZoom,n=void 0===t?1:t,a=e.minZoom,i=void 0===a?.1:a,l=e.maxZoom,u=void 0===l?3:l,c=e.zoomStep,s=void 0===c?.1:c,d=o((0,r.useState)(n),2),f=d[0],p=d[1],m=o((0,r.useState)({x:0,y:0}),2),h=m[0],v=m[1],y=(0,r.useCallback)(function(){p(function(e){return Math.min(e+s,u)})},[u,s]),b=(0,r.useCallback)(function(){p(function(e){return Math.max(e-s,i)})},[i,s]),g=(0,r.useCallback)(function(e){var t=Math.max(i,Math.min(u,e));p(t)},[i,u]),w=(0,r.useCallback)(function(){p(n)},[n]),_=(0,r.useCallback)(function(e,t,n,r){var o=n/e,a=r/t,l=Math.min(o,a,u);p(Math.max(l,i))},[i,u]),S=(0,r.useCallback)(function(e,t,n){var r=Math.max(i,Math.min(u,f*n));v({x:e,y:t}),p(r)},[f,i,u]),x=(0,r.useCallback)(function(e,t,n,r,o){if(e&&0!==e.length){var a=1/0,l=1/0,c=-1/0,s=-1/0;e.forEach(function(e){a=Math.min(a,e.x),l=Math.min(l,e.y),c=Math.max(c,e.x+e.width),s=Math.max(s,e.y+e.height)});var d=c-a,f=s-l,m=r/(1.2*d),h=o/(1.2*f),y=Math.min(m,h,u),b=Math.max(i,Math.min(u,y)),g=r/2-(a+d/2)*b,w=o/2-(l+f/2)*b;p(b),v({x:g,y:w})}},[i,u]),C=(0,r.useCallback)(function(){return{transform:"scale(".concat(f,")"),transformOrigin:"".concat(h.x,"px ").concat(h.y,"px")}},[f,h]),O=(0,r.useCallback)(function(e,t){return{x:(e-h.x)/f,y:(t-h.y)/f}},[f,h]),z=(0,r.useCallback)(function(e,t){return{x:e*f+h.x,y:t*f+h.y}},[f,h]);return{zoom:f,zoomOrigin:h,zoomIn:y,zoomOut:b,setZoomLevel:g,resetZoom:w,zoomToFit:_,zoomToPoint:S,zoomToSelection:x,getTransformStyle:C,screenToCanvas:O,canvasToScreen:z}}},87:(e,t,n)=>{n.d(t,{default:()=>C});var r={};n.r(r),n.d(r,{useCanvasState:()=>l.v,useClipboard:()=>s.i,useContextMenu:()=>f.E,useDragAndDrop:()=>m.g,useHistory:()=>u.W,useKeyboardShortcuts:()=>p.K,useResize:()=>h.s,useRotation:()=>v.o,useSelection:()=>c.C,useZoom:()=>d.f});var o=n(540),a=n(961),i=n(222),l=n(632),u=n(469),c=n(811),s=n(483),d=n(58),f=n(493),p=n(874),m=n(491),h=n(41),v=n(95);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function g(e,t,n){return(t=_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_(r.key),r)}}function _(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:t+""}"undefined"!=typeof window&&(window.React=o,window.ReactDOM=a);var S={errors:[],initialized:!1,logError:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o={message:e.message,stack:e.stack,context:r,timestamp:(new Date).toISOString(),userAgent:null===(t=navigator)||void 0===t?void 0:t.userAgent,url:null===(n=window)||void 0===n||null===(n=n.location)||void 0===n?void 0:n.href};this.errors.push(o)},preventMultipleInit:function(){var e=Date.now(),t=e-(window._pdfBuilderLastInit||0);return!(window._pdfBuilderInitialized&&t<5e3)&&(window._pdfBuilderInitialized=!0,window._pdfBuilderLastInit=e,!0)}};try{"undefined"!=typeof window&&(window.React=o,window.ReactDOM=a,window._forceReactInclusion={React:o,ReactDOM:a,createElement:o.createElement})}catch(O){S.logError(O,"React initialization")}var x=new(function(){return e=function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.version="2.0.0",this.editors=new Map,this._hooks=r,this._forceInclude={useHistory:u.W,useRotation:v.o,useResize:h.s};try{var n=u.W(),o=v.o(function(){}),a=h.s();this._dummyInstances={dummyHistory:n,dummyRotation:o,dummyResize:a}}catch(e){}},t=[{key:"init",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!e||"string"!=typeof e)throw new Error("ContainerId must be a non-empty string");var r=document.getElementById(e);if(!r)throw new Error('Container with ID "'.concat(e,'" does not exist in the DOM'));if(!o||!a)throw new Error("React or ReactDOM is not available. Make sure the scripts are loaded properly.");if(!i.O)throw new Error("PDFCanvasEditor component is not available. Check for compilation errors.");var l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({templateId:null,templateName:null,isNew:!0,initialElements:[],width:595,height:842,zoom:1,gridSize:10,snapToGrid:!0},n);("number"!=typeof l.width||l.width<=0)&&(l.width=595),("number"!=typeof l.height||l.height<=0)&&(l.height=842);var u=(0,o.createElement)(i.O,{options:l,ref:function(e){t.canvas=e}});if(!u)throw new Error("Failed to create React element for PDFCanvasEditor");a.render(u,r),this.editors.set(e,{container:r,options:l})}catch(O){var c=document.getElementById(e);throw c&&(c.innerHTML="\n                    <div style=\"\n                        color: #721c24;\n                        background-color: #f8d7da;\n                        border: 1px solid #f5c6cb;\n                        border-radius: 4px;\n                        padding: 15px;\n                        margin: 10px 0;\n                        font-family: Arial, sans-serif;\n                        font-size: 14px;\n                    \">\n                        <strong>Erreur PDF Builder Pro</strong><br>\n                        Impossible d'initialiser l'éditeur. Vérifiez la console pour plus de détails.<br>\n                        <small>Erreur: ".concat(O.message,"</small>\n                    </div>\n                ")),O}}},{key:"destroy",value:function(e){try{var t=this.editors.get(e);t&&(a&&a.unmountComponentAtNode&&a.unmountComponentAtNode(t.container),this.editors.delete(e))}catch(O){this.editors.delete(e)}}},{key:"getData",value:function(e){return null}},{key:"getElements",value:function(){try{return this.canvas&&"function"==typeof this.canvas.getElements?this.canvas.getElements():[]}catch(O){return[]}}}],t&&w(e.prototype,t),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}());const C=x;try{"undefined"!=typeof window&&(window.PDFBuilderPro=x,window.pdfBuilderPro=x)}catch(O){}S.preventMultipleInit(),window.PDFBuilderPro=x,window.pdfBuilderPro=x},95:(e,t,n)=>{n.d(t,{o:()=>i});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=o((0,r.useState)(!1),2),i=a[0],l=a[1],u=o((0,r.useState)({angle:0,centerX:0,centerY:0}),2),c=u[0],s=u[1],d=(0,r.useCallback)(function(r,o){r.preventDefault(),r.stopPropagation(),l(!0);var a=r.currentTarget.getBoundingClientRect(),u=a.left+a.width/2,d=a.top+a.height/2,f=r.clientX-u,p=r.clientY-d,m=Math.atan2(p,f)*(180/Math.PI);s({angle:m-(o.rotation||0),centerX:u,centerY:d});var h=function(r){if(i){var o=r.clientX-u,a=r.clientY-d,l=Math.atan2(a,o)*(180/Math.PI);l-=c.angle,n&&(l=Math.round(l/t)*t),e(l=(l%360+360)%360)}},v=function(){l(!1),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",v)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",v)},[i,c,t,n,e]);return{isRotating:i,handleRotationStart:d}}},244:(e,t,n)=>{n.d(t,{R:()=>f});var r=n(540),o=n(234),a=n(957);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e,t,n){var l=s((0,r.useState)({}),2),d=l[0],f=l[1],p=s((0,r.useState)("appearance"),2),m=p[0],h=p[1],v=(0,r.useMemo)(function(){return e.length>0?t.find(function(t){return t.id===e[0]}):null},[e,t]);(0,r.useEffect)(function(){if(v){var e={color:"#333333",backgroundColor:"transparent",borderColor:"#dddddd",borderWidth:0,borderStyle:"solid",borderRadius:4,fontSize:14,fontFamily:"Inter",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",textAlign:"left",lineHeight:1.2,letterSpacing:0},t=v.type,n=u({},e);Object.keys(e).forEach(function(e){var r=(0,a.Dw)(t,e);null!==r&&(n[e]=r),"special"===a.xG[t]&&"backgroundColor"===e&&(n[e]="transparent")});var r=u(u({},n),v);Object.keys(n).forEach(function(e){if(!(0,a.Qn)(t,e)){var n=(0,a.uF)(t,e,r[e]);n!==r[e]&&(r[e]=n)}else"special"!==a.xG[t]||"backgroundColor"!==e||r[e]||(r[e]="transparent")}),Object.keys(r).forEach(function(e){(0,a.qb)(t,e,r[e]).valid||(r[e]=(0,a.uF)(t,e,r[e]))}),f(r)}else f({})},[null==v?void 0:v.id]);var y=(0,r.useCallback)(function(e,r,l){var s=t.find(function(t){return t.id===e});if(s){var d=l;if((0,a.qb)(s.type,r,l).valid){if("boolean"!=typeof l&&!r.startsWith("columns."))try{var p=o.l.validateProperty(r,l);void 0!==p&&(d=p)}catch(m){}f(function(e){var t;if(r.includes(".")){(function(e,t,n){var r=t.split("."),o=r.pop();r.reduce(function(e,t){return e[t]&&"object"===i(e[t])?e[t]=u({},e[t]):e[t]={},e[t]},e)[o]=n})(t=u({},e),r,d)}else t=u(u({},e),{},c({},r,d));return t}),n(e,r,d)}}},[n,t]),b=(0,r.useCallback)(function(e,t){var n={"color-dark":{color:"#1e293b"},"color-light":{color:"#f8fafc"},"color-primary":{color:"#2563eb"},"color-success":{color:"#16a34a"},"color-warning":{color:"#ca8a04"},"color-error":{color:"#dc2626"},"text-title":{fontSize:24,fontWeight:"bold",textAlign:"center"},"text-subtitle":{fontSize:18,fontWeight:"bold",textAlign:"left"},"text-body":{fontSize:14,fontWeight:"normal",textAlign:"left"},"text-caption":{fontSize:12,fontWeight:"normal",textAlign:"left"},"shape-rounded":{borderRadius:8},"shape-circle":{borderRadius:50},"shape-square":{borderRadius:0},"effect-shadow":{shadow:!0,shadowColor:"#000000",shadowOffsetX:2,shadowOffsetY:2},"effect-glow":{shadow:!0,shadowColor:"#2563eb",shadowOffsetX:0,shadowOffsetY:0},"effect-none":{shadow:!1,brightness:100,contrast:100,saturate:100}};n[t]&&Object.entries(n[t]).forEach(function(t){var n=s(t,2),r=n[0],o=n[1];y(e,r,o)})},[y]),g=(0,r.useCallback)(function(e){Object.entries({x:50,y:50,width:100,height:50,backgroundColor:"#ffffff",borderColor:"#dddddd",borderWidth:1,borderStyle:"solid",borderRadius:4,color:"#333333",fontSize:14,fontFamily:"Inter",fontWeight:"normal",fontStyle:"normal",textAlign:"left",textDecoration:"none",lineHeight:1.2,letterSpacing:0,opacity:100,rotation:0,scale:100,shadow:!1,brightness:100,contrast:100,saturate:100}).forEach(function(t){var n=s(t,2),r=n[0],o=n[1];y(e,r,o)})},[y]);return{localProperties:d,activeTab:m,setActiveTab:h,selectedElement:v,handlePropertyChange:y,applyPropertyPreset:b,resetProperties:g,validatePropertyValue:function(e,t){switch(e){case"x":case"y":case"width":case"height":return Math.max(0,parseInt(t)||0);case"fontSize":return Math.max(8,Math.min(72,parseInt(t)||14));case"lineHeight":return Math.max(.5,Math.min(5,parseFloat(t)||1.2));case"letterSpacing":return Math.max(-5,Math.min(20,parseFloat(t)||0));case"borderWidth":return Math.max(0,Math.min(20,parseInt(t)||0));case"borderStyle":return["solid","dashed","dotted","double"].includes(t)?t:"solid";case"borderRadius":return Math.max(0,Math.min(100,parseInt(t)||0));case"rotation":return((parseInt(t)||0)%360+360)%360;case"scale":return Math.max(10,Math.min(200,parseInt(t)||100));case"opacity":return Math.max(0,Math.min(100,parseInt(t)||100));case"brightness":case"contrast":case"saturate":return Math.max(0,Math.min(200,parseInt(t)||100));case"shadowOffsetX":case"shadowOffsetY":return Math.max(-50,Math.min(50,parseInt(t)||0));default:return t}}}}},369:(e,t,n)=>{n.d(t,{I:()=>o});var r=n(540),o=function(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e3,i=(0,r.useRef)(new Map),l=(0,r.useRef)(null),u=(0,r.useRef)(new Map),c=(0,r.useCallback)(function(e,t,n){l.current&&clearTimeout(l.current);var r="".concat(e,".").concat(t);i.current.set(r,{elementId:e,property:t,value:n}),o&&(l.current=setTimeout(function(){d()},a))},[o,a]),s=(0,r.useCallback)(function(e,n,r){l.current&&clearTimeout(l.current),t(e,n,r);var o="".concat(e,".").concat(n);u.current.set(o,r),i.current.delete(o)},[t]),d=(0,r.useCallback)(function(){if(0!==i.current.size){var e=Array.from(i.current.values()),r=e.reduce(function(e,t){return e[t.elementId]||(e[t.elementId]={}),e[t.elementId][t.property]=t.value,e},{});n&&Object.keys(r).length>1?n(r):e.forEach(function(e){var n=e.elementId,r=e.property,o=e.value;t(n,r,o)}),e.forEach(function(e){var t=e.elementId,n=e.property,r=e.value,o="".concat(t,".").concat(n);u.current.set(o,r)}),i.current.clear()}},[t,n]),f=(0,r.useCallback)(function(){d()},[d]),p=(0,r.useCallback)(function(){return i.current.size>0},[]),m=(0,r.useCallback)(function(e){var t=[];return i.current.forEach(function(n,r){n.elementId===e&&t.push(n)}),t},[]),h=(0,r.useCallback)(function(e){var t=[];i.current.forEach(function(n,r){n.elementId===e&&t.push(r)}),t.forEach(function(e){return i.current.delete(e)})},[]),v=(0,r.useCallback)(function(e,t){var n="".concat(e,".").concat(t),r=u.current.get(n);return void 0!==r?(i.current.delete(n),r):null},[]),y=(0,r.useCallback)(function(e,t,n,r){var o=n;return r&&(o=r(n)),o=b(t,o),c(e,t,o),o},[c]),b=function(e,t){switch(e){case"x":case"y":case"width":case"height":return Math.max(0,parseInt(t)||0);case"fontSize":return Math.max(8,Math.min(72,parseInt(t)||14));case"borderWidth":return Math.max(0,Math.min(20,parseInt(t)||0));case"borderRadius":return Math.max(0,Math.min(100,parseInt(t)||0));case"rotation":return((parseInt(t)||0)%360+360)%360;case"scale":return Math.max(10,Math.min(200,parseInt(t)||100));case"opacity":return Math.max(0,Math.min(100,parseInt(t)||100));case"brightness":case"contrast":case"saturate":return Math.max(0,Math.min(200,parseInt(t)||100));case"shadowOffsetX":case"shadowOffsetY":return Math.max(-50,Math.min(50,parseInt(t)||0));default:return t}};return(0,r.useEffect)(function(){return function(){l.current&&clearTimeout(l.current)}},[]),(0,r.useEffect)(function(){o&&i.current.size>0&&d()},[e,o,d]),{sync:c,syncImmediate:s,syncPending:d,forceSync:f,hasPendingChanges:p,getPendingChanges:m,cancelPendingChanges:h,validateAndSync:y,restoreLastSaved:v,pendingChangesCount:i.current.size}}},469:(e,t,n)=>{n.d(t,{W:()=>i});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).maxHistorySize,t=void 0===e?50:e,n=o((0,r.useState)([]),2),a=n[0],i=n[1],l=o((0,r.useState)(-1),2),u=l[0],c=l[1],s=(0,r.useRef)(!1);return{addToHistory:(0,r.useCallback)(function(e){s.current?s.current=!1:i(function(n){var r=n.slice(0,u+1);return r.push(e),r.length>t?(r.shift(),c(r.length-1),r):(c(r.length-1),r)})},[u,t]),undo:(0,r.useCallback)(function(){return u>0?(s.current=!0,c(function(e){return e-1}),a[u-1]):null},[u,a]),redo:(0,r.useCallback)(function(){return u<a.length-1?(s.current=!0,c(function(e){return e+1}),a[u+1]):null},[u,a]),canUndo:(0,r.useCallback)(function(){return u>0},[u]),canRedo:(0,r.useCallback)(function(){return u<a.length-1},[u]),clearHistory:(0,r.useCallback)(function(){i([]),c(-1)},[]),getCurrentState:(0,r.useCallback)(function(){return u>=0?a[u]:null},[u,a]),historySize:a.length,currentIndex:u}}},483:(e,t,n)=>{n.d(t,{i:()=>i});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e){var t=e.onPaste,n=o((0,r.useState)(null),2),a=n[0],i=n[1],l=(0,r.useCallback)(function(e){i(e)},[]),u=(0,r.useCallback)(function(){return a&&t&&t(a),a},[a,t]),c=(0,r.useCallback)(function(e){return l(e),e},[l]),s=(0,r.useCallback)(function(){return null!==a},[a]),d=(0,r.useCallback)(function(){i(null)},[]);return{copy:l,paste:u,cut:c,hasData:s,clear:d,clipboardData:a}}},491:(e,t,n)=>{n.d(t,{g:()=>l});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e){var t=e.onElementMove,n=e.onElementDrop,i=e.snapToGrid,l=void 0===i||i,u=e.gridSize,c=void 0===u?10:u,s=e.zoom,d=void 0===s?1:s,f=e.canvasWidth,p=void 0===f?595:f,m=e.canvasHeight,h=void 0===m?842:m,v=e.guides,y=void 0===v?{horizontal:[],vertical:[]}:v,b=e.snapToGuides,g=void 0===b||b,w=o((0,r.useState)(!1),2),_=w[0],S=w[1],x=o((0,r.useState)({x:0,y:0}),2),C=x[0],O=x[1],z=o((0,r.useState)(null),2),k=z[0],j=z[1],E=(0,r.useRef)({x:0,y:0}),M=(0,r.useRef)({x:0,y:0}),T=(0,r.useRef)(null),I=(0,r.useRef)({x:0,y:0}),A=(0,r.useCallback)(function(e){return l?Math.round(e/c)*c:e},[l,c]),P=(0,r.useCallback)(function(e){if(!g)return e;var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){u=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(u)throw i}}}}(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?y.horizontal:y.vertical);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(Math.abs(e-r)<=5)return r}}catch(o){n.e(o)}finally{n.f()}return e},[g,y]),D=(0,r.useCallback)(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("line"===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)&&!t)return e;var n=e;return n=A(n),n=P(n,t)},[A,P]);(0,r.useEffect)(function(){return function(){T.current&&(document.removeEventListener("mousemove",T.current.handleMouseMove),document.removeEventListener("mouseup",T.current.handleMouseUp),T.current=null)}},[]);var B=(0,r.useCallback)(function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(0===e.button&&e.target&&e.target.isConnected&&e.target.parentNode&&e.target.parentNode.isConnected){e.preventDefault(),S(!0),j(t);var l=o||{left:0,top:0,width:p,height:h},u=a||d||1,c=(e.clientX-l.left)/u,s=(e.clientY-l.top)/u;E.current={x:c-r.left,y:s-r.top},M.current={x:r.left,y:r.top};var f=function(e){if(T.current){var t=(e.clientX-l.left)/u,n=(e.clientY-l.top)/u;0;var i=t-c,d=n-s,f=o?o.width/a:p,m=o?o.height/a:h,v=Math.max(0,Math.min(f-r.width,D(r.left+i,!1,b))),y=Math.max(0,Math.min(m-r.height,D(r.top+d,!0,b))),b=T.current.elementType,g={x:v-r.left,y:y-r.top};O(g),I.current=g}},m=function(){if(!T.current)return S(!1),O({x:0,y:0}),void j(null);var e=T.current,t=e.elementId;e.elementType;if(S(!1),n&&t){var r=M.current.x+I.current.x,o=M.current.y+I.current.y;n(t,{x:r,y:o})}O({x:0,y:0}),j(null),M.current={x:0,y:0},I.current={x:0,y:0},document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",m),T.current=null};T.current={handleMouseMove:f,handleMouseUp:m,elementId:t,elementType:i},document.addEventListener("mousemove",f),document.addEventListener("mouseup",m)}},[A,t,n,d,p,h]);return{isDragging:_,dragOffset:C,draggedElementId:k,handleMouseDown:B,handleDragStart:(0,r.useCallback)(function(e,t,n){e.dataTransfer.setData("text/plain",t),e.dataTransfer.effectAllowed="move",E.current={x:e.clientX-n.left,y:e.clientY-n.top}},[]),handleDragOver:(0,r.useCallback)(function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"},[]),handleDrop:(0,r.useCallback)(function(e,t,r){e.preventDefault();var o=e.dataTransfer.getData("text/plain");if(o){var a=(e.clientX-t.left-E.current.x)/d,i=(e.clientY-t.top-E.current.y)/d,l=t?t.width/d:p,u=t?t.height/d:h,c=Math.max(0,Math.min(l-r.width,D(a,!1))),s=Math.max(0,Math.min(u-r.height,D(i,!0)));n&&n(o,{x:c,y:s})}},[A,n,d,p,h])}}},493:(e,t,n)=>{n.d(t,{E:()=>i});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e=o((0,r.useState)(null),2),t=e[0],n=e[1],a=o((0,r.useState)(!1),2),i=a[0],l=a[1],u=(0,r.useCallback)(function(e,t,r){var o=36*r.length,a=e,i=t;e+180>window.innerWidth&&(a=e-180),t+o>window.innerHeight&&(i=t-o),a=Math.max(0,Math.min(a,window.innerWidth-180)),i=Math.max(0,Math.min(i,window.innerHeight-o)),n({x:a,y:i,items:r})},[]),c=(0,r.useCallback)(function(){t&&(l(!0),setTimeout(function(){n(null),l(!1)},150))},[t]),s=(0,r.useCallback)(function(e){return c(),e},[c]);return(0,r.useEffect)(function(){var e=function(e){t&&!e.target.closest(".context-menu")&&c()},n=function(e){"Escape"===e.key&&t&&c()};return t&&(document.addEventListener("mousedown",e),document.addEventListener("keydown",n)),function(){document.removeEventListener("mousedown",e),document.removeEventListener("keydown",n)}},[t,c]),{contextMenu:t,showContextMenu:u,hideContextMenu:c,handleContextMenuAction:s,isAnimating:i}}},535:(e,t,n)=>{n.d(t,{k:()=>p});var r=n(540);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function l(n,r,o,a){var l=r&&r.prototype instanceof c?r:c,s=Object.create(l.prototype);return i(s,"_invoke",function(n,r,o){var a,i,l,c=0,s=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,l=e,f.n=n,u}};function p(n,r){for(i=n,l=r,t=0;!d&&c&&!o&&t<s.length;t++){var o,a=s[t],p=f.p,m=a[2];n>3?(o=m===r)&&(l=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,f.n=m,i=0))}if(o||n>1)return u;throw d=!0,r}return function(o,s,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&p(s,m),i=s,l=m;(t=i<2?e:l)||!d;){a||(i?i<3?(i>1&&(f.n=-1),p(i,l)):f.n=l:f.v=l);try{if(c=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?l:n.call(r,f))!==u)break}catch(t){a=e,i=1,l=t}finally{c=1}}return{value:t,done:d}}}(n,o,a),!0),s}var u={};function c(){}function s(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(i(t={},r,function(){return this}),t),p=d.prototype=c.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=d,i(p,"constructor",d),i(d,"constructor",s),s.displayName="GeneratorFunction",i(d,o,"GeneratorFunction"),i(p),i(p,o,"Generator"),i(p,r,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(a=function(){return{w:l,m}})()}function i(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,t,n,r){function a(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},i(e,t,n,r)}function l(e,t,n,r,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,o)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var p=function(){var e=d((0,r.useState)({defaultCanvasWidth:210,defaultCanvasHeight:297,defaultCanvasUnit:"mm",defaultOrientation:"portrait",canvasBackgroundColor:"#ffffff",canvasShowTransparency:!1,containerBackgroundColor:"#f8f9fa",containerShowTransparency:!1,marginTop:10,marginRight:10,marginBottom:10,marginLeft:10,showMargins:!0,showGrid:!0,gridSize:10,gridColor:"#e0e0e0",gridOpacity:30,snapToGrid:!0,snapToElements:!0,snapToMargins:!0,snapTolerance:5,showGuides:!0,lockGuides:!1,defaultZoom:"100",minZoom:10,maxZoom:500,zoomStep:25,panWithMouse:!0,smoothZoom:!0,showZoomIndicator:!0,zoomWithWheel:!1,zoomToSelection:!0,showResizeHandles:!0,handleSize:8,handleColor:"#007cba",enableRotation:!0,rotationStep:15,rotationSnap:!0,multiSelect:!0,selectAllShortcut:!0,showSelectionBounds:!0,copyPasteEnabled:!0,duplicateOnDrag:!1,exportQuality:"print",exportFormat:"pdf",compressImages:!0,imageQuality:85,maxImageSize:2048,includeMetadata:!0,pdfAuthor:"",pdfSubject:"",autoCrop:!1,embedFonts:!0,optimizeForWeb:!0,enableHardwareAcceleration:!0,limitFps:!0,maxFps:60,autoSaveEnabled:!0,autoSaveInterval:30,autoSaveVersions:10,undoLevels:50,redoLevels:50,enableKeyboardShortcuts:!0,debugMode:!1,showFps:!1,resizeHandleSize:12,resizeHandleColor:"#007cba",resizeHandleBorderColor:"#ffffff",resizeHandleOffset:-6,selectionBorderWidth:2,selectionBorderColor:"var(--primary-color)",selectionShadowOpacity:.1,selectionBorderSpacing:2,resizeZoneSize:16,resizeZoneOpacity:.1,showResizeHandlesLegacy:!0,showResizeZones:!0,selectionAnimation:!0,defaultTextColor:"#000000",defaultBackgroundColor:"#ffffff",defaultFontSize:14,ajaxurl:window.ajaxurl||"",nonce:window.pdfBuilderNonce||""}),2),t=e[0],n=e[1],o=function(){return window.pdfBuilderCanvasSettings?window.pdfBuilderCanvasSettings:null},i=function(){return window.pdfBuilderAjax?{ajaxurl:window.pdfBuilderAjax.ajaxurl||"",nonce:window.pdfBuilderAjax.nonce||""}:{ajaxurl:window.ajaxurl||"",nonce:window.pdfBuilderNonce||window.pdf_builder_nonce||""}};(0,r.useEffect)(function(){var e=o(),t=i();if(e)n(function(n){return c(c(c({},n),t),{},{defaultCanvasWidth:e.default_canvas_width||n.defaultCanvasWidth,defaultCanvasHeight:e.default_canvas_height||n.defaultCanvasHeight,defaultCanvasUnit:e.default_canvas_unit||n.defaultCanvasUnit,defaultOrientation:e.default_orientation||n.defaultOrientation,canvasBackgroundColor:e.canvas_background_color||n.canvasBackgroundColor,canvasShowTransparency:void 0!==e.canvas_show_transparency?e.canvas_show_transparency:n.canvasShowTransparency,containerBackgroundColor:e.container_background_color||n.containerBackgroundColor,containerShowTransparency:void 0!==e.container_show_transparency?e.container_show_transparency:n.containerShowTransparency,marginTop:e.margin_top||n.marginTop,marginRight:e.margin_right||n.marginRight,marginBottom:e.margin_bottom||n.marginBottom,marginLeft:e.margin_left||n.marginLeft,showMargins:void 0!==e.show_margins?e.show_margins:n.showMargins,showGrid:void 0!==e.show_grid?e.show_grid:n.showGrid,gridSize:e.grid_size||n.gridSize,gridColor:e.grid_color||n.gridColor,gridOpacity:e.grid_opacity||n.gridOpacity,snapToGrid:void 0!==e.snap_to_grid?e.snap_to_grid:n.snapToGrid,snapToElements:void 0!==e.snap_to_elements?e.snap_to_elements:n.snapToElements,snapToMargins:void 0!==e.snap_to_margins?e.snap_to_margins:n.snapToMargins,snapTolerance:e.snap_tolerance||n.snapTolerance,showGuides:void 0!==e.show_guides?e.show_guides:n.showGuides,lockGuides:void 0!==e.lock_guides?e.lock_guides:n.lockGuides,defaultZoom:e.default_zoom||n.defaultZoom,minZoom:e.min_zoom||n.minZoom,maxZoom:e.max_zoom||n.maxZoom,zoomStep:e.zoom_step||n.zoomStep,panWithMouse:void 0!==e.pan_with_mouse?e.pan_with_mouse:n.panWithMouse,smoothZoom:void 0!==e.smooth_zoom?e.smooth_zoom:n.smoothZoom,showZoomIndicator:void 0!==e.show_zoom_indicator?e.show_zoom_indicator:n.showZoomIndicator,zoomWithWheel:void 0!==e.zoom_with_wheel?e.zoom_with_wheel:n.zoomWithWheel,zoomToSelection:void 0!==e.zoom_to_selection?e.zoom_to_selection:n.zoomToSelection,showResizeHandles:!0,handleSize:e.handle_size||n.handleSize,handleColor:e.handle_color||n.handleColor,enableRotation:void 0!==e.enable_rotation?e.enable_rotation:n.enableRotation,rotationStep:e.rotation_step||n.rotationStep,rotationSnap:void 0!==e.rotation_snap?e.rotation_snap:n.rotationSnap,multiSelect:void 0!==e.multi_select?e.multi_select:n.multiSelect,selectAllShortcut:void 0!==e.select_all_shortcut?e.select_all_shortcut:n.selectAllShortcut,showSelectionBounds:void 0!==e.show_selection_bounds?e.show_selection_bounds:n.showSelectionBounds,copyPasteEnabled:void 0!==e.copy_paste_enabled?e.copy_paste_enabled:n.copyPasteEnabled,duplicateOnDrag:void 0!==e.duplicate_on_drag?e.duplicate_on_drag:n.duplicateOnDrag,exportQuality:e.export_quality||n.exportQuality,exportFormat:e.export_format||n.exportFormat,compressImages:void 0!==e.compress_images?e.compress_images:n.compressImages,imageQuality:e.image_quality||n.imageQuality,maxImageSize:e.max_image_size||n.maxImageSize,includeMetadata:void 0!==e.include_metadata?e.include_metadata:n.includeMetadata,pdfAuthor:e.pdf_author||n.pdfAuthor,pdfSubject:e.pdf_subject||n.pdfSubject,autoCrop:void 0!==e.auto_crop?e.auto_crop:n.autoCrop,embedFonts:void 0!==e.embed_fonts?e.embed_fonts:n.embedFonts,optimizeForWeb:void 0!==e.optimize_for_web?e.optimize_for_web:n.optimizeForWeb,enableHardwareAcceleration:void 0!==e.enable_hardware_acceleration?e.enable_hardware_acceleration:n.enableHardwareAcceleration,limitFps:void 0!==e.limit_fps?e.limit_fps:n.limitFps,maxFps:e.max_fps||n.maxFps,autoSaveEnabled:void 0!==e.auto_save_enabled?e.auto_save_enabled:n.autoSaveEnabled,autoSaveInterval:e.auto_save_interval||n.autoSaveInterval,autoSaveVersions:e.auto_save_versions||n.autoSaveVersions,undoLevels:e.undo_levels||n.undoLevels,redoLevels:e.redo_levels||n.redoLevels,enableKeyboardShortcuts:void 0!==e.enable_keyboard_shortcuts?e.enable_keyboard_shortcuts:n.enableKeyboardShortcuts,debugMode:void 0!==e.debug_mode?e.debug_mode:n.debugMode,showFps:void 0!==e.show_fps?e.show_fps:n.showFps,resizeHandleSize:e.canvas_handle_size||n.resizeHandleSize,resizeHandleColor:e.canvas_handle_color||n.resizeHandleColor,resizeHandleBorderColor:e.canvas_handle_hover_color||n.resizeHandleBorderColor,selectionBorderWidth:e.canvas_border_width||n.selectionBorderWidth,selectionBorderColor:e.canvas_border_color||n.selectionBorderColor,selectionBorderSpacing:e.canvas_border_spacing||n.selectionBorderSpacing,showResizeHandlesLegacy:void 0!==e.canvas_resize_handles_enabled?e.canvas_resize_handles_enabled:n.showResizeHandlesLegacy,showResizeZones:void 0!==e.canvas_element_borders_enabled?e.canvas_element_borders_enabled:n.showResizeZones,defaultTextColor:e.default_text_color||n.defaultTextColor,defaultBackgroundColor:e.default_background_color||n.defaultBackgroundColor,defaultFontSize:e.default_font_size||n.defaultFontSize})});else{var r=i(),a=localStorage.getItem("pdf-builder-global-settings");if(a)try{var l=JSON.parse(a);l.showResizeHandles=!0,n(function(e){return c(c(c({},e),r),l)})}catch(u){n(function(e){return c(c({},e),r)})}else n(function(e){return c(c({},e),r)})}},[]),(0,r.useEffect)(function(){var e=function(e){s()};return window.addEventListener("pdfBuilderSettingsUpdated",e),function(){window.removeEventListener("pdfBuilderSettingsUpdated",e)}},[]),(0,r.useEffect)(function(){var e=document.documentElement;e.style.setProperty("--resize-handle-size","".concat(t.resizeHandleSize,"px")),e.style.setProperty("--resize-handle-color",t.resizeHandleColor),e.style.setProperty("--resize-handle-border-color",t.resizeHandleBorderColor),e.style.setProperty("--resize-handle-offset","".concat(t.resizeHandleOffset,"px")),e.style.setProperty("--selection-border-width","".concat(t.selectionBorderWidth,"px")),e.style.setProperty("--selection-border-color",t.selectionBorderColor),e.style.setProperty("--selection-border-spacing","".concat(t.selectionBorderSpacing,"px")),e.style.setProperty("--selection-shadow-opacity",t.selectionShadowOpacity),e.style.setProperty("--resize-zone-size","".concat(t.resizeZoneSize,"px")),e.style.setProperty("--resize-zone-opacity",t.resizeZoneOpacity),e.style.setProperty("--show-resize-handles",t.showResizeHandles?"block":"none"),e.style.setProperty("--show-resize-zones",t.showResizeZones?"auto":"none"),e.style.setProperty("--selection-animation",t.selectionAnimation?"all 0.2s ease":"none")},[t]);var u=function(){var e,t=(e=a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:n(function(e){var n=c(c({},e),t);n.showResizeHandles=!0,localStorage.setItem("pdf-builder-global-settings",JSON.stringify(n));var r=i();if(r.ajaxurl&&r.nonce){var o={show_grid:n.showGrid,grid_size:n.gridSize,grid_color:n.gridColor,grid_opacity:n.gridOpacity,snap_to_grid:n.snapToGrid,snap_to_elements:n.snapToElements,snap_to_margins:n.snapToMargins,snap_tolerance:n.snapTolerance,show_guides:n.showGuides,lock_guides:n.lockGuides,default_zoom:n.defaultZoom,min_zoom:n.minZoom,max_zoom:n.maxZoom,zoom_step:n.zoomStep,pan_with_mouse:n.panWithMouse,smooth_zoom:n.smoothZoom,show_zoom_indicator:n.showZoomIndicator,zoom_with_wheel:n.zoomWithWheel,zoom_to_selection:n.zoomToSelection,show_resize_handles:n.showResizeHandles,handle_size:n.handleSize,handle_color:n.handleColor,enable_rotation:n.enableRotation,rotation_step:n.rotationStep,rotation_snap:n.rotationSnap,multi_select:n.multiSelect,select_all_shortcut:n.selectAllShortcut,show_selection_bounds:n.showSelectionBounds,copy_paste_enabled:n.copyPasteEnabled,duplicate_on_drag:n.duplicateOnDrag,export_quality:n.exportQuality,export_format:n.exportFormat,compress_images:n.compressImages,image_quality:n.imageQuality,max_image_size:n.maxImageSize,include_metadata:n.includeMetadata,pdf_author:n.pdfAuthor,pdf_subject:n.pdfSubject,auto_crop:n.autoCrop,embed_fonts:n.embedFonts,optimize_for_web:n.optimizeForWeb,enable_hardware_acceleration:n.enableHardwareAcceleration,limit_fps:n.limitFps,max_fps:n.maxFps,auto_save_enabled:n.autoSaveEnabled,auto_save_interval:n.autoSaveInterval,auto_save_versions:n.autoSaveVersions,undo_levels:n.undoLevels,redo_levels:n.redoLevels,enable_keyboard_shortcuts:n.enableKeyboardShortcuts,debug_mode:n.debugMode,show_fps:n.showFps,default_canvas_width:n.defaultCanvasWidth,default_canvas_height:n.defaultCanvasHeight,default_canvas_unit:n.defaultCanvasUnit,canvas_background_color:n.canvasBackgroundColor,canvas_show_transparency:n.canvasShowTransparency,margin_top:n.marginTop,margin_right:n.marginRight,margin_bottom:n.marginBottom,margin_left:n.marginLeft,show_margins:n.showMargins};fetch(r.ajaxurl+"?action=pdf_builder_save_settings_page",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c(c({},o),{},{nonce:r.nonce}))}).then(function(e){e.ok}).catch(function(e){})}return n});case 1:return e.a(2)}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,u,"next",e)}function u(e){l(a,r,o,i,u,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}(),s=function(){var e=o(),t=i();e&&n(function(n){return c(c(c({},n),t),{},{defaultCanvasWidth:e.default_canvas_width||n.defaultCanvasWidth,defaultCanvasHeight:e.default_canvas_height||n.defaultCanvasHeight,defaultCanvasUnit:e.default_canvas_unit||n.defaultCanvasUnit,defaultOrientation:e.default_orientation||n.defaultOrientation,canvasBackgroundColor:e.canvas_background_color||n.canvasBackgroundColor,canvasShowTransparency:void 0!==e.canvas_show_transparency?e.canvas_show_transparency:n.canvasShowTransparency,containerBackgroundColor:e.container_background_color||n.containerBackgroundColor,containerShowTransparency:void 0!==e.container_show_transparency?e.container_show_transparency:n.containerShowTransparency,marginTop:e.margin_top||n.marginTop,marginRight:e.margin_right||n.marginRight,marginBottom:e.margin_bottom||n.marginBottom,marginLeft:e.margin_left||n.marginLeft,showMargins:void 0!==e.show_margins?e.show_margins:n.showMargins,showGrid:void 0!==e.show_grid?e.show_grid:n.showGrid,gridSize:e.grid_size||n.gridSize,gridColor:e.grid_color||n.gridColor,gridOpacity:e.grid_opacity||n.gridOpacity,snapToGrid:void 0!==e.snap_to_grid?e.snap_to_grid:n.snapToGrid,snapToElements:void 0!==e.snap_to_elements?e.snap_to_elements:n.snapToElements,snapToMargins:void 0!==e.snap_to_margins?e.snap_to_margins:n.snapToMargins,snapTolerance:e.snap_tolerance||n.snapTolerance,showGuides:void 0!==e.show_guides?e.show_guides:n.showGuides,lockGuides:void 0!==e.lock_guides?e.lock_guides:n.lockGuides,defaultZoom:e.default_zoom||n.defaultZoom,minZoom:e.min_zoom||n.minZoom,maxZoom:e.max_zoom||n.maxZoom,zoomStep:e.zoom_step||n.zoomStep,panWithMouse:void 0!==e.pan_with_mouse?e.pan_with_mouse:n.panWithMouse,smoothZoom:void 0!==e.smooth_zoom?e.smooth_zoom:n.smoothZoom,showZoomIndicator:void 0!==e.show_zoom_indicator?e.show_zoom_indicator:n.showZoomIndicator,zoomWithWheel:void 0!==e.zoom_with_wheel?e.zoom_with_wheel:n.zoomWithWheel,zoomToSelection:void 0!==e.zoom_to_selection?e.zoom_to_selection:n.zoomToSelection,showResizeHandles:!0,handleSize:e.handle_size||n.handleSize,handleColor:e.handle_color||n.handleColor,enableRotation:void 0!==e.enable_rotation?e.enable_rotation:n.enableRotation,rotationStep:e.rotation_step||n.rotationStep,rotationSnap:void 0!==e.rotation_snap?e.rotation_snap:n.rotationSnap,multiSelect:void 0!==e.multi_select?e.multi_select:n.multiSelect,selectAllShortcut:void 0!==e.select_all_shortcut?e.select_all_shortcut:n.selectAllShortcut,showSelectionBounds:void 0!==e.show_selection_bounds?e.show_selection_bounds:n.showSelectionBounds,copyPasteEnabled:void 0!==e.copy_paste_enabled?e.copy_paste_enabled:n.copyPasteEnabled,duplicateOnDrag:void 0!==e.duplicate_on_drag?e.duplicate_on_drag:n.duplicateOnDrag,exportQuality:e.export_quality||n.exportQuality,exportFormat:e.export_format||n.exportFormat,compressImages:void 0!==e.compress_images?e.compress_images:n.compressImages,imageQuality:e.image_quality||n.imageQuality,maxImageSize:e.max_image_size||n.maxImageSize,includeMetadata:void 0!==e.include_metadata?e.include_metadata:n.includeMetadata,pdfAuthor:e.pdf_author||n.pdfAuthor,pdfSubject:e.pdf_subject||n.pdfSubject,autoCrop:void 0!==e.auto_crop?e.auto_crop:n.autoCrop,embedFonts:void 0!==e.embed_fonts?e.embed_fonts:n.embedFonts,optimizeForWeb:void 0!==e.optimize_for_web?e.optimize_for_web:n.optimizeForWeb,enableHardwareAcceleration:void 0!==e.enable_hardware_acceleration?e.enable_hardware_acceleration:n.enableHardwareAcceleration,limitFps:void 0!==e.limit_fps?e.limit_fps:n.limitFps,maxFps:e.max_fps||n.maxFps,autoSaveEnabled:void 0!==e.auto_save_enabled?e.auto_save_enabled:n.autoSaveEnabled,autoSaveInterval:e.auto_save_interval||n.autoSaveInterval,autoSaveVersions:e.auto_save_versions||n.autoSaveVersions,undoLevels:e.undo_levels||n.undoLevels,redoLevels:e.redo_levels||n.redoLevels,enableKeyboardShortcuts:void 0!==e.enable_keyboard_shortcuts?e.enable_keyboard_shortcuts:n.enableKeyboardShortcuts,debugMode:void 0!==e.debug_mode?e.debug_mode:n.debugMode,showFps:void 0!==e.show_fps?e.show_fps:n.showFps,resizeHandleSize:e.canvas_handle_size||n.resizeHandleSize,resizeHandleColor:e.canvas_handle_color||n.resizeHandleColor,resizeHandleBorderColor:e.canvas_handle_hover_color||n.resizeHandleBorderColor,selectionBorderWidth:e.canvas_border_width||n.selectionBorderWidth,selectionBorderColor:e.canvas_border_color||n.selectionBorderColor,selectionBorderSpacing:e.canvas_border_spacing||n.selectionBorderSpacing,showResizeHandlesLegacy:void 0!==e.canvas_resize_handles_enabled?e.canvas_resize_handles_enabled:n.showResizeHandlesLegacy,showResizeZones:void 0!==e.canvas_element_borders_enabled?e.canvas_element_borders_enabled:n.showResizeZones,defaultTextColor:e.default_text_color||n.defaultTextColor,defaultBackgroundColor:e.default_background_color||n.defaultBackgroundColor,defaultFontSize:e.default_font_size||n.defaultFontSize})})};return{settings:t,updateSettings:u,resetToDefaults:function(){n({resizeHandleSize:12,resizeHandleColor:"#007cba",resizeHandleBorderColor:"#ffffff",selectionBorderWidth:2,selectionBorderColor:"var(--primary-color)",selectionBorderSpacing:2,selectionShadowOpacity:.1,resizeZoneSize:16,resizeZoneOpacity:.1,showResizeHandles:!0,showResizeZones:!0,selectionAnimation:!0})},refreshSettings:s}}},632:(e,t,n)=>{n.d(t,{v:()=>O});var r=n(540),o=n(469),a=n(811),i=n(483),l=n(58),u=n(493),c=n(491);function s(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof l?r:l,c=Object.create(u.prototype);return d(c,"_invoke",function(n,r,o){var a,l,u,c=0,s=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,l=0,u=e,f.n=n,i}};function p(n,r){for(l=n,u=r,t=0;!d&&c&&!o&&t<s.length;t++){var o,a=s[t],p=f.p,m=a[2];n>3?(o=m===r)&&(u=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,f.n=m,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,s,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&p(s,m),l=s,u=m;(t=l<2?e:u)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,u)):f.n=u:f.v=u);try{if(c=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(d=f.n<0)?u:n.call(r,f))!==i)break}catch(t){a=e,l=1,u=t}finally{c=1}}return{value:t,done:d}}}(n,o,a),!0),c}var i={};function l(){}function u(){}function c(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(d(t={},r,function(){return this}),t),p=c.prototype=l.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,d(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=c,d(p,"constructor",c),d(c,"constructor",u),u.displayName="GeneratorFunction",d(c,o,"GeneratorFunction"),d(p),d(p,o,"Generator"),d(p,r,function(){return this}),d(p,"toString",function(){return"[object Generator]"}),(s=function(){return{w:a,m}})()}function d(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}d=function(e,t,n,r){function a(t,n){d(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},d(e,t,n,r)}function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function m(e,t,n,r,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,o)}function h(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){m(a,r,o,i,l,"next",e)}function l(e){m(a,r,o,i,l,"throw",e)}i(void 0)})}}function v(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=p(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==p(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t=(0,r.useRef)(e);return t.current=e,t};if("undefined"!=typeof window&&void 0===window.toastr){var C=function(e,t,n){var r=document.createElement("div");switch(r.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      z-index: 100;\n      padding: 15px 20px;\n      margin-bottom: 10px;\n      border-radius: 5px;\n      color: white;\n      font-family: Arial, sans-serif;\n      font-size: 14px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      max-width: 300px;\n      opacity: 0;\n      transform: translateX(100%);\n      transition: all 0.3s ease;\n    ",e){case"success":r.style.backgroundColor="#51A351";break;case"error":r.style.backgroundColor="#BD362F";break;case"warning":r.style.backgroundColor="#F89406";break;default:r.style.backgroundColor="#2F96B4"}var o=t?"<strong>".concat(t,"</strong><br>"):"";r.innerHTML="".concat(o).concat(n);var a=document.createElement("button");function i(e){e.style.opacity="0",e.style.transform="translateX(100%)",setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},300)}a.innerHTML="×",a.style.cssText="\n      position: absolute;\n      top: 5px;\n      right: 10px;\n      background: none;\n      border: none;\n      color: white;\n      font-size: 20px;\n      cursor: pointer;\n      opacity: 0.8;\n    ",a.onclick=function(){return i(r)},r.appendChild(a),document.body.appendChild(r),setTimeout(function(){r.style.opacity="1",r.style.transform="translateX(0)"},10),setTimeout(function(){return i(r)},5e3)};window.toastr={success:function(e,t){C("success",t,e)},error:function(e,t){C("error",t,e)},warning:function(e,t){C("warning",t,e)},info:function(e,t){C("info",t,e)},options:{}}}var O=function(e){var t,n=e.initialElements,d=void 0===n?[]:n,m=e.templateId,y=void 0===m?null:m,g=e.canvasWidth,_=void 0===g?595:g,S=e.canvasHeight,C=void 0===S?842:S,O=e.globalSettings,z=void 0===O?null:O,k=w((0,r.useState)(d),2),j=k[0],E=k[1],M=w((0,r.useState)(1),2),T=M[0],I=M[1],A=w((0,r.useState)(!1),2),P=A[0],D=(A[1],w((0,r.useState)({saving:!1,loading:!1,duplicating:!1,deleting:!1}),2)),B=D[0],R=D[1],H=(0,o.W)(),F=(0,a.C)({onSelectionChange:(0,r.useCallback)(function(e){},[]),multiSelect:null===(t=null==z?void 0:z.multiSelect)||void 0===t||t}),W=x(H),L=x(F),Z=(0,i.i)({onPaste:(0,r.useCallback)(function(e){if("elements"===e.type){var t=e.elements.map(function(t){return b(b({},t),{},{id:"element_".concat(T+e.elements.indexOf(t)),x:t.x+20,y:t.y+20})});E(function(e){return[].concat(v(e),v(t))}),I(function(e){return e+t.length}),F.selectAll(t.map(function(e){return e.id}))}},[T,F])}),N=(0,l.f)({initialZoom:z?parseFloat(z.defaultZoom)/100:1,minZoom:z?z.minZoom/100:.25,maxZoom:z?z.maxZoom/100:3,zoomStep:z?z.zoomStep/100:.1}),G=(0,u.E)(),U=(0,r.useCallback)(function(e,t){E(function(n){return n.map(function(n){if(n.id===e){var r=b(b({},n),t);return"divider"===n.type&&(r.height=16),"line"===n.type&&(r.height=12),r}return n})})},[]);(0,r.useEffect)(function(){if(j.length>0)try{W.current&&"function"==typeof W.current.addToHistory&&W.current.addToHistory({elements:j,nextId:T})}catch(e){}},[j,T]);var X=(0,r.useCallback)(function(e){return Array.isArray(e)?e.map(function(e){return e.id&&e.type?e:null}).filter(Boolean):[]},[]);(0,r.useEffect)(function(){var e=X(d);if(E(e),e&&e.length>0){var t=Math.max.apply(Math,v(e.map(function(e){var t,n=(null===(t=e.id)||void 0===t?void 0:t.split("_"))||[];return parseInt(n[1]||0)})));I(t+1)}else I(1)},[d,X]);var Y=(0,c.g)({onElementMove:(0,r.useCallback)(function(e,t){U(e,t)},[U]),onElementDrop:(0,r.useCallback)(function(e,t){U(e,t),H.addToHistory({elements:j.map(function(n){return n.id===e?b(b({},n),t):n}),nextId:T})},[U,H,j,T])}),q=(0,r.useCallback)(function(e){return e.map(function(e){var t=b({},e);return["domElement","ref","eventListeners","component","render"].forEach(function(e){delete t[e]}),t})},[]);(0,r.useEffect)(function(){if(j.length>0||0===H.historySize){var e=q(j);H.addToHistory({elements:e,nextId:T})}},[j,T,H,q]),(0,r.useEffect)(function(){var e=["product_table","customer_info","company_logo","company_info","order_number","document_type","progress-bar"];j.some(function(t){return e.includes(t.type)&&"transparent"!==t.backgroundColor})&&E(function(t){return t.map(function(t){return e.includes(t.type)&&"transparent"!==t.backgroundColor?b(b({},t),{},{backgroundColor:"transparent"}):t})})},[]);var $=(0,r.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=W.current,r=L.current;if(r&&n&&"function"==typeof r.selectElement&&"function"==typeof n.addToHistory){var o=b(b({id:"element_".concat(T),type:e},{x:50,y:50,width:100,height:50,backgroundColor:"transparent",borderColor:"transparent",borderWidth:0,borderStyle:"solid",borderRadius:0,color:"#1e293b",fontFamily:"Inter, sans-serif",fontSize:14,fontWeight:"normal",fontStyle:"normal",textAlign:"left",textDecoration:"none",text:"Texte",opacity:100,rotation:0,scale:100,visible:!0,src:"",alt:"",objectFit:"cover",brightness:100,contrast:100,saturate:100,shadow:!1,shadowColor:"#000000",shadowOffsetX:2,shadowOffsetY:2,showHeaders:!0,showBorders:!0,dataSource:"order_items",showSubtotal:!1,showShipping:!0,showTaxes:!0,showDiscount:!1,showTotal:!1,progressColor:"#3b82f6",progressValue:75,lineColor:"#64748b",lineWidth:2,documentType:"invoice",imageUrl:"",spacing:8,layout:"vertical",alignment:"left",fit:"contain"}),t);"line"===e?o.height=12:"divider"===e&&(o.height=16,o.width=200),E(function(e){var t=[].concat(v(e),[o]);try{n&&"function"==typeof n.addToHistory&&n.addToHistory({elements:t,nextId:T+1})}catch(r){}return t}),I(function(e){return e+1});try{r&&"function"==typeof r.selectElement&&r.selectElement(o.id)}catch(a){}}},[T]),Q=(0,r.useCallback)(function(e){E(function(t){var n=t.filter(function(t){return t.id!==e});return H.addToHistory({elements:n,nextId:T}),n}),F.clearSelection()},[F,H,T]),K=(0,r.useCallback)(function(){var e=F.deleteSelected();E(function(t){var n=t.filter(function(t){return!e.includes(t.id)});return H.addToHistory({elements:n,nextId:T}),n}),F.clearSelection()},[F,H,T]),V=(0,r.useCallback)(function(e){var t=j.find(function(t){return t.id===e});if(t){var n=b(b({},t),{},{id:"element_".concat(T),x:t.x+20,y:t.y+20});E(function(e){var t=[].concat(v(e),[n]);return H.addToHistory({elements:t,nextId:T+1}),t}),I(function(e){return e+1}),F.selectElement(n.id)}},[j,T,F,H]),J=(0,r.useCallback)(function(){var e=F.duplicateSelected(),t=[];e.forEach(function(e){var n=j.find(function(t){return t.id===e});if(n){var r=b(b({},n),{},{id:"element_".concat(T+t.length),x:n.x+20,y:n.y+20});t.push(r)}}),t.length>0&&(E(function(e){var n=[].concat(v(e),t);return H.addToHistory({elements:n,nextId:T+t.length}),n}),I(function(e){return e+t.length}),F.selectAll(t.map(function(e){return e.id})))},[j,T,F,H]),ee=(0,r.useCallback)(function(){var e=F.selectedElements,t=j.filter(function(t){return e.includes(t.id)});t.length>0&&Z.copy({type:"elements",elements:t})},[j,F,Z]),te=(0,r.useCallback)(function(){Z.paste()},[Z]),ne=(0,r.useCallback)(function(){var e=H.undo();e&&(E(e.elements),I(e.nextId),F.clearSelection())},[H,F]),re=(0,r.useCallback)(function(){var e=H.redo();e&&(E(e.elements),I(e.nextId),F.clearSelection())},[H,F]),oe=(0,r.useCallback)(h(s().m(function e(){var t,n,r,o,a,i,l,u,c,d,m,h,v,g,S,x,O,z,k,E,M,T,I,A,P,D,H,F,W,L,Z,N;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!B.saving){e.n=1;break}return e.a(2);case 1:return R(function(e){return b(b({},e),{},{saving:!0})}),t=y&&"0"!==y&&0!==y,n=function(){return Promise.resolve(!0)},e.n=2,n();case 2:r=e.v,e.p=3,u=function(e){for(var t=["domElement","eventListeners","ref","onClick","onMouseDown","onMouseUp","onMouseMove","onContextMenu","onDoubleClick","onDragStart","onDragEnd","onResize","component","render","props","state","context","refs","_reactInternalInstance","_reactInternals","$$typeof","constructor","prototype","_owner","_store","key","ref","_self","_source"],n={},r=0,o=Object.entries(e);r<o.length;r++){var a=w(o[r],2),i=a[0],l=a[1];if(!t.includes(i)&&!i.startsWith("_")){var u=l;if(["x","y","width","height","fontSize","opacity","lineHeight","letterSpacing","zIndex","borderWidth","borderRadius","rotation","padding","scale","shadowOffsetX","shadowOffsetY","brightness","contrast","saturate","progressValue","lineWidth","spacing"].includes(i))if("string"!=typeof l||""===l||isNaN(l)){if("number"!=typeof l){u={x:0,y:0,width:100,height:50,fontSize:14,opacity:1,lineHeight:1.2,letterSpacing:0,zIndex:0,borderWidth:0,borderRadius:0,rotation:0,padding:0}[i]||0}}else u=parseFloat(l);if(["color","backgroundColor","borderColor","shadowColor","progressColor","lineColor"].includes(i)&&l&&"transparent"!==l&&!/^#[0-9A-Fa-f]{3,6}$/i.test(l)){u={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#008000",blue:"#0000ff",gray:"#808080",grey:"#808080",transparent:"transparent"}[l.toLowerCase()]||"#000000"}if("fontWeight"===i){["normal","bold","100","200","300","400","500","600","700","800","900"].includes(l)||(u="normal")}if("textAlign"===i){["left","center","right","justify"].includes(l)||(u="left")}if("textDecoration"===i){["none","underline","overline","line-through"].includes(l)||(u="none")}if("textTransform"===i){["none","capitalize","uppercase","lowercase"].includes(l)||(u="none")}if("borderStyle"===i){["solid","dashed","dotted","double","none"].includes(l)||(u="solid")}if("text"!==i&&"content"!==i||"string"!=typeof l&&(u=""),"fontFamily"===i&&("string"==typeof l&&""!==l.trim()||(u="Inter, sans-serif")),"fontStyle"===i){["normal","italic","oblique"].includes(l)||(u="normal")}if("visible"===i&&"boolean"!=typeof l&&(u=!0),"scale"===i&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(u=100):u=parseFloat(l),u=Math.max(10,Math.min(500,u))),"shadow"===i&&"boolean"!=typeof l&&(u=!1),"shadowColor"===i&&l&&"transparent"!==l&&!/^#[0-9A-Fa-f]{3,6}$/i.test(l)){u={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#008000",blue:"#0000ff",gray:"#808080",grey:"#808080",transparent:"transparent"}[l.toLowerCase()]||"#000000"}if(["shadowOffsetX","shadowOffsetY"].includes(i)&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(u=2):u=parseFloat(l)),"brightness"!==i&&"contrast"!==i&&"saturate"!==i||("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(u=100):u=parseFloat(l),u=Math.max(0,Math.min(200,u))),"objectFit"===i){["fill","contain","cover","none","scale-down"].includes(l)||(u="cover")}var c,s,d,f,m,h;if(["showHeaders","showBorders","showSubtotal","showShipping","showTaxes","showDiscount","showTotal"].includes(i)&&"boolean"!=typeof l&&(u=!1),"dataSource"===i){["order_items","cart_items","custom"].includes(l)||(u="order_items")}if("progressValue"===i&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(u=0):u=parseFloat(l),u=Math.max(0,Math.min(100,u))),"lineWidth"===i&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(u=2):u=parseFloat(l),u=Math.max(1,Math.min(10,u))),"spacing"===i&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(u=8):u=parseFloat(l)),"layout"===i){["vertical","horizontal","grid"].includes(l)||(u="vertical")}if("alignment"===i){["left","center","right","justify"].includes(l)||(u="left")}if("fit"===i){["contain","cover","fill","none"].includes(l)||(u="contain")}if("documentType"===i){["invoice","quote","receipt","order"].includes(l)||(u="invoice")}if("columns"===i)if("object"===p(l)&&null!==l)u={image:null===(c=l.image)||void 0===c||c,name:null===(s=l.name)||void 0===s||s,sku:null!==(d=l.sku)&&void 0!==d&&d,quantity:null===(f=l.quantity)||void 0===f||f,price:null===(m=l.price)||void 0===m||m,total:null===(h=l.total)||void 0===h||h};else u={image:!0,name:!0,sku:!1,quantity:!0,price:!0,total:!0};if(null!=u)if("string"==typeof u||"number"==typeof u||"boolean"==typeof u)n[i]=u;else if(Array.isArray(u))try{var v=u.filter(function(e){return null!=e}).map(function(e){if("object"===p(e)&&null!==e){for(var t={},n=0,r=Object.entries(e);n<r.length;n++){var o=w(r[n],2),a=o[0],i=o[1];"string"!=typeof i&&"number"!=typeof i&&"boolean"!=typeof i||(t[a]=i)}return t}return"string"==typeof e||"number"==typeof e||"boolean"==typeof e?e:null}).filter(function(e){return null!==e});JSON.stringify(v),n[i]=v}catch(C){n[i]=[]}else if("object"===p(u))try{for(var y={},b=0,g=Object.entries(u);b<g.length;b++){var _=w(g[b],2),S=_[0],x=_[1];S.startsWith("_")||t.includes(S)||("string"!=typeof x&&"number"!=typeof x&&"boolean"!=typeof x||(y[S]=x))}JSON.stringify(y),n[i]=y}catch(C){n[i]={}}}}return n},c=[];try{j.forEach(function(e,t){e&&p(e),e&&e.id,e&&e.type}),c=j.filter(function(e){return e&&"object"===p(e)&&e.id&&e.type}).map(u).filter(function(e){return e&&e.id&&e.type}),JSON.stringify(c)}catch(s){c=[]}if(d={elements:c,canvasWidth:_,canvasHeight:C,version:"1.0"},e.p=4,m=JSON.stringify(d),(h=JSON.parse(m)).elements&&Array.isArray(h.elements)){e.n=5;break}throw new Error("Structure de données invalide: éléments manquants ou incorrects");case 5:v=f(h.elements),e.p=6,v.s();case 7:if((g=v.n()).done){e.n=9;break}if((S=g.value).id&&S.type){e.n=8;break}throw new Error("Élément invalide détecté: ID ou type manquant pour ".concat(JSON.stringify(S)));case 8:e.n=7;break;case 9:e.n=11;break;case 10:e.p=10,L=e.v,v.e(L);case 11:return e.p=11,v.f(),e.f(11);case 12:e.n=14;break;case 13:throw e.p=13,Z=e.v,new Error("Données JSON invalides côté client: "+Z.message);case 14:return(x=new FormData).append("action","pdf_builder_pro_save_template"),x.append("template_data",m),x.append("template_name",(null===(o=window.pdfBuilderData)||void 0===o?void 0:o.templateName)||"Template ".concat((null===(a=window.pdfBuilderData)||void 0===a?void 0:a.templateId)||"New")),x.append("template_id",(null===(i=window.pdfBuilderData)||void 0===i?void 0:i.templateId)||"0"),e.p=15,e.n=16,fetch((null===(O=window.pdfBuilderAjax)||void 0===O?void 0:O.ajaxurl)||"/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"pdf_builder_get_fresh_nonce"})});case 16:if(!(z=e.v).ok){e.n=18;break}return e.n=17,z.json();case 17:(k=e.v).success?x.append("nonce",k.data.nonce):x.append("nonce",(null===(E=window.pdfBuilderAjax)||void 0===E?void 0:E.nonce)||(null===(M=window.pdfBuilderData)||void 0===M?void 0:M.nonce)||""),e.n=19;break;case 18:x.append("nonce",(null===(T=window.pdfBuilderAjax)||void 0===T?void 0:T.nonce)||(null===(I=window.pdfBuilderData)||void 0===I?void 0:I.nonce)||"");case 19:e.n=21;break;case 20:e.p=20,e.v,x.append("nonce",(null===(A=window.pdfBuilderAjax)||void 0===A?void 0:A.nonce)||(null===(P=window.pdfBuilderData)||void 0===P?void 0:P.nonce)||"");case 21:return e.n=22,fetch((null===(l=window.pdfBuilderAjax)||void 0===l?void 0:l.ajaxurl)||"/wp-admin/admin-ajax.php",{method:"POST",body:x});case 22:return D=e.v,e.n=23,D.json();case 23:if((H=e.v).success){e.n=24;break}throw new Error((null===(F=H.data)||void 0===F?void 0:F.message)||"Erreur lors de la sauvegarde");case 24:return t&&(r?toastr.success("Modifications du canvas sauvegardées avec succès !"):alert("Modifications du canvas sauvegardées avec succès !")),e.a(2,d);case 25:throw e.p=25,N=e.v,W=N.message||"Erreur inconnue lors de la sauvegarde",r?toastr.error("Erreur lors de la sauvegarde: ".concat(W)):alert("Erreur lors de la sauvegarde: ".concat(W)),N;case 26:return e.p=26,R(function(e){return b(b({},e),{},{saving:!1})}),e.f(26);case 27:return e.a(2)}},e,null,[[15,20],[6,10,11,12],[4,13],[3,25,26,27]])})),[j,_,C,P,y]),ae=((0,r.useCallback)(function(e){e.elements&&(E(e.elements),I(e.nextId||Math.max.apply(Math,v(e.elements.map(function(e){return parseInt(e.id.split("_")[1])})||[0]))+1),F.clearSelection(),H.clearHistory())},[F,H]),(0,r.useCallback)(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=[];n?r.push({label:"Dupliquer",action:function(){return V(n)}},{label:"Supprimer",action:function(){return Q(n)}},{type:"separator"},{label:"Copier",action:ee},{label:"Coller",action:te,disabled:!Z.hasData()}):F.selectedElements.length>0?r.push({label:"Dupliquer",action:J},{label:"Supprimer",action:K},{type:"separator"},{label:"Copier",action:ee},{label:"Coller",action:te,disabled:!Z.hasData()}):r.push({label:"Coller",action:te,disabled:!Z.hasData()}),G.showContextMenu(e,t,r)},[F,G,V,Q,ee,te,Z,J,K])),ie=(0,r.useCallback)(function(){var e=F.selectedElements;if(0!==e.length){var t=j.filter(function(t){return e.includes(t.id)});if(0!==t.length){var n=document.querySelector(".canvas-container");if(n){var r=n.getBoundingClientRect(),o=r.width,a=r.height;N.zoomToSelection(t,_,C,o,a)}}}},[F.selectedElements,j,N,_,C]),le=function(e){return Math.round(e*(96/72))};return(0,r.useMemo)(function(){return{elements:j,canvasWidth:le(_),canvasHeight:le(C),selection:F,zoom:N,contextMenu:G,dragAndDrop:Y,addElement:$,updateElement:U,deleteElement:Q,deleteSelectedElements:K,duplicateElement:V,duplicateSelectedElements:J,copySelectedElements:ee,pasteElements:te,undo:ne,redo:re,canUndo:H.canUndo(),canRedo:H.canRedo(),history:H,zoomToSelection:ie,saveTemplate:oe,loadingStates:B,isSaving:B.saving,showContextMenu:ae,getAllElements:(0,r.useCallback)(function(){return j},[j]),getElementById:(0,r.useCallback)(function(e){return j.find(function(t){return t.id===e})},[j])}},[j,_,C,F,N,G,Y,$,U,Q,K,V,J,ee,te,ne,re,H,ae,ie,oe])}},811:(e,t,n)=>{n.d(t,{C:()=>f});var r=n(540);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e){var t=e.onSelectionChange,n=e.multiSelect,o=void 0===n||n,a=c((0,r.useState)([]),2),l=a[0],s=a[1],d=c((0,r.useState)(null),2),f=d[0],p=d[1],m=(0,r.useCallback)(function(e){o&&(arguments.length>1&&void 0!==arguments[1]&&arguments[1])?s(function(n){var r=n.includes(e)?n.filter(function(t){return t!==e}):[].concat(u(n),[e]);return null==t||t(r),r}):(s([e]),null==t||t([e]))},[o,t]),h=(0,r.useCallback)(function(e){s(e),null==t||t(e)},[t]),v=(0,r.useCallback)(function(){s([]),null==t||t([])},[t]),y=(0,r.useCallback)(function(e){return l.includes(e)},[l]),b=(0,r.useCallback)(function(e,t){p({startX:e,startY:t,endX:e,endY:t})},[]),g=(0,r.useCallback)(function(e,t){p(function(n){return n?i(i({},n),{},{endX:e,endY:t}):null})},[]),w=(0,r.useCallback)(function(e){if(f){var n=f.startX,r=f.startY,a=f.endX,i=f.endY,l=Math.min(n,a),c=Math.max(n,a),d=Math.min(r,i),m=Math.max(r,i),h=e.filter(function(e){var t=e.x+e.width/2,n=e.y+e.height/2;return t>=l&&t<=c&&n>=d&&n<=m}).map(function(e){return e.id});h.length>0&&(o?s(function(e){var n=u(new Set([].concat(u(e),u(h))));return null==t||t(n),n}):(s(h),null==t||t(h))),p(null)}},[f,o,t]),_=(0,r.useCallback)(function(){return u(l)},[l]),S=(0,r.useCallback)(function(){return u(l)},[l]);return{selectedElements:l,selectionBox:f,selectElement:m,selectAll:h,clearSelection:v,isSelected:y,startSelectionBox:b,updateSelectionBox:g,endSelectionBox:w,deleteSelected:_,duplicateSelected:S}}},874:(e,t,n)=>{n.d(t,{K:()=>o});var r=n(540),o=function(e){var t=e.onDelete,n=e.onCopy,o=e.onPaste,a=e.onUndo,i=e.onRedo,l=e.onSave,u=e.onZoomIn,c=e.onZoomOut,s=e.onSelectAll,d=e.onDeselectAll,f=e.onToolSelect,p=e.onToggleGrid;(0,r.useEffect)(function(){var e=function(e){if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&"true"!==e.target.contentEditable){var r=e.ctrlKey||e.metaKey;switch(e.key.toLowerCase()){case"delete":case"backspace":t&&(e.preventDefault(),t());break;case"c":r&&n&&(e.preventDefault(),n());break;case"v":r&&o&&(e.preventDefault(),o());break;case"z":r&&(e.preventDefault(),e.shiftKey&&i?i():a&&a());break;case"y":r&&i&&(e.preventDefault(),i());break;case"s":r&&l&&(e.preventDefault(),l());break;case"+":case"=":r&&u&&(e.preventDefault(),u());break;case"-":r&&c&&(e.preventDefault(),c());break;case"a":r&&s&&(e.preventDefault(),s());break;case"d":r&&d&&(e.preventDefault(),d());break;case"g":r&&p&&(e.preventDefault(),p());break;case"v":!r&&f&&(e.preventDefault(),f("select"));break;case"r":!r&&f&&(e.preventDefault(),f("rectangle"));break;case"t":!r&&f&&(e.preventDefault(),f("text"));break;case"i":!r&&f&&(e.preventDefault(),f("image"));break;case"l":!r&&f&&(e.preventDefault(),f("line"))}}};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[t,n,o,a,i,l,u,c,s,d,f,p])}}}]);