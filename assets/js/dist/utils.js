/*! For license information please see utils.js.LICENSE.txt */
"use strict";(self.webpackChunkwp_pdf_builder_pro=self.webpackChunkwp_pdf_builder_pro||[]).push([[738],{149:(e,t,n)=>{n.r(t),n.d(t,{useCanvasState:()=>r.v,useClipboard:()=>i.i,useContextMenu:()=>s.E,useDragAndDrop:()=>u.g,useHistory:()=>o.W,useKeyboardShortcuts:()=>c.K,useResize:()=>d.s,useRotation:()=>f.o,useSelection:()=>a.C,useZoom:()=>l.f});var r=n(169),o=n(232),a=n(698),i=n(430),l=n(553),s=n(364),c=n(960),u=n(174),d=n(630),f=n(920)},169:(e,t,n)=>{n.d(t,{v:()=>O});var r=n(540),o=n(232),a=n(698),i=n(430),l=n(553),s=n(364),c=n(174);function u(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof l?r:l,c=Object.create(s.prototype);return d(c,"_invoke",function(n,r,o){var a,l,s,c=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,l=0,s=e,f.n=n,i}};function p(n,r){for(l=n,s=r,t=0;!d&&c&&!o&&t<u.length;t++){var o,a=u[t],p=f.p,h=a[2];n>3?(o=h===r)&&(s=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,h){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),l=u,s=h;(t=l<2?e:s)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,s)):f.n=s:f.v=s);try{if(c=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==i)break}catch(t){a=e,l=1,s=t}finally{c=1}}return{value:t,done:d}}}(n,o,a),!0),c}var i={};function l(){}function s(){}function c(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(d(t={},r,function(){return this}),t),p=c.prototype=l.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,d(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=c,d(p,"constructor",c),d(c,"constructor",s),s.displayName="GeneratorFunction",d(c,o,"GeneratorFunction"),d(p),d(p,o,"Generator"),d(p,r,function(){return this}),d(p,"toString",function(){return"[object Generator]"}),(u=function(){return{w:a,m:h}})()}function d(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}d=function(e,t,n,r){function a(t,n){d(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},d(e,t,n,r)}function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function h(e,t,n,r,o,a,i){try{var l=e[a](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){h(a,r,o,i,l,"next",e)}function l(e){h(a,r,o,i,l,"throw",e)}i(void 0)})}}function y(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t,n){return(t=function(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t=(0,r.useRef)(e);return t.current=e,t};if("undefined"!=typeof window&&void 0===window.toastr){var C=function(e,t,n){var r=document.createElement("div");switch(r.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      z-index: 100;\n      padding: 15px 20px;\n      margin-bottom: 10px;\n      border-radius: 5px;\n      color: white;\n      font-family: Arial, sans-serif;\n      font-size: 14px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      max-width: 300px;\n      opacity: 0;\n      transform: translateX(100%);\n      transition: all 0.3s ease;\n    ",e){case"success":r.style.backgroundColor="#51A351";break;case"error":r.style.backgroundColor="#BD362F";break;case"warning":r.style.backgroundColor="#F89406";break;default:r.style.backgroundColor="#2F96B4"}var o=t?"<strong>".concat(t,"</strong><br>"):"";r.innerHTML="".concat(o).concat(n);var a=document.createElement("button");function i(e){e.style.opacity="0",e.style.transform="translateX(100%)",setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},300)}a.innerHTML="×",a.style.cssText="\n      position: absolute;\n      top: 5px;\n      right: 10px;\n      background: none;\n      border: none;\n      color: white;\n      font-size: 20px;\n      cursor: pointer;\n      opacity: 0.8;\n    ",a.onclick=function(){return i(r)},r.appendChild(a),document.body.appendChild(r),setTimeout(function(){r.style.opacity="1",r.style.transform="translateX(0)"},10),setTimeout(function(){return i(r)},5e3)};window.toastr={success:function(e,t){C("success",t,e)},error:function(e,t){C("error",t,e)},warning:function(e,t){C("warning",t,e)},info:function(e,t){C("info",t,e)},options:{}}}var O=function(e){var t,n=e.initialElements,d=void 0===n?[]:n,h=e.templateId,v=void 0===h?null:h,g=e.canvasWidth,_=void 0===g?595:g,S=e.canvasHeight,C=void 0===S?842:S,O=e.globalSettings,z=void 0===O?null:O,k=w((0,r.useState)(d),2),j=k[0],M=k[1],E=w((0,r.useState)(1),2),T=E[0],A=E[1],P=w((0,r.useState)(!1),2),I=P[0],D=(P[1],w((0,r.useState)({saving:!1,loading:!1,duplicating:!1,deleting:!1}),2)),W=D[0],B=D[1],F=(0,o.W)(),H=(0,a.C)({onSelectionChange:(0,r.useCallback)(function(e){},[]),multiSelect:null===(t=null==z?void 0:z.multiSelect)||void 0===t||t}),R=x(F),Z=x(H),L=(0,i.i)({onPaste:(0,r.useCallback)(function(e){if("elements"===e.type){var t=e.elements.map(function(t){return b(b({},t),{},{id:"element_".concat(T+e.elements.indexOf(t)),x:t.x+20,y:t.y+20})});M(function(e){return[].concat(y(e),y(t))}),A(function(e){return e+t.length}),H.selectAll(t.map(function(e){return e.id}))}},[T,H])}),G=(0,l.f)({initialZoom:z?parseFloat(z.defaultZoom)/100:1,minZoom:z?z.minZoom/100:.25,maxZoom:z?z.maxZoom/100:3,zoomStep:z?z.zoomStep/100:.1}),N=(0,s.E)(),X=(0,r.useCallback)(function(e,t){M(function(n){return n.map(function(n){if(n.id===e){var r=b(b({},n),t);return"divider"===n.type&&(r.height=16),"line"===n.type&&(r.height=12),r}return n})})},[]);(0,r.useEffect)(function(){if(j.length>0)try{R.current&&"function"==typeof R.current.addToHistory&&R.current.addToHistory({elements:j,nextId:T})}catch(e){}},[j,T]);var U=(0,r.useCallback)(function(e){return Array.isArray(e)?e.map(function(e){return e.id&&e.type?e:null}).filter(Boolean):[]},[]);(0,r.useEffect)(function(){var e=U(d);if(M(e),e&&e.length>0){var t=Math.max.apply(Math,y(e.map(function(e){var t,n=(null===(t=e.id)||void 0===t?void 0:t.split("_"))||[];return parseInt(n[1]||0)})));A(t+1)}else A(1)},[d,U]);var V=(0,c.g)({onElementMove:(0,r.useCallback)(function(e,t){X(e,t)},[X]),onElementDrop:(0,r.useCallback)(function(e,t){X(e,t),F.addToHistory({elements:j.map(function(n){return n.id===e?b(b({},n),t):n}),nextId:T})},[X,F,j,T])}),Y=(0,r.useCallback)(function(e){return e.map(function(e){var t=b({},e);return["domElement","ref","eventListeners","component","render"].forEach(function(e){delete t[e]}),t})},[]);(0,r.useEffect)(function(){if(j.length>0||0===F.historySize){var e=Y(j);F.addToHistory({elements:e,nextId:T})}},[j,T,F,Y]),(0,r.useEffect)(function(){var e=["product_table","customer_info","company_logo","company_info","order_number","document_type","progress-bar"];j.some(function(t){return e.includes(t.type)&&"transparent"!==t.backgroundColor})&&M(function(t){return t.map(function(t){return e.includes(t.type)&&"transparent"!==t.backgroundColor?b(b({},t),{},{backgroundColor:"transparent"}):t})})},[]);var q=(0,r.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=R.current,r=Z.current;if(r&&n&&"function"==typeof r.selectElement&&"function"==typeof n.addToHistory){var o=b(b({id:"element_".concat(T),type:e},{x:50,y:50,width:100,height:50,backgroundColor:"transparent",borderColor:"transparent",borderWidth:0,borderStyle:"solid",borderRadius:0,color:"#1e293b",fontFamily:"Inter, sans-serif",fontSize:14,fontWeight:"normal",fontStyle:"normal",textAlign:"left",textDecoration:"none",text:"Texte",opacity:100,rotation:0,scale:100,visible:!0,src:"",alt:"",objectFit:"cover",brightness:100,contrast:100,saturate:100,shadow:!1,shadowColor:"#000000",shadowOffsetX:2,shadowOffsetY:2,showHeaders:!0,showBorders:!0,dataSource:"order_items",showSubtotal:!1,showShipping:!0,showTaxes:!0,showDiscount:!1,showTotal:!1,progressColor:"#3b82f6",progressValue:75,lineColor:"#64748b",lineWidth:2,documentType:"invoice",imageUrl:"",spacing:8,layout:"vertical",alignment:"left",fit:"contain"}),t);"line"===e?(o.height=12,o.width=200):"divider"===e&&(o.height=16,o.width=200),M(function(e){var t=[].concat(y(e),[o]);try{n&&"function"==typeof n.addToHistory&&n.addToHistory({elements:t,nextId:T+1})}catch(e){}return t}),A(function(e){return e+1});try{r&&"function"==typeof r.selectElement&&r.selectElement(o.id)}catch(e){}}},[T]),$=(0,r.useCallback)(function(e){M(function(t){var n=t.filter(function(t){return t.id!==e});return F.addToHistory({elements:n,nextId:T}),n}),H.clearSelection()},[H,F,T]),Q=(0,r.useCallback)(function(){var e=H.deleteSelected();M(function(t){var n=t.filter(function(t){return!e.includes(t.id)});return F.addToHistory({elements:n,nextId:T}),n}),H.clearSelection()},[H,F,T]),K=(0,r.useCallback)(function(e){var t=j.find(function(t){return t.id===e});if(t){var n=b(b({},t),{},{id:"element_".concat(T),x:t.x+20,y:t.y+20});M(function(e){var t=[].concat(y(e),[n]);return F.addToHistory({elements:t,nextId:T+1}),t}),A(function(e){return e+1}),H.selectElement(n.id)}},[j,T,H,F]),J=(0,r.useCallback)(function(){var e=H.duplicateSelected(),t=[];e.forEach(function(e){var n=j.find(function(t){return t.id===e});if(n){var r=b(b({},n),{},{id:"element_".concat(T+t.length),x:n.x+20,y:n.y+20});t.push(r)}}),t.length>0&&(M(function(e){var n=[].concat(y(e),t);return F.addToHistory({elements:n,nextId:T+t.length}),n}),A(function(e){return e+t.length}),H.selectAll(t.map(function(e){return e.id})))},[j,T,H,F]),ee=(0,r.useCallback)(function(){var e=H.selectedElements,t=j.filter(function(t){return e.includes(t.id)});t.length>0&&L.copy({type:"elements",elements:t})},[j,H,L]),te=(0,r.useCallback)(function(){L.paste()},[L]),ne=(0,r.useCallback)(function(){var e=F.undo();e&&(M(e.elements),A(e.nextId),H.clearSelection())},[F,H]),re=(0,r.useCallback)(function(){var e=F.redo();e&&(M(e.elements),A(e.nextId),H.clearSelection())},[F,H]),oe=(0,r.useCallback)(m(u().m(function e(){var t,n,r,o,a,i,l,s,c,d,h,m,y,g,S,x,O,z,k,M,E,T,A,P,I;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!W.saving){e.n=1;break}return e.a(2);case 1:return B(function(e){return b(b({},e),{},{saving:!0})}),t=v&&"0"!==v&&0!==v,n=function(){return Promise.resolve(!0)},e.n=2,n();case 2:r=e.v,e.p=3,d=function(e){for(var t=["domElement","eventListeners","ref","onClick","onMouseDown","onMouseUp","onMouseMove","onContextMenu","onDoubleClick","onDragStart","onDragEnd","onResize","component","render","props","state","context","refs","_reactInternalInstance","_reactInternals","$$typeof","constructor","prototype","_owner","_store","key","ref","_self","_source"],n={},r=0,o=Object.entries(e);r<o.length;r++){var a=w(o[r],2),i=a[0],l=a[1];if(!t.includes(i)&&!i.startsWith("_")){var s,c,u,d,f,h,m=l;if(["x","y","width","height","fontSize","opacity","lineHeight","letterSpacing","zIndex","borderWidth","borderRadius","rotation","padding","scale","shadowOffsetX","shadowOffsetY","brightness","contrast","saturate","progressValue","lineWidth","spacing"].includes(i)&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(m={x:0,y:0,width:100,height:50,fontSize:14,opacity:1,lineHeight:1.2,letterSpacing:0,zIndex:0,borderWidth:0,borderRadius:0,rotation:0,padding:0}[i]||0):m=parseFloat(l)),["color","backgroundColor","borderColor","shadowColor","progressColor","lineColor"].includes(i)&&l&&"transparent"!==l&&!/^#[0-9A-Fa-f]{3,6}$/i.test(l)&&(m={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#008000",blue:"#0000ff",gray:"#808080",grey:"#808080",transparent:"transparent"}[l.toLowerCase()]||"#000000"),"fontWeight"===i&&(["normal","bold","100","200","300","400","500","600","700","800","900"].includes(l)||(m="normal")),"textAlign"===i&&(["left","center","right","justify"].includes(l)||(m="left")),"textDecoration"===i&&(["none","underline","overline","line-through"].includes(l)||(m="none")),"textTransform"===i&&(["none","capitalize","uppercase","lowercase"].includes(l)||(m="none")),"borderStyle"===i&&(["solid","dashed","dotted","double","none"].includes(l)||(m="solid")),"text"!==i&&"content"!==i||"string"!=typeof l&&(m=""),"fontFamily"===i&&("string"==typeof l&&""!==l.trim()||(m="Inter, sans-serif")),"fontStyle"===i&&(["normal","italic","oblique"].includes(l)||(m="normal")),"visible"===i&&"boolean"!=typeof l&&(m=!0),"scale"===i&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(m=100):m=parseFloat(l),m=Math.max(10,Math.min(500,m))),"shadow"===i&&"boolean"!=typeof l&&(m=!1),"shadowColor"===i&&l&&"transparent"!==l&&!/^#[0-9A-Fa-f]{3,6}$/i.test(l)&&(m={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#008000",blue:"#0000ff",gray:"#808080",grey:"#808080",transparent:"transparent"}[l.toLowerCase()]||"#000000"),["shadowOffsetX","shadowOffsetY"].includes(i)&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(m=2):m=parseFloat(l)),"brightness"!==i&&"contrast"!==i&&"saturate"!==i||("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(m=100):m=parseFloat(l),m=Math.max(0,Math.min(200,m))),"objectFit"===i&&(["fill","contain","cover","none","scale-down"].includes(l)||(m="cover")),["showHeaders","showBorders","showSubtotal","showShipping","showTaxes","showDiscount","showTotal"].includes(i)&&"boolean"!=typeof l&&(m=!1),"dataSource"===i&&(["order_items","cart_items","custom"].includes(l)||(m="order_items")),"progressValue"===i&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(m=0):m=parseFloat(l),m=Math.max(0,Math.min(100,m))),"lineWidth"===i&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(m=2):m=parseFloat(l),m=Math.max(1,Math.min(10,m))),"spacing"===i&&("string"!=typeof l||""===l||isNaN(l)?"number"!=typeof l&&(m=8):m=parseFloat(l)),"layout"===i&&(["vertical","horizontal","grid"].includes(l)||(m="vertical")),"alignment"===i&&(["left","center","right","justify"].includes(l)||(m="left")),"fit"===i&&(["contain","cover","fill","none"].includes(l)||(m="contain")),"documentType"===i&&(["invoice","quote","receipt","order"].includes(l)||(m="invoice")),"columns"===i&&(m="object"===p(l)&&null!==l?{image:null===(s=l.image)||void 0===s||s,name:null===(c=l.name)||void 0===c||c,sku:null!==(u=l.sku)&&void 0!==u&&u,quantity:null===(d=l.quantity)||void 0===d||d,price:null===(f=l.price)||void 0===f||f,total:null===(h=l.total)||void 0===h||h}:{image:!0,name:!0,sku:!1,quantity:!0,price:!0,total:!0}),null!=m)if("string"==typeof m||"number"==typeof m||"boolean"==typeof m)n[i]=m;else if(Array.isArray(m))try{var y=m.filter(function(e){return null!=e}).map(function(e){if("object"===p(e)&&null!==e){for(var t={},n=0,r=Object.entries(e);n<r.length;n++){var o=w(r[n],2),a=o[0],i=o[1];"string"!=typeof i&&"number"!=typeof i&&"boolean"!=typeof i||(t[a]=i)}return t}return"string"==typeof e||"number"==typeof e||"boolean"==typeof e?e:null}).filter(function(e){return null!==e});JSON.stringify(y),n[i]=y}catch(e){console.warn("Impossible de sérialiser le tableau pour ".concat(i,", utilisation tableau vide:"),e),n[i]=[]}else if("object"===p(m))try{for(var v={},b=0,g=Object.entries(m);b<g.length;b++){var _=w(g[b],2),S=_[0],x=_[1];S.startsWith("_")||t.includes(S)||"string"!=typeof x&&"number"!=typeof x&&"boolean"!=typeof x||(v[S]=x)}JSON.stringify(v),n[i]=v}catch(e){console.warn("Impossible de sérialiser l'objet pour ".concat(i,", utilisation objet vide:"),e),n[i]={}}else console.warn("Type non supporté ignoré pour ".concat(i,": ").concat(p(m)))}}return n},h=[];try{j.forEach(function(e,t){e&&p(e),e&&e.id,e&&e.type}),h=j.filter(function(e){return e&&"object"===p(e)&&e.id&&e.type}).map(d).filter(function(e){return e&&e.id&&e.type}),JSON.stringify(h)}catch(e){console.error("❌ PDF Builder SAVE - Erreur lors du nettoyage des éléments:",e),console.error("❌ PDF Builder SAVE - Éléments originaux qui ont causé l'erreur:",j),h=[]}if(m={elements:h,canvasWidth:_,canvasHeight:C,version:"1.0"},e.p=4,y=JSON.stringify(m),(g=JSON.parse(y)).elements&&Array.isArray(g.elements)){e.n=5;break}throw new Error("Structure de données invalide: éléments manquants ou incorrects");case 5:S=f(g.elements),e.p=6,S.s();case 7:if((x=S.n()).done){e.n=9;break}if((O=x.value).id&&O.type){e.n=8;break}throw new Error("Élément invalide détecté: ID ou type manquant pour ".concat(JSON.stringify(O)));case 8:e.n=7;break;case 9:e.n=11;break;case 10:e.p=10,A=e.v,S.e(A);case 11:return e.p=11,S.f(),e.f(11);case 12:e.n=14;break;case 13:throw e.p=13,P=e.v,console.error("Erreur de validation JSON côté client:",P),console.error("Données templateData qui ont causé l'erreur:",m),new Error("Données JSON invalides côté client: "+P.message);case 14:return(z=new FormData).append("action","pdf_builder_pro_save_template"),z.append("template_data",y),z.append("template_name",(null===(o=window.pdfBuilderData)||void 0===o?void 0:o.templateName)||"Template ".concat((null===(a=window.pdfBuilderData)||void 0===a?void 0:a.templateId)||"New")),z.append("template_id",(null===(i=window.pdfBuilderData)||void 0===i?void 0:i.templateId)||"0"),z.append("nonce",(null===(l=window.pdfBuilderAjax)||void 0===l?void 0:l.nonce)||(null===(s=window.pdfBuilderData)||void 0===s?void 0:s.nonce)||""),e.n=15,fetch((null===(c=window.pdfBuilderAjax)||void 0===c?void 0:c.ajaxurl)||"/wp-admin/admin-ajax.php",{method:"POST",body:z});case 15:return k=e.v,e.n=16,k.json();case 16:if((M=e.v).success){e.n=17;break}throw new Error((null===(E=M.data)||void 0===E?void 0:E.message)||"Erreur lors de la sauvegarde");case 17:return t&&(r?toastr.success("Modifications du canvas sauvegardées avec succès !"):alert("Modifications du canvas sauvegardées avec succès !")),e.a(2,m);case 18:throw e.p=18,I=e.v,console.error("❌ PDF Builder SAVE - Erreur lors de la sauvegarde:",I),console.error("❌ PDF Builder SAVE - Détails de l'erreur:",{message:I.message,stack:I.stack,name:I.name}),T=I.message||"Erreur inconnue lors de la sauvegarde",r?toastr.error("Erreur lors de la sauvegarde: ".concat(T)):alert("Erreur lors de la sauvegarde: ".concat(T)),I;case 19:return e.p=19,B(function(e){return b(b({},e),{},{saving:!1})}),e.f(19);case 20:return e.a(2)}},e,null,[[6,10,11,12],[4,13],[3,18,19,20]])})),[j,_,C,I,v]),ae=((0,r.useCallback)(function(e){e.elements&&(M(e.elements),A(e.nextId||Math.max.apply(Math,y(e.elements.map(function(e){return parseInt(e.id.split("_")[1])})||[0]))+1),H.clearSelection(),F.clearHistory())},[H,F]),(0,r.useCallback)(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=[];n?r.push({label:"Dupliquer",action:function(){return K(n)}},{label:"Supprimer",action:function(){return $(n)}},{type:"separator"},{label:"Copier",action:ee},{label:"Coller",action:te,disabled:!L.hasData()}):H.selectedElements.length>0?r.push({label:"Dupliquer",action:J},{label:"Supprimer",action:Q},{type:"separator"},{label:"Copier",action:ee},{label:"Coller",action:te,disabled:!L.hasData()}):r.push({label:"Coller",action:te,disabled:!L.hasData()}),N.showContextMenu(e,t,r)},[H,N,K,$,ee,te,L,J,Q])),ie=(0,r.useCallback)(function(){var e=H.selectedElements;if(0!==e.length){var t=j.filter(function(t){return e.includes(t.id)});if(0!==t.length){var n=document.querySelector(".canvas-container");if(n){var r=n.getBoundingClientRect(),o=r.width,a=r.height;G.zoomToSelection(t,_,C,o,a)}}}},[H.selectedElements,j,G,_,C]);return(0,r.useMemo)(function(){return{elements:j,canvasWidth:_,canvasHeight:C,selection:H,zoom:G,contextMenu:N,dragAndDrop:V,addElement:q,updateElement:X,deleteElement:$,deleteSelectedElements:Q,duplicateElement:K,duplicateSelectedElements:J,copySelectedElements:ee,pasteElements:te,undo:ne,redo:re,canUndo:F.canUndo(),canRedo:F.canRedo(),history:F,zoomToSelection:ie,saveTemplate:oe,loadingStates:W,isSaving:W.saving,showContextMenu:ae,getAllElements:(0,r.useCallback)(function(){return j},[j]),getElementById:(0,r.useCallback)(function(e){return j.find(function(t){return t.id===e})},[j])}},[j,_,C,H,G,N,V,q,X,$,Q,K,J,ee,te,ne,re,F,ae,ie,oe])}},174:(e,t,n)=>{n.d(t,{g:()=>l});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var l=function(e){var t=e.onElementMove,n=e.onElementDrop,i=e.snapToGrid,l=void 0===i||i,s=e.gridSize,c=void 0===s?10:s,u=e.zoom,d=void 0===u?1:u,f=e.canvasWidth,p=void 0===f?595:f,h=e.canvasHeight,m=void 0===h?842:h,y=e.guides,v=void 0===y?{horizontal:[],vertical:[]}:y,b=e.snapToGuides,g=void 0===b||b,w=o((0,r.useState)(!1),2),_=w[0],S=w[1],x=o((0,r.useState)({x:0,y:0}),2),C=x[0],O=x[1],z=o((0,r.useState)(null),2),k=z[0],j=z[1],M=(0,r.useRef)({x:0,y:0}),E=(0,r.useRef)({x:0,y:0}),T=(0,r.useRef)(null),A=(0,r.useRef)({x:0,y:0}),P=(0,r.useCallback)(function(e){return l?Math.round(e/c)*c:e},[l,c]),I=(0,r.useCallback)(function(e){if(!g)return e;var t,n=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=a(e))){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(l)throw o}}}}(arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?v.vertical:v.horizontal);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(Math.abs(e-r)<=5)return r}}catch(e){n.e(e)}finally{n.f()}return e},[g,v]),D=(0,r.useCallback)(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("line"===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)&&!t)return e;var n=e;return n=P(n),I(n,t)},[P,I]);(0,r.useEffect)(function(){return function(){T.current&&(document.removeEventListener("mousemove",T.current.handleMouseMove),document.removeEventListener("mouseup",T.current.handleMouseUp),T.current=null)}},[]);var W=(0,r.useCallback)(function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(0===e.button)if(e.target&&e.target.isConnected)if(e.target.parentNode&&e.target.parentNode.isConnected){e.preventDefault(),S(!0),j(t);var l=o||{left:0,top:0,width:p,height:m},s=a||d||1,c=(e.clientX-l.left)/s,u=(e.clientY-l.top)/s;M.current={x:c-r.left,y:u-r.top},E.current={x:r.left,y:r.top};var f=function(e){if(T.current){var t=(e.clientX-l.left)/s,n=(e.clientY-l.top)/s,i=t-c,d=n-u,f=o?o.width/a:p,h=o?o.height/a:m,y=Math.max(0,Math.min(f-r.width,D(r.left+i,!1,b))),v=Math.max(0,Math.min(h-r.height,D(r.top+d,!0,b))),b=T.current.elementType,g={x:y-r.left,y:v-r.top};O(g),A.current=g}else console.warn("Drag data no longer exists during move")},h=function(){if(!T.current)return console.warn("Drag data no longer exists during drop"),S(!1),O({x:0,y:0}),void j(null);var e=T.current,t=e.elementId;if(e.elementType,S(!1),n&&t){var r=E.current.x+A.current.x,o=E.current.y+A.current.y;n(t,{x:r,y:o})}else console.warn("[DEBUG] onElementDrop not called - elementId:",t,"onElementDrop:",!!n);O({x:0,y:0}),j(null),E.current={x:0,y:0},A.current={x:0,y:0},document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",h),T.current=null};T.current={handleMouseMove:f,handleMouseUp:h,elementId:t,elementType:i},document.addEventListener("mousemove",f),document.addEventListener("mouseup",h)}else console.warn("Drag target parent no longer exists in DOM");else console.warn("Drag target no longer exists in DOM")},[P,t,n,d,p,m]);return{isDragging:_,dragOffset:C,draggedElementId:k,handleMouseDown:W,handleDragStart:(0,r.useCallback)(function(e,t,n){e.dataTransfer.setData("text/plain",t),e.dataTransfer.effectAllowed="move",M.current={x:e.clientX-n.left,y:e.clientY-n.top}},[]),handleDragOver:(0,r.useCallback)(function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"},[]),handleDrop:(0,r.useCallback)(function(e,t,r){e.preventDefault();var o=e.dataTransfer.getData("text/plain");if(o){var a=(e.clientX-t.left-M.current.x)/d,i=(e.clientY-t.top-M.current.y)/d,l=t?t.width/d:p,s=t?t.height/d:m,c=Math.max(0,Math.min(l-r.width,D(a,!1))),u=Math.max(0,Math.min(s-r.height,D(i,!0)));n&&n(o,{x:c,y:u})}},[P,n,d,p,m])}}},232:(e,t,n)=>{n.d(t,{W:()=>i});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).maxHistorySize,t=void 0===e?50:e,n=o((0,r.useState)([]),2),a=n[0],i=n[1],l=o((0,r.useState)(-1),2),s=l[0],c=l[1],u=(0,r.useRef)(!1);return{addToHistory:(0,r.useCallback)(function(e){u.current?u.current=!1:i(function(n){var r=n.slice(0,s+1);return r.push(e),r.length>t?(r.shift(),c(r.length-1),r):(c(r.length-1),r)})},[s,t]),undo:(0,r.useCallback)(function(){return s>0?(u.current=!0,c(function(e){return e-1}),a[s-1]):null},[s,a]),redo:(0,r.useCallback)(function(){return s<a.length-1?(u.current=!0,c(function(e){return e+1}),a[s+1]):null},[s,a]),canUndo:(0,r.useCallback)(function(){return s>0},[s]),canRedo:(0,r.useCallback)(function(){return s<a.length-1},[s]),clearHistory:(0,r.useCallback)(function(){i([]),c(-1)},[]),getCurrentState:(0,r.useCallback)(function(){return s>=0?a[s]:null},[s,a]),historySize:a.length,currentIndex:s}}},364:(e,t,n)=>{n.d(t,{E:()=>i});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(){var e=o((0,r.useState)(null),2),t=e[0],n=e[1],a=o((0,r.useState)(!1),2),i=a[0],l=a[1],s=(0,r.useCallback)(function(e,t,r){var o=36*r.length,a=e,i=t;e+180>window.innerWidth&&(a=e-180),t+o>window.innerHeight&&(i=t-o),a=Math.max(0,Math.min(a,window.innerWidth-180)),i=Math.max(0,Math.min(i,window.innerHeight-o)),n({x:a,y:i,items:r})},[]),c=(0,r.useCallback)(function(){t&&(l(!0),setTimeout(function(){n(null),l(!1)},150))},[t]),u=(0,r.useCallback)(function(e){return c(),e},[c]);return(0,r.useEffect)(function(){var e=function(e){t&&!e.target.closest(".context-menu")&&c()},n=function(e){"Escape"===e.key&&t&&c()};return t&&(document.addEventListener("mousedown",e),document.addEventListener("keydown",n)),function(){document.removeEventListener("mousedown",e),document.removeEventListener("keydown",n)}},[t,c]),{contextMenu:t,showContextMenu:s,hideContextMenu:c,handleContextMenuAction:u,isAnimating:i}}},430:(e,t,n)=>{n.d(t,{i:()=>a});var r=n(540);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e){var t,n,a=e.onPaste,i=(t=(0,r.useState)(null),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=i[0],s=i[1],c=(0,r.useCallback)(function(e){s(e)},[]),u=(0,r.useCallback)(function(){return l&&a&&a(l),l},[l,a]),d=(0,r.useCallback)(function(e){return c(e),e},[c]),f=(0,r.useCallback)(function(){return null!==l},[l]),p=(0,r.useCallback)(function(){s(null)},[]);return{copy:c,paste:u,cut:d,hasData:f,clear:p,clipboardData:l}}},455:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}n.d(t,{l:()=>c});var c=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.propertyValidators=new Map,this.propertyPresets=new Map,this.propertyGroups=new Map,this.initDefaults()},t=[{key:"initDefaults",value:function(){var e=this;this.propertyValidators.set("numeric",function(e){return parseFloat(e)||0}),this.propertyValidators.set("positiveNumeric",function(e){return Math.max(0,parseFloat(e)||0)}),this.propertyValidators.set("percentage",function(e){return Math.max(0,Math.min(100,parseFloat(e)||100))}),this.propertyValidators.set("angle",function(e){return((parseFloat(e)||0)%360+360)%360}),this.propertyValidators.set("color",function(t){return e.validateColor(t)}),this.propertyValidators.set("fontSize",function(e){return Math.max(8,Math.min(72,parseInt(e)||14))}),this.propertyValidators.set("borderWidth",function(e){return Math.max(0,Math.min(20,parseInt(e)||0))}),this.propertyValidators.set("borderStyle",function(e){return["solid","dashed","dotted","double"].includes(e)?e:"solid"}),this.propertyValidators.set("borderRadius",function(e){return Math.max(0,Math.min(100,parseInt(e)||0))}),this.propertyPresets.set("colors",{slate:["#f8fafc","#f1f5f9","#e2e8f0","#cbd5e1","#94a3b8","#64748b","#475569","#334155","#1e293b"],blue:["#eff6ff","#dbeafe","#bfdbfe","#93c5fd","#60a5fa","#3b82f6","#2563eb","#1d4ed8","#1e40af"],green:["#f0fdf4","#dcfce7","#bbf7d0","#86efac","#4ade80","#22c55e","#16a34a","#15803d","#166534"],red:["#fef2f2","#fee2e2","#fecaca","#fca5a5","#f87171","#ef4444","#dc2626","#b91c1c","#991b1b"]}),this.propertyGroups.set("position",["x","y"]),this.propertyGroups.set("dimensions",["width","height"]),this.propertyGroups.set("typography",["fontFamily","fontSize","fontWeight","fontStyle","color","textAlign"]),this.propertyGroups.set("appearance",["backgroundColor","borderColor","borderWidth","borderRadius"]),this.propertyGroups.set("effects",["opacity","shadow","brightness","contrast","saturate"]),this.propertyGroups.set("transform",["rotation","scale"])}},{key:"validateColor",value:function(e){if(!e)return"#000000";if(/^#[0-9A-Fa-f]{6}$/.test(e)||/^#[0-9A-Fa-f]{3}$/.test(e))return e;var t=document.createElement("div");return t.style.color=e,t.style.color||"#000000"}},{key:"validateProperty",value:function(e,t){if("boolean"==typeof t)return t;if(e.startsWith("columns."))return t;var n=this.propertyValidators.get(e);if(n)try{return n(t)}catch(t){return this.getDefaultValue(e)}return this.isNumericProperty(e)?this.validateNumericProperty(e,t):this.isColorProperty(e)?this.validateColorProperty(t):this.isTextStyleProperty(e)?this.validateTextStyleProperty(e,t):t}},{key:"isNumericProperty",value:function(e){return["x","y","width","height","fontSize","opacity","lineHeight","letterSpacing","zIndex","borderWidth","borderRadius","rotation","padding"].includes(e)}},{key:"isColorProperty",value:function(e){return["color","backgroundColor","borderColor"].includes(e)}},{key:"isTextStyleProperty",value:function(e){return["fontWeight","textAlign","textDecoration","textTransform","borderStyle"].includes(e)}},{key:"validateNumericProperty",value:function(e,t){if(null==t||""===t)return this.getDefaultValue(e);var n;if("string"==typeof t){if(n=parseFloat(t),isNaN(n))return this.getDefaultValue(e)}else{if("number"!=typeof t)return this.getDefaultValue(e);n=t}var r={fontSize:{min:8,max:72},opacity:{min:0,max:1},lineHeight:{min:.5,max:3},letterSpacing:{min:-5,max:10},zIndex:{min:-100,max:1e3},borderWidth:{min:0,max:20},borderRadius:{min:0,max:100},rotation:{min:-180,max:180},padding:{min:0,max:100}};if(r[e]){var o=r[e],a=o.min,i=o.max;n=Math.max(a,Math.min(i,n))}return n}},{key:"validateColorProperty",value:function(e){if(!e)return"#000000";if("transparent"===e)return e;if(/^#[0-9A-Fa-f]{6}$/.test(e)||/^#[0-9A-Fa-f]{3}$/.test(e))return e;var t=document.createElement("div");t.style.color=e;var n=t.style.color;return n&&""!==n?e:"#000000"}},{key:"validateTextStyleProperty",value:function(e,t){var n={fontWeight:["normal","bold","100","200","300","400","500","600","700","800","900"],textAlign:["left","center","right","justify"],textDecoration:["none","underline","overline","line-through"],textTransform:["none","capitalize","uppercase","lowercase"],borderStyle:["solid","dashed","dotted","double","none"]};return n[e]&&n[e].includes(t)?t:{fontWeight:"normal",textAlign:"left",textDecoration:"none",textTransform:"none",borderStyle:"solid"}[e]||t}},{key:"getDefaultValue",value:function(e){return{x:0,y:0,width:100,height:50,fontSize:14,opacity:1,lineHeight:1.2,letterSpacing:0,zIndex:0,borderWidth:0,borderRadius:0,rotation:0,padding:0,color:"#333333",backgroundColor:"transparent",borderColor:"#dddddd",fontWeight:"normal",textAlign:"left",textDecoration:"none",textTransform:"none",borderStyle:"solid"}[e]||null}},{key:"getPresets",value:function(e){return this.propertyPresets.get(e)||{}}},{key:"getPropertiesInGroup",value:function(e){return this.propertyGroups.get(e)||[]}},{key:"applyPreset",value:function(e,t){return{"text-title":{fontSize:24,fontWeight:"bold",textAlign:"center",color:"#1e293b"},"text-subtitle":{fontSize:18,fontWeight:"bold",textAlign:"left",color:"#334155"},"text-body":{fontSize:14,fontWeight:"normal",textAlign:"left",color:"#475569"},"text-caption":{fontSize:12,fontWeight:"normal",textAlign:"left",color:"#64748b"},"shape-rounded":{borderRadius:8,borderWidth:1,borderColor:"transparent"},"shape-circle":{borderRadius:50,borderWidth:1,borderColor:"transparent"},"shape-square":{borderRadius:0,borderWidth:1,borderColor:"transparent"},"effect-shadow-soft":{shadow:!0,shadowColor:"#000000",shadowOffsetX:1,shadowOffsetY:1,opacity:90},"effect-shadow-strong":{shadow:!0,shadowColor:"#000000",shadowOffsetX:3,shadowOffsetY:3,opacity:85},"effect-glow":{shadow:!0,shadowColor:"#2563eb",shadowOffsetX:0,shadowOffsetY:0,opacity:95},"color-primary":{backgroundColor:"#2563eb",color:"#ffffff"},"color-secondary":{backgroundColor:"#64748b",color:"#ffffff"},"color-success":{backgroundColor:"#16a34a",color:"#ffffff"},"color-warning":{backgroundColor:"#ca8a04",color:"#ffffff"},"color-error":{backgroundColor:"#dc2626",color:"#ffffff"}}[e]||{}}},{key:"getDefaultProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"text";return a(a({},{x:50,y:50,width:100,height:50,opacity:100,rotation:0,scale:100,visible:!0,backgroundColor:"transparent",borderColor:"transparent",borderWidth:0,borderStyle:"solid",borderRadius:0,color:"#1e293b",fontFamily:"Inter, sans-serif",fontSize:14,fontWeight:"normal",fontStyle:"normal",textAlign:"left",textDecoration:"none",text:"Texte",src:"",alt:"",objectFit:"cover",shadow:!1,shadowColor:"#000000",shadowOffsetX:2,shadowOffsetY:2,brightness:100,contrast:100,saturate:100,showHeaders:!0,showBorders:!0,headers:["Produit","Qté","Prix"],dataSource:"order_items",columns:{image:!0,name:!0,sku:!1,quantity:!0,price:!0,total:!0},showSubtotal:!1,showShipping:!0,showTaxes:!0,showDiscount:!1,showTotal:!1,progressColor:"#3b82f6",progressValue:75,lineColor:"#64748b",lineWidth:2,documentType:"invoice",imageUrl:"",spacing:8,layout:"vertical",alignment:"left",fit:"contain"}),{text:{width:150,height:30},image:{width:150,height:100},rectangle:{backgroundColor:"#f1f5f9",borderWidth:1,width:150,height:80},product_table:{width:300,height:150},customer_info:{width:200,height:100},company_logo:{width:100,height:60},order_number:{width:150,height:30},company_info:{width:200,height:80},document_type:{width:120,height:40},watermark:{width:300,height:200,opacity:10,text:"CONFIDENTIEL"},"progress-bar":{width:200,height:20},barcode:{width:150,height:60},qrcode:{width:80,height:80},icon:{width:50,height:50},line:{width:200,height:2}}[e]||{})}},{key:"getComputedProperties",value:function(e){return{absoluteX:e.x+e.width/2,absoluteY:e.y+e.height/2,scaledWidth:e.width*(e.scale/100),scaledHeight:e.height*(e.scale/100),cssTransform:"rotate(".concat(e.rotation,"deg) scale(").concat(e.scale/100,")"),cssFilter:"brightness(".concat(e.brightness,"%) contrast(").concat(e.contrast,"%) saturate(").concat(e.saturate,"%)"),cssBoxShadow:e.shadow?"".concat(e.shadowOffsetX||0,"px ").concat(e.shadowOffsetY||0,"px 4px ").concat(e.shadowColor||"#000000"):"none"}}},{key:"isAnimatable",value:function(e){return["x","y","width","height","rotation","scale","opacity","brightness","contrast","saturate"].includes(e)}},{key:"getPropertyConstraints",value:function(e){return{x:{min:-1e3,max:2e3,step:1},y:{min:-1e3,max:2e3,step:1},width:{min:1,max:2e3,step:1},height:{min:1,max:2e3,step:1},fontSize:{min:8,max:72,step:1},borderWidth:{min:0,max:20,step:1},borderRadius:{min:0,max:100,step:1},rotation:{min:-180,max:180,step:1},scale:{min:10,max:200,step:5},opacity:{min:0,max:100,step:1},brightness:{min:0,max:200,step:5},contrast:{min:0,max:200,step:5},saturate:{min:0,max:200,step:5},shadowOffsetX:{min:-50,max:50,step:1},shadowOffsetY:{min:-50,max:50,step:1}}[e]||{}}}],t&&l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}())},553:(e,t,n)=>{n.d(t,{f:()=>i});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e){var t=e.initialZoom,n=void 0===t?1:t,a=e.minZoom,i=void 0===a?.1:a,l=e.maxZoom,s=void 0===l?3:l,c=e.zoomStep,u=void 0===c?.1:c,d=o((0,r.useState)(n),2),f=d[0],p=d[1],h=o((0,r.useState)({x:0,y:0}),2),m=h[0],y=h[1],v=(0,r.useCallback)(function(){p(function(e){return Math.min(e+u,s)})},[s,u]),b=(0,r.useCallback)(function(){p(function(e){return Math.max(e-u,i)})},[i,u]),g=(0,r.useCallback)(function(e){var t=Math.max(i,Math.min(s,e));p(t)},[i,s]),w=(0,r.useCallback)(function(){p(n)},[n]),_=(0,r.useCallback)(function(e,t,n,r){var o=n/e,a=r/t,l=Math.min(o,a,s);p(Math.max(l,i))},[i,s]),S=(0,r.useCallback)(function(e,t,n){var r=Math.max(i,Math.min(s,f*n));y({x:e,y:t}),p(r)},[f,i,s]),x=(0,r.useCallback)(function(e,t,n,r,o){if(e&&0!==e.length){var a=1/0,l=1/0,c=-1/0,u=-1/0;e.forEach(function(e){a=Math.min(a,e.x),l=Math.min(l,e.y),c=Math.max(c,e.x+e.width),u=Math.max(u,e.y+e.height)});var d=c-a,f=u-l,h=r/(1.2*d),m=o/(1.2*f),v=Math.min(h,m,s),b=Math.max(i,Math.min(s,v)),g=r/2-(a+d/2)*b,w=o/2-(l+f/2)*b;p(b),y({x:g,y:w})}},[i,s]),C=(0,r.useCallback)(function(){return{transform:"scale(".concat(f,")"),transformOrigin:"".concat(m.x,"px ").concat(m.y,"px")}},[f,m]),O=(0,r.useCallback)(function(e,t){return{x:(e-m.x)/f,y:(t-m.y)/f}},[f,m]),z=(0,r.useCallback)(function(e,t){return{x:e*f+m.x,y:t*f+m.y}},[f,m]);return{zoom:f,zoomOrigin:m,zoomIn:v,zoomOut:b,setZoomLevel:g,resetZoom:w,zoomToFit:_,zoomToPoint:S,zoomToSelection:x,getTransformStyle:C,screenToCanvas:O,canvasToScreen:z}}},630:(e,t,n)=>{n.d(t,{s:()=>d});var r=n(540);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n){return(t=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var d=function(e){var t=e.onElementResize,n=e.snapToGrid,o=void 0===n||n,a=e.gridSize,l=void 0===a?10:a,u=e.minWidth,d=void 0===u?20:u,f=e.minHeight,p=void 0===f?20:f,h=e.zoom,m=void 0===h?1:h,y=e.canvasRect,v=void 0===y?null:y,b=e.canvasWidth,g=void 0===b?595:b,w=e.canvasHeight,_=void 0===w?842:w,S=e.guides,x=void 0===S?{horizontal:[],vertical:[]}:S,C=e.snapToGuides,O=void 0===C||C,z=e.elementType,k=void 0===z?null:z,j=s((0,r.useState)(!1),2),M=j[0],E=j[1],T=s((0,r.useState)(null),2),A=T[0],P=T[1],I=(0,r.useRef)({x:0,y:0}),D=(0,r.useRef)({x:0,y:0,width:0,height:0}),W=(0,r.useCallback)(function(e){return o?Math.round(e/l)*l:e},[o,l]),B=(0,r.useCallback)(function(e){if(!O)return e;var t,n=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=c(e))){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw o}}}}(arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?x.vertical:x.horizontal);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(Math.abs(e-r)<=5)return r}}catch(e){n.e(e)}finally{n.f()}return e},[O,x]),F=(0,r.useCallback)(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e;return n=W(n),B(n,t)},[W,B]),H=(0,r.useCallback)(function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(e.preventDefault(),e.stopPropagation(),e.target&&e.target.isConnected)if(e.target.parentNode&&e.target.parentNode.isConnected){E(!0),P(n);var l=o||v||{left:0,top:0},s=a||m||1;I.current={x:(e.clientX-l.left)/s,y:(e.clientY-l.top)/s},D.current=i({},r);var c=function(e){var r=(e.clientX-l.left)/s,a=(e.clientY-l.top)/s,c=r-I.current.x,u=a-I.current.y,f=i({},D.current),h="divider"===k||"line"===k;switch(n){case"nw":h?(f.x=F(D.current.x+c,!1),f.width=F(D.current.width-c,!1)):(f.x=F(D.current.x+c,!1),f.y=F(D.current.y+u,!0),f.width=F(D.current.width-c,!1),f.height=F(D.current.height-u,!0));break;case"ne":h?f.width=F(D.current.width+c,!1):(f.y=F(D.current.y+u,!0),f.width=F(D.current.width+c,!1),f.height=F(D.current.height-u,!0));break;case"sw":h?(f.x=F(D.current.x+c,!1),f.width=F(D.current.width-c,!1)):(f.x=F(D.current.x+c,!1),f.width=F(D.current.width-c,!1),f.height=F(D.current.height+u,!0));break;case"se":h?f.width=F(D.current.width+c,!1):(f.width=F(D.current.width+c,!1),f.height=F(D.current.height+u,!0));break;case"n":h||(f.y=F(D.current.y+u,!0),f.height=F(D.current.height-u,!0));break;case"s":h||(f.height=F(D.current.height+u,!0));break;case"w":f.x=F(D.current.x+c,!1),f.width=F(D.current.width-c,!1);break;case"e":f.width=F(D.current.width+c,!1)}f.width<d&&(n.includes("w")&&(f.x=D.current.x+D.current.width-d),f.width=d),f.height<p&&(n.includes("n")&&(f.y=D.current.y+D.current.height-p),f.height=p);var m=o?o.width/s:g,y=o?o.height/s:_;f.x=Math.max(0,Math.min(m-f.width,f.x)),f.y=Math.max(0,Math.min(y-f.height,f.y)),t&&t(f)},u=function(){E(!1),P(null),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",u)};document.addEventListener("mousemove",c),document.addEventListener("mouseup",u)}else console.warn("Resize handle parent no longer exists in DOM");else console.warn("Resize handle target no longer exists in DOM")},[W,d,p,t,m,v,g,_]);return{isResizing:M,resizeHandle:A,handleResizeStart:H}}},698:(e,t,n)=>{n.d(t,{C:()=>f});var r=n(540);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n){return(t=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e){var t=e.onSelectionChange,n=e.multiSelect,o=void 0===n||n,a=c((0,r.useState)([]),2),l=a[0],u=a[1],d=c((0,r.useState)(null),2),f=d[0],p=d[1],h=(0,r.useCallback)(function(e){o&&arguments.length>1&&void 0!==arguments[1]&&arguments[1]?u(function(n){var r=n.includes(e)?n.filter(function(t){return t!==e}):[].concat(s(n),[e]);return null==t||t(r),r}):(u([e]),null==t||t([e]))},[o,t]),m=(0,r.useCallback)(function(e){u(e),null==t||t(e)},[t]),y=(0,r.useCallback)(function(){u([]),null==t||t([])},[t]),v=(0,r.useCallback)(function(e){return l.includes(e)},[l]),b=(0,r.useCallback)(function(e,t){p({startX:e,startY:t,endX:e,endY:t})},[]),g=(0,r.useCallback)(function(e,t){p(function(n){return n?i(i({},n),{},{endX:e,endY:t}):null})},[]),w=(0,r.useCallback)(function(e){if(f){var n=f.startX,r=f.startY,a=f.endX,i=f.endY,l=Math.min(n,a),c=Math.max(n,a),d=Math.min(r,i),h=Math.max(r,i),m=e.filter(function(e){var t=e.x+e.width/2,n=e.y+e.height/2;return t>=l&&t<=c&&n>=d&&n<=h}).map(function(e){return e.id});m.length>0&&(o?u(function(e){var n=s(new Set([].concat(s(e),s(m))));return null==t||t(n),n}):(u(m),null==t||t(m))),p(null)}},[f,o,t]),_=(0,r.useCallback)(function(){return s(l)},[l]),S=(0,r.useCallback)(function(){return s(l)},[l]);return{selectedElements:l,selectionBox:f,selectElement:h,selectAll:m,clearSelection:y,isSelected:v,startSelectionBox:b,updateSelectionBox:g,endSelectionBox:w,deleteSelected:_,duplicateSelected:S}}},700:(e,t,n)=>{n.d(t,{k:()=>f});var r=n(540);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function l(n,r,o,a){var l=r&&r.prototype instanceof c?r:c,u=Object.create(l.prototype);return i(u,"_invoke",function(n,r,o){var a,i,l,c=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,i=0,l=e,f.n=n,s}};function p(n,r){for(i=n,l=r,t=0;!d&&c&&!o&&t<u.length;t++){var o,a=u[t],p=f.p,h=a[2];n>3?(o=h===r)&&(l=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,i=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,h){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),i=u,l=h;(t=i<2?e:l)||!d;){a||(i?i<3?(i>1&&(f.n=-1),p(i,l)):f.n=l:f.v=l);try{if(c=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?l:n.call(r,f))!==s)break}catch(t){a=e,i=1,l=t}finally{c=1}}return{value:t,done:d}}}(n,o,a),!0),u}var s={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(i(t={},r,function(){return this}),t),p=d.prototype=c.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,i(p,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,o,"GeneratorFunction"),i(p),i(p,o,"Generator"),i(p,r,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(a=function(){return{w:l,m:h}})()}function i(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,t,n,r){function a(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},i(e,t,n,r)}function l(e,t,n,r,o,a,i){try{var l=e[a](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){u(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function u(e,t,n){return(t=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=function(){var e,t,n=(e=(0,r.useState)({defaultCanvasWidth:210,defaultCanvasHeight:297,defaultCanvasUnit:"mm",defaultOrientation:"portrait",canvasBackgroundColor:"#ffffff",canvasShowTransparency:!1,containerBackgroundColor:"#f8f9fa",containerShowTransparency:!1,marginTop:10,marginRight:10,marginBottom:10,marginLeft:10,showMargins:!0,showGrid:!0,gridSize:10,gridColor:"#e0e0e0",gridOpacity:30,snapToGrid:!0,snapToElements:!0,snapToMargins:!0,snapTolerance:5,showGuides:!0,lockGuides:!1,defaultZoom:"100",minZoom:10,maxZoom:500,zoomStep:25,panWithMouse:!0,smoothZoom:!0,showZoomIndicator:!0,zoomWithWheel:!1,zoomToSelection:!0,showResizeHandles:!0,handleSize:8,handleColor:"#007cba",enableRotation:!0,rotationStep:15,rotationSnap:!0,multiSelect:!0,selectAllShortcut:!0,showSelectionBounds:!0,copyPasteEnabled:!0,duplicateOnDrag:!1,exportQuality:"print",exportFormat:"pdf",compressImages:!0,imageQuality:85,maxImageSize:2048,includeMetadata:!0,pdfAuthor:"",pdfSubject:"",autoCrop:!1,embedFonts:!0,optimizeForWeb:!0,enableHardwareAcceleration:!0,limitFps:!0,maxFps:60,autoSaveEnabled:!0,autoSaveInterval:30,autoSaveVersions:10,undoLevels:50,redoLevels:50,enableKeyboardShortcuts:!0,debugMode:!1,showFps:!1,resizeHandleSize:12,resizeHandleColor:"#007cba",resizeHandleBorderColor:"#ffffff",resizeHandleOffset:-6,selectionBorderWidth:2,selectionBorderColor:"var(--primary-color)",selectionShadowOpacity:.1,selectionBorderSpacing:2,resizeZoneSize:16,resizeZoneOpacity:.1,showResizeHandlesLegacy:!0,showResizeZones:!0,selectionAnimation:!0,defaultTextColor:"#000000",defaultBackgroundColor:"#ffffff",defaultFontSize:14,ajaxurl:window.ajaxurl||"",nonce:window.pdfBuilderNonce||""}),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],i=n[1],s=function(){return window.pdfBuilderCanvasSettings?window.pdfBuilderCanvasSettings:null},u=function(){return window.pdfBuilderAjax?{ajaxurl:window.pdfBuilderAjax.ajaxurl||"",nonce:window.pdfBuilderAjax.nonce||""}:{ajaxurl:window.ajaxurl||"",nonce:window.pdfBuilderNonce||window.pdf_builder_nonce||""}};(0,r.useEffect)(function(){var e=s(),t=u();if(e)i(function(n){return c(c(c({},n),t),{},{defaultCanvasWidth:e.default_canvas_width||n.defaultCanvasWidth,defaultCanvasHeight:e.default_canvas_height||n.defaultCanvasHeight,defaultCanvasUnit:e.default_canvas_unit||n.defaultCanvasUnit,defaultOrientation:e.default_orientation||n.defaultOrientation,canvasBackgroundColor:e.canvas_background_color||n.canvasBackgroundColor,canvasShowTransparency:void 0!==e.canvas_show_transparency?e.canvas_show_transparency:n.canvasShowTransparency,containerBackgroundColor:e.container_background_color||n.containerBackgroundColor,containerShowTransparency:void 0!==e.container_show_transparency?e.container_show_transparency:n.containerShowTransparency,marginTop:e.margin_top||n.marginTop,marginRight:e.margin_right||n.marginRight,marginBottom:e.margin_bottom||n.marginBottom,marginLeft:e.margin_left||n.marginLeft,showMargins:void 0!==e.show_margins?e.show_margins:n.showMargins,showGrid:void 0!==e.show_grid?e.show_grid:n.showGrid,gridSize:e.grid_size||n.gridSize,gridColor:e.grid_color||n.gridColor,gridOpacity:e.grid_opacity||n.gridOpacity,snapToGrid:void 0!==e.snap_to_grid?e.snap_to_grid:n.snapToGrid,snapToElements:void 0!==e.snap_to_elements?e.snap_to_elements:n.snapToElements,snapToMargins:void 0!==e.snap_to_margins?e.snap_to_margins:n.snapToMargins,snapTolerance:e.snap_tolerance||n.snapTolerance,showGuides:void 0!==e.show_guides?e.show_guides:n.showGuides,lockGuides:void 0!==e.lock_guides?e.lock_guides:n.lockGuides,defaultZoom:e.default_zoom||n.defaultZoom,minZoom:e.min_zoom||n.minZoom,maxZoom:e.max_zoom||n.maxZoom,zoomStep:e.zoom_step||n.zoomStep,panWithMouse:void 0!==e.pan_with_mouse?e.pan_with_mouse:n.panWithMouse,smoothZoom:void 0!==e.smooth_zoom?e.smooth_zoom:n.smoothZoom,showZoomIndicator:void 0!==e.show_zoom_indicator?e.show_zoom_indicator:n.showZoomIndicator,zoomWithWheel:void 0!==e.zoom_with_wheel?e.zoom_with_wheel:n.zoomWithWheel,zoomToSelection:void 0!==e.zoom_to_selection?e.zoom_to_selection:n.zoomToSelection,showResizeHandles:!0,handleSize:e.handle_size||n.handleSize,handleColor:e.handle_color||n.handleColor,enableRotation:void 0!==e.enable_rotation?e.enable_rotation:n.enableRotation,rotationStep:e.rotation_step||n.rotationStep,rotationSnap:void 0!==e.rotation_snap?e.rotation_snap:n.rotationSnap,multiSelect:void 0!==e.multi_select?e.multi_select:n.multiSelect,selectAllShortcut:void 0!==e.select_all_shortcut?e.select_all_shortcut:n.selectAllShortcut,showSelectionBounds:void 0!==e.show_selection_bounds?e.show_selection_bounds:n.showSelectionBounds,copyPasteEnabled:void 0!==e.copy_paste_enabled?e.copy_paste_enabled:n.copyPasteEnabled,duplicateOnDrag:void 0!==e.duplicate_on_drag?e.duplicate_on_drag:n.duplicateOnDrag,exportQuality:e.export_quality||n.exportQuality,exportFormat:e.export_format||n.exportFormat,compressImages:void 0!==e.compress_images?e.compress_images:n.compressImages,imageQuality:e.image_quality||n.imageQuality,maxImageSize:e.max_image_size||n.maxImageSize,includeMetadata:void 0!==e.include_metadata?e.include_metadata:n.includeMetadata,pdfAuthor:e.pdf_author||n.pdfAuthor,pdfSubject:e.pdf_subject||n.pdfSubject,autoCrop:void 0!==e.auto_crop?e.auto_crop:n.autoCrop,embedFonts:void 0!==e.embed_fonts?e.embed_fonts:n.embedFonts,optimizeForWeb:void 0!==e.optimize_for_web?e.optimize_for_web:n.optimizeForWeb,enableHardwareAcceleration:void 0!==e.enable_hardware_acceleration?e.enable_hardware_acceleration:n.enableHardwareAcceleration,limitFps:void 0!==e.limit_fps?e.limit_fps:n.limitFps,maxFps:e.max_fps||n.maxFps,autoSaveEnabled:void 0!==e.auto_save_enabled?e.auto_save_enabled:n.autoSaveEnabled,autoSaveInterval:e.auto_save_interval||n.autoSaveInterval,autoSaveVersions:e.auto_save_versions||n.autoSaveVersions,undoLevels:e.undo_levels||n.undoLevels,redoLevels:e.redo_levels||n.redoLevels,enableKeyboardShortcuts:void 0!==e.enable_keyboard_shortcuts?e.enable_keyboard_shortcuts:n.enableKeyboardShortcuts,debugMode:void 0!==e.debug_mode?e.debug_mode:n.debugMode,showFps:void 0!==e.show_fps?e.show_fps:n.showFps,resizeHandleSize:e.canvas_handle_size||n.resizeHandleSize,resizeHandleColor:e.canvas_handle_color||n.resizeHandleColor,resizeHandleBorderColor:e.canvas_handle_hover_color||n.resizeHandleBorderColor,selectionBorderWidth:e.canvas_border_width||n.selectionBorderWidth,selectionBorderColor:e.canvas_border_color||n.selectionBorderColor,selectionBorderSpacing:e.canvas_border_spacing||n.selectionBorderSpacing,showResizeHandlesLegacy:void 0!==e.canvas_resize_handles_enabled?e.canvas_resize_handles_enabled:n.showResizeHandlesLegacy,showResizeZones:void 0!==e.canvas_element_borders_enabled?e.canvas_element_borders_enabled:n.showResizeZones,defaultTextColor:e.default_text_color||n.defaultTextColor,defaultBackgroundColor:e.default_background_color||n.defaultBackgroundColor,defaultFontSize:e.default_font_size||n.defaultFontSize})});else{var n=u(),r=localStorage.getItem("pdf-builder-global-settings");if(r)try{var o=JSON.parse(r);o.showResizeHandles=!0,i(function(e){return c(c(c({},e),n),o)})}catch(e){i(function(e){return c(c({},e),n)})}else i(function(e){return c(c({},e),n)})}},[]),(0,r.useEffect)(function(){var e=function(e){p()};return window.addEventListener("pdfBuilderSettingsUpdated",e),function(){window.removeEventListener("pdfBuilderSettingsUpdated",e)}},[]),(0,r.useEffect)(function(){var e=document.documentElement;e.style.setProperty("--resize-handle-size","".concat(o.resizeHandleSize,"px")),e.style.setProperty("--resize-handle-color",o.resizeHandleColor),e.style.setProperty("--resize-handle-border-color",o.resizeHandleBorderColor),e.style.setProperty("--resize-handle-offset","".concat(o.resizeHandleOffset,"px")),e.style.setProperty("--selection-border-width","".concat(o.selectionBorderWidth,"px")),e.style.setProperty("--selection-border-color",o.selectionBorderColor),e.style.setProperty("--selection-border-spacing","".concat(o.selectionBorderSpacing,"px")),e.style.setProperty("--selection-shadow-opacity",o.selectionShadowOpacity),e.style.setProperty("--resize-zone-size","".concat(o.resizeZoneSize,"px")),e.style.setProperty("--resize-zone-opacity",o.resizeZoneOpacity),e.style.setProperty("--show-resize-handles",o.showResizeHandles?"block":"none"),e.style.setProperty("--show-resize-zones",o.showResizeZones?"auto":"none"),e.style.setProperty("--selection-animation",o.selectionAnimation?"all 0.2s ease":"none")},[o]);var f=function(){var e,t=(e=a().m(function e(t){return a().w(function(e){for(;;)switch(e.n){case 0:i(function(e){var n=c(c({},e),t);n.showResizeHandles=!0,localStorage.setItem("pdf-builder-global-settings",JSON.stringify(n));var r=u();if(r.ajaxurl&&r.nonce){var o={show_grid:n.showGrid,grid_size:n.gridSize,grid_color:n.gridColor,grid_opacity:n.gridOpacity,snap_to_grid:n.snapToGrid,snap_to_elements:n.snapToElements,snap_to_margins:n.snapToMargins,snap_tolerance:n.snapTolerance,show_guides:n.showGuides,lock_guides:n.lockGuides,default_zoom:n.defaultZoom,min_zoom:n.minZoom,max_zoom:n.maxZoom,zoom_step:n.zoomStep,pan_with_mouse:n.panWithMouse,smooth_zoom:n.smoothZoom,show_zoom_indicator:n.showZoomIndicator,zoom_with_wheel:n.zoomWithWheel,zoom_to_selection:n.zoomToSelection,show_resize_handles:n.showResizeHandles,handle_size:n.handleSize,handle_color:n.handleColor,enable_rotation:n.enableRotation,rotation_step:n.rotationStep,rotation_snap:n.rotationSnap,multi_select:n.multiSelect,select_all_shortcut:n.selectAllShortcut,show_selection_bounds:n.showSelectionBounds,copy_paste_enabled:n.copyPasteEnabled,duplicate_on_drag:n.duplicateOnDrag,export_quality:n.exportQuality,export_format:n.exportFormat,compress_images:n.compressImages,image_quality:n.imageQuality,max_image_size:n.maxImageSize,include_metadata:n.includeMetadata,pdf_author:n.pdfAuthor,pdf_subject:n.pdfSubject,auto_crop:n.autoCrop,embed_fonts:n.embedFonts,optimize_for_web:n.optimizeForWeb,enable_hardware_acceleration:n.enableHardwareAcceleration,limit_fps:n.limitFps,max_fps:n.maxFps,auto_save_enabled:n.autoSaveEnabled,auto_save_interval:n.autoSaveInterval,auto_save_versions:n.autoSaveVersions,undo_levels:n.undoLevels,redo_levels:n.redoLevels,enable_keyboard_shortcuts:n.enableKeyboardShortcuts,debug_mode:n.debugMode,show_fps:n.showFps,default_canvas_width:n.defaultCanvasWidth,default_canvas_height:n.defaultCanvasHeight,default_canvas_unit:n.defaultCanvasUnit,canvas_background_color:n.canvasBackgroundColor,canvas_show_transparency:n.canvasShowTransparency,margin_top:n.marginTop,margin_right:n.marginRight,margin_bottom:n.marginBottom,margin_left:n.marginLeft,show_margins:n.showMargins};fetch(r.ajaxurl+"?action=pdf_builder_save_settings_page",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c(c({},o),{},{nonce:r.nonce}))}).then(function(e){e.ok||console.warn("Erreur lors de la sauvegarde des paramètres dans WordPress:",e.status)}).catch(function(e){console.warn("Erreur AJAX lors de la sauvegarde des paramètres:",e)})}return n});case 1:return e.a(2)}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){l(a,r,o,i,s,"next",e)}function s(e){l(a,r,o,i,s,"throw",e)}i(void 0)})});return function(e){return t.apply(this,arguments)}}(),p=function(){var e=s(),t=u();e&&i(function(n){return c(c(c({},n),t),{},{defaultCanvasWidth:e.default_canvas_width||n.defaultCanvasWidth,defaultCanvasHeight:e.default_canvas_height||n.defaultCanvasHeight,defaultCanvasUnit:e.default_canvas_unit||n.defaultCanvasUnit,defaultOrientation:e.default_orientation||n.defaultOrientation,canvasBackgroundColor:e.canvas_background_color||n.canvasBackgroundColor,canvasShowTransparency:void 0!==e.canvas_show_transparency?e.canvas_show_transparency:n.canvasShowTransparency,containerBackgroundColor:e.container_background_color||n.containerBackgroundColor,containerShowTransparency:void 0!==e.container_show_transparency?e.container_show_transparency:n.containerShowTransparency,marginTop:e.margin_top||n.marginTop,marginRight:e.margin_right||n.marginRight,marginBottom:e.margin_bottom||n.marginBottom,marginLeft:e.margin_left||n.marginLeft,showMargins:void 0!==e.show_margins?e.show_margins:n.showMargins,showGrid:void 0!==e.show_grid?e.show_grid:n.showGrid,gridSize:e.grid_size||n.gridSize,gridColor:e.grid_color||n.gridColor,gridOpacity:e.grid_opacity||n.gridOpacity,snapToGrid:void 0!==e.snap_to_grid?e.snap_to_grid:n.snapToGrid,snapToElements:void 0!==e.snap_to_elements?e.snap_to_elements:n.snapToElements,snapToMargins:void 0!==e.snap_to_margins?e.snap_to_margins:n.snapToMargins,snapTolerance:e.snap_tolerance||n.snapTolerance,showGuides:void 0!==e.show_guides?e.show_guides:n.showGuides,lockGuides:void 0!==e.lock_guides?e.lock_guides:n.lockGuides,defaultZoom:e.default_zoom||n.defaultZoom,minZoom:e.min_zoom||n.minZoom,maxZoom:e.max_zoom||n.maxZoom,zoomStep:e.zoom_step||n.zoomStep,panWithMouse:void 0!==e.pan_with_mouse?e.pan_with_mouse:n.panWithMouse,smoothZoom:void 0!==e.smooth_zoom?e.smooth_zoom:n.smoothZoom,showZoomIndicator:void 0!==e.show_zoom_indicator?e.show_zoom_indicator:n.showZoomIndicator,zoomWithWheel:void 0!==e.zoom_with_wheel?e.zoom_with_wheel:n.zoomWithWheel,zoomToSelection:void 0!==e.zoom_to_selection?e.zoom_to_selection:n.zoomToSelection,showResizeHandles:!0,handleSize:e.handle_size||n.handleSize,handleColor:e.handle_color||n.handleColor,enableRotation:void 0!==e.enable_rotation?e.enable_rotation:n.enableRotation,rotationStep:e.rotation_step||n.rotationStep,rotationSnap:void 0!==e.rotation_snap?e.rotation_snap:n.rotationSnap,multiSelect:void 0!==e.multi_select?e.multi_select:n.multiSelect,selectAllShortcut:void 0!==e.select_all_shortcut?e.select_all_shortcut:n.selectAllShortcut,showSelectionBounds:void 0!==e.show_selection_bounds?e.show_selection_bounds:n.showSelectionBounds,copyPasteEnabled:void 0!==e.copy_paste_enabled?e.copy_paste_enabled:n.copyPasteEnabled,duplicateOnDrag:void 0!==e.duplicate_on_drag?e.duplicate_on_drag:n.duplicateOnDrag,exportQuality:e.export_quality||n.exportQuality,exportFormat:e.export_format||n.exportFormat,compressImages:void 0!==e.compress_images?e.compress_images:n.compressImages,imageQuality:e.image_quality||n.imageQuality,maxImageSize:e.max_image_size||n.maxImageSize,includeMetadata:void 0!==e.include_metadata?e.include_metadata:n.includeMetadata,pdfAuthor:e.pdf_author||n.pdfAuthor,pdfSubject:e.pdf_subject||n.pdfSubject,autoCrop:void 0!==e.auto_crop?e.auto_crop:n.autoCrop,embedFonts:void 0!==e.embed_fonts?e.embed_fonts:n.embedFonts,optimizeForWeb:void 0!==e.optimize_for_web?e.optimize_for_web:n.optimizeForWeb,enableHardwareAcceleration:void 0!==e.enable_hardware_acceleration?e.enable_hardware_acceleration:n.enableHardwareAcceleration,limitFps:void 0!==e.limit_fps?e.limit_fps:n.limitFps,maxFps:e.max_fps||n.maxFps,autoSaveEnabled:void 0!==e.auto_save_enabled?e.auto_save_enabled:n.autoSaveEnabled,autoSaveInterval:e.auto_save_interval||n.autoSaveInterval,autoSaveVersions:e.auto_save_versions||n.autoSaveVersions,undoLevels:e.undo_levels||n.undoLevels,redoLevels:e.redo_levels||n.redoLevels,enableKeyboardShortcuts:void 0!==e.enable_keyboard_shortcuts?e.enable_keyboard_shortcuts:n.enableKeyboardShortcuts,debugMode:void 0!==e.debug_mode?e.debug_mode:n.debugMode,showFps:void 0!==e.show_fps?e.show_fps:n.showFps,resizeHandleSize:e.canvas_handle_size||n.resizeHandleSize,resizeHandleColor:e.canvas_handle_color||n.resizeHandleColor,resizeHandleBorderColor:e.canvas_handle_hover_color||n.resizeHandleBorderColor,selectionBorderWidth:e.canvas_border_width||n.selectionBorderWidth,selectionBorderColor:e.canvas_border_color||n.selectionBorderColor,selectionBorderSpacing:e.canvas_border_spacing||n.selectionBorderSpacing,showResizeHandlesLegacy:void 0!==e.canvas_resize_handles_enabled?e.canvas_resize_handles_enabled:n.showResizeHandlesLegacy,showResizeZones:void 0!==e.canvas_element_borders_enabled?e.canvas_element_borders_enabled:n.showResizeZones,defaultTextColor:e.default_text_color||n.defaultTextColor,defaultBackgroundColor:e.default_background_color||n.defaultBackgroundColor,defaultFontSize:e.default_font_size||n.defaultFontSize})})};return{settings:o,updateSettings:f,resetToDefaults:function(){i({resizeHandleSize:12,resizeHandleColor:"#007cba",resizeHandleBorderColor:"#ffffff",selectionBorderWidth:2,selectionBorderColor:"var(--primary-color)",selectionBorderSpacing:2,selectionShadowOpacity:.1,resizeZoneSize:16,resizeZoneOpacity:.1,showResizeHandles:!0,showResizeZones:!0,selectionAnimation:!0})},refreshSettings:p}}},743:(e,t,n)=>{n.d(t,{R:()=>f});var r=n(540),o=n(455),a=n(779);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e,t,n){var l=u((0,r.useState)({}),2),d=l[0],f=l[1],p=u((0,r.useState)("appearance"),2),h=p[0],m=p[1],y=(0,r.useMemo)(function(){return e.length>0?t.find(function(t){return t.id===e[0]}):null},[e,t]);(0,r.useEffect)(function(){if(y){var e={color:"#333333",backgroundColor:"transparent",borderColor:"#dddddd",borderWidth:0,borderStyle:"solid",borderRadius:4,fontSize:14,fontFamily:"Inter",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",textAlign:"left",lineHeight:1.2,letterSpacing:0},t=y.type,n=s({},e);Object.keys(e).forEach(function(e){var r=(0,a.Dw)(t,e);null!==r&&(n[e]=r),"special"===a.xG[t]&&"backgroundColor"===e&&(n[e]="transparent")});var r=s(s({},n),y);Object.keys(n).forEach(function(e){if((0,a.Qn)(t,e))"special"!==a.xG[t]||"backgroundColor"!==e||r[e]||(r[e]="transparent");else{var n=(0,a.uF)(t,e,r[e]);n!==r[e]&&(r[e]=n)}}),Object.keys(r).forEach(function(e){(0,a.qb)(t,e,r[e]).valid||(r[e]=(0,a.uF)(t,e,r[e]))}),f(r)}else f({})},[null==y?void 0:y.id]);var v=(0,r.useCallback)(function(e,r,l){var u=t.find(function(t){return t.id===e});if(u){var d=l;if((0,a.qb)(u.type,r,l).valid){if("boolean"!=typeof l&&!r.startsWith("columns."))try{var p=o.l.validateProperty(r,l);void 0!==p&&(d=p)}catch(e){}f(function(e){var t;return r.includes(".")?function(e,t,n){var r=t.split("."),o=r.pop();r.reduce(function(e,t){return e[t]&&"object"===i(e[t])?e[t]=s({},e[t]):e[t]={},e[t]},e)[o]=n}(t=s({},e),r,d):t=s(s({},e),{},c({},r,d)),t}),n(e,r,d)}}},[n,t]),b=(0,r.useCallback)(function(e,t){var n={"color-dark":{color:"#1e293b"},"color-light":{color:"#f8fafc"},"color-primary":{color:"#2563eb"},"color-success":{color:"#16a34a"},"color-warning":{color:"#ca8a04"},"color-error":{color:"#dc2626"},"text-title":{fontSize:24,fontWeight:"bold",textAlign:"center"},"text-subtitle":{fontSize:18,fontWeight:"bold",textAlign:"left"},"text-body":{fontSize:14,fontWeight:"normal",textAlign:"left"},"text-caption":{fontSize:12,fontWeight:"normal",textAlign:"left"},"shape-rounded":{borderRadius:8},"shape-circle":{borderRadius:50},"shape-square":{borderRadius:0},"effect-shadow":{shadow:!0,shadowColor:"#000000",shadowOffsetX:2,shadowOffsetY:2},"effect-glow":{shadow:!0,shadowColor:"#2563eb",shadowOffsetX:0,shadowOffsetY:0},"effect-none":{shadow:!1,brightness:100,contrast:100,saturate:100}};n[t]&&Object.entries(n[t]).forEach(function(t){var n=u(t,2),r=n[0],o=n[1];v(e,r,o)})},[v]),g=(0,r.useCallback)(function(e){Object.entries({x:50,y:50,width:100,height:50,backgroundColor:"#ffffff",borderColor:"#dddddd",borderWidth:1,borderStyle:"solid",borderRadius:4,color:"#333333",fontSize:14,fontFamily:"Inter",fontWeight:"normal",fontStyle:"normal",textAlign:"left",textDecoration:"none",lineHeight:1.2,letterSpacing:0,opacity:100,rotation:0,scale:100,shadow:!1,brightness:100,contrast:100,saturate:100}).forEach(function(t){var n=u(t,2),r=n[0],o=n[1];v(e,r,o)})},[v]);return{localProperties:d,activeTab:h,setActiveTab:m,selectedElement:y,handlePropertyChange:v,applyPropertyPreset:b,resetProperties:g,validatePropertyValue:function(e,t){switch(e){case"x":case"y":case"width":case"height":return Math.max(0,parseInt(t)||0);case"fontSize":return Math.max(8,Math.min(72,parseInt(t)||14));case"lineHeight":return Math.max(.5,Math.min(5,parseFloat(t)||1.2));case"letterSpacing":return Math.max(-5,Math.min(20,parseFloat(t)||0));case"borderWidth":return Math.max(0,Math.min(20,parseInt(t)||0));case"borderStyle":return["solid","dashed","dotted","double"].includes(t)?t:"solid";case"borderRadius":return Math.max(0,Math.min(100,parseInt(t)||0));case"rotation":return((parseInt(t)||0)%360+360)%360;case"scale":return Math.max(10,Math.min(200,parseInt(t)||100));case"opacity":return Math.max(0,Math.min(100,parseInt(t)||100));case"brightness":case"contrast":case"saturate":return Math.max(0,Math.min(200,parseInt(t)||100));case"shadowOffsetX":case"shadowOffsetY":return Math.max(-50,Math.min(50,parseInt(t)||0));default:return t}}}}},874:(e,t,n)=>{n.d(t,{I:()=>o});var r=n(540),o=function(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e3,i=(0,r.useRef)(new Map),l=(0,r.useRef)(null),s=(0,r.useRef)(new Map),c=(0,r.useCallback)(function(e,t,n){l.current&&clearTimeout(l.current);var r="".concat(e,".").concat(t);i.current.set(r,{elementId:e,property:t,value:n}),o&&(l.current=setTimeout(function(){d()},a))},[o,a]),u=(0,r.useCallback)(function(e,n,r){l.current&&clearTimeout(l.current),t(e,n,r);var o="".concat(e,".").concat(n);s.current.set(o,r),i.current.delete(o)},[t]),d=(0,r.useCallback)(function(){if(0!==i.current.size){var e=Array.from(i.current.values()),r=e.reduce(function(e,t){return e[t.elementId]||(e[t.elementId]={}),e[t.elementId][t.property]=t.value,e},{});n&&Object.keys(r).length>1?n(r):e.forEach(function(e){var n=e.elementId,r=e.property,o=e.value;t(n,r,o)}),e.forEach(function(e){var t=e.elementId,n=e.property,r=e.value,o="".concat(t,".").concat(n);s.current.set(o,r)}),i.current.clear()}},[t,n]),f=(0,r.useCallback)(function(){d()},[d]),p=(0,r.useCallback)(function(){return i.current.size>0},[]),h=(0,r.useCallback)(function(e){var t=[];return i.current.forEach(function(n,r){n.elementId===e&&t.push(n)}),t},[]),m=(0,r.useCallback)(function(e){var t=[];i.current.forEach(function(n,r){n.elementId===e&&t.push(r)}),t.forEach(function(e){return i.current.delete(e)})},[]),y=(0,r.useCallback)(function(e,t){var n="".concat(e,".").concat(t),r=s.current.get(n);return void 0!==r?(i.current.delete(n),r):null},[]),v=(0,r.useCallback)(function(e,t,n,r){var o=n;return r&&(o=r(n)),o=b(t,o),c(e,t,o),o},[c]),b=function(e,t){switch(e){case"x":case"y":case"width":case"height":return Math.max(0,parseInt(t)||0);case"fontSize":return Math.max(8,Math.min(72,parseInt(t)||14));case"borderWidth":return Math.max(0,Math.min(20,parseInt(t)||0));case"borderRadius":return Math.max(0,Math.min(100,parseInt(t)||0));case"rotation":return((parseInt(t)||0)%360+360)%360;case"scale":return Math.max(10,Math.min(200,parseInt(t)||100));case"opacity":return Math.max(0,Math.min(100,parseInt(t)||100));case"brightness":case"contrast":case"saturate":return Math.max(0,Math.min(200,parseInt(t)||100));case"shadowOffsetX":case"shadowOffsetY":return Math.max(-50,Math.min(50,parseInt(t)||0));default:return t}};return(0,r.useEffect)(function(){return function(){l.current&&clearTimeout(l.current)}},[]),(0,r.useEffect)(function(){o&&i.current.size>0&&d()},[e,o,d]),{sync:c,syncImmediate:u,syncPending:d,forceSync:f,hasPendingChanges:p,getPendingChanges:h,cancelPendingChanges:m,validateAndSync:v,restoreLastSaved:y,pendingChangesCount:i.current.size}}},920:(e,t,n)=>{n.d(t,{o:()=>i});var r=n(540);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],s=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=o((0,r.useState)(!1),2),i=a[0],l=a[1],s=o((0,r.useState)({angle:0,centerX:0,centerY:0}),2),c=s[0],u=s[1],d=(0,r.useCallback)(function(r,o){r.preventDefault(),r.stopPropagation(),l(!0);var a=r.currentTarget.getBoundingClientRect(),s=a.left+a.width/2,d=a.top+a.height/2,f=r.clientX-s,p=r.clientY-d,h=Math.atan2(p,f)*(180/Math.PI);u({angle:h-(o.rotation||0),centerX:s,centerY:d});var m=function(r){if(i){var o=r.clientX-s,a=r.clientY-d,l=Math.atan2(a,o)*(180/Math.PI);l-=c.angle,n&&(l=Math.round(l/t)*t),e(l=(l%360+360)%360)}},y=function(){l(!1),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",y)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",y)},[i,c,t,n,e]);return{isRotating:i,handleRotationStart:d}}},960:(e,t,n)=>{n.d(t,{K:()=>o});var r=n(540),o=function(e){var t=e.onDelete,n=e.onCopy,o=e.onPaste,a=e.onUndo,i=e.onRedo,l=e.onSave,s=e.onZoomIn,c=e.onZoomOut,u=e.onSelectAll,d=e.onDeselectAll,f=e.onToolSelect,p=e.onToggleGrid,h=e.onTogglePreview;(0,r.useEffect)(function(){var e=function(e){if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&"true"!==e.target.contentEditable){var r=e.ctrlKey||e.metaKey;switch(e.key.toLowerCase()){case"delete":case"backspace":t&&(e.preventDefault(),t());break;case"c":r&&n&&(e.preventDefault(),n());break;case"v":r&&o&&(e.preventDefault(),o());break;case"z":r&&(e.preventDefault(),e.shiftKey&&i?i():a&&a());break;case"y":r&&i&&(e.preventDefault(),i());break;case"s":r&&l&&(e.preventDefault(),l());break;case"+":case"=":r&&s&&(e.preventDefault(),s());break;case"-":r&&c&&(e.preventDefault(),c());break;case"a":r&&u&&(e.preventDefault(),u());break;case"d":r&&d&&(e.preventDefault(),d());break;case"g":r&&p&&(e.preventDefault(),p());break;case"p":r&&h&&(e.preventDefault(),h());break;case"v":!r&&f&&(e.preventDefault(),f("select"));break;case"r":!r&&f&&(e.preventDefault(),f("rectangle"));break;case"t":!r&&f&&(e.preventDefault(),f("text"));break;case"i":!r&&f&&(e.preventDefault(),f("image"));break;case"l":!r&&f&&(e.preventDefault(),f("line"))}}};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[t,n,o,a,i,l,s,c,u,d,f,p,h])}}}]);